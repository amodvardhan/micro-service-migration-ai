function vW(i,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in i)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(i,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function _0(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function sc(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var s=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return i[r]}})}),n}var MU={exports:{}},A1={},AU={exports:{}},cn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b0=Symbol.for("react.element"),xW=Symbol.for("react.portal"),_W=Symbol.for("react.fragment"),bW=Symbol.for("react.strict_mode"),SW=Symbol.for("react.profiler"),wW=Symbol.for("react.provider"),TW=Symbol.for("react.context"),EW=Symbol.for("react.forward_ref"),MW=Symbol.for("react.suspense"),AW=Symbol.for("react.memo"),CW=Symbol.for("react.lazy"),xk=Symbol.iterator;function RW(i){return i===null||typeof i!="object"?null:(i=xk&&i[xk]||i["@@iterator"],typeof i=="function"?i:null)}var CU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},RU=Object.assign,PU={};function Fp(i,e,n){this.props=i,this.context=e,this.refs=PU,this.updater=n||CU}Fp.prototype.isReactComponent={};Fp.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};Fp.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function NU(){}NU.prototype=Fp.prototype;function DR(i,e,n){this.props=i,this.context=e,this.refs=PU,this.updater=n||CU}var OR=DR.prototype=new NU;OR.constructor=DR;RU(OR,Fp.prototype);OR.isPureReactComponent=!0;var _k=Array.isArray,kU=Object.prototype.hasOwnProperty,FR={current:null},LU={key:!0,ref:!0,__self:!0,__source:!0};function IU(i,e,n){var r,s={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)kU.call(e,r)&&!LU.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(i&&i.defaultProps)for(r in l=i.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:b0,type:i,key:o,ref:a,props:s,_owner:FR.current}}function PW(i,e){return{$$typeof:b0,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function BR(i){return typeof i=="object"&&i!==null&&i.$$typeof===b0}function NW(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(n){return e[n]})}var bk=/\/+/g;function zw(i,e){return typeof i=="object"&&i!==null&&i.key!=null?NW(""+i.key):e.toString(36)}function f_(i,e,n,r,s){var o=typeof i;(o==="undefined"||o==="boolean")&&(i=null);var a=!1;if(i===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(i.$$typeof){case b0:case xW:a=!0}}if(a)return a=i,s=s(a),i=r===""?"."+zw(a,0):r,_k(s)?(n="",i!=null&&(n=i.replace(bk,"$&/")+"/"),f_(s,e,n,"",function(u){return u})):s!=null&&(BR(s)&&(s=PW(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(bk,"$&/")+"/")+i)),e.push(s)),1;if(a=0,r=r===""?".":r+":",_k(i))for(var l=0;l<i.length;l++){o=i[l];var c=r+zw(o,l);a+=f_(o,e,n,c,s)}else if(c=RW(i),typeof c=="function")for(i=c.call(i),l=0;!(o=i.next()).done;)o=o.value,c=r+zw(o,l++),a+=f_(o,e,n,c,s);else if(o==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function uv(i,e,n){if(i==null)return i;var r=[],s=0;return f_(i,r,"","",function(o){return e.call(n,o,s++)}),r}function kW(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(n){(i._status===0||i._status===-1)&&(i._status=1,i._result=n)},function(n){(i._status===0||i._status===-1)&&(i._status=2,i._result=n)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var ls={current:null},p_={transition:null},LW={ReactCurrentDispatcher:ls,ReactCurrentBatchConfig:p_,ReactCurrentOwner:FR};function DU(){throw Error("act(...) is not supported in production builds of React.")}cn.Children={map:uv,forEach:function(i,e,n){uv(i,function(){e.apply(this,arguments)},n)},count:function(i){var e=0;return uv(i,function(){e++}),e},toArray:function(i){return uv(i,function(e){return e})||[]},only:function(i){if(!BR(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};cn.Component=Fp;cn.Fragment=_W;cn.Profiler=SW;cn.PureComponent=DR;cn.StrictMode=bW;cn.Suspense=MW;cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LW;cn.act=DU;cn.cloneElement=function(i,e,n){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var r=RU({},i.props),s=i.key,o=i.ref,a=i._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=FR.current),e.key!==void 0&&(s=""+e.key),i.type&&i.type.defaultProps)var l=i.type.defaultProps;for(c in e)kU.call(e,c)&&!LU.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:b0,type:i.type,key:s,ref:o,props:r,_owner:a}};cn.createContext=function(i){return i={$$typeof:TW,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:wW,_context:i},i.Consumer=i};cn.createElement=IU;cn.createFactory=function(i){var e=IU.bind(null,i);return e.type=i,e};cn.createRef=function(){return{current:null}};cn.forwardRef=function(i){return{$$typeof:EW,render:i}};cn.isValidElement=BR;cn.lazy=function(i){return{$$typeof:CW,_payload:{_status:-1,_result:i},_init:kW}};cn.memo=function(i,e){return{$$typeof:AW,type:i,compare:e===void 0?null:e}};cn.startTransition=function(i){var e=p_.transition;p_.transition={};try{i()}finally{p_.transition=e}};cn.unstable_act=DU;cn.useCallback=function(i,e){return ls.current.useCallback(i,e)};cn.useContext=function(i){return ls.current.useContext(i)};cn.useDebugValue=function(){};cn.useDeferredValue=function(i){return ls.current.useDeferredValue(i)};cn.useEffect=function(i,e){return ls.current.useEffect(i,e)};cn.useId=function(){return ls.current.useId()};cn.useImperativeHandle=function(i,e,n){return ls.current.useImperativeHandle(i,e,n)};cn.useInsertionEffect=function(i,e){return ls.current.useInsertionEffect(i,e)};cn.useLayoutEffect=function(i,e){return ls.current.useLayoutEffect(i,e)};cn.useMemo=function(i,e){return ls.current.useMemo(i,e)};cn.useReducer=function(i,e,n){return ls.current.useReducer(i,e,n)};cn.useRef=function(i){return ls.current.useRef(i)};cn.useState=function(i){return ls.current.useState(i)};cn.useSyncExternalStore=function(i,e,n){return ls.current.useSyncExternalStore(i,e,n)};cn.useTransition=function(){return ls.current.useTransition()};cn.version="18.3.1";AU.exports=cn;var I=AU.exports;const ns=_0(I),ib=vW({__proto__:null,default:ns},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IW=I,DW=Symbol.for("react.element"),OW=Symbol.for("react.fragment"),FW=Object.prototype.hasOwnProperty,BW=IW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UW={key:!0,ref:!0,__self:!0,__source:!0};function OU(i,e,n){var r,s={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)FW.call(e,r)&&!UW.hasOwnProperty(r)&&(s[r]=e[r]);if(i&&i.defaultProps)for(r in e=i.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:DW,type:i,key:o,ref:a,props:s,_owner:BW.current}}A1.Fragment=OW;A1.jsx=OU;A1.jsxs=OU;MU.exports=A1;var UR=MU.exports;const zW=UR.Fragment,Y=UR.jsx,lt=UR.jsxs;var sA={},FU={exports:{}},ao={},BU={exports:{}},UU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(D,X){var q=D.length;D.push(X);e:for(;0<q;){var J=q-1>>>1,se=D[J];if(0<s(se,X))D[J]=X,D[q]=se,q=J;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var X=D[0],q=D.pop();if(q!==X){D[0]=q;e:for(var J=0,se=D.length,de=se>>>1;J<de;){var G=2*(J+1)-1,Q=D[G],ee=G+1,ie=D[ee];if(0>s(Q,q))ee<se&&0>s(ie,Q)?(D[J]=ie,D[ee]=q,J=ee):(D[J]=Q,D[G]=q,J=G);else if(ee<se&&0>s(ie,q))D[J]=ie,D[ee]=q,J=ee;else break e}}return X}function s(D,X){var q=D.sortIndex-X.sortIndex;return q!==0?q:D.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();i.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(D){for(var X=n(u);X!==null;){if(X.callback===null)r(u);else if(X.startTime<=D)r(u),X.sortIndex=X.expirationTime,e(c,X);else break;X=n(u)}}function b(D){if(y=!1,x(D),!m)if(n(c)!==null)m=!0,P(S);else{var X=n(u);X!==null&&W(b,X.startTime-D)}}function S(D,X){m=!1,y&&(y=!1,g(E),E=-1),p=!0;var q=f;try{for(x(X),h=n(c);h!==null&&(!(h.expirationTime>X)||D&&!R());){var J=h.callback;if(typeof J=="function"){h.callback=null,f=h.priorityLevel;var se=J(h.expirationTime<=X);X=i.unstable_now(),typeof se=="function"?h.callback=se:h===n(c)&&r(c),x(X)}else r(c);h=n(c)}if(h!==null)var de=!0;else{var G=n(u);G!==null&&W(b,G.startTime-X),de=!1}return de}finally{h=null,f=q,p=!1}}var T=!1,w=null,E=-1,A=5,M=-1;function R(){return!(i.unstable_now()-M<A)}function F(){if(w!==null){var D=i.unstable_now();M=D;var X=!0;try{X=w(!0,D)}finally{X?B():(T=!1,w=null)}}else T=!1}var B;if(typeof _=="function")B=function(){_(F)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,L=C.port2;C.port1.onmessage=F,B=function(){L.postMessage(null)}}else B=function(){v(F,0)};function P(D){w=D,T||(T=!0,B())}function W(D,X){E=v(function(){D(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(D){D.callback=null},i.unstable_continueExecution=function(){m||p||(m=!0,P(S))},i.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<D?Math.floor(1e3/D):5},i.unstable_getCurrentPriorityLevel=function(){return f},i.unstable_getFirstCallbackNode=function(){return n(c)},i.unstable_next=function(D){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var q=f;f=X;try{return D()}finally{f=q}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(D,X){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var q=f;f=D;try{return X()}finally{f=q}},i.unstable_scheduleCallback=function(D,X,q){var J=i.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?J+q:J):q=J,D){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=q+se,D={id:d++,callback:X,priorityLevel:D,startTime:q,expirationTime:se,sortIndex:-1},q>J?(D.sortIndex=q,e(u,D),n(c)===null&&D===n(u)&&(y?(g(E),E=-1):y=!0,W(b,q-J))):(D.sortIndex=se,e(c,D),m||p||(m=!0,P(S))),D},i.unstable_shouldYield=R,i.unstable_wrapCallback=function(D){var X=f;return function(){var q=f;f=X;try{return D.apply(this,arguments)}finally{f=q}}}})(UU);BU.exports=UU;var VW=BU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $W=I,so=VW;function ze(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zU=new Set,sy={};function jd(i,e){Qf(i,e),Qf(i+"Capture",e)}function Qf(i,e){for(sy[i]=e,i=0;i<e.length;i++)zU.add(e[i])}var Xl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oA=Object.prototype.hasOwnProperty,GW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sk={},wk={};function HW(i){return oA.call(wk,i)?!0:oA.call(Sk,i)?!1:GW.test(i)?wk[i]=!0:(Sk[i]=!0,!1)}function WW(i,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function jW(i,e,n,r){if(e===null||typeof e>"u"||WW(i,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function cs(i,e,n,r,s,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=i,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var wr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){wr[i]=new cs(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];wr[e]=new cs(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){wr[i]=new cs(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){wr[i]=new cs(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){wr[i]=new cs(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){wr[i]=new cs(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){wr[i]=new cs(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){wr[i]=new cs(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){wr[i]=new cs(i,5,!1,i.toLowerCase(),null,!1,!1)});var zR=/[\-:]([a-z])/g;function VR(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(zR,VR);wr[e]=new cs(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(zR,VR);wr[e]=new cs(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(zR,VR);wr[e]=new cs(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){wr[i]=new cs(i,1,!1,i.toLowerCase(),null,!1,!1)});wr.xlinkHref=new cs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){wr[i]=new cs(i,1,!1,i.toLowerCase(),null,!0,!0)});function $R(i,e,n,r){var s=wr.hasOwnProperty(e)?wr[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(jW(e,n,s,r)&&(n=null),r||s===null?HW(e)&&(n===null?i.removeAttribute(e):i.setAttribute(e,""+n)):s.mustUseProperty?i[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?i.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?i.setAttributeNS(r,e,n):i.setAttribute(e,n))))}var oc=$W.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dv=Symbol.for("react.element"),nf=Symbol.for("react.portal"),rf=Symbol.for("react.fragment"),GR=Symbol.for("react.strict_mode"),aA=Symbol.for("react.profiler"),VU=Symbol.for("react.provider"),$U=Symbol.for("react.context"),HR=Symbol.for("react.forward_ref"),lA=Symbol.for("react.suspense"),cA=Symbol.for("react.suspense_list"),WR=Symbol.for("react.memo"),Uc=Symbol.for("react.lazy"),GU=Symbol.for("react.offscreen"),Tk=Symbol.iterator;function pm(i){return i===null||typeof i!="object"?null:(i=Tk&&i[Tk]||i["@@iterator"],typeof i=="function"?i:null)}var di=Object.assign,Vw;function mg(i){if(Vw===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Vw=e&&e[1]||""}return`
`+Vw+i}var $w=!1;function Gw(i,e){if(!i||$w)return"";$w=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(i,[],e)}else{try{e.call()}catch(u){r=u}i.call(e.prototype)}else{try{throw Error()}catch(u){r=u}i()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),a=s.length-1,l=o.length-1;1<=a&&0<=l&&s[a]!==o[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==o[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==o[l]){var c=`
`+s[a].replace(" at new "," at ");return i.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",i.displayName)),c}while(1<=a&&0<=l);break}}}finally{$w=!1,Error.prepareStackTrace=n}return(i=i?i.displayName||i.name:"")?mg(i):""}function qW(i){switch(i.tag){case 5:return mg(i.type);case 16:return mg("Lazy");case 13:return mg("Suspense");case 19:return mg("SuspenseList");case 0:case 2:case 15:return i=Gw(i.type,!1),i;case 11:return i=Gw(i.type.render,!1),i;case 1:return i=Gw(i.type,!0),i;default:return""}}function uA(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case rf:return"Fragment";case nf:return"Portal";case aA:return"Profiler";case GR:return"StrictMode";case lA:return"Suspense";case cA:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case $U:return(i.displayName||"Context")+".Consumer";case VU:return(i._context.displayName||"Context")+".Provider";case HR:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case WR:return e=i.displayName||null,e!==null?e:uA(i.type)||"Memo";case Uc:e=i._payload,i=i._init;try{return uA(i(e))}catch{}}return null}function XW(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return uA(e);case 8:return e===GR?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function du(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function HU(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function KW(i){var e=HU(i)?"checked":"value",n=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),r=""+i[e];if(!i.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(i,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function hv(i){i._valueTracker||(i._valueTracker=KW(i))}function WU(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return i&&(r=HU(i)?i.checked?"true":"false":i.value),i=r,i!==n?(e.setValue(i),!0):!1}function rb(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function dA(i,e){var n=e.checked;return di({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??i._wrapperState.initialChecked})}function Ek(i,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=du(e.value!=null?e.value:n),i._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jU(i,e){e=e.checked,e!=null&&$R(i,"checked",e,!1)}function hA(i,e){jU(i,e);var n=du(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&i.value===""||i.value!=n)&&(i.value=""+n):i.value!==""+n&&(i.value=""+n);else if(r==="submit"||r==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?fA(i,e.type,n):e.hasOwnProperty("defaultValue")&&fA(i,e.type,du(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function Mk(i,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,n||e===i.value||(i.value=e),i.defaultValue=e}n=i.name,n!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,n!==""&&(i.name=n)}function fA(i,e,n){(e!=="number"||rb(i.ownerDocument)!==i)&&(n==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+n&&(i.defaultValue=""+n))}var gg=Array.isArray;function Af(i,e,n,r){if(i=i.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<i.length;n++)s=e.hasOwnProperty("$"+i[n].value),i[n].selected!==s&&(i[n].selected=s),s&&r&&(i[n].defaultSelected=!0)}else{for(n=""+du(n),e=null,s=0;s<i.length;s++){if(i[s].value===n){i[s].selected=!0,r&&(i[s].defaultSelected=!0);return}e!==null||i[s].disabled||(e=i[s])}e!==null&&(e.selected=!0)}}function pA(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ze(91));return di({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Ak(i,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ze(92));if(gg(n)){if(1<n.length)throw Error(ze(93));n=n[0]}e=n}e==null&&(e=""),n=e}i._wrapperState={initialValue:du(n)}}function qU(i,e){var n=du(e.value),r=du(e.defaultValue);n!=null&&(n=""+n,n!==i.value&&(i.value=n),e.defaultValue==null&&i.defaultValue!==n&&(i.defaultValue=n)),r!=null&&(i.defaultValue=""+r)}function Ck(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function XU(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mA(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?XU(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var fv,KU=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return i(e,n,r,s)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(fv=fv||document.createElement("div"),fv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=fv.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function oy(i,e){if(e){var n=i.firstChild;if(n&&n===i.lastChild&&n.nodeType===3){n.nodeValue=e;return}}i.textContent=e}var Ng={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},YW=["Webkit","ms","Moz","O"];Object.keys(Ng).forEach(function(i){YW.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),Ng[e]=Ng[i]})});function YU(i,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ng.hasOwnProperty(i)&&Ng[i]?(""+e).trim():e+"px"}function ZU(i,e){i=i.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=YU(n,e[n],r);n==="float"&&(n="cssFloat"),r?i.setProperty(n,s):i[n]=s}}var ZW=di({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gA(i,e){if(e){if(ZW[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ze(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ze(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ze(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ze(62))}}function yA(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vA=null;function jR(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var xA=null,Cf=null,Rf=null;function Rk(i){if(i=T0(i)){if(typeof xA!="function")throw Error(ze(280));var e=i.stateNode;e&&(e=k1(e),xA(i.stateNode,i.type,e))}}function QU(i){Cf?Rf?Rf.push(i):Rf=[i]:Cf=i}function JU(){if(Cf){var i=Cf,e=Rf;if(Rf=Cf=null,Rk(i),e)for(i=0;i<e.length;i++)Rk(e[i])}}function ez(i,e){return i(e)}function tz(){}var Hw=!1;function nz(i,e,n){if(Hw)return i(e,n);Hw=!0;try{return ez(i,e,n)}finally{Hw=!1,(Cf!==null||Rf!==null)&&(tz(),JU())}}function ay(i,e){var n=i.stateNode;if(n===null)return null;var r=k1(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(i=i.type,r=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!r;break e;default:i=!1}if(i)return null;if(n&&typeof n!="function")throw Error(ze(231,e,typeof n));return n}var _A=!1;if(Xl)try{var mm={};Object.defineProperty(mm,"passive",{get:function(){_A=!0}}),window.addEventListener("test",mm,mm),window.removeEventListener("test",mm,mm)}catch{_A=!1}function QW(i,e,n,r,s,o,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var kg=!1,sb=null,ob=!1,bA=null,JW={onError:function(i){kg=!0,sb=i}};function ej(i,e,n,r,s,o,a,l,c){kg=!1,sb=null,QW.apply(JW,arguments)}function tj(i,e,n,r,s,o,a,l,c){if(ej.apply(this,arguments),kg){if(kg){var u=sb;kg=!1,sb=null}else throw Error(ze(198));ob||(ob=!0,bA=u)}}function qd(i){var e=i,n=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(n=e.return),i=e.return;while(i)}return e.tag===3?n:null}function iz(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function Pk(i){if(qd(i)!==i)throw Error(ze(188))}function nj(i){var e=i.alternate;if(!e){if(e=qd(i),e===null)throw Error(ze(188));return e!==i?null:i}for(var n=i,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return Pk(s),i;if(o===r)return Pk(s),e;o=o.sibling}throw Error(ze(188))}if(n.return!==r.return)n=s,r=o;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=o;break}if(l===r){a=!0,r=s,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=s;break}if(l===r){a=!0,r=o,n=s;break}l=l.sibling}if(!a)throw Error(ze(189))}}if(n.alternate!==r)throw Error(ze(190))}if(n.tag!==3)throw Error(ze(188));return n.stateNode.current===n?i:e}function rz(i){return i=nj(i),i!==null?sz(i):null}function sz(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=sz(i);if(e!==null)return e;i=i.sibling}return null}var oz=so.unstable_scheduleCallback,Nk=so.unstable_cancelCallback,ij=so.unstable_shouldYield,rj=so.unstable_requestPaint,Si=so.unstable_now,sj=so.unstable_getCurrentPriorityLevel,qR=so.unstable_ImmediatePriority,az=so.unstable_UserBlockingPriority,ab=so.unstable_NormalPriority,oj=so.unstable_LowPriority,lz=so.unstable_IdlePriority,C1=null,$a=null;function aj(i){if($a&&typeof $a.onCommitFiberRoot=="function")try{$a.onCommitFiberRoot(C1,i,void 0,(i.current.flags&128)===128)}catch{}}var la=Math.clz32?Math.clz32:uj,lj=Math.log,cj=Math.LN2;function uj(i){return i>>>=0,i===0?32:31-(lj(i)/cj|0)|0}var pv=64,mv=4194304;function yg(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function lb(i,e){var n=i.pendingLanes;if(n===0)return 0;var r=0,s=i.suspendedLanes,o=i.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=yg(l):(o&=a,o!==0&&(r=yg(o)))}else a=n&~s,a!==0?r=yg(a):o!==0&&(r=yg(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=r;0<e;)n=31-la(e),s=1<<n,r|=i[n],e&=~s;return r}function dj(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hj(i,e){for(var n=i.suspendedLanes,r=i.pingedLanes,s=i.expirationTimes,o=i.pendingLanes;0<o;){var a=31-la(o),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=dj(l,e)):c<=e&&(i.expiredLanes|=l),o&=~l}}function SA(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function cz(){var i=pv;return pv<<=1,!(pv&4194240)&&(pv=64),i}function Ww(i){for(var e=[],n=0;31>n;n++)e.push(i);return e}function S0(i,e,n){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-la(e),i[e]=n}function fj(i,e){var n=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var r=i.eventTimes;for(i=i.expirationTimes;0<n;){var s=31-la(n),o=1<<s;e[s]=0,r[s]=-1,i[s]=-1,n&=~o}}function XR(i,e){var n=i.entangledLanes|=e;for(i=i.entanglements;n;){var r=31-la(n),s=1<<r;s&e|i[r]&e&&(i[r]|=e),n&=~s}}var Cn=0;function uz(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var dz,KR,hz,fz,pz,wA=!1,gv=[],Zc=null,Qc=null,Jc=null,ly=new Map,cy=new Map,Gc=[],pj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kk(i,e){switch(i){case"focusin":case"focusout":Zc=null;break;case"dragenter":case"dragleave":Qc=null;break;case"mouseover":case"mouseout":Jc=null;break;case"pointerover":case"pointerout":ly.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":cy.delete(e.pointerId)}}function gm(i,e,n,r,s,o){return i===null||i.nativeEvent!==o?(i={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=T0(e),e!==null&&KR(e)),i):(i.eventSystemFlags|=r,e=i.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),i)}function mj(i,e,n,r,s){switch(e){case"focusin":return Zc=gm(Zc,i,e,n,r,s),!0;case"dragenter":return Qc=gm(Qc,i,e,n,r,s),!0;case"mouseover":return Jc=gm(Jc,i,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return ly.set(o,gm(ly.get(o)||null,i,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,cy.set(o,gm(cy.get(o)||null,i,e,n,r,s)),!0}return!1}function mz(i){var e=hd(i.target);if(e!==null){var n=qd(e);if(n!==null){if(e=n.tag,e===13){if(e=iz(n),e!==null){i.blockedOn=e,pz(i.priority,function(){hz(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){i.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}i.blockedOn=null}function m_(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var n=TA(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(n===null){n=i.nativeEvent;var r=new n.constructor(n.type,n);vA=r,n.target.dispatchEvent(r),vA=null}else return e=T0(n),e!==null&&KR(e),i.blockedOn=n,!1;e.shift()}return!0}function Lk(i,e,n){m_(i)&&n.delete(e)}function gj(){wA=!1,Zc!==null&&m_(Zc)&&(Zc=null),Qc!==null&&m_(Qc)&&(Qc=null),Jc!==null&&m_(Jc)&&(Jc=null),ly.forEach(Lk),cy.forEach(Lk)}function ym(i,e){i.blockedOn===e&&(i.blockedOn=null,wA||(wA=!0,so.unstable_scheduleCallback(so.unstable_NormalPriority,gj)))}function uy(i){function e(s){return ym(s,i)}if(0<gv.length){ym(gv[0],i);for(var n=1;n<gv.length;n++){var r=gv[n];r.blockedOn===i&&(r.blockedOn=null)}}for(Zc!==null&&ym(Zc,i),Qc!==null&&ym(Qc,i),Jc!==null&&ym(Jc,i),ly.forEach(e),cy.forEach(e),n=0;n<Gc.length;n++)r=Gc[n],r.blockedOn===i&&(r.blockedOn=null);for(;0<Gc.length&&(n=Gc[0],n.blockedOn===null);)mz(n),n.blockedOn===null&&Gc.shift()}var Pf=oc.ReactCurrentBatchConfig,cb=!0;function yj(i,e,n,r){var s=Cn,o=Pf.transition;Pf.transition=null;try{Cn=1,YR(i,e,n,r)}finally{Cn=s,Pf.transition=o}}function vj(i,e,n,r){var s=Cn,o=Pf.transition;Pf.transition=null;try{Cn=4,YR(i,e,n,r)}finally{Cn=s,Pf.transition=o}}function YR(i,e,n,r){if(cb){var s=TA(i,e,n,r);if(s===null)tT(i,e,r,ub,n),kk(i,r);else if(mj(s,i,e,n,r))r.stopPropagation();else if(kk(i,r),e&4&&-1<pj.indexOf(i)){for(;s!==null;){var o=T0(s);if(o!==null&&dz(o),o=TA(i,e,n,r),o===null&&tT(i,e,r,ub,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else tT(i,e,r,null,n)}}var ub=null;function TA(i,e,n,r){if(ub=null,i=jR(r),i=hd(i),i!==null)if(e=qd(i),e===null)i=null;else if(n=e.tag,n===13){if(i=iz(e),i!==null)return i;i=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return ub=i,null}function gz(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sj()){case qR:return 1;case az:return 4;case ab:case oj:return 16;case lz:return 536870912;default:return 16}default:return 16}}var qc=null,ZR=null,g_=null;function yz(){if(g_)return g_;var i,e=ZR,n=e.length,r,s="value"in qc?qc.value:qc.textContent,o=s.length;for(i=0;i<n&&e[i]===s[i];i++);var a=n-i;for(r=1;r<=a&&e[n-r]===s[o-r];r++);return g_=s.slice(i,1<r?1-r:void 0)}function y_(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function yv(){return!0}function Ik(){return!1}function lo(i){function e(n,r,s,o,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var l in i)i.hasOwnProperty(l)&&(n=i[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?yv:Ik,this.isPropagationStopped=Ik,this}return di(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=yv)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=yv)},persist:function(){},isPersistent:yv}),e}var Bp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},QR=lo(Bp),w0=di({},Bp,{view:0,detail:0}),xj=lo(w0),jw,qw,vm,R1=di({},w0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:JR,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==vm&&(vm&&i.type==="mousemove"?(jw=i.screenX-vm.screenX,qw=i.screenY-vm.screenY):qw=jw=0,vm=i),jw)},movementY:function(i){return"movementY"in i?i.movementY:qw}}),Dk=lo(R1),_j=di({},R1,{dataTransfer:0}),bj=lo(_j),Sj=di({},w0,{relatedTarget:0}),Xw=lo(Sj),wj=di({},Bp,{animationName:0,elapsedTime:0,pseudoElement:0}),Tj=lo(wj),Ej=di({},Bp,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Mj=lo(Ej),Aj=di({},Bp,{data:0}),Ok=lo(Aj),Cj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nj(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=Pj[i])?!!e[i]:!1}function JR(){return Nj}var kj=di({},w0,{key:function(i){if(i.key){var e=Cj[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=y_(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Rj[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:JR,charCode:function(i){return i.type==="keypress"?y_(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?y_(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Lj=lo(kj),Ij=di({},R1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fk=lo(Ij),Dj=di({},w0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:JR}),Oj=lo(Dj),Fj=di({},Bp,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bj=lo(Fj),Uj=di({},R1,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),zj=lo(Uj),Vj=[9,13,27,32],eP=Xl&&"CompositionEvent"in window,Lg=null;Xl&&"documentMode"in document&&(Lg=document.documentMode);var $j=Xl&&"TextEvent"in window&&!Lg,vz=Xl&&(!eP||Lg&&8<Lg&&11>=Lg),Bk=String.fromCharCode(32),Uk=!1;function xz(i,e){switch(i){case"keyup":return Vj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _z(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var sf=!1;function Gj(i,e){switch(i){case"compositionend":return _z(e);case"keypress":return e.which!==32?null:(Uk=!0,Bk);case"textInput":return i=e.data,i===Bk&&Uk?null:i;default:return null}}function Hj(i,e){if(sf)return i==="compositionend"||!eP&&xz(i,e)?(i=yz(),g_=ZR=qc=null,sf=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return vz&&e.locale!=="ko"?null:e.data;default:return null}}var Wj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zk(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!Wj[i.type]:e==="textarea"}function bz(i,e,n,r){QU(r),e=db(e,"onChange"),0<e.length&&(n=new QR("onChange","change",null,n,r),i.push({event:n,listeners:e}))}var Ig=null,dy=null;function jj(i){kz(i,0)}function P1(i){var e=lf(i);if(WU(e))return i}function qj(i,e){if(i==="change")return e}var Sz=!1;if(Xl){var Kw;if(Xl){var Yw="oninput"in document;if(!Yw){var Vk=document.createElement("div");Vk.setAttribute("oninput","return;"),Yw=typeof Vk.oninput=="function"}Kw=Yw}else Kw=!1;Sz=Kw&&(!document.documentMode||9<document.documentMode)}function $k(){Ig&&(Ig.detachEvent("onpropertychange",wz),dy=Ig=null)}function wz(i){if(i.propertyName==="value"&&P1(dy)){var e=[];bz(e,dy,i,jR(i)),nz(jj,e)}}function Xj(i,e,n){i==="focusin"?($k(),Ig=e,dy=n,Ig.attachEvent("onpropertychange",wz)):i==="focusout"&&$k()}function Kj(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return P1(dy)}function Yj(i,e){if(i==="click")return P1(e)}function Zj(i,e){if(i==="input"||i==="change")return P1(e)}function Qj(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var ha=typeof Object.is=="function"?Object.is:Qj;function hy(i,e){if(ha(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var n=Object.keys(i),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!oA.call(e,s)||!ha(i[s],e[s]))return!1}return!0}function Gk(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Hk(i,e){var n=Gk(i);i=0;for(var r;n;){if(n.nodeType===3){if(r=i+n.textContent.length,i<=e&&r>=e)return{node:n,offset:e-i};i=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Gk(n)}}function Tz(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?Tz(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function Ez(){for(var i=window,e=rb();e instanceof i.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)i=e.contentWindow;else break;e=rb(i.document)}return e}function tP(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function Jj(i){var e=Ez(),n=i.focusedElem,r=i.selectionRange;if(e!==n&&n&&n.ownerDocument&&Tz(n.ownerDocument.documentElement,n)){if(r!==null&&tP(n)){if(e=r.start,i=r.end,i===void 0&&(i=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(i,n.value.length);else if(i=(e=n.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!i.extend&&o>r&&(s=r,r=o,o=s),s=Hk(n,o);var a=Hk(n,r);s&&a&&(i.rangeCount!==1||i.anchorNode!==s.node||i.anchorOffset!==s.offset||i.focusNode!==a.node||i.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),i.removeAllRanges(),o>r?(i.addRange(e),i.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),i.addRange(e)))}}for(e=[],i=n;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)i=e[n],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var e9=Xl&&"documentMode"in document&&11>=document.documentMode,of=null,EA=null,Dg=null,MA=!1;function Wk(i,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;MA||of==null||of!==rb(r)||(r=of,"selectionStart"in r&&tP(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Dg&&hy(Dg,r)||(Dg=r,r=db(EA,"onSelect"),0<r.length&&(e=new QR("onSelect","select",null,e,n),i.push({event:e,listeners:r}),e.target=of)))}function vv(i,e){var n={};return n[i.toLowerCase()]=e.toLowerCase(),n["Webkit"+i]="webkit"+e,n["Moz"+i]="moz"+e,n}var af={animationend:vv("Animation","AnimationEnd"),animationiteration:vv("Animation","AnimationIteration"),animationstart:vv("Animation","AnimationStart"),transitionend:vv("Transition","TransitionEnd")},Zw={},Mz={};Xl&&(Mz=document.createElement("div").style,"AnimationEvent"in window||(delete af.animationend.animation,delete af.animationiteration.animation,delete af.animationstart.animation),"TransitionEvent"in window||delete af.transitionend.transition);function N1(i){if(Zw[i])return Zw[i];if(!af[i])return i;var e=af[i],n;for(n in e)if(e.hasOwnProperty(n)&&n in Mz)return Zw[i]=e[n];return i}var Az=N1("animationend"),Cz=N1("animationiteration"),Rz=N1("animationstart"),Pz=N1("transitionend"),Nz=new Map,jk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _u(i,e){Nz.set(i,e),jd(e,[i])}for(var Qw=0;Qw<jk.length;Qw++){var Jw=jk[Qw],t9=Jw.toLowerCase(),n9=Jw[0].toUpperCase()+Jw.slice(1);_u(t9,"on"+n9)}_u(Az,"onAnimationEnd");_u(Cz,"onAnimationIteration");_u(Rz,"onAnimationStart");_u("dblclick","onDoubleClick");_u("focusin","onFocus");_u("focusout","onBlur");_u(Pz,"onTransitionEnd");Qf("onMouseEnter",["mouseout","mouseover"]);Qf("onMouseLeave",["mouseout","mouseover"]);Qf("onPointerEnter",["pointerout","pointerover"]);Qf("onPointerLeave",["pointerout","pointerover"]);jd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));jd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));jd("onBeforeInput",["compositionend","keypress","textInput","paste"]);jd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));jd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));jd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),i9=new Set("cancel close invalid load scroll toggle".split(" ").concat(vg));function qk(i,e,n){var r=i.type||"unknown-event";i.currentTarget=n,tj(r,e,void 0,i),i.currentTarget=null}function kz(i,e){e=(e&4)!==0;for(var n=0;n<i.length;n++){var r=i[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;qk(s,l,u),o=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;qk(s,l,u),o=c}}}if(ob)throw i=bA,ob=!1,bA=null,i}function Gn(i,e){var n=e[NA];n===void 0&&(n=e[NA]=new Set);var r=i+"__bubble";n.has(r)||(Lz(e,i,2,!1),n.add(r))}function eT(i,e,n){var r=0;e&&(r|=4),Lz(n,i,r,e)}var xv="_reactListening"+Math.random().toString(36).slice(2);function fy(i){if(!i[xv]){i[xv]=!0,zU.forEach(function(n){n!=="selectionchange"&&(i9.has(n)||eT(n,!1,i),eT(n,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[xv]||(e[xv]=!0,eT("selectionchange",!1,e))}}function Lz(i,e,n,r){switch(gz(e)){case 1:var s=yj;break;case 4:s=vj;break;default:s=YR}n=s.bind(null,e,n,i),s=void 0,!_A||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?i.addEventListener(e,n,{capture:!0,passive:s}):i.addEventListener(e,n,!0):s!==void 0?i.addEventListener(e,n,{passive:s}):i.addEventListener(e,n,!1)}function tT(i,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=hd(l),a===null)return;if(c=a.tag,c===5||c===6){r=o=a;continue e}l=l.parentNode}}r=r.return}nz(function(){var u=o,d=jR(n),h=[];e:{var f=Nz.get(i);if(f!==void 0){var p=QR,m=i;switch(i){case"keypress":if(y_(n)===0)break e;case"keydown":case"keyup":p=Lj;break;case"focusin":m="focus",p=Xw;break;case"focusout":m="blur",p=Xw;break;case"beforeblur":case"afterblur":p=Xw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Dk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=bj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Oj;break;case Az:case Cz:case Rz:p=Tj;break;case Pz:p=Bj;break;case"scroll":p=xj;break;case"wheel":p=zj;break;case"copy":case"cut":case"paste":p=Mj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Fk}var y=(e&4)!==0,v=!y&&i==="scroll",g=y?f!==null?f+"Capture":null:f;y=[];for(var _=u,x;_!==null;){x=_;var b=x.stateNode;if(x.tag===5&&b!==null&&(x=b,g!==null&&(b=ay(_,g),b!=null&&y.push(py(_,b,x)))),v)break;_=_.return}0<y.length&&(f=new p(f,m,null,n,d),h.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=i==="mouseover"||i==="pointerover",p=i==="mouseout"||i==="pointerout",f&&n!==vA&&(m=n.relatedTarget||n.fromElement)&&(hd(m)||m[Kl]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=u,m=m?hd(m):null,m!==null&&(v=qd(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(y=Dk,b="onMouseLeave",g="onMouseEnter",_="mouse",(i==="pointerout"||i==="pointerover")&&(y=Fk,b="onPointerLeave",g="onPointerEnter",_="pointer"),v=p==null?f:lf(p),x=m==null?f:lf(m),f=new y(b,_+"leave",p,n,d),f.target=v,f.relatedTarget=x,b=null,hd(d)===u&&(y=new y(g,_+"enter",m,n,d),y.target=x,y.relatedTarget=v,b=y),v=b,p&&m)t:{for(y=p,g=m,_=0,x=y;x;x=nh(x))_++;for(x=0,b=g;b;b=nh(b))x++;for(;0<_-x;)y=nh(y),_--;for(;0<x-_;)g=nh(g),x--;for(;_--;){if(y===g||g!==null&&y===g.alternate)break t;y=nh(y),g=nh(g)}y=null}else y=null;p!==null&&Xk(h,f,p,y,!1),m!==null&&v!==null&&Xk(h,v,m,y,!0)}}e:{if(f=u?lf(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var S=qj;else if(zk(f))if(Sz)S=Zj;else{S=Kj;var T=Xj}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=Yj);if(S&&(S=S(i,u))){bz(h,S,n,d);break e}T&&T(i,f,u),i==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&fA(f,"number",f.value)}switch(T=u?lf(u):window,i){case"focusin":(zk(T)||T.contentEditable==="true")&&(of=T,EA=u,Dg=null);break;case"focusout":Dg=EA=of=null;break;case"mousedown":MA=!0;break;case"contextmenu":case"mouseup":case"dragend":MA=!1,Wk(h,n,d);break;case"selectionchange":if(e9)break;case"keydown":case"keyup":Wk(h,n,d)}var w;if(eP)e:{switch(i){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else sf?xz(i,n)&&(E="onCompositionEnd"):i==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(vz&&n.locale!=="ko"&&(sf||E!=="onCompositionStart"?E==="onCompositionEnd"&&sf&&(w=yz()):(qc=d,ZR="value"in qc?qc.value:qc.textContent,sf=!0)),T=db(u,E),0<T.length&&(E=new Ok(E,i,null,n,d),h.push({event:E,listeners:T}),w?E.data=w:(w=_z(n),w!==null&&(E.data=w)))),(w=$j?Gj(i,n):Hj(i,n))&&(u=db(u,"onBeforeInput"),0<u.length&&(d=new Ok("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=w))}kz(h,e)})}function py(i,e,n){return{instance:i,listener:e,currentTarget:n}}function db(i,e){for(var n=e+"Capture",r=[];i!==null;){var s=i,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=ay(i,n),o!=null&&r.unshift(py(i,o,s)),o=ay(i,e),o!=null&&r.push(py(i,o,s))),i=i.return}return r}function nh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Xk(i,e,n,r,s){for(var o=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=ay(n,o),c!=null&&a.unshift(py(n,c,l))):s||(c=ay(n,o),c!=null&&a.push(py(n,c,l)))),n=n.return}a.length!==0&&i.push({event:e,listeners:a})}var r9=/\r\n?/g,s9=/\u0000|\uFFFD/g;function Kk(i){return(typeof i=="string"?i:""+i).replace(r9,`
`).replace(s9,"")}function _v(i,e,n){if(e=Kk(e),Kk(i)!==e&&n)throw Error(ze(425))}function hb(){}var AA=null,CA=null;function RA(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var PA=typeof setTimeout=="function"?setTimeout:void 0,o9=typeof clearTimeout=="function"?clearTimeout:void 0,Yk=typeof Promise=="function"?Promise:void 0,a9=typeof queueMicrotask=="function"?queueMicrotask:typeof Yk<"u"?function(i){return Yk.resolve(null).then(i).catch(l9)}:PA;function l9(i){setTimeout(function(){throw i})}function nT(i,e){var n=e,r=0;do{var s=n.nextSibling;if(i.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){i.removeChild(s),uy(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);uy(e)}function eu(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function Zk(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var n=i.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return i;e--}else n==="/$"&&e++}i=i.previousSibling}return null}var Up=Math.random().toString(36).slice(2),Oa="__reactFiber$"+Up,my="__reactProps$"+Up,Kl="__reactContainer$"+Up,NA="__reactEvents$"+Up,c9="__reactListeners$"+Up,u9="__reactHandles$"+Up;function hd(i){var e=i[Oa];if(e)return e;for(var n=i.parentNode;n;){if(e=n[Kl]||n[Oa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(i=Zk(i);i!==null;){if(n=i[Oa])return n;i=Zk(i)}return e}i=n,n=i.parentNode}return null}function T0(i){return i=i[Oa]||i[Kl],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function lf(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(ze(33))}function k1(i){return i[my]||null}var kA=[],cf=-1;function bu(i){return{current:i}}function Kn(i){0>cf||(i.current=kA[cf],kA[cf]=null,cf--)}function zn(i,e){cf++,kA[cf]=i.current,i.current=e}var hu={},Vr=bu(hu),Ts=bu(!1),Ad=hu;function Jf(i,e){var n=i.type.contextTypes;if(!n)return hu;var r=i.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=s),s}function Es(i){return i=i.childContextTypes,i!=null}function fb(){Kn(Ts),Kn(Vr)}function Qk(i,e,n){if(Vr.current!==hu)throw Error(ze(168));zn(Vr,e),zn(Ts,n)}function Iz(i,e,n){var r=i.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(ze(108,XW(i)||"Unknown",s));return di({},n,r)}function pb(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||hu,Ad=Vr.current,zn(Vr,i),zn(Ts,Ts.current),!0}function Jk(i,e,n){var r=i.stateNode;if(!r)throw Error(ze(169));n?(i=Iz(i,e,Ad),r.__reactInternalMemoizedMergedChildContext=i,Kn(Ts),Kn(Vr),zn(Vr,i)):Kn(Ts),zn(Ts,n)}var wl=null,L1=!1,iT=!1;function Dz(i){wl===null?wl=[i]:wl.push(i)}function d9(i){L1=!0,Dz(i)}function Su(){if(!iT&&wl!==null){iT=!0;var i=0,e=Cn;try{var n=wl;for(Cn=1;i<n.length;i++){var r=n[i];do r=r(!0);while(r!==null)}wl=null,L1=!1}catch(s){throw wl!==null&&(wl=wl.slice(i+1)),oz(qR,Su),s}finally{Cn=e,iT=!1}}return null}var uf=[],df=0,mb=null,gb=0,xo=[],_o=0,Cd=null,kl=1,Ll="";function Yu(i,e){uf[df++]=gb,uf[df++]=mb,mb=i,gb=e}function Oz(i,e,n){xo[_o++]=kl,xo[_o++]=Ll,xo[_o++]=Cd,Cd=i;var r=kl;i=Ll;var s=32-la(r)-1;r&=~(1<<s),n+=1;var o=32-la(e)+s;if(30<o){var a=s-s%5;o=(r&(1<<a)-1).toString(32),r>>=a,s-=a,kl=1<<32-la(e)+s|n<<s|r,Ll=o+i}else kl=1<<o|n<<s|r,Ll=i}function nP(i){i.return!==null&&(Yu(i,1),Oz(i,1,0))}function iP(i){for(;i===mb;)mb=uf[--df],uf[df]=null,gb=uf[--df],uf[df]=null;for(;i===Cd;)Cd=xo[--_o],xo[_o]=null,Ll=xo[--_o],xo[_o]=null,kl=xo[--_o],xo[_o]=null}var Zs=null,Xs=null,ei=!1,na=null;function Fz(i,e){var n=Ao(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=i,e=i.deletions,e===null?(i.deletions=[n],i.flags|=16):e.push(n)}function eL(i,e){switch(i.tag){case 5:var n=i.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,Zs=i,Xs=eu(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,Zs=i,Xs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Cd!==null?{id:kl,overflow:Ll}:null,i.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ao(18,null,null,0),n.stateNode=e,n.return=i,i.child=n,Zs=i,Xs=null,!0):!1;default:return!1}}function LA(i){return(i.mode&1)!==0&&(i.flags&128)===0}function IA(i){if(ei){var e=Xs;if(e){var n=e;if(!eL(i,e)){if(LA(i))throw Error(ze(418));e=eu(n.nextSibling);var r=Zs;e&&eL(i,e)?Fz(r,n):(i.flags=i.flags&-4097|2,ei=!1,Zs=i)}}else{if(LA(i))throw Error(ze(418));i.flags=i.flags&-4097|2,ei=!1,Zs=i}}}function tL(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Zs=i}function bv(i){if(i!==Zs)return!1;if(!ei)return tL(i),ei=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!RA(i.type,i.memoizedProps)),e&&(e=Xs)){if(LA(i))throw Bz(),Error(ze(418));for(;e;)Fz(i,e),e=eu(e.nextSibling)}if(tL(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ze(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var n=i.data;if(n==="/$"){if(e===0){Xs=eu(i.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}i=i.nextSibling}Xs=null}}else Xs=Zs?eu(i.stateNode.nextSibling):null;return!0}function Bz(){for(var i=Xs;i;)i=eu(i.nextSibling)}function ep(){Xs=Zs=null,ei=!1}function rP(i){na===null?na=[i]:na.push(i)}var h9=oc.ReactCurrentBatchConfig;function xm(i,e,n){if(i=n.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ze(309));var r=n.stateNode}if(!r)throw Error(ze(147,i));var s=r,o=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var l=s.refs;a===null?delete l[o]:l[o]=a},e._stringRef=o,e)}if(typeof i!="string")throw Error(ze(284));if(!n._owner)throw Error(ze(290,i))}return i}function Sv(i,e){throw i=Object.prototype.toString.call(e),Error(ze(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function nL(i){var e=i._init;return e(i._payload)}function Uz(i){function e(g,_){if(i){var x=g.deletions;x===null?(g.deletions=[_],g.flags|=16):x.push(_)}}function n(g,_){if(!i)return null;for(;_!==null;)e(g,_),_=_.sibling;return null}function r(g,_){for(g=new Map;_!==null;)_.key!==null?g.set(_.key,_):g.set(_.index,_),_=_.sibling;return g}function s(g,_){return g=ru(g,_),g.index=0,g.sibling=null,g}function o(g,_,x){return g.index=x,i?(x=g.alternate,x!==null?(x=x.index,x<_?(g.flags|=2,_):x):(g.flags|=2,_)):(g.flags|=1048576,_)}function a(g){return i&&g.alternate===null&&(g.flags|=2),g}function l(g,_,x,b){return _===null||_.tag!==6?(_=uT(x,g.mode,b),_.return=g,_):(_=s(_,x),_.return=g,_)}function c(g,_,x,b){var S=x.type;return S===rf?d(g,_,x.props.children,b,x.key):_!==null&&(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Uc&&nL(S)===_.type)?(b=s(_,x.props),b.ref=xm(g,_,x),b.return=g,b):(b=T_(x.type,x.key,x.props,null,g.mode,b),b.ref=xm(g,_,x),b.return=g,b)}function u(g,_,x,b){return _===null||_.tag!==4||_.stateNode.containerInfo!==x.containerInfo||_.stateNode.implementation!==x.implementation?(_=dT(x,g.mode,b),_.return=g,_):(_=s(_,x.children||[]),_.return=g,_)}function d(g,_,x,b,S){return _===null||_.tag!==7?(_=_d(x,g.mode,b,S),_.return=g,_):(_=s(_,x),_.return=g,_)}function h(g,_,x){if(typeof _=="string"&&_!==""||typeof _=="number")return _=uT(""+_,g.mode,x),_.return=g,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case dv:return x=T_(_.type,_.key,_.props,null,g.mode,x),x.ref=xm(g,null,_),x.return=g,x;case nf:return _=dT(_,g.mode,x),_.return=g,_;case Uc:var b=_._init;return h(g,b(_._payload),x)}if(gg(_)||pm(_))return _=_d(_,g.mode,x,null),_.return=g,_;Sv(g,_)}return null}function f(g,_,x,b){var S=_!==null?_.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return S!==null?null:l(g,_,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case dv:return x.key===S?c(g,_,x,b):null;case nf:return x.key===S?u(g,_,x,b):null;case Uc:return S=x._init,f(g,_,S(x._payload),b)}if(gg(x)||pm(x))return S!==null?null:d(g,_,x,b,null);Sv(g,x)}return null}function p(g,_,x,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return g=g.get(x)||null,l(_,g,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case dv:return g=g.get(b.key===null?x:b.key)||null,c(_,g,b,S);case nf:return g=g.get(b.key===null?x:b.key)||null,u(_,g,b,S);case Uc:var T=b._init;return p(g,_,x,T(b._payload),S)}if(gg(b)||pm(b))return g=g.get(x)||null,d(_,g,b,S,null);Sv(_,b)}return null}function m(g,_,x,b){for(var S=null,T=null,w=_,E=_=0,A=null;w!==null&&E<x.length;E++){w.index>E?(A=w,w=null):A=w.sibling;var M=f(g,w,x[E],b);if(M===null){w===null&&(w=A);break}i&&w&&M.alternate===null&&e(g,w),_=o(M,_,E),T===null?S=M:T.sibling=M,T=M,w=A}if(E===x.length)return n(g,w),ei&&Yu(g,E),S;if(w===null){for(;E<x.length;E++)w=h(g,x[E],b),w!==null&&(_=o(w,_,E),T===null?S=w:T.sibling=w,T=w);return ei&&Yu(g,E),S}for(w=r(g,w);E<x.length;E++)A=p(w,g,E,x[E],b),A!==null&&(i&&A.alternate!==null&&w.delete(A.key===null?E:A.key),_=o(A,_,E),T===null?S=A:T.sibling=A,T=A);return i&&w.forEach(function(R){return e(g,R)}),ei&&Yu(g,E),S}function y(g,_,x,b){var S=pm(x);if(typeof S!="function")throw Error(ze(150));if(x=S.call(x),x==null)throw Error(ze(151));for(var T=S=null,w=_,E=_=0,A=null,M=x.next();w!==null&&!M.done;E++,M=x.next()){w.index>E?(A=w,w=null):A=w.sibling;var R=f(g,w,M.value,b);if(R===null){w===null&&(w=A);break}i&&w&&R.alternate===null&&e(g,w),_=o(R,_,E),T===null?S=R:T.sibling=R,T=R,w=A}if(M.done)return n(g,w),ei&&Yu(g,E),S;if(w===null){for(;!M.done;E++,M=x.next())M=h(g,M.value,b),M!==null&&(_=o(M,_,E),T===null?S=M:T.sibling=M,T=M);return ei&&Yu(g,E),S}for(w=r(g,w);!M.done;E++,M=x.next())M=p(w,g,E,M.value,b),M!==null&&(i&&M.alternate!==null&&w.delete(M.key===null?E:M.key),_=o(M,_,E),T===null?S=M:T.sibling=M,T=M);return i&&w.forEach(function(F){return e(g,F)}),ei&&Yu(g,E),S}function v(g,_,x,b){if(typeof x=="object"&&x!==null&&x.type===rf&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case dv:e:{for(var S=x.key,T=_;T!==null;){if(T.key===S){if(S=x.type,S===rf){if(T.tag===7){n(g,T.sibling),_=s(T,x.props.children),_.return=g,g=_;break e}}else if(T.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Uc&&nL(S)===T.type){n(g,T.sibling),_=s(T,x.props),_.ref=xm(g,T,x),_.return=g,g=_;break e}n(g,T);break}else e(g,T);T=T.sibling}x.type===rf?(_=_d(x.props.children,g.mode,b,x.key),_.return=g,g=_):(b=T_(x.type,x.key,x.props,null,g.mode,b),b.ref=xm(g,_,x),b.return=g,g=b)}return a(g);case nf:e:{for(T=x.key;_!==null;){if(_.key===T)if(_.tag===4&&_.stateNode.containerInfo===x.containerInfo&&_.stateNode.implementation===x.implementation){n(g,_.sibling),_=s(_,x.children||[]),_.return=g,g=_;break e}else{n(g,_);break}else e(g,_);_=_.sibling}_=dT(x,g.mode,b),_.return=g,g=_}return a(g);case Uc:return T=x._init,v(g,_,T(x._payload),b)}if(gg(x))return m(g,_,x,b);if(pm(x))return y(g,_,x,b);Sv(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,_!==null&&_.tag===6?(n(g,_.sibling),_=s(_,x),_.return=g,g=_):(n(g,_),_=uT(x,g.mode,b),_.return=g,g=_),a(g)):n(g,_)}return v}var tp=Uz(!0),zz=Uz(!1),yb=bu(null),vb=null,hf=null,sP=null;function oP(){sP=hf=vb=null}function aP(i){var e=yb.current;Kn(yb),i._currentValue=e}function DA(i,e,n){for(;i!==null;){var r=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),i===n)break;i=i.return}}function Nf(i,e){vb=i,sP=hf=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(xs=!0),i.firstContext=null)}function No(i){var e=i._currentValue;if(sP!==i)if(i={context:i,memoizedValue:e,next:null},hf===null){if(vb===null)throw Error(ze(308));hf=i,vb.dependencies={lanes:0,firstContext:i}}else hf=hf.next=i;return e}var fd=null;function lP(i){fd===null?fd=[i]:fd.push(i)}function Vz(i,e,n,r){var s=e.interleaved;return s===null?(n.next=n,lP(e)):(n.next=s.next,s.next=n),e.interleaved=n,Yl(i,r)}function Yl(i,e){i.lanes|=e;var n=i.alternate;for(n!==null&&(n.lanes|=e),n=i,i=i.return;i!==null;)i.childLanes|=e,n=i.alternate,n!==null&&(n.childLanes|=e),n=i,i=i.return;return n.tag===3?n.stateNode:null}var zc=!1;function cP(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $z(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function zl(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function tu(i,e,n){var r=i.updateQueue;if(r===null)return null;if(r=r.shared,hn&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Yl(i,n)}return s=r.interleaved,s===null?(e.next=e,lP(r)):(e.next=s.next,s.next=e),r.interleaved=e,Yl(i,n)}function v_(i,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=i.pendingLanes,n|=r,e.lanes=n,XR(i,n)}}function iL(i,e){var n=i.updateQueue,r=i.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},i.updateQueue=n;return}i=n.lastBaseUpdate,i===null?n.firstBaseUpdate=e:i.next=e,n.lastBaseUpdate=e}function xb(i,e,n,r){var s=i.updateQueue;zc=!1;var o=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?o=u:a.next=u,a=c;var d=i.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(o!==null){var h=s.baseState;a=0,d=u=c=null,l=o;do{var f=l.lane,p=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=i,y=l;switch(f=e,p=n,y.tag){case 1:if(m=y.payload,typeof m=="function"){h=m.call(p,h,f);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=y.payload,f=typeof m=="function"?m.call(p,h,f):m,f==null)break e;h=di({},h,f);break e;case 2:zc=!0}}l.callback!==null&&l.lane!==0&&(i.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,a|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);Pd|=a,i.lanes=a,i.memoizedState=h}}function rL(i,e,n){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var r=i[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ze(191,s));s.call(r)}}}var E0={},Ga=bu(E0),gy=bu(E0),yy=bu(E0);function pd(i){if(i===E0)throw Error(ze(174));return i}function uP(i,e){switch(zn(yy,e),zn(gy,i),zn(Ga,E0),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:mA(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=mA(e,i)}Kn(Ga),zn(Ga,e)}function np(){Kn(Ga),Kn(gy),Kn(yy)}function Gz(i){pd(yy.current);var e=pd(Ga.current),n=mA(e,i.type);e!==n&&(zn(gy,i),zn(Ga,n))}function dP(i){gy.current===i&&(Kn(Ga),Kn(gy))}var oi=bu(0);function _b(i){for(var e=i;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rT=[];function hP(){for(var i=0;i<rT.length;i++)rT[i]._workInProgressVersionPrimary=null;rT.length=0}var x_=oc.ReactCurrentDispatcher,sT=oc.ReactCurrentBatchConfig,Rd=0,ui=null,ji=null,rr=null,bb=!1,Og=!1,vy=0,f9=0;function Ar(){throw Error(ze(321))}function fP(i,e){if(e===null)return!1;for(var n=0;n<e.length&&n<i.length;n++)if(!ha(i[n],e[n]))return!1;return!0}function pP(i,e,n,r,s,o){if(Rd=o,ui=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,x_.current=i===null||i.memoizedState===null?y9:v9,i=n(r,s),Og){o=0;do{if(Og=!1,vy=0,25<=o)throw Error(ze(301));o+=1,rr=ji=null,e.updateQueue=null,x_.current=x9,i=n(r,s)}while(Og)}if(x_.current=Sb,e=ji!==null&&ji.next!==null,Rd=0,rr=ji=ui=null,bb=!1,e)throw Error(ze(300));return i}function mP(){var i=vy!==0;return vy=0,i}function Pa(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rr===null?ui.memoizedState=rr=i:rr=rr.next=i,rr}function ko(){if(ji===null){var i=ui.alternate;i=i!==null?i.memoizedState:null}else i=ji.next;var e=rr===null?ui.memoizedState:rr.next;if(e!==null)rr=e,ji=i;else{if(i===null)throw Error(ze(310));ji=i,i={memoizedState:ji.memoizedState,baseState:ji.baseState,baseQueue:ji.baseQueue,queue:ji.queue,next:null},rr===null?ui.memoizedState=rr=i:rr=rr.next=i}return rr}function xy(i,e){return typeof e=="function"?e(i):e}function oT(i){var e=ko(),n=e.queue;if(n===null)throw Error(ze(311));n.lastRenderedReducer=i;var r=ji,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var l=a=null,c=null,u=o;do{var d=u.lane;if((Rd&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:i(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,a=r):c=c.next=h,ui.lanes|=d,Pd|=d}u=u.next}while(u!==null&&u!==o);c===null?a=r:c.next=l,ha(r,e.memoizedState)||(xs=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(i=n.interleaved,i!==null){s=i;do o=s.lane,ui.lanes|=o,Pd|=o,s=s.next;while(s!==i)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function aT(i){var e=ko(),n=e.queue;if(n===null)throw Error(ze(311));n.lastRenderedReducer=i;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do o=i(o,a.action),a=a.next;while(a!==s);ha(o,e.memoizedState)||(xs=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Hz(){}function Wz(i,e){var n=ui,r=ko(),s=e(),o=!ha(r.memoizedState,s);if(o&&(r.memoizedState=s,xs=!0),r=r.queue,gP(Xz.bind(null,n,r,i),[i]),r.getSnapshot!==e||o||rr!==null&&rr.memoizedState.tag&1){if(n.flags|=2048,_y(9,qz.bind(null,n,r,s,e),void 0,null),cr===null)throw Error(ze(349));Rd&30||jz(n,e,s)}return s}function jz(i,e,n){i.flags|=16384,i={getSnapshot:e,value:n},e=ui.updateQueue,e===null?(e={lastEffect:null,stores:null},ui.updateQueue=e,e.stores=[i]):(n=e.stores,n===null?e.stores=[i]:n.push(i))}function qz(i,e,n,r){e.value=n,e.getSnapshot=r,Kz(e)&&Yz(i)}function Xz(i,e,n){return n(function(){Kz(e)&&Yz(i)})}function Kz(i){var e=i.getSnapshot;i=i.value;try{var n=e();return!ha(i,n)}catch{return!0}}function Yz(i){var e=Yl(i,1);e!==null&&ca(e,i,1,-1)}function sL(i){var e=Pa();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xy,lastRenderedState:i},e.queue=i,i=i.dispatch=g9.bind(null,ui,i),[e.memoizedState,i]}function _y(i,e,n,r){return i={tag:i,create:e,destroy:n,deps:r,next:null},e=ui.updateQueue,e===null?(e={lastEffect:null,stores:null},ui.updateQueue=e,e.lastEffect=i.next=i):(n=e.lastEffect,n===null?e.lastEffect=i.next=i:(r=n.next,n.next=i,i.next=r,e.lastEffect=i)),i}function Zz(){return ko().memoizedState}function __(i,e,n,r){var s=Pa();ui.flags|=i,s.memoizedState=_y(1|e,n,void 0,r===void 0?null:r)}function I1(i,e,n,r){var s=ko();r=r===void 0?null:r;var o=void 0;if(ji!==null){var a=ji.memoizedState;if(o=a.destroy,r!==null&&fP(r,a.deps)){s.memoizedState=_y(e,n,o,r);return}}ui.flags|=i,s.memoizedState=_y(1|e,n,o,r)}function oL(i,e){return __(8390656,8,i,e)}function gP(i,e){return I1(2048,8,i,e)}function Qz(i,e){return I1(4,2,i,e)}function Jz(i,e){return I1(4,4,i,e)}function e4(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function t4(i,e,n){return n=n!=null?n.concat([i]):null,I1(4,4,e4.bind(null,e,i),n)}function yP(){}function n4(i,e){var n=ko();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&fP(e,r[1])?r[0]:(n.memoizedState=[i,e],i)}function i4(i,e){var n=ko();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&fP(e,r[1])?r[0]:(i=i(),n.memoizedState=[i,e],i)}function r4(i,e,n){return Rd&21?(ha(n,e)||(n=cz(),ui.lanes|=n,Pd|=n,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,xs=!0),i.memoizedState=n)}function p9(i,e){var n=Cn;Cn=n!==0&&4>n?n:4,i(!0);var r=sT.transition;sT.transition={};try{i(!1),e()}finally{Cn=n,sT.transition=r}}function s4(){return ko().memoizedState}function m9(i,e,n){var r=iu(i);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},o4(i))a4(e,n);else if(n=Vz(i,e,n,r),n!==null){var s=ss();ca(n,i,r,s),l4(n,e,r)}}function g9(i,e,n){var r=iu(i),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(o4(i))a4(e,s);else{var o=i.alternate;if(i.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,l=o(a,n);if(s.hasEagerState=!0,s.eagerState=l,ha(l,a)){var c=e.interleaved;c===null?(s.next=s,lP(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=Vz(i,e,s,r),n!==null&&(s=ss(),ca(n,i,r,s),l4(n,e,r))}}function o4(i){var e=i.alternate;return i===ui||e!==null&&e===ui}function a4(i,e){Og=bb=!0;var n=i.pending;n===null?e.next=e:(e.next=n.next,n.next=e),i.pending=e}function l4(i,e,n){if(n&4194240){var r=e.lanes;r&=i.pendingLanes,n|=r,e.lanes=n,XR(i,n)}}var Sb={readContext:No,useCallback:Ar,useContext:Ar,useEffect:Ar,useImperativeHandle:Ar,useInsertionEffect:Ar,useLayoutEffect:Ar,useMemo:Ar,useReducer:Ar,useRef:Ar,useState:Ar,useDebugValue:Ar,useDeferredValue:Ar,useTransition:Ar,useMutableSource:Ar,useSyncExternalStore:Ar,useId:Ar,unstable_isNewReconciler:!1},y9={readContext:No,useCallback:function(i,e){return Pa().memoizedState=[i,e===void 0?null:e],i},useContext:No,useEffect:oL,useImperativeHandle:function(i,e,n){return n=n!=null?n.concat([i]):null,__(4194308,4,e4.bind(null,e,i),n)},useLayoutEffect:function(i,e){return __(4194308,4,i,e)},useInsertionEffect:function(i,e){return __(4,2,i,e)},useMemo:function(i,e){var n=Pa();return e=e===void 0?null:e,i=i(),n.memoizedState=[i,e],i},useReducer:function(i,e,n){var r=Pa();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},r.queue=i,i=i.dispatch=m9.bind(null,ui,i),[r.memoizedState,i]},useRef:function(i){var e=Pa();return i={current:i},e.memoizedState=i},useState:sL,useDebugValue:yP,useDeferredValue:function(i){return Pa().memoizedState=i},useTransition:function(){var i=sL(!1),e=i[0];return i=p9.bind(null,i[1]),Pa().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,n){var r=ui,s=Pa();if(ei){if(n===void 0)throw Error(ze(407));n=n()}else{if(n=e(),cr===null)throw Error(ze(349));Rd&30||jz(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,oL(Xz.bind(null,r,o,i),[i]),r.flags|=2048,_y(9,qz.bind(null,r,o,n,e),void 0,null),n},useId:function(){var i=Pa(),e=cr.identifierPrefix;if(ei){var n=Ll,r=kl;n=(r&~(1<<32-la(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=vy++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=f9++,e=":"+e+"r"+n.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},v9={readContext:No,useCallback:n4,useContext:No,useEffect:gP,useImperativeHandle:t4,useInsertionEffect:Qz,useLayoutEffect:Jz,useMemo:i4,useReducer:oT,useRef:Zz,useState:function(){return oT(xy)},useDebugValue:yP,useDeferredValue:function(i){var e=ko();return r4(e,ji.memoizedState,i)},useTransition:function(){var i=oT(xy)[0],e=ko().memoizedState;return[i,e]},useMutableSource:Hz,useSyncExternalStore:Wz,useId:s4,unstable_isNewReconciler:!1},x9={readContext:No,useCallback:n4,useContext:No,useEffect:gP,useImperativeHandle:t4,useInsertionEffect:Qz,useLayoutEffect:Jz,useMemo:i4,useReducer:aT,useRef:Zz,useState:function(){return aT(xy)},useDebugValue:yP,useDeferredValue:function(i){var e=ko();return ji===null?e.memoizedState=i:r4(e,ji.memoizedState,i)},useTransition:function(){var i=aT(xy)[0],e=ko().memoizedState;return[i,e]},useMutableSource:Hz,useSyncExternalStore:Wz,useId:s4,unstable_isNewReconciler:!1};function Qo(i,e){if(i&&i.defaultProps){e=di({},e),i=i.defaultProps;for(var n in i)e[n]===void 0&&(e[n]=i[n]);return e}return e}function OA(i,e,n,r){e=i.memoizedState,n=n(r,e),n=n==null?e:di({},e,n),i.memoizedState=n,i.lanes===0&&(i.updateQueue.baseState=n)}var D1={isMounted:function(i){return(i=i._reactInternals)?qd(i)===i:!1},enqueueSetState:function(i,e,n){i=i._reactInternals;var r=ss(),s=iu(i),o=zl(r,s);o.payload=e,n!=null&&(o.callback=n),e=tu(i,o,s),e!==null&&(ca(e,i,s,r),v_(e,i,s))},enqueueReplaceState:function(i,e,n){i=i._reactInternals;var r=ss(),s=iu(i),o=zl(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=tu(i,o,s),e!==null&&(ca(e,i,s,r),v_(e,i,s))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var n=ss(),r=iu(i),s=zl(n,r);s.tag=2,e!=null&&(s.callback=e),e=tu(i,s,r),e!==null&&(ca(e,i,r,n),v_(e,i,r))}};function aL(i,e,n,r,s,o,a){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!hy(n,r)||!hy(s,o):!0}function c4(i,e,n){var r=!1,s=hu,o=e.contextType;return typeof o=="object"&&o!==null?o=No(o):(s=Es(e)?Ad:Vr.current,r=e.contextTypes,o=(r=r!=null)?Jf(i,s):hu),e=new e(n,o),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=D1,i.stateNode=e,e._reactInternals=i,r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=s,i.__reactInternalMemoizedMaskedChildContext=o),e}function lL(i,e,n,r){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==i&&D1.enqueueReplaceState(e,e.state,null)}function FA(i,e,n,r){var s=i.stateNode;s.props=n,s.state=i.memoizedState,s.refs={},cP(i);var o=e.contextType;typeof o=="object"&&o!==null?s.context=No(o):(o=Es(e)?Ad:Vr.current,s.context=Jf(i,o)),s.state=i.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(OA(i,e,o,n),s.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&D1.enqueueReplaceState(s,s.state,null),xb(i,n,s,r),s.state=i.memoizedState),typeof s.componentDidMount=="function"&&(i.flags|=4194308)}function ip(i,e){try{var n="",r=e;do n+=qW(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:i,source:e,stack:s,digest:null}}function lT(i,e,n){return{value:i,source:null,stack:n??null,digest:e??null}}function BA(i,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var _9=typeof WeakMap=="function"?WeakMap:Map;function u4(i,e,n){n=zl(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Tb||(Tb=!0,XA=r),BA(i,e)},n}function d4(i,e,n){n=zl(-1,n),n.tag=3;var r=i.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){BA(i,e)}}var o=i.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){BA(i,e),typeof r!="function"&&(nu===null?nu=new Set([this]):nu.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function cL(i,e,n){var r=i.pingCache;if(r===null){r=i.pingCache=new _9;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),i=I9.bind(null,i,e,n),e.then(i,i))}function uL(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function dL(i,e,n,r,s){return i.mode&1?(i.flags|=65536,i.lanes=s,i):(i===e?i.flags|=65536:(i.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=zl(-1,1),e.tag=2,tu(n,e,1))),n.lanes|=1),i)}var b9=oc.ReactCurrentOwner,xs=!1;function Kr(i,e,n,r){e.child=i===null?zz(e,null,n,r):tp(e,i.child,n,r)}function hL(i,e,n,r,s){n=n.render;var o=e.ref;return Nf(e,s),r=pP(i,e,n,r,o,s),n=mP(),i!==null&&!xs?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~s,Zl(i,e,s)):(ei&&n&&nP(e),e.flags|=1,Kr(i,e,r,s),e.child)}function fL(i,e,n,r,s){if(i===null){var o=n.type;return typeof o=="function"&&!EP(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,h4(i,e,o,r,s)):(i=T_(n.type,null,r,e,e.mode,s),i.ref=e.ref,i.return=e,e.child=i)}if(o=i.child,!(i.lanes&s)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:hy,n(a,r)&&i.ref===e.ref)return Zl(i,e,s)}return e.flags|=1,i=ru(o,r),i.ref=e.ref,i.return=e,e.child=i}function h4(i,e,n,r,s){if(i!==null){var o=i.memoizedProps;if(hy(o,r)&&i.ref===e.ref)if(xs=!1,e.pendingProps=r=o,(i.lanes&s)!==0)i.flags&131072&&(xs=!0);else return e.lanes=i.lanes,Zl(i,e,s)}return UA(i,e,n,r,s)}function f4(i,e,n){var r=e.pendingProps,s=r.children,o=i!==null?i.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},zn(pf,Gs),Gs|=n;else{if(!(n&1073741824))return i=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,zn(pf,Gs),Gs|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,zn(pf,Gs),Gs|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,zn(pf,Gs),Gs|=r;return Kr(i,e,s,n),e.child}function p4(i,e){var n=e.ref;(i===null&&n!==null||i!==null&&i.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function UA(i,e,n,r,s){var o=Es(n)?Ad:Vr.current;return o=Jf(e,o),Nf(e,s),n=pP(i,e,n,r,o,s),r=mP(),i!==null&&!xs?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~s,Zl(i,e,s)):(ei&&r&&nP(e),e.flags|=1,Kr(i,e,n,s),e.child)}function pL(i,e,n,r,s){if(Es(n)){var o=!0;pb(e)}else o=!1;if(Nf(e,s),e.stateNode===null)b_(i,e),c4(e,n,r),FA(e,n,r,s),r=!0;else if(i===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=No(u):(u=Es(n)?Ad:Vr.current,u=Jf(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==u)&&lL(e,a,r,u),zc=!1;var f=e.memoizedState;a.state=f,xb(e,r,a,s),c=e.memoizedState,l!==r||f!==c||Ts.current||zc?(typeof d=="function"&&(OA(e,n,d,r),c=e.memoizedState),(l=zc||aL(e,n,l,r,f,c,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=u,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,$z(i,e),l=e.memoizedProps,u=e.type===e.elementType?l:Qo(e.type,l),a.props=u,h=e.pendingProps,f=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=No(c):(c=Es(n)?Ad:Vr.current,c=Jf(e,c));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||f!==c)&&lL(e,a,r,c),zc=!1,f=e.memoizedState,a.state=f,xb(e,r,a,s);var m=e.memoizedState;l!==h||f!==m||Ts.current||zc?(typeof p=="function"&&(OA(e,n,p,r),m=e.memoizedState),(u=zc||aL(e,n,u,r,f,m,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===i.memoizedProps&&f===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===i.memoizedProps&&f===i.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),a.props=r,a.state=m,a.context=c,r=u):(typeof a.componentDidUpdate!="function"||l===i.memoizedProps&&f===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===i.memoizedProps&&f===i.memoizedState||(e.flags|=1024),r=!1)}return zA(i,e,n,r,o,s)}function zA(i,e,n,r,s,o){p4(i,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&Jk(e,n,!1),Zl(i,e,o);r=e.stateNode,b9.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,i!==null&&a?(e.child=tp(e,i.child,null,o),e.child=tp(e,null,l,o)):Kr(i,e,l,o),e.memoizedState=r.state,s&&Jk(e,n,!0),e.child}function m4(i){var e=i.stateNode;e.pendingContext?Qk(i,e.pendingContext,e.pendingContext!==e.context):e.context&&Qk(i,e.context,!1),uP(i,e.containerInfo)}function mL(i,e,n,r,s){return ep(),rP(s),e.flags|=256,Kr(i,e,n,r),e.child}var VA={dehydrated:null,treeContext:null,retryLane:0};function $A(i){return{baseLanes:i,cachePool:null,transitions:null}}function g4(i,e,n){var r=e.pendingProps,s=oi.current,o=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=i!==null&&i.memoizedState===null?!1:(s&2)!==0),l?(o=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(s|=1),zn(oi,s&1),i===null)return IA(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,i=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=B1(a,r,0,null),i=_d(i,r,n,null),o.return=e,i.return=e,o.sibling=i,e.child=o,e.child.memoizedState=$A(n),e.memoizedState=VA,i):vP(e,a));if(s=i.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return S9(i,e,a,r,l,s,n);if(o){o=r.fallback,a=e.mode,s=i.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ru(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=ru(l,o):(o=_d(o,a,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=i.child.memoizedState,a=a===null?$A(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=i.childLanes&~n,e.memoizedState=VA,r}return o=i.child,i=o.sibling,r=ru(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,i!==null&&(n=e.deletions,n===null?(e.deletions=[i],e.flags|=16):n.push(i)),e.child=r,e.memoizedState=null,r}function vP(i,e){return e=B1({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function wv(i,e,n,r){return r!==null&&rP(r),tp(e,i.child,null,n),i=vP(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function S9(i,e,n,r,s,o,a){if(n)return e.flags&256?(e.flags&=-257,r=lT(Error(ze(422))),wv(i,e,a,r)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=B1({mode:"visible",children:r.children},s,0,null),o=_d(o,s,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&tp(e,i.child,null,a),e.child.memoizedState=$A(a),e.memoizedState=VA,o);if(!(e.mode&1))return wv(i,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(ze(419)),r=lT(o,r,void 0),wv(i,e,a,r)}if(l=(a&i.childLanes)!==0,xs||l){if(r=cr,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Yl(i,s),ca(r,i,s,-1))}return TP(),r=lT(Error(ze(421))),wv(i,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=i.child,e=D9.bind(null,i),s._reactRetry=e,null):(i=o.treeContext,Xs=eu(s.nextSibling),Zs=e,ei=!0,na=null,i!==null&&(xo[_o++]=kl,xo[_o++]=Ll,xo[_o++]=Cd,kl=i.id,Ll=i.overflow,Cd=e),e=vP(e,r.children),e.flags|=4096,e)}function gL(i,e,n){i.lanes|=e;var r=i.alternate;r!==null&&(r.lanes|=e),DA(i.return,e,n)}function cT(i,e,n,r,s){var o=i.memoizedState;o===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function y4(i,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(Kr(i,e,r.children,n),r=oi.current,r&2)r=r&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&gL(i,n,e);else if(i.tag===19)gL(i,n,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}r&=1}if(zn(oi,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)i=n.alternate,i!==null&&_b(i)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),cT(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(i=s.alternate,i!==null&&_b(i)===null){e.child=s;break}i=s.sibling,s.sibling=n,n=s,s=i}cT(e,!0,n,null,o);break;case"together":cT(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function b_(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Zl(i,e,n){if(i!==null&&(e.dependencies=i.dependencies),Pd|=e.lanes,!(n&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(ze(153));if(e.child!==null){for(i=e.child,n=ru(i,i.pendingProps),e.child=n,n.return=e;i.sibling!==null;)i=i.sibling,n=n.sibling=ru(i,i.pendingProps),n.return=e;n.sibling=null}return e.child}function w9(i,e,n){switch(e.tag){case 3:m4(e),ep();break;case 5:Gz(e);break;case 1:Es(e.type)&&pb(e);break;case 4:uP(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;zn(yb,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(zn(oi,oi.current&1),e.flags|=128,null):n&e.child.childLanes?g4(i,e,n):(zn(oi,oi.current&1),i=Zl(i,e,n),i!==null?i.sibling:null);zn(oi,oi.current&1);break;case 19:if(r=(n&e.childLanes)!==0,i.flags&128){if(r)return y4(i,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),zn(oi,oi.current),r)break;return null;case 22:case 23:return e.lanes=0,f4(i,e,n)}return Zl(i,e,n)}var v4,GA,x4,_4;v4=function(i,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)i.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};GA=function(){};x4=function(i,e,n,r){var s=i.memoizedProps;if(s!==r){i=e.stateNode,pd(Ga.current);var o=null;switch(n){case"input":s=dA(i,s),r=dA(i,r),o=[];break;case"select":s=di({},s,{value:void 0}),r=di({},r,{value:void 0}),o=[];break;case"textarea":s=pA(i,s),r=pA(i,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(i.onclick=hb)}gA(n,r);var a;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(sy.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(sy.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Gn("scroll",i),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};_4=function(i,e,n,r){n!==r&&(e.flags|=4)};function _m(i,e){if(!ei)switch(i.tailMode){case"hidden":e=i.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?i.tail=null:n.sibling=null;break;case"collapsed":n=i.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:r.sibling=null}}function Cr(i){var e=i.alternate!==null&&i.alternate.child===i.child,n=0,r=0;if(e)for(var s=i.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=i,s=s.sibling;else for(s=i.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=i,s=s.sibling;return i.subtreeFlags|=r,i.childLanes=n,e}function T9(i,e,n){var r=e.pendingProps;switch(iP(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cr(e),null;case 1:return Es(e.type)&&fb(),Cr(e),null;case 3:return r=e.stateNode,np(),Kn(Ts),Kn(Vr),hP(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(i===null||i.child===null)&&(bv(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,na!==null&&(ZA(na),na=null))),GA(i,e),Cr(e),null;case 5:dP(e);var s=pd(yy.current);if(n=e.type,i!==null&&e.stateNode!=null)x4(i,e,n,r,s),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ze(166));return Cr(e),null}if(i=pd(Ga.current),bv(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Oa]=e,r[my]=o,i=(e.mode&1)!==0,n){case"dialog":Gn("cancel",r),Gn("close",r);break;case"iframe":case"object":case"embed":Gn("load",r);break;case"video":case"audio":for(s=0;s<vg.length;s++)Gn(vg[s],r);break;case"source":Gn("error",r);break;case"img":case"image":case"link":Gn("error",r),Gn("load",r);break;case"details":Gn("toggle",r);break;case"input":Ek(r,o),Gn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Gn("invalid",r);break;case"textarea":Ak(r,o),Gn("invalid",r)}gA(n,o),s=null;for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&_v(r.textContent,l,i),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&_v(r.textContent,l,i),s=["children",""+l]):sy.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Gn("scroll",r)}switch(n){case"input":hv(r),Mk(r,o,!0);break;case"textarea":hv(r),Ck(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=hb)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=XU(n)),i==="http://www.w3.org/1999/xhtml"?n==="script"?(i=a.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof r.is=="string"?i=a.createElement(n,{is:r.is}):(i=a.createElement(n),n==="select"&&(a=i,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):i=a.createElementNS(i,n),i[Oa]=e,i[my]=r,v4(i,e,!1,!1),e.stateNode=i;e:{switch(a=yA(n,r),n){case"dialog":Gn("cancel",i),Gn("close",i),s=r;break;case"iframe":case"object":case"embed":Gn("load",i),s=r;break;case"video":case"audio":for(s=0;s<vg.length;s++)Gn(vg[s],i);s=r;break;case"source":Gn("error",i),s=r;break;case"img":case"image":case"link":Gn("error",i),Gn("load",i),s=r;break;case"details":Gn("toggle",i),s=r;break;case"input":Ek(i,r),s=dA(i,r),Gn("invalid",i);break;case"option":s=r;break;case"select":i._wrapperState={wasMultiple:!!r.multiple},s=di({},r,{value:void 0}),Gn("invalid",i);break;case"textarea":Ak(i,r),s=pA(i,r),Gn("invalid",i);break;default:s=r}gA(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?ZU(i,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&KU(i,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&oy(i,c):typeof c=="number"&&oy(i,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(sy.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Gn("scroll",i):c!=null&&$R(i,o,c,a))}switch(n){case"input":hv(i),Mk(i,r,!1);break;case"textarea":hv(i),Ck(i);break;case"option":r.value!=null&&i.setAttribute("value",""+du(r.value));break;case"select":i.multiple=!!r.multiple,o=r.value,o!=null?Af(i,!!r.multiple,o,!1):r.defaultValue!=null&&Af(i,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(i.onclick=hb)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Cr(e),null;case 6:if(i&&e.stateNode!=null)_4(i,e,i.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ze(166));if(n=pd(yy.current),pd(Ga.current),bv(e)){if(r=e.stateNode,n=e.memoizedProps,r[Oa]=e,(o=r.nodeValue!==n)&&(i=Zs,i!==null))switch(i.tag){case 3:_v(r.nodeValue,n,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&_v(r.nodeValue,n,(i.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Oa]=e,e.stateNode=r}return Cr(e),null;case 13:if(Kn(oi),r=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(ei&&Xs!==null&&e.mode&1&&!(e.flags&128))Bz(),ep(),e.flags|=98560,o=!1;else if(o=bv(e),r!==null&&r.dehydrated!==null){if(i===null){if(!o)throw Error(ze(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ze(317));o[Oa]=e}else ep(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Cr(e),o=!1}else na!==null&&(ZA(na),na=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(i!==null&&i.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(i===null||oi.current&1?qi===0&&(qi=3):TP())),e.updateQueue!==null&&(e.flags|=4),Cr(e),null);case 4:return np(),GA(i,e),i===null&&fy(e.stateNode.containerInfo),Cr(e),null;case 10:return aP(e.type._context),Cr(e),null;case 17:return Es(e.type)&&fb(),Cr(e),null;case 19:if(Kn(oi),o=e.memoizedState,o===null)return Cr(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)_m(o,!1);else{if(qi!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(a=_b(i),a!==null){for(e.flags|=128,_m(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,i=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=i,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,i=a.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n=n.sibling;return zn(oi,oi.current&1|2),e.child}i=i.sibling}o.tail!==null&&Si()>rp&&(e.flags|=128,r=!0,_m(o,!1),e.lanes=4194304)}else{if(!r)if(i=_b(a),i!==null){if(e.flags|=128,r=!0,n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),_m(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!ei)return Cr(e),null}else 2*Si()-o.renderingStartTime>rp&&n!==1073741824&&(e.flags|=128,r=!0,_m(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Si(),e.sibling=null,n=oi.current,zn(oi,r?n&1|2:n&1),e):(Cr(e),null);case 22:case 23:return wP(),r=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Gs&1073741824&&(Cr(e),e.subtreeFlags&6&&(e.flags|=8192)):Cr(e),null;case 24:return null;case 25:return null}throw Error(ze(156,e.tag))}function E9(i,e){switch(iP(e),e.tag){case 1:return Es(e.type)&&fb(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return np(),Kn(Ts),Kn(Vr),hP(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return dP(e),null;case 13:if(Kn(oi),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(ze(340));ep()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return Kn(oi),null;case 4:return np(),null;case 10:return aP(e.type._context),null;case 22:case 23:return wP(),null;case 24:return null;default:return null}}var Tv=!1,Fr=!1,M9=typeof WeakSet=="function"?WeakSet:Set,ht=null;function ff(i,e){var n=i.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){mi(i,e,r)}else n.current=null}function HA(i,e,n){try{n()}catch(r){mi(i,e,r)}}var yL=!1;function A9(i,e){if(AA=cb,i=Ez(),tP(i)){if("selectionStart"in i)var n={start:i.selectionStart,end:i.selectionEnd};else e:{n=(n=i.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=i,f=null;t:for(;;){for(var p;h!==n||s!==0&&h.nodeType!==3||(l=a+s),h!==o||r!==0&&h.nodeType!==3||(c=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===i)break t;if(f===n&&++u===s&&(l=a),f===o&&++d===r&&(c=a),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(CA={focusedElem:i,selectionRange:n},cb=!1,ht=e;ht!==null;)if(e=ht,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,ht=i;else for(;ht!==null;){e=ht;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var y=m.memoizedProps,v=m.memoizedState,g=e.stateNode,_=g.getSnapshotBeforeUpdate(e.elementType===e.type?y:Qo(e.type,y),v);g.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ze(163))}}catch(b){mi(e,e.return,b)}if(i=e.sibling,i!==null){i.return=e.return,ht=i;break}ht=e.return}return m=yL,yL=!1,m}function Fg(i,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&i)===i){var o=s.destroy;s.destroy=void 0,o!==void 0&&HA(e,n,o)}s=s.next}while(s!==r)}}function O1(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&i)===i){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function WA(i){var e=i.ref;if(e!==null){var n=i.stateNode;switch(i.tag){case 5:i=n;break;default:i=n}typeof e=="function"?e(i):e.current=i}}function b4(i){var e=i.alternate;e!==null&&(i.alternate=null,b4(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Oa],delete e[my],delete e[NA],delete e[c9],delete e[u9])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function S4(i){return i.tag===5||i.tag===3||i.tag===4}function vL(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||S4(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function jA(i,e,n){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(i,e):n.insertBefore(i,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(i,n)):(e=n,e.appendChild(i)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hb));else if(r!==4&&(i=i.child,i!==null))for(jA(i,e,n),i=i.sibling;i!==null;)jA(i,e,n),i=i.sibling}function qA(i,e,n){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?n.insertBefore(i,e):n.appendChild(i);else if(r!==4&&(i=i.child,i!==null))for(qA(i,e,n),i=i.sibling;i!==null;)qA(i,e,n),i=i.sibling}var gr=null,ea=!1;function mc(i,e,n){for(n=n.child;n!==null;)w4(i,e,n),n=n.sibling}function w4(i,e,n){if($a&&typeof $a.onCommitFiberUnmount=="function")try{$a.onCommitFiberUnmount(C1,n)}catch{}switch(n.tag){case 5:Fr||ff(n,e);case 6:var r=gr,s=ea;gr=null,mc(i,e,n),gr=r,ea=s,gr!==null&&(ea?(i=gr,n=n.stateNode,i.nodeType===8?i.parentNode.removeChild(n):i.removeChild(n)):gr.removeChild(n.stateNode));break;case 18:gr!==null&&(ea?(i=gr,n=n.stateNode,i.nodeType===8?nT(i.parentNode,n):i.nodeType===1&&nT(i,n),uy(i)):nT(gr,n.stateNode));break;case 4:r=gr,s=ea,gr=n.stateNode.containerInfo,ea=!0,mc(i,e,n),gr=r,ea=s;break;case 0:case 11:case 14:case 15:if(!Fr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&HA(n,e,a),s=s.next}while(s!==r)}mc(i,e,n);break;case 1:if(!Fr&&(ff(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){mi(n,e,l)}mc(i,e,n);break;case 21:mc(i,e,n);break;case 22:n.mode&1?(Fr=(r=Fr)||n.memoizedState!==null,mc(i,e,n),Fr=r):mc(i,e,n);break;default:mc(i,e,n)}}function xL(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var n=i.stateNode;n===null&&(n=i.stateNode=new M9),e.forEach(function(r){var s=O9.bind(null,i,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Uo(i,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=i,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:gr=l.stateNode,ea=!1;break e;case 3:gr=l.stateNode.containerInfo,ea=!0;break e;case 4:gr=l.stateNode.containerInfo,ea=!0;break e}l=l.return}if(gr===null)throw Error(ze(160));w4(o,a,s),gr=null,ea=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){mi(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)T4(e,i),e=e.sibling}function T4(i,e){var n=i.alternate,r=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Uo(e,i),wa(i),r&4){try{Fg(3,i,i.return),O1(3,i)}catch(y){mi(i,i.return,y)}try{Fg(5,i,i.return)}catch(y){mi(i,i.return,y)}}break;case 1:Uo(e,i),wa(i),r&512&&n!==null&&ff(n,n.return);break;case 5:if(Uo(e,i),wa(i),r&512&&n!==null&&ff(n,n.return),i.flags&32){var s=i.stateNode;try{oy(s,"")}catch(y){mi(i,i.return,y)}}if(r&4&&(s=i.stateNode,s!=null)){var o=i.memoizedProps,a=n!==null?n.memoizedProps:o,l=i.type,c=i.updateQueue;if(i.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&jU(s,o),yA(l,a);var u=yA(l,o);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];d==="style"?ZU(s,h):d==="dangerouslySetInnerHTML"?KU(s,h):d==="children"?oy(s,h):$R(s,d,h,u)}switch(l){case"input":hA(s,o);break;case"textarea":qU(s,o);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?Af(s,!!o.multiple,p,!1):f!==!!o.multiple&&(o.defaultValue!=null?Af(s,!!o.multiple,o.defaultValue,!0):Af(s,!!o.multiple,o.multiple?[]:"",!1))}s[my]=o}catch(y){mi(i,i.return,y)}}break;case 6:if(Uo(e,i),wa(i),r&4){if(i.stateNode===null)throw Error(ze(162));s=i.stateNode,o=i.memoizedProps;try{s.nodeValue=o}catch(y){mi(i,i.return,y)}}break;case 3:if(Uo(e,i),wa(i),r&4&&n!==null&&n.memoizedState.isDehydrated)try{uy(e.containerInfo)}catch(y){mi(i,i.return,y)}break;case 4:Uo(e,i),wa(i);break;case 13:Uo(e,i),wa(i),s=i.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(bP=Si())),r&4&&xL(i);break;case 22:if(d=n!==null&&n.memoizedState!==null,i.mode&1?(Fr=(u=Fr)||d,Uo(e,i),Fr=u):Uo(e,i),wa(i),r&8192){if(u=i.memoizedState!==null,(i.stateNode.isHidden=u)&&!d&&i.mode&1)for(ht=i,d=i.child;d!==null;){for(h=ht=d;ht!==null;){switch(f=ht,p=f.child,f.tag){case 0:case 11:case 14:case 15:Fg(4,f,f.return);break;case 1:ff(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(y){mi(r,n,y)}}break;case 5:ff(f,f.return);break;case 22:if(f.memoizedState!==null){bL(h);continue}}p!==null?(p.return=f,ht=p):bL(h)}d=d.sibling}e:for(d=null,h=i;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=YU("display",a))}catch(y){mi(i,i.return,y)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(y){mi(i,i.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===i)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===i)break e;for(;h.sibling===null;){if(h.return===null||h.return===i)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Uo(e,i),wa(i),r&4&&xL(i);break;case 21:break;default:Uo(e,i),wa(i)}}function wa(i){var e=i.flags;if(e&2){try{e:{for(var n=i.return;n!==null;){if(S4(n)){var r=n;break e}n=n.return}throw Error(ze(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(oy(s,""),r.flags&=-33);var o=vL(i);qA(i,o,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=vL(i);jA(i,l,a);break;default:throw Error(ze(161))}}catch(c){mi(i,i.return,c)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function C9(i,e,n){ht=i,E4(i)}function E4(i,e,n){for(var r=(i.mode&1)!==0;ht!==null;){var s=ht,o=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Tv;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Fr;l=Tv;var u=Fr;if(Tv=a,(Fr=c)&&!u)for(ht=s;ht!==null;)a=ht,c=a.child,a.tag===22&&a.memoizedState!==null?SL(s):c!==null?(c.return=a,ht=c):SL(s);for(;o!==null;)ht=o,E4(o),o=o.sibling;ht=s,Tv=l,Fr=u}_L(i)}else s.subtreeFlags&8772&&o!==null?(o.return=s,ht=o):_L(i)}}function _L(i){for(;ht!==null;){var e=ht;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Fr||O1(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Fr)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Qo(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&rL(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}rL(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&uy(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ze(163))}Fr||e.flags&512&&WA(e)}catch(f){mi(e,e.return,f)}}if(e===i){ht=null;break}if(n=e.sibling,n!==null){n.return=e.return,ht=n;break}ht=e.return}}function bL(i){for(;ht!==null;){var e=ht;if(e===i){ht=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ht=n;break}ht=e.return}}function SL(i){for(;ht!==null;){var e=ht;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{O1(4,e)}catch(c){mi(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){mi(e,s,c)}}var o=e.return;try{WA(e)}catch(c){mi(e,o,c)}break;case 5:var a=e.return;try{WA(e)}catch(c){mi(e,a,c)}}}catch(c){mi(e,e.return,c)}if(e===i){ht=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ht=l;break}ht=e.return}}var R9=Math.ceil,wb=oc.ReactCurrentDispatcher,xP=oc.ReactCurrentOwner,Ro=oc.ReactCurrentBatchConfig,hn=0,cr=null,Oi=null,br=0,Gs=0,pf=bu(0),qi=0,by=null,Pd=0,F1=0,_P=0,Bg=null,ms=null,bP=0,rp=1/0,Sl=null,Tb=!1,XA=null,nu=null,Ev=!1,Xc=null,Eb=0,Ug=0,KA=null,S_=-1,w_=0;function ss(){return hn&6?Si():S_!==-1?S_:S_=Si()}function iu(i){return i.mode&1?hn&2&&br!==0?br&-br:h9.transition!==null?(w_===0&&(w_=cz()),w_):(i=Cn,i!==0||(i=window.event,i=i===void 0?16:gz(i.type)),i):1}function ca(i,e,n,r){if(50<Ug)throw Ug=0,KA=null,Error(ze(185));S0(i,n,r),(!(hn&2)||i!==cr)&&(i===cr&&(!(hn&2)&&(F1|=n),qi===4&&Hc(i,br)),Ms(i,r),n===1&&hn===0&&!(e.mode&1)&&(rp=Si()+500,L1&&Su()))}function Ms(i,e){var n=i.callbackNode;hj(i,e);var r=lb(i,i===cr?br:0);if(r===0)n!==null&&Nk(n),i.callbackNode=null,i.callbackPriority=0;else if(e=r&-r,i.callbackPriority!==e){if(n!=null&&Nk(n),e===1)i.tag===0?d9(wL.bind(null,i)):Dz(wL.bind(null,i)),a9(function(){!(hn&6)&&Su()}),n=null;else{switch(uz(r)){case 1:n=qR;break;case 4:n=az;break;case 16:n=ab;break;case 536870912:n=lz;break;default:n=ab}n=L4(n,M4.bind(null,i))}i.callbackPriority=e,i.callbackNode=n}}function M4(i,e){if(S_=-1,w_=0,hn&6)throw Error(ze(327));var n=i.callbackNode;if(kf()&&i.callbackNode!==n)return null;var r=lb(i,i===cr?br:0);if(r===0)return null;if(r&30||r&i.expiredLanes||e)e=Mb(i,r);else{e=r;var s=hn;hn|=2;var o=C4();(cr!==i||br!==e)&&(Sl=null,rp=Si()+500,xd(i,e));do try{k9();break}catch(l){A4(i,l)}while(1);oP(),wb.current=o,hn=s,Oi!==null?e=0:(cr=null,br=0,e=qi)}if(e!==0){if(e===2&&(s=SA(i),s!==0&&(r=s,e=YA(i,s))),e===1)throw n=by,xd(i,0),Hc(i,r),Ms(i,Si()),n;if(e===6)Hc(i,r);else{if(s=i.current.alternate,!(r&30)&&!P9(s)&&(e=Mb(i,r),e===2&&(o=SA(i),o!==0&&(r=o,e=YA(i,o))),e===1))throw n=by,xd(i,0),Hc(i,r),Ms(i,Si()),n;switch(i.finishedWork=s,i.finishedLanes=r,e){case 0:case 1:throw Error(ze(345));case 2:Zu(i,ms,Sl);break;case 3:if(Hc(i,r),(r&130023424)===r&&(e=bP+500-Si(),10<e)){if(lb(i,0)!==0)break;if(s=i.suspendedLanes,(s&r)!==r){ss(),i.pingedLanes|=i.suspendedLanes&s;break}i.timeoutHandle=PA(Zu.bind(null,i,ms,Sl),e);break}Zu(i,ms,Sl);break;case 4:if(Hc(i,r),(r&4194240)===r)break;for(e=i.eventTimes,s=-1;0<r;){var a=31-la(r);o=1<<a,a=e[a],a>s&&(s=a),r&=~o}if(r=s,r=Si()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*R9(r/1960))-r,10<r){i.timeoutHandle=PA(Zu.bind(null,i,ms,Sl),r);break}Zu(i,ms,Sl);break;case 5:Zu(i,ms,Sl);break;default:throw Error(ze(329))}}}return Ms(i,Si()),i.callbackNode===n?M4.bind(null,i):null}function YA(i,e){var n=Bg;return i.current.memoizedState.isDehydrated&&(xd(i,e).flags|=256),i=Mb(i,e),i!==2&&(e=ms,ms=n,e!==null&&ZA(e)),i}function ZA(i){ms===null?ms=i:ms.push.apply(ms,i)}function P9(i){for(var e=i;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!ha(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Hc(i,e){for(e&=~_P,e&=~F1,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var n=31-la(e),r=1<<n;i[n]=-1,e&=~r}}function wL(i){if(hn&6)throw Error(ze(327));kf();var e=lb(i,0);if(!(e&1))return Ms(i,Si()),null;var n=Mb(i,e);if(i.tag!==0&&n===2){var r=SA(i);r!==0&&(e=r,n=YA(i,r))}if(n===1)throw n=by,xd(i,0),Hc(i,e),Ms(i,Si()),n;if(n===6)throw Error(ze(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,Zu(i,ms,Sl),Ms(i,Si()),null}function SP(i,e){var n=hn;hn|=1;try{return i(e)}finally{hn=n,hn===0&&(rp=Si()+500,L1&&Su())}}function Nd(i){Xc!==null&&Xc.tag===0&&!(hn&6)&&kf();var e=hn;hn|=1;var n=Ro.transition,r=Cn;try{if(Ro.transition=null,Cn=1,i)return i()}finally{Cn=r,Ro.transition=n,hn=e,!(hn&6)&&Su()}}function wP(){Gs=pf.current,Kn(pf)}function xd(i,e){i.finishedWork=null,i.finishedLanes=0;var n=i.timeoutHandle;if(n!==-1&&(i.timeoutHandle=-1,o9(n)),Oi!==null)for(n=Oi.return;n!==null;){var r=n;switch(iP(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fb();break;case 3:np(),Kn(Ts),Kn(Vr),hP();break;case 5:dP(r);break;case 4:np();break;case 13:Kn(oi);break;case 19:Kn(oi);break;case 10:aP(r.type._context);break;case 22:case 23:wP()}n=n.return}if(cr=i,Oi=i=ru(i.current,null),br=Gs=e,qi=0,by=null,_P=F1=Pd=0,ms=Bg=null,fd!==null){for(e=0;e<fd.length;e++)if(n=fd[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=s,r.next=a}n.pending=r}fd=null}return i}function A4(i,e){do{var n=Oi;try{if(oP(),x_.current=Sb,bb){for(var r=ui.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}bb=!1}if(Rd=0,rr=ji=ui=null,Og=!1,vy=0,xP.current=null,n===null||n.return===null){qi=1,by=e,Oi=null;break}e:{var o=i,a=n.return,l=n,c=e;if(e=br,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=uL(a);if(p!==null){p.flags&=-257,dL(p,a,l,o,e),p.mode&1&&cL(o,u,e),e=p,c=u;var m=e.updateQueue;if(m===null){var y=new Set;y.add(c),e.updateQueue=y}else m.add(c);break e}else{if(!(e&1)){cL(o,u,e),TP();break e}c=Error(ze(426))}}else if(ei&&l.mode&1){var v=uL(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),dL(v,a,l,o,e),rP(ip(c,l));break e}}o=c=ip(c,l),qi!==4&&(qi=2),Bg===null?Bg=[o]:Bg.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=u4(o,c,e);iL(o,g);break e;case 1:l=c;var _=o.type,x=o.stateNode;if(!(o.flags&128)&&(typeof _.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(nu===null||!nu.has(x)))){o.flags|=65536,e&=-e,o.lanes|=e;var b=d4(o,l,e);iL(o,b);break e}}o=o.return}while(o!==null)}P4(n)}catch(S){e=S,Oi===n&&n!==null&&(Oi=n=n.return);continue}break}while(1)}function C4(){var i=wb.current;return wb.current=Sb,i===null?Sb:i}function TP(){(qi===0||qi===3||qi===2)&&(qi=4),cr===null||!(Pd&268435455)&&!(F1&268435455)||Hc(cr,br)}function Mb(i,e){var n=hn;hn|=2;var r=C4();(cr!==i||br!==e)&&(Sl=null,xd(i,e));do try{N9();break}catch(s){A4(i,s)}while(1);if(oP(),hn=n,wb.current=r,Oi!==null)throw Error(ze(261));return cr=null,br=0,qi}function N9(){for(;Oi!==null;)R4(Oi)}function k9(){for(;Oi!==null&&!ij();)R4(Oi)}function R4(i){var e=k4(i.alternate,i,Gs);i.memoizedProps=i.pendingProps,e===null?P4(i):Oi=e,xP.current=null}function P4(i){var e=i;do{var n=e.alternate;if(i=e.return,e.flags&32768){if(n=E9(n,e),n!==null){n.flags&=32767,Oi=n;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{qi=6,Oi=null;return}}else if(n=T9(n,e,Gs),n!==null){Oi=n;return}if(e=e.sibling,e!==null){Oi=e;return}Oi=e=i}while(e!==null);qi===0&&(qi=5)}function Zu(i,e,n){var r=Cn,s=Ro.transition;try{Ro.transition=null,Cn=1,L9(i,e,n,r)}finally{Ro.transition=s,Cn=r}return null}function L9(i,e,n,r){do kf();while(Xc!==null);if(hn&6)throw Error(ze(327));n=i.finishedWork;var s=i.finishedLanes;if(n===null)return null;if(i.finishedWork=null,i.finishedLanes=0,n===i.current)throw Error(ze(177));i.callbackNode=null,i.callbackPriority=0;var o=n.lanes|n.childLanes;if(fj(i,o),i===cr&&(Oi=cr=null,br=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ev||(Ev=!0,L4(ab,function(){return kf(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ro.transition,Ro.transition=null;var a=Cn;Cn=1;var l=hn;hn|=4,xP.current=null,A9(i,n),T4(n,i),Jj(CA),cb=!!AA,CA=AA=null,i.current=n,C9(n),rj(),hn=l,Cn=a,Ro.transition=o}else i.current=n;if(Ev&&(Ev=!1,Xc=i,Eb=s),o=i.pendingLanes,o===0&&(nu=null),aj(n.stateNode),Ms(i,Si()),e!==null)for(r=i.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Tb)throw Tb=!1,i=XA,XA=null,i;return Eb&1&&i.tag!==0&&kf(),o=i.pendingLanes,o&1?i===KA?Ug++:(Ug=0,KA=i):Ug=0,Su(),null}function kf(){if(Xc!==null){var i=uz(Eb),e=Ro.transition,n=Cn;try{if(Ro.transition=null,Cn=16>i?16:i,Xc===null)var r=!1;else{if(i=Xc,Xc=null,Eb=0,hn&6)throw Error(ze(331));var s=hn;for(hn|=4,ht=i.current;ht!==null;){var o=ht,a=o.child;if(ht.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ht=u;ht!==null;){var d=ht;switch(d.tag){case 0:case 11:case 15:Fg(8,d,o)}var h=d.child;if(h!==null)h.return=d,ht=h;else for(;ht!==null;){d=ht;var f=d.sibling,p=d.return;if(b4(d),d===u){ht=null;break}if(f!==null){f.return=p,ht=f;break}ht=p}}}var m=o.alternate;if(m!==null){var y=m.child;if(y!==null){m.child=null;do{var v=y.sibling;y.sibling=null,y=v}while(y!==null)}}ht=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,ht=a;else e:for(;ht!==null;){if(o=ht,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Fg(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,ht=g;break e}ht=o.return}}var _=i.current;for(ht=_;ht!==null;){a=ht;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,ht=x;else e:for(a=_;ht!==null;){if(l=ht,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:O1(9,l)}}catch(S){mi(l,l.return,S)}if(l===a){ht=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,ht=b;break e}ht=l.return}}if(hn=s,Su(),$a&&typeof $a.onPostCommitFiberRoot=="function")try{$a.onPostCommitFiberRoot(C1,i)}catch{}r=!0}return r}finally{Cn=n,Ro.transition=e}}return!1}function TL(i,e,n){e=ip(n,e),e=u4(i,e,1),i=tu(i,e,1),e=ss(),i!==null&&(S0(i,1,e),Ms(i,e))}function mi(i,e,n){if(i.tag===3)TL(i,i,n);else for(;e!==null;){if(e.tag===3){TL(e,i,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(nu===null||!nu.has(r))){i=ip(n,i),i=d4(e,i,1),e=tu(e,i,1),i=ss(),e!==null&&(S0(e,1,i),Ms(e,i));break}}e=e.return}}function I9(i,e,n){var r=i.pingCache;r!==null&&r.delete(e),e=ss(),i.pingedLanes|=i.suspendedLanes&n,cr===i&&(br&n)===n&&(qi===4||qi===3&&(br&130023424)===br&&500>Si()-bP?xd(i,0):_P|=n),Ms(i,e)}function N4(i,e){e===0&&(i.mode&1?(e=mv,mv<<=1,!(mv&130023424)&&(mv=4194304)):e=1);var n=ss();i=Yl(i,e),i!==null&&(S0(i,e,n),Ms(i,n))}function D9(i){var e=i.memoizedState,n=0;e!==null&&(n=e.retryLane),N4(i,n)}function O9(i,e){var n=0;switch(i.tag){case 13:var r=i.stateNode,s=i.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=i.stateNode;break;default:throw Error(ze(314))}r!==null&&r.delete(e),N4(i,n)}var k4;k4=function(i,e,n){if(i!==null)if(i.memoizedProps!==e.pendingProps||Ts.current)xs=!0;else{if(!(i.lanes&n)&&!(e.flags&128))return xs=!1,w9(i,e,n);xs=!!(i.flags&131072)}else xs=!1,ei&&e.flags&1048576&&Oz(e,gb,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;b_(i,e),i=e.pendingProps;var s=Jf(e,Vr.current);Nf(e,n),s=pP(null,e,r,i,s,n);var o=mP();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Es(r)?(o=!0,pb(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,cP(e),s.updater=D1,e.stateNode=s,s._reactInternals=e,FA(e,r,i,n),e=zA(null,e,r,!0,o,n)):(e.tag=0,ei&&o&&nP(e),Kr(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(b_(i,e),i=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=B9(r),i=Qo(r,i),s){case 0:e=UA(null,e,r,i,n);break e;case 1:e=pL(null,e,r,i,n);break e;case 11:e=hL(null,e,r,i,n);break e;case 14:e=fL(null,e,r,Qo(r.type,i),n);break e}throw Error(ze(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Qo(r,s),UA(i,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Qo(r,s),pL(i,e,r,s,n);case 3:e:{if(m4(e),i===null)throw Error(ze(387));r=e.pendingProps,o=e.memoizedState,s=o.element,$z(i,e),xb(e,r,null,n);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=ip(Error(ze(423)),e),e=mL(i,e,r,n,s);break e}else if(r!==s){s=ip(Error(ze(424)),e),e=mL(i,e,r,n,s);break e}else for(Xs=eu(e.stateNode.containerInfo.firstChild),Zs=e,ei=!0,na=null,n=zz(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ep(),r===s){e=Zl(i,e,n);break e}Kr(i,e,r,n)}e=e.child}return e;case 5:return Gz(e),i===null&&IA(e),r=e.type,s=e.pendingProps,o=i!==null?i.memoizedProps:null,a=s.children,RA(r,s)?a=null:o!==null&&RA(r,o)&&(e.flags|=32),p4(i,e),Kr(i,e,a,n),e.child;case 6:return i===null&&IA(e),null;case 13:return g4(i,e,n);case 4:return uP(e,e.stateNode.containerInfo),r=e.pendingProps,i===null?e.child=tp(e,null,r,n):Kr(i,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Qo(r,s),hL(i,e,r,s,n);case 7:return Kr(i,e,e.pendingProps,n),e.child;case 8:return Kr(i,e,e.pendingProps.children,n),e.child;case 12:return Kr(i,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,a=s.value,zn(yb,r._currentValue),r._currentValue=a,o!==null)if(ha(o.value,a)){if(o.children===s.children&&!Ts.current){e=Zl(i,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){a=o.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=zl(-1,n&-n),c.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),DA(o.return,n,e),l.lanes|=n;break}c=c.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(ze(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),DA(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Kr(i,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Nf(e,n),s=No(s),r=r(s),e.flags|=1,Kr(i,e,r,n),e.child;case 14:return r=e.type,s=Qo(r,e.pendingProps),s=Qo(r.type,s),fL(i,e,r,s,n);case 15:return h4(i,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Qo(r,s),b_(i,e),e.tag=1,Es(r)?(i=!0,pb(e)):i=!1,Nf(e,n),c4(e,r,s),FA(e,r,s,n),zA(null,e,r,!0,i,n);case 19:return y4(i,e,n);case 22:return f4(i,e,n)}throw Error(ze(156,e.tag))};function L4(i,e){return oz(i,e)}function F9(i,e,n,r){this.tag=i,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ao(i,e,n,r){return new F9(i,e,n,r)}function EP(i){return i=i.prototype,!(!i||!i.isReactComponent)}function B9(i){if(typeof i=="function")return EP(i)?1:0;if(i!=null){if(i=i.$$typeof,i===HR)return 11;if(i===WR)return 14}return 2}function ru(i,e){var n=i.alternate;return n===null?(n=Ao(i.tag,e,i.key,i.mode),n.elementType=i.elementType,n.type=i.type,n.stateNode=i.stateNode,n.alternate=i,i.alternate=n):(n.pendingProps=e,n.type=i.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=i.flags&14680064,n.childLanes=i.childLanes,n.lanes=i.lanes,n.child=i.child,n.memoizedProps=i.memoizedProps,n.memoizedState=i.memoizedState,n.updateQueue=i.updateQueue,e=i.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=i.sibling,n.index=i.index,n.ref=i.ref,n}function T_(i,e,n,r,s,o){var a=2;if(r=i,typeof i=="function")EP(i)&&(a=1);else if(typeof i=="string")a=5;else e:switch(i){case rf:return _d(n.children,s,o,e);case GR:a=8,s|=8;break;case aA:return i=Ao(12,n,e,s|2),i.elementType=aA,i.lanes=o,i;case lA:return i=Ao(13,n,e,s),i.elementType=lA,i.lanes=o,i;case cA:return i=Ao(19,n,e,s),i.elementType=cA,i.lanes=o,i;case GU:return B1(n,s,o,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case VU:a=10;break e;case $U:a=9;break e;case HR:a=11;break e;case WR:a=14;break e;case Uc:a=16,r=null;break e}throw Error(ze(130,i==null?i:typeof i,""))}return e=Ao(a,n,e,s),e.elementType=i,e.type=r,e.lanes=o,e}function _d(i,e,n,r){return i=Ao(7,i,r,e),i.lanes=n,i}function B1(i,e,n,r){return i=Ao(22,i,r,e),i.elementType=GU,i.lanes=n,i.stateNode={isHidden:!1},i}function uT(i,e,n){return i=Ao(6,i,null,e),i.lanes=n,i}function dT(i,e,n){return e=Ao(4,i.children!==null?i.children:[],i.key,e),e.lanes=n,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function U9(i,e,n,r,s){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ww(0),this.expirationTimes=Ww(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ww(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function MP(i,e,n,r,s,o,a,l,c){return i=new U9(i,e,n,l,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ao(3,null,null,e),i.current=o,o.stateNode=i,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},cP(o),i}function z9(i,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nf,key:r==null?null:""+r,children:i,containerInfo:e,implementation:n}}function I4(i){if(!i)return hu;i=i._reactInternals;e:{if(qd(i)!==i||i.tag!==1)throw Error(ze(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Es(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ze(171))}if(i.tag===1){var n=i.type;if(Es(n))return Iz(i,n,e)}return e}function D4(i,e,n,r,s,o,a,l,c){return i=MP(n,r,!0,i,s,o,a,l,c),i.context=I4(null),n=i.current,r=ss(),s=iu(n),o=zl(r,s),o.callback=e??null,tu(n,o,s),i.current.lanes=s,S0(i,s,r),Ms(i,r),i}function U1(i,e,n,r){var s=e.current,o=ss(),a=iu(s);return n=I4(n),e.context===null?e.context=n:e.pendingContext=n,e=zl(o,a),e.payload={element:i},r=r===void 0?null:r,r!==null&&(e.callback=r),i=tu(s,e,a),i!==null&&(ca(i,s,a,o),v_(i,s,a)),a}function Ab(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function EL(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var n=i.retryLane;i.retryLane=n!==0&&n<e?n:e}}function AP(i,e){EL(i,e),(i=i.alternate)&&EL(i,e)}function V9(){return null}var O4=typeof reportError=="function"?reportError:function(i){console.error(i)};function CP(i){this._internalRoot=i}z1.prototype.render=CP.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(ze(409));U1(i,e,null,null)};z1.prototype.unmount=CP.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Nd(function(){U1(null,i,null,null)}),e[Kl]=null}};function z1(i){this._internalRoot=i}z1.prototype.unstable_scheduleHydration=function(i){if(i){var e=fz();i={blockedOn:null,target:i,priority:e};for(var n=0;n<Gc.length&&e!==0&&e<Gc[n].priority;n++);Gc.splice(n,0,i),n===0&&mz(i)}};function RP(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function V1(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function ML(){}function $9(i,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=Ab(a);o.call(u)}}var a=D4(e,r,i,0,null,!1,!1,"",ML);return i._reactRootContainer=a,i[Kl]=a.current,fy(i.nodeType===8?i.parentNode:i),Nd(),a}for(;s=i.lastChild;)i.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Ab(c);l.call(u)}}var c=MP(i,0,!1,null,null,!1,!1,"",ML);return i._reactRootContainer=c,i[Kl]=c.current,fy(i.nodeType===8?i.parentNode:i),Nd(function(){U1(e,c,n,r)}),c}function $1(i,e,n,r,s){var o=n._reactRootContainer;if(o){var a=o;if(typeof s=="function"){var l=s;s=function(){var c=Ab(a);l.call(c)}}U1(e,a,i,s)}else a=$9(n,e,i,s,r);return Ab(a)}dz=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var n=yg(e.pendingLanes);n!==0&&(XR(e,n|1),Ms(e,Si()),!(hn&6)&&(rp=Si()+500,Su()))}break;case 13:Nd(function(){var r=Yl(i,1);if(r!==null){var s=ss();ca(r,i,1,s)}}),AP(i,1)}};KR=function(i){if(i.tag===13){var e=Yl(i,134217728);if(e!==null){var n=ss();ca(e,i,134217728,n)}AP(i,134217728)}};hz=function(i){if(i.tag===13){var e=iu(i),n=Yl(i,e);if(n!==null){var r=ss();ca(n,i,e,r)}AP(i,e)}};fz=function(){return Cn};pz=function(i,e){var n=Cn;try{return Cn=i,e()}finally{Cn=n}};xA=function(i,e,n){switch(e){case"input":if(hA(i,n),e=n.name,n.type==="radio"&&e!=null){for(n=i;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==i&&r.form===i.form){var s=k1(r);if(!s)throw Error(ze(90));WU(r),hA(r,s)}}}break;case"textarea":qU(i,n);break;case"select":e=n.value,e!=null&&Af(i,!!n.multiple,e,!1)}};ez=SP;tz=Nd;var G9={usingClientEntryPoint:!1,Events:[T0,lf,k1,QU,JU,SP]},bm={findFiberByHostInstance:hd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},H9={bundleType:bm.bundleType,version:bm.version,rendererPackageName:bm.rendererPackageName,rendererConfig:bm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oc.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=rz(i),i===null?null:i.stateNode},findFiberByHostInstance:bm.findFiberByHostInstance||V9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mv.isDisabled&&Mv.supportsFiber)try{C1=Mv.inject(H9),$a=Mv}catch{}}ao.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G9;ao.createPortal=function(i,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!RP(e))throw Error(ze(200));return z9(i,e,null,n)};ao.createRoot=function(i,e){if(!RP(i))throw Error(ze(299));var n=!1,r="",s=O4;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=MP(i,1,!1,null,null,n,!1,r,s),i[Kl]=e.current,fy(i.nodeType===8?i.parentNode:i),new CP(e)};ao.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(ze(188)):(i=Object.keys(i).join(","),Error(ze(268,i)));return i=rz(e),i=i===null?null:i.stateNode,i};ao.flushSync=function(i){return Nd(i)};ao.hydrate=function(i,e,n){if(!V1(e))throw Error(ze(200));return $1(null,i,e,!0,n)};ao.hydrateRoot=function(i,e,n){if(!RP(i))throw Error(ze(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",a=O4;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=D4(e,null,i,1,n??null,s,!1,o,a),i[Kl]=e.current,fy(i),r)for(i=0;i<r.length;i++)n=r[i],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new z1(e)};ao.render=function(i,e,n){if(!V1(e))throw Error(ze(200));return $1(null,i,e,!1,n)};ao.unmountComponentAtNode=function(i){if(!V1(i))throw Error(ze(40));return i._reactRootContainer?(Nd(function(){$1(null,null,i,!1,function(){i._reactRootContainer=null,i[Kl]=null})}),!0):!1};ao.unstable_batchedUpdates=SP;ao.unstable_renderSubtreeIntoContainer=function(i,e,n,r){if(!V1(n))throw Error(ze(200));if(i==null||i._reactInternals===void 0)throw Error(ze(38));return $1(i,e,n,!1,r)};ao.version="18.3.1-next-f1338f8080-20240426";function F4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(F4)}catch(i){console.error(i)}}F4(),FU.exports=ao;var PP=FU.exports;const Av=_0(PP);var AL=PP;sA.createRoot=AL.createRoot,sA.hydrateRoot=AL.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sy(){return Sy=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Sy.apply(this,arguments)}var Kc;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Kc||(Kc={}));const CL="popstate";function W9(i){i===void 0&&(i={});function e(r,s){let{pathname:o,search:a,hash:l}=r.location;return QA("",{pathname:o,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Cb(s)}return q9(e,n,null,i)}function Bi(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function B4(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function j9(){return Math.random().toString(36).substr(2,8)}function RL(i,e){return{usr:i.state,key:i.key,idx:e}}function QA(i,e,n,r){return n===void 0&&(n=null),Sy({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?zp(e):e,{state:n,key:e&&e.key||r||j9()})}function Cb(i){let{pathname:e="/",search:n="",hash:r=""}=i;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function zp(i){let e={};if(i){let n=i.indexOf("#");n>=0&&(e.hash=i.substr(n),i=i.substr(0,n));let r=i.indexOf("?");r>=0&&(e.search=i.substr(r),i=i.substr(0,r)),i&&(e.pathname=i)}return e}function q9(i,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,a=s.history,l=Kc.Pop,c=null,u=d();u==null&&(u=0,a.replaceState(Sy({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function h(){l=Kc.Pop;let v=d(),g=v==null?null:v-u;u=v,c&&c({action:l,location:y.location,delta:g})}function f(v,g){l=Kc.Push;let _=QA(y.location,v,g);n&&n(_,v),u=d()+1;let x=RL(_,u),b=y.createHref(_);try{a.pushState(x,"",b)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(b)}o&&c&&c({action:l,location:y.location,delta:1})}function p(v,g){l=Kc.Replace;let _=QA(y.location,v,g);n&&n(_,v),u=d();let x=RL(_,u),b=y.createHref(_);a.replaceState(x,"",b),o&&c&&c({action:l,location:y.location,delta:0})}function m(v){let g=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof v=="string"?v:Cb(v);return _=_.replace(/ $/,"%20"),Bi(g,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,g)}let y={get action(){return l},get location(){return i(s,a)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(CL,h),c=v,()=>{s.removeEventListener(CL,h),c=null}},createHref(v){return e(s,v)},createURL:m,encodeLocation(v){let g=m(v);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:p,go(v){return a.go(v)}};return y}var PL;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(PL||(PL={}));function X9(i,e,n){return n===void 0&&(n="/"),K9(i,e,n,!1)}function K9(i,e,n,r){let s=typeof e=="string"?zp(e):e,o=NP(s.pathname||"/",n);if(o==null)return null;let a=U4(i);Y9(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let u=a7(o);l=s7(a[c],u,r)}return l}function U4(i,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,a,l)=>{let c={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};c.relativePath.startsWith("/")&&(Bi(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=su([r,c.relativePath]),d=n.concat(c);o.children&&o.children.length>0&&(Bi(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),U4(o.children,e,d,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:i7(u,o.index),routesMeta:d})};return i.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,a);else for(let c of z4(o.path))s(o,a,c)}),e}function z4(i){let e=i.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let a=z4(r.join("/")),l=[];return l.push(...a.map(c=>c===""?o:[o,c].join("/"))),s&&l.push(...a),l.map(c=>i.startsWith("/")&&c===""?"/":c)}function Y9(i){i.sort((e,n)=>e.score!==n.score?n.score-e.score:r7(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Z9=/^:[\w-]+$/,Q9=3,J9=2,e7=1,t7=10,n7=-2,NL=i=>i==="*";function i7(i,e){let n=i.split("/"),r=n.length;return n.some(NL)&&(r+=n7),e&&(r+=J9),n.filter(s=>!NL(s)).reduce((s,o)=>s+(Z9.test(o)?Q9:o===""?e7:t7),r)}function r7(i,e){return i.length===e.length&&i.slice(0,-1).every((r,s)=>r===e[s])?i[i.length-1]-e[e.length-1]:0}function s7(i,e,n){n===void 0&&(n=!1);let{routesMeta:r}=i,s={},o="/",a=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=o==="/"?e:e.slice(o.length)||"/",h=kL({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=kL({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),a.push({params:s,pathname:su([o,h.pathname]),pathnameBase:d7(su([o,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(o=su([o,h.pathnameBase]))}return a}function kL(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[n,r]=o7(i.path,i.caseSensitive,i.end),s=e.match(n);if(!s)return null;let o=s[0],a=o.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let y=l[h]||"";a=o.slice(0,o.length-y.length).replace(/(.)\/+$/,"$1")}const m=l[h];return p&&!m?u[f]=void 0:u[f]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:a,pattern:i}}function o7(i,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),B4(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let r=[],s="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(r.push({paramName:"*"}),s+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":i!==""&&i!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function a7(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return B4(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function NP(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=i.charAt(n);return r&&r!=="/"?null:i.slice(n)||"/"}function l7(i,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof i=="string"?zp(i):i;return{pathname:n?n.startsWith("/")?n:c7(n,e):e,search:h7(r),hash:f7(s)}}function c7(i,e){let n=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function hT(i,e,n,r){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function u7(i){return i.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function V4(i,e){let n=u7(i);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function $4(i,e,n,r){r===void 0&&(r=!1);let s;typeof i=="string"?s=zp(i):(s=Sy({},i),Bi(!s.pathname||!s.pathname.includes("?"),hT("?","pathname","search",s)),Bi(!s.pathname||!s.pathname.includes("#"),hT("#","pathname","hash",s)),Bi(!s.search||!s.search.includes("#"),hT("#","search","hash",s)));let o=i===""||s.pathname==="",a=o?"/":s.pathname,l;if(a==null)l=n;else{let h=e.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=l7(s,l),u=a&&a!=="/"&&a.endsWith("/"),d=(o||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const su=i=>i.join("/").replace(/\/\/+/g,"/"),d7=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),h7=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,f7=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function p7(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const G4=["post","put","patch","delete"];new Set(G4);const m7=["get",...G4];new Set(m7);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wy(){return wy=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},wy.apply(this,arguments)}const kP=I.createContext(null),g7=I.createContext(null),Xd=I.createContext(null),G1=I.createContext(null),ac=I.createContext({outlet:null,matches:[],isDataRoute:!1}),H4=I.createContext(null);function y7(i,e){let{relative:n}=e===void 0?{}:e;M0()||Bi(!1);let{basename:r,navigator:s}=I.useContext(Xd),{hash:o,pathname:a,search:l}=X4(i,{relative:n}),c=a;return r!=="/"&&(c=a==="/"?r:su([r,a])),s.createHref({pathname:c,search:l,hash:o})}function M0(){return I.useContext(G1)!=null}function H1(){return M0()||Bi(!1),I.useContext(G1).location}function W4(i){I.useContext(Xd).static||I.useLayoutEffect(i)}function j4(){let{isDataRoute:i}=I.useContext(ac);return i?k7():v7()}function v7(){M0()||Bi(!1);let i=I.useContext(kP),{basename:e,future:n,navigator:r}=I.useContext(Xd),{matches:s}=I.useContext(ac),{pathname:o}=H1(),a=JSON.stringify(V4(s,n.v7_relativeSplatPath)),l=I.useRef(!1);return W4(()=>{l.current=!0}),I.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let h=$4(u,JSON.parse(a),o,d.relative==="path");i==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:su([e,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[e,r,a,o,i])}const x7=I.createContext(null);function _7(i){let e=I.useContext(ac).outlet;return e&&I.createElement(x7.Provider,{value:i},e)}function q4(){let{matches:i}=I.useContext(ac),e=i[i.length-1];return e?e.params:{}}function X4(i,e){let{relative:n}=e===void 0?{}:e,{future:r}=I.useContext(Xd),{matches:s}=I.useContext(ac),{pathname:o}=H1(),a=JSON.stringify(V4(s,r.v7_relativeSplatPath));return I.useMemo(()=>$4(i,JSON.parse(a),o,n==="path"),[i,a,o,n])}function b7(i,e){return S7(i,e)}function S7(i,e,n,r){M0()||Bi(!1);let{navigator:s,static:o}=I.useContext(Xd),{matches:a}=I.useContext(ac),l=a[a.length-1],c=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let d=H1(),h;if(e){var f;let g=typeof e=="string"?zp(e):e;u==="/"||(f=g.pathname)!=null&&f.startsWith(u)||Bi(!1),h=g}else h=d;let p=h.pathname||"/",m=p;if(u!=="/"){let g=u.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(g.length).join("/")}let y=!o&&n&&n.matches&&n.matches.length>0?n.matches:X9(i,{pathname:m}),v=A7(y&&y.map(g=>Object.assign({},g,{params:Object.assign({},c,g.params),pathname:su([u,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?u:su([u,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),a,n,r);return e&&v?I.createElement(G1.Provider,{value:{location:wy({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Kc.Pop}},v):v}function w7(){let i=N7(),e=p7(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),n=i instanceof Error?i.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},e),n?I.createElement("pre",{style:s},n):null,o)}const T7=I.createElement(w7,null);class E7 extends I.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?I.createElement(ac.Provider,{value:this.props.routeContext},I.createElement(H4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function M7(i){let{routeContext:e,match:n,children:r}=i,s=I.useContext(kP);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),I.createElement(ac.Provider,{value:e},r)}function A7(i,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),i==null){var o;if(!n)return null;if(n.errors)i=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)i=n.matches;else return null}let a=i,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=a.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||Bi(!1),a=a.slice(0,Math.min(a.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<a.length;d++){let h=a[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:p}=n,m=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||m){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,h,f)=>{let p,m=!1,y=null,v=null;n&&(p=l&&h.route.id?l[h.route.id]:void 0,y=h.route.errorElement||T7,c&&(u<0&&f===0?(L7("route-fallback",!1),m=!0,v=null):u===f&&(m=!0,v=h.route.hydrateFallbackElement||null)));let g=e.concat(a.slice(0,f+1)),_=()=>{let x;return p?x=y:m?x=v:h.route.Component?x=I.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=d,I.createElement(M7,{match:h,routeContext:{outlet:d,matches:g,isDataRoute:n!=null},children:x})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?I.createElement(E7,{location:n.location,revalidation:n.revalidation,component:y,error:p,children:_(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):_()},null)}var K4=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(K4||{}),Rb=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(Rb||{});function C7(i){let e=I.useContext(kP);return e||Bi(!1),e}function R7(i){let e=I.useContext(g7);return e||Bi(!1),e}function P7(i){let e=I.useContext(ac);return e||Bi(!1),e}function Y4(i){let e=P7(),n=e.matches[e.matches.length-1];return n.route.id||Bi(!1),n.route.id}function N7(){var i;let e=I.useContext(H4),n=R7(Rb.UseRouteError),r=Y4(Rb.UseRouteError);return e!==void 0?e:(i=n.errors)==null?void 0:i[r]}function k7(){let{router:i}=C7(K4.UseNavigateStable),e=Y4(Rb.UseNavigateStable),n=I.useRef(!1);return W4(()=>{n.current=!0}),I.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?i.navigate(s):i.navigate(s,wy({fromRouteId:e},o)))},[i,e])}const LL={};function L7(i,e,n){!e&&!LL[i]&&(LL[i]=!0)}function I7(i,e){i==null||i.v7_startTransition,(i==null?void 0:i.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function D7(i){return _7(i.context)}function Qu(i){Bi(!1)}function O7(i){let{basename:e="/",children:n=null,location:r,navigationType:s=Kc.Pop,navigator:o,static:a=!1,future:l}=i;M0()&&Bi(!1);let c=e.replace(/^\/*/,"/"),u=I.useMemo(()=>({basename:c,navigator:o,static:a,future:wy({v7_relativeSplatPath:!1},l)}),[c,l,o,a]);typeof r=="string"&&(r=zp(r));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:m="default"}=r,y=I.useMemo(()=>{let v=NP(d,c);return v==null?null:{location:{pathname:v,search:h,hash:f,state:p,key:m},navigationType:s}},[c,d,h,f,p,m,s]);return y==null?null:I.createElement(Xd.Provider,{value:u},I.createElement(G1.Provider,{children:n,value:y}))}function F7(i){let{children:e,location:n}=i;return b7(JA(e),n)}new Promise(()=>{});function JA(i,e){e===void 0&&(e=[]);let n=[];return I.Children.forEach(i,(r,s)=>{if(!I.isValidElement(r))return;let o=[...e,s];if(r.type===I.Fragment){n.push.apply(n,JA(r.props.children,o));return}r.type!==Qu&&Bi(!1),!r.props.index||!r.props.children||Bi(!1);let a={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=JA(r.props.children,o)),n.push(a)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function eC(){return eC=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},eC.apply(this,arguments)}function B7(i,e){if(i==null)return{};var n={},r=Object.keys(i),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=i[s]);return n}function U7(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function z7(i,e){return i.button===0&&(!e||e==="_self")&&!U7(i)}const V7=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],$7="6";try{window.__reactRouterVersion=$7}catch{}const G7="startTransition",IL=ib[G7];function H7(i){let{basename:e,children:n,future:r,window:s}=i,o=I.useRef();o.current==null&&(o.current=W9({window:s,v5Compat:!0}));let a=o.current,[l,c]=I.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},d=I.useCallback(h=>{u&&IL?IL(()=>c(h)):c(h)},[c,u]);return I.useLayoutEffect(()=>a.listen(d),[a,d]),I.useEffect(()=>I7(r),[r]),I.createElement(O7,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a,future:r})}const W7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",j7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vl=I.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:o,replace:a,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,f=B7(e,V7),{basename:p}=I.useContext(Xd),m,y=!1;if(typeof u=="string"&&j7.test(u)&&(m=u,W7))try{let x=new URL(window.location.href),b=u.startsWith("//")?new URL(x.protocol+u):new URL(u),S=NP(b.pathname,p);b.origin===x.origin&&S!=null?u=S+b.search+b.hash:y=!0}catch{}let v=y7(u,{relative:s}),g=q7(u,{replace:a,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function _(x){r&&r(x),x.defaultPrevented||g(x)}return I.createElement("a",eC({},f,{href:m||v,onClick:y||o?r:_,ref:n,target:c}))});var DL;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(DL||(DL={}));var OL;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(OL||(OL={}));function q7(i,e){let{target:n,replace:r,state:s,preventScrollReset:o,relative:a,viewTransition:l}=e===void 0?{}:e,c=j4(),u=H1(),d=X4(i,{relative:a});return I.useCallback(h=>{if(z7(h,n)){h.preventDefault();let f=r!==void 0?r:Cb(u)===Cb(d);c(i,{replace:f,state:s,preventScrollReset:o,relative:a,viewTransition:l})}},[u,c,d,r,s,n,i,o,a,l])}function kd(i){let e="https://mui.com/production-error/?code="+i;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+i+"; visit "+e+" for the full message."}const X7=Object.freeze(Object.defineProperty({__proto__:null,default:kd},Symbol.toStringTag,{value:"Module"})),sp="$$material";function z(){return z=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},z.apply(null,arguments)}function rt(i,e){if(i==null)return{};var n={};for(var r in i)if({}.hasOwnProperty.call(i,r)){if(e.indexOf(r)!==-1)continue;n[r]=i[r]}return n}var K7=!1;function Y7(i){if(i.sheet)return i.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===i)return document.styleSheets[e]}function Z7(i){var e=document.createElement("style");return e.setAttribute("data-emotion",i.key),i.nonce!==void 0&&e.setAttribute("nonce",i.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Q7=function(){function i(n){var r=this;this._insertTag=function(s){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(s,o),r.tags.push(s)},this.isSpeedy=n.speedy===void 0?!K7:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=i.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Z7(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var o=Y7(s);try{o.insertRule(r,o.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var s;return(s=r.parentNode)==null?void 0:s.removeChild(r)}),this.tags=[],this.ctr=0},i}(),Dr="-ms-",Pb="-moz-",xn="-webkit-",Z4="comm",LP="rule",IP="decl",J7="@import",Q4="@keyframes",eq="@layer",tq=Math.abs,W1=String.fromCharCode,nq=Object.assign;function iq(i,e){return yr(i,0)^45?(((e<<2^yr(i,0))<<2^yr(i,1))<<2^yr(i,2))<<2^yr(i,3):0}function J4(i){return i.trim()}function rq(i,e){return(i=e.exec(i))?i[0]:i}function bn(i,e,n){return i.replace(e,n)}function tC(i,e){return i.indexOf(e)}function yr(i,e){return i.charCodeAt(e)|0}function Ty(i,e,n){return i.slice(e,n)}function La(i){return i.length}function DP(i){return i.length}function Cv(i,e){return e.push(i),i}function sq(i,e){return i.map(e).join("")}var j1=1,op=1,e5=0,Ns=0,Ii=0,Vp="";function q1(i,e,n,r,s,o,a){return{value:i,root:e,parent:n,type:r,props:s,children:o,line:j1,column:op,length:a,return:""}}function Sm(i,e){return nq(q1("",null,null,"",null,null,0),i,{length:-i.length},e)}function oq(){return Ii}function aq(){return Ii=Ns>0?yr(Vp,--Ns):0,op--,Ii===10&&(op=1,j1--),Ii}function Qs(){return Ii=Ns<e5?yr(Vp,Ns++):0,op++,Ii===10&&(op=1,j1++),Ii}function Ha(){return yr(Vp,Ns)}function E_(){return Ns}function A0(i,e){return Ty(Vp,i,e)}function Ey(i){switch(i){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function t5(i){return j1=op=1,e5=La(Vp=i),Ns=0,[]}function n5(i){return Vp="",i}function M_(i){return J4(A0(Ns-1,nC(i===91?i+2:i===40?i+1:i)))}function lq(i){for(;(Ii=Ha())&&Ii<33;)Qs();return Ey(i)>2||Ey(Ii)>3?"":" "}function cq(i,e){for(;--e&&Qs()&&!(Ii<48||Ii>102||Ii>57&&Ii<65||Ii>70&&Ii<97););return A0(i,E_()+(e<6&&Ha()==32&&Qs()==32))}function nC(i){for(;Qs();)switch(Ii){case i:return Ns;case 34:case 39:i!==34&&i!==39&&nC(Ii);break;case 40:i===41&&nC(i);break;case 92:Qs();break}return Ns}function uq(i,e){for(;Qs()&&i+Ii!==47+10;)if(i+Ii===42+42&&Ha()===47)break;return"/*"+A0(e,Ns-1)+"*"+W1(i===47?i:Qs())}function dq(i){for(;!Ey(Ha());)Qs();return A0(i,Ns)}function hq(i){return n5(A_("",null,null,null,[""],i=t5(i),0,[0],i))}function A_(i,e,n,r,s,o,a,l,c){for(var u=0,d=0,h=a,f=0,p=0,m=0,y=1,v=1,g=1,_=0,x="",b=s,S=o,T=r,w=x;v;)switch(m=_,_=Qs()){case 40:if(m!=108&&yr(w,h-1)==58){tC(w+=bn(M_(_),"&","&\f"),"&\f")!=-1&&(g=-1);break}case 34:case 39:case 91:w+=M_(_);break;case 9:case 10:case 13:case 32:w+=lq(m);break;case 92:w+=cq(E_()-1,7);continue;case 47:switch(Ha()){case 42:case 47:Cv(fq(uq(Qs(),E_()),e,n),c);break;default:w+="/"}break;case 123*y:l[u++]=La(w)*g;case 125*y:case 59:case 0:switch(_){case 0:case 125:v=0;case 59+d:g==-1&&(w=bn(w,/\f/g,"")),p>0&&La(w)-h&&Cv(p>32?BL(w+";",r,n,h-1):BL(bn(w," ","")+";",r,n,h-2),c);break;case 59:w+=";";default:if(Cv(T=FL(w,e,n,u,d,s,l,x,b=[],S=[],h),o),_===123)if(d===0)A_(w,e,T,T,b,o,h,l,S);else switch(f===99&&yr(w,3)===110?100:f){case 100:case 108:case 109:case 115:A_(i,T,T,r&&Cv(FL(i,T,T,0,0,s,l,x,s,b=[],h),S),s,S,h,l,r?b:S);break;default:A_(w,T,T,T,[""],S,0,l,S)}}u=d=p=0,y=g=1,x=w="",h=a;break;case 58:h=1+La(w),p=m;default:if(y<1){if(_==123)--y;else if(_==125&&y++==0&&aq()==125)continue}switch(w+=W1(_),_*y){case 38:g=d>0?1:(w+="\f",-1);break;case 44:l[u++]=(La(w)-1)*g,g=1;break;case 64:Ha()===45&&(w+=M_(Qs())),f=Ha(),d=h=La(x=w+=dq(E_())),_++;break;case 45:m===45&&La(w)==2&&(y=0)}}return o}function FL(i,e,n,r,s,o,a,l,c,u,d){for(var h=s-1,f=s===0?o:[""],p=DP(f),m=0,y=0,v=0;m<r;++m)for(var g=0,_=Ty(i,h+1,h=tq(y=a[m])),x=i;g<p;++g)(x=J4(y>0?f[g]+" "+_:bn(_,/&\f/g,f[g])))&&(c[v++]=x);return q1(i,e,n,s===0?LP:l,c,u,d)}function fq(i,e,n){return q1(i,e,n,Z4,W1(oq()),Ty(i,2,-2),0)}function BL(i,e,n,r){return q1(i,e,n,IP,Ty(i,0,r),Ty(i,r+1,-1),r)}function Lf(i,e){for(var n="",r=DP(i),s=0;s<r;s++)n+=e(i[s],s,i,e)||"";return n}function pq(i,e,n,r){switch(i.type){case eq:if(i.children.length)break;case J7:case IP:return i.return=i.return||i.value;case Z4:return"";case Q4:return i.return=i.value+"{"+Lf(i.children,r)+"}";case LP:i.value=i.props.join(",")}return La(n=Lf(i.children,r))?i.return=i.value+"{"+n+"}":""}function mq(i){var e=DP(i);return function(n,r,s,o){for(var a="",l=0;l<e;l++)a+=i[l](n,r,s,o)||"";return a}}function gq(i){return function(e){e.root||(e=e.return)&&i(e)}}function i5(i){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=i(n)),e[n]}}var yq=function(e,n,r){for(var s=0,o=0;s=o,o=Ha(),s===38&&o===12&&(n[r]=1),!Ey(o);)Qs();return A0(e,Ns)},vq=function(e,n){var r=-1,s=44;do switch(Ey(s)){case 0:s===38&&Ha()===12&&(n[r]=1),e[r]+=yq(Ns-1,n,r);break;case 2:e[r]+=M_(s);break;case 4:if(s===44){e[++r]=Ha()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=W1(s)}while(s=Qs());return e},xq=function(e,n){return n5(vq(t5(e),n))},UL=new WeakMap,_q=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,s=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!UL.get(r))&&!s){UL.set(e,!0);for(var o=[],a=xq(n,o),l=r.props,c=0,u=0;c<a.length;c++)for(var d=0;d<l.length;d++,u++)e.props[u]=o[c]?a[c].replace(/&\f/g,l[d]):l[d]+" "+a[c]}}},bq=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function r5(i,e){switch(iq(i,e)){case 5103:return xn+"print-"+i+i;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return xn+i+i;case 5349:case 4246:case 4810:case 6968:case 2756:return xn+i+Pb+i+Dr+i+i;case 6828:case 4268:return xn+i+Dr+i+i;case 6165:return xn+i+Dr+"flex-"+i+i;case 5187:return xn+i+bn(i,/(\w+).+(:[^]+)/,xn+"box-$1$2"+Dr+"flex-$1$2")+i;case 5443:return xn+i+Dr+"flex-item-"+bn(i,/flex-|-self/,"")+i;case 4675:return xn+i+Dr+"flex-line-pack"+bn(i,/align-content|flex-|-self/,"")+i;case 5548:return xn+i+Dr+bn(i,"shrink","negative")+i;case 5292:return xn+i+Dr+bn(i,"basis","preferred-size")+i;case 6060:return xn+"box-"+bn(i,"-grow","")+xn+i+Dr+bn(i,"grow","positive")+i;case 4554:return xn+bn(i,/([^-])(transform)/g,"$1"+xn+"$2")+i;case 6187:return bn(bn(bn(i,/(zoom-|grab)/,xn+"$1"),/(image-set)/,xn+"$1"),i,"")+i;case 5495:case 3959:return bn(i,/(image-set\([^]*)/,xn+"$1$`$1");case 4968:return bn(bn(i,/(.+:)(flex-)?(.*)/,xn+"box-pack:$3"+Dr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+xn+i+i;case 4095:case 3583:case 4068:case 2532:return bn(i,/(.+)-inline(.+)/,xn+"$1$2")+i;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(La(i)-1-e>6)switch(yr(i,e+1)){case 109:if(yr(i,e+4)!==45)break;case 102:return bn(i,/(.+:)(.+)-([^]+)/,"$1"+xn+"$2-$3$1"+Pb+(yr(i,e+3)==108?"$3":"$2-$3"))+i;case 115:return~tC(i,"stretch")?r5(bn(i,"stretch","fill-available"),e)+i:i}break;case 4949:if(yr(i,e+1)!==115)break;case 6444:switch(yr(i,La(i)-3-(~tC(i,"!important")&&10))){case 107:return bn(i,":",":"+xn)+i;case 101:return bn(i,/(.+:)([^;!]+)(;|!.+)?/,"$1"+xn+(yr(i,14)===45?"inline-":"")+"box$3$1"+xn+"$2$3$1"+Dr+"$2box$3")+i}break;case 5936:switch(yr(i,e+11)){case 114:return xn+i+Dr+bn(i,/[svh]\w+-[tblr]{2}/,"tb")+i;case 108:return xn+i+Dr+bn(i,/[svh]\w+-[tblr]{2}/,"tb-rl")+i;case 45:return xn+i+Dr+bn(i,/[svh]\w+-[tblr]{2}/,"lr")+i}return xn+i+Dr+i+i}return i}var Sq=function(e,n,r,s){if(e.length>-1&&!e.return)switch(e.type){case IP:e.return=r5(e.value,e.length);break;case Q4:return Lf([Sm(e,{value:bn(e.value,"@","@"+xn)})],s);case LP:if(e.length)return sq(e.props,function(o){switch(rq(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Lf([Sm(e,{props:[bn(o,/:(read-\w+)/,":"+Pb+"$1")]})],s);case"::placeholder":return Lf([Sm(e,{props:[bn(o,/:(plac\w+)/,":"+xn+"input-$1")]}),Sm(e,{props:[bn(o,/:(plac\w+)/,":"+Pb+"$1")]}),Sm(e,{props:[bn(o,/:(plac\w+)/,Dr+"input-$1")]})],s)}return""})}},wq=[Sq],s5=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(y){var v=y.getAttribute("data-emotion");v.indexOf(" ")!==-1&&(document.head.appendChild(y),y.setAttribute("data-s",""))})}var s=e.stylisPlugins||wq,o={},a,l=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(y){for(var v=y.getAttribute("data-emotion").split(" "),g=1;g<v.length;g++)o[v[g]]=!0;l.push(y)});var c,u=[_q,bq];{var d,h=[pq,gq(function(y){d.insert(y)})],f=mq(u.concat(s,h)),p=function(v){return Lf(hq(v),f)};c=function(v,g,_,x){d=_,p(v?v+"{"+g.styles+"}":g.styles),x&&(m.inserted[g.name]=!0)}}var m={key:n,sheet:new Q7({key:n,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:c};return m.sheet.hydrate(l),m},o5={exports:{}},Rn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fr=typeof Symbol=="function"&&Symbol.for,OP=fr?Symbol.for("react.element"):60103,FP=fr?Symbol.for("react.portal"):60106,X1=fr?Symbol.for("react.fragment"):60107,K1=fr?Symbol.for("react.strict_mode"):60108,Y1=fr?Symbol.for("react.profiler"):60114,Z1=fr?Symbol.for("react.provider"):60109,Q1=fr?Symbol.for("react.context"):60110,BP=fr?Symbol.for("react.async_mode"):60111,J1=fr?Symbol.for("react.concurrent_mode"):60111,eS=fr?Symbol.for("react.forward_ref"):60112,tS=fr?Symbol.for("react.suspense"):60113,Tq=fr?Symbol.for("react.suspense_list"):60120,nS=fr?Symbol.for("react.memo"):60115,iS=fr?Symbol.for("react.lazy"):60116,Eq=fr?Symbol.for("react.block"):60121,Mq=fr?Symbol.for("react.fundamental"):60117,Aq=fr?Symbol.for("react.responder"):60118,Cq=fr?Symbol.for("react.scope"):60119;function co(i){if(typeof i=="object"&&i!==null){var e=i.$$typeof;switch(e){case OP:switch(i=i.type,i){case BP:case J1:case X1:case Y1:case K1:case tS:return i;default:switch(i=i&&i.$$typeof,i){case Q1:case eS:case iS:case nS:case Z1:return i;default:return e}}case FP:return e}}}function a5(i){return co(i)===J1}Rn.AsyncMode=BP;Rn.ConcurrentMode=J1;Rn.ContextConsumer=Q1;Rn.ContextProvider=Z1;Rn.Element=OP;Rn.ForwardRef=eS;Rn.Fragment=X1;Rn.Lazy=iS;Rn.Memo=nS;Rn.Portal=FP;Rn.Profiler=Y1;Rn.StrictMode=K1;Rn.Suspense=tS;Rn.isAsyncMode=function(i){return a5(i)||co(i)===BP};Rn.isConcurrentMode=a5;Rn.isContextConsumer=function(i){return co(i)===Q1};Rn.isContextProvider=function(i){return co(i)===Z1};Rn.isElement=function(i){return typeof i=="object"&&i!==null&&i.$$typeof===OP};Rn.isForwardRef=function(i){return co(i)===eS};Rn.isFragment=function(i){return co(i)===X1};Rn.isLazy=function(i){return co(i)===iS};Rn.isMemo=function(i){return co(i)===nS};Rn.isPortal=function(i){return co(i)===FP};Rn.isProfiler=function(i){return co(i)===Y1};Rn.isStrictMode=function(i){return co(i)===K1};Rn.isSuspense=function(i){return co(i)===tS};Rn.isValidElementType=function(i){return typeof i=="string"||typeof i=="function"||i===X1||i===J1||i===Y1||i===K1||i===tS||i===Tq||typeof i=="object"&&i!==null&&(i.$$typeof===iS||i.$$typeof===nS||i.$$typeof===Z1||i.$$typeof===Q1||i.$$typeof===eS||i.$$typeof===Mq||i.$$typeof===Aq||i.$$typeof===Cq||i.$$typeof===Eq)};Rn.typeOf=co;o5.exports=Rn;var Rq=o5.exports,l5=Rq,Pq={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Nq={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},c5={};c5[l5.ForwardRef]=Pq;c5[l5.Memo]=Nq;var kq=!0;function u5(i,e,n){var r="";return n.split(" ").forEach(function(s){i[s]!==void 0?e.push(i[s]+";"):s&&(r+=s+" ")}),r}var UP=function(e,n,r){var s=e.key+"-"+n.name;(r===!1||kq===!1)&&e.registered[s]===void 0&&(e.registered[s]=n.styles)},zP=function(e,n,r){UP(e,n,r);var s=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var o=n;do e.insert(n===o?"."+s:"",o,e.sheet,!0),o=o.next;while(o!==void 0)}};function Lq(i){for(var e=0,n,r=0,s=i.length;s>=4;++r,s-=4)n=i.charCodeAt(r)&255|(i.charCodeAt(++r)&255)<<8|(i.charCodeAt(++r)&255)<<16|(i.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(i.charCodeAt(r+2)&255)<<16;case 2:e^=(i.charCodeAt(r+1)&255)<<8;case 1:e^=i.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var Iq={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Dq=!1,Oq=/[A-Z]|^ms/g,Fq=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d5=function(e){return e.charCodeAt(1)===45},zL=function(e){return e!=null&&typeof e!="boolean"},fT=i5(function(i){return d5(i)?i:i.replace(Oq,"-$&").toLowerCase()}),VL=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(Fq,function(r,s,o){return Ia={name:s,styles:o,next:Ia},s})}return Iq[e]!==1&&!d5(e)&&typeof n=="number"&&n!==0?n+"px":n},Bq="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function My(i,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var s=n;if(s.anim===1)return Ia={name:s.name,styles:s.styles,next:Ia},s.name;var o=n;if(o.styles!==void 0){var a=o.next;if(a!==void 0)for(;a!==void 0;)Ia={name:a.name,styles:a.styles,next:Ia},a=a.next;var l=o.styles+";";return l}return Uq(i,e,n)}case"function":{if(i!==void 0){var c=Ia,u=n(i);return Ia=c,My(i,e,u)}break}}var d=n;if(e==null)return d;var h=e[d];return h!==void 0?h:d}function Uq(i,e,n){var r="";if(Array.isArray(n))for(var s=0;s<n.length;s++)r+=My(i,e,n[s])+";";else for(var o in n){var a=n[o];if(typeof a!="object"){var l=a;e!=null&&e[l]!==void 0?r+=o+"{"+e[l]+"}":zL(l)&&(r+=fT(o)+":"+VL(o,l)+";")}else{if(o==="NO_COMPONENT_SELECTOR"&&Dq)throw new Error(Bq);if(Array.isArray(a)&&typeof a[0]=="string"&&(e==null||e[a[0]]===void 0))for(var c=0;c<a.length;c++)zL(a[c])&&(r+=fT(o)+":"+VL(o,a[c])+";");else{var u=My(i,e,a);switch(o){case"animation":case"animationName":{r+=fT(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}}return r}var $L=/label:\s*([^\s;{]+)\s*(;|$)/g,Ia;function rS(i,e,n){if(i.length===1&&typeof i[0]=="object"&&i[0]!==null&&i[0].styles!==void 0)return i[0];var r=!0,s="";Ia=void 0;var o=i[0];if(o==null||o.raw===void 0)r=!1,s+=My(n,e,o);else{var a=o;s+=a[0]}for(var l=1;l<i.length;l++)if(s+=My(n,e,i[l]),r){var c=o;s+=c[l]}$L.lastIndex=0;for(var u="",d;(d=$L.exec(s))!==null;)u+="-"+d[1];var h=Lq(s)+u;return{name:h,styles:s,next:Ia}}var zq=function(e){return e()},h5=ib["useInsertionEffect"]?ib["useInsertionEffect"]:!1,f5=h5||zq,GL=h5||I.useLayoutEffect,Vq=!1,p5=I.createContext(typeof HTMLElement<"u"?s5({key:"css"}):null),$q=p5.Provider,VP=function(e){return I.forwardRef(function(n,r){var s=I.useContext(p5);return e(n,s,r)})},$p=I.createContext({}),$P={}.hasOwnProperty,iC="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Gq=function(e,n){var r={};for(var s in n)$P.call(n,s)&&(r[s]=n[s]);return r[iC]=e,r},Hq=function(e){var n=e.cache,r=e.serialized,s=e.isStringTag;return UP(n,r,s),f5(function(){return zP(n,r,s)}),null},Wq=VP(function(i,e,n){var r=i.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var s=i[iC],o=[r],a="";typeof i.className=="string"?a=u5(e.registered,o,i.className):i.className!=null&&(a=i.className+" ");var l=rS(o,void 0,I.useContext($p));a+=e.key+"-"+l.name;var c={};for(var u in i)$P.call(i,u)&&u!=="css"&&u!==iC&&!Vq&&(c[u]=i[u]);return c.className=a,n&&(c.ref=n),I.createElement(I.Fragment,null,I.createElement(Hq,{cache:e,serialized:l,isStringTag:typeof s=="string"}),I.createElement(s,c))}),jq=Wq,pT={exports:{}},HL;function m5(){return HL||(HL=1,function(i){function e(){return i.exports=e=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var o in s)({}).hasOwnProperty.call(s,o)&&(n[o]=s[o])}return n},i.exports.__esModule=!0,i.exports.default=i.exports,e.apply(null,arguments)}i.exports=e,i.exports.__esModule=!0,i.exports.default=i.exports}(pT)),pT.exports}m5();var WL=function(e,n){var r=arguments;if(n==null||!$P.call(n,"css"))return I.createElement.apply(void 0,r);var s=r.length,o=new Array(s);o[0]=jq,o[1]=Gq(e,n);for(var a=2;a<s;a++)o[a]=r[a];return I.createElement.apply(null,o)};(function(i){var e;e||(e=i.JSX||(i.JSX={}))})(WL||(WL={}));var qq=VP(function(i,e){var n=i.styles,r=rS([n],void 0,I.useContext($p)),s=I.useRef();return GL(function(){var o=e.key+"-global",a=new e.sheet.constructor({key:o,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),l=!1,c=document.querySelector('style[data-emotion="'+o+" "+r.name+'"]');return e.sheet.tags.length&&(a.before=e.sheet.tags[0]),c!==null&&(l=!0,c.setAttribute("data-emotion",o),a.hydrate([c])),s.current=[a,l],function(){a.flush()}},[e]),GL(function(){var o=s.current,a=o[0],l=o[1];if(l){o[1]=!1;return}if(r.next!==void 0&&zP(e,r.next,!0),a.tags.length){var c=a.tags[a.tags.length-1].nextElementSibling;a.before=c,a.flush()}e.insert("",r,a,!1)},[e,r.name]),null});function sS(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return rS(e)}function Gp(){var i=sS.apply(void 0,arguments),e="animation-"+i.name;return{name:e,styles:"@keyframes "+e+"{"+i.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var Xq=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Kq=i5(function(i){return Xq.test(i)||i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)<91}),Yq=!1,Zq=Kq,Qq=function(e){return e!=="theme"},jL=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?Zq:Qq},qL=function(e,n,r){var s;if(n){var o=n.shouldForwardProp;s=e.__emotion_forwardProp&&o?function(a){return e.__emotion_forwardProp(a)&&o(a)}:o}return typeof s!="function"&&r&&(s=e.__emotion_forwardProp),s},Jq=function(e){var n=e.cache,r=e.serialized,s=e.isStringTag;return UP(n,r,s),f5(function(){return zP(n,r,s)}),null},eX=function i(e,n){var r=e.__emotion_real===e,s=r&&e.__emotion_base||e,o,a;n!==void 0&&(o=n.label,a=n.target);var l=qL(e,n,r),c=l||jL(s),u=!c("as");return function(){var d=arguments,h=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(o!==void 0&&h.push("label:"+o+";"),d[0]==null||d[0].raw===void 0)h.push.apply(h,d);else{var f=d[0];h.push(f[0]);for(var p=d.length,m=1;m<p;m++)h.push(d[m],f[m])}var y=VP(function(v,g,_){var x=u&&v.as||s,b="",S=[],T=v;if(v.theme==null){T={};for(var w in v)T[w]=v[w];T.theme=I.useContext($p)}typeof v.className=="string"?b=u5(g.registered,S,v.className):v.className!=null&&(b=v.className+" ");var E=rS(h.concat(S),g.registered,T);b+=g.key+"-"+E.name,a!==void 0&&(b+=" "+a);var A=u&&l===void 0?jL(x):c,M={};for(var R in v)u&&R==="as"||A(R)&&(M[R]=v[R]);return M.className=b,_&&(M.ref=_),I.createElement(I.Fragment,null,I.createElement(Jq,{cache:g,serialized:E,isStringTag:typeof x=="string"}),I.createElement(x,M))});return y.displayName=o!==void 0?o:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",y.defaultProps=e.defaultProps,y.__emotion_real=y,y.__emotion_base=s,y.__emotion_styles=h,y.__emotion_forwardProp=l,Object.defineProperty(y,"toString",{value:function(){return a===void 0&&Yq?"NO_COMPONENT_SELECTOR":"."+a}}),y.withComponent=function(v,g){var _=i(v,z({},n,g,{shouldForwardProp:qL(y,g,!0)}));return _.apply(void 0,h)},y}},tX=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],rC=eX.bind(null);tX.forEach(function(i){rC[i]=rC(i)});var g5={exports:{}},nX="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",iX=nX,rX=iX;function y5(){}function v5(){}v5.resetWarningCache=y5;var sX=function(){function i(r,s,o,a,l,c){if(c!==rX){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}i.isRequired=i;function e(){return i}var n={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:e,element:i,elementType:i,instanceOf:e,node:i,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:v5,resetWarningCache:y5};return n.PropTypes=n,n};g5.exports=sX();var oX=g5.exports;const oe=_0(oX);let sC;typeof document=="object"&&(sC=s5({key:"css",prepend:!0}));function aX(i){const{injectFirst:e,children:n}=i;return e&&sC?Y($q,{value:sC,children:n}):n}function lX(i){return i==null||Object.keys(i).length===0}function x5(i){const{styles:e,defaultTheme:n={}}=i;return Y(qq,{styles:typeof e=="function"?s=>e(lX(s)?n:s):e})}/**
 * @mui/styled-engine v5.16.14
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function GP(i,e){return rC(i,e)}const _5=(i,e)=>{Array.isArray(i.__emotion_styles)&&(i.__emotion_styles=e(i.__emotion_styles))},cX=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:x5,StyledEngineProvider:aX,ThemeContext:$p,css:sS,default:GP,internal_processStyles:_5,keyframes:Gp},Symbol.toStringTag,{value:"Module"}));function Al(i){if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)}function b5(i){if(I.isValidElement(i)||!Al(i))return i;const e={};return Object.keys(i).forEach(n=>{e[n]=b5(i[n])}),e}function Js(i,e,n={clone:!0}){const r=n.clone?z({},i):i;return Al(i)&&Al(e)&&Object.keys(e).forEach(s=>{I.isValidElement(e[s])?r[s]=e[s]:Al(e[s])&&Object.prototype.hasOwnProperty.call(i,s)&&Al(i[s])?r[s]=Js(i[s],e[s],n):n.clone?r[s]=Al(e[s])?b5(e[s]):e[s]:r[s]=e[s]}),r}const uX=Object.freeze(Object.defineProperty({__proto__:null,default:Js,isPlainObject:Al},Symbol.toStringTag,{value:"Module"})),dX=["values","unit","step"],hX=i=>{const e=Object.keys(i).map(n=>({key:n,val:i[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>z({},n,{[r.key]:r.val}),{})};function S5(i){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=i,s=rt(i,dX),o=hX(e),a=Object.keys(o);function l(f){return`@media (min-width:${typeof e[f]=="number"?e[f]:f}${n})`}function c(f){return`@media (max-width:${(typeof e[f]=="number"?e[f]:f)-r/100}${n})`}function u(f,p){const m=a.indexOf(p);return`@media (min-width:${typeof e[f]=="number"?e[f]:f}${n}) and (max-width:${(m!==-1&&typeof e[a[m]]=="number"?e[a[m]]:p)-r/100}${n})`}function d(f){return a.indexOf(f)+1<a.length?u(f,a[a.indexOf(f)+1]):l(f)}function h(f){const p=a.indexOf(f);return p===0?l(a[1]):p===a.length-1?c(a[p]):u(f,a[a.indexOf(f)+1]).replace("@media","@media not all and")}return z({keys:a,values:o,up:l,down:c,between:u,only:d,not:h,unit:n},s)}const fX={borderRadius:4},pX=fX;function zg(i,e){return e?Js(i,e,{clone:!1}):i}const HP={xs:0,sm:600,md:900,lg:1200,xl:1536},XL={keys:["xs","sm","md","lg","xl"],up:i=>`@media (min-width:${HP[i]}px)`};function Lo(i,e,n){const r=i.theme||{};if(Array.isArray(e)){const o=r.breakpoints||XL;return e.reduce((a,l,c)=>(a[o.up(o.keys[c])]=n(e[c]),a),{})}if(typeof e=="object"){const o=r.breakpoints||XL;return Object.keys(e).reduce((a,l)=>{if(Object.keys(o.values||HP).indexOf(l)!==-1){const c=o.up(l);a[c]=n(e[l],l)}else{const c=l;a[c]=e[c]}return a},{})}return n(e)}function mX(i={}){var e;return((e=i.keys)==null?void 0:e.reduce((r,s)=>{const o=i.up(s);return r[o]={},r},{}))||{}}function gX(i,e){return i.reduce((n,r)=>{const s=n[r];return(!s||Object.keys(s).length===0)&&delete n[r],n},e)}function yX(i,e){if(typeof i!="object")return{};const n={},r=Object.keys(e);return Array.isArray(i)?r.forEach((s,o)=>{o<i.length&&(n[s]=!0)}):r.forEach(s=>{i[s]!=null&&(n[s]=!0)}),n}function oS({values:i,breakpoints:e,base:n}){const r=n||yX(i,e),s=Object.keys(r);if(s.length===0)return i;let o;return s.reduce((a,l,c)=>(Array.isArray(i)?(a[l]=i[c]!=null?i[c]:i[o],o=c):typeof i=="object"?(a[l]=i[l]!=null?i[l]:i[o],o=l):a[l]=i,a),{})}function We(i){if(typeof i!="string")throw new Error(kd(7));return i.charAt(0).toUpperCase()+i.slice(1)}const vX=Object.freeze(Object.defineProperty({__proto__:null,default:We},Symbol.toStringTag,{value:"Module"}));function aS(i,e,n=!0){if(!e||typeof e!="string")return null;if(i&&i.vars&&n){const r=`vars.${e}`.split(".").reduce((s,o)=>s&&s[o]?s[o]:null,i);if(r!=null)return r}return e.split(".").reduce((r,s)=>r&&r[s]!=null?r[s]:null,i)}function Nb(i,e,n,r=n){let s;return typeof i=="function"?s=i(n):Array.isArray(i)?s=i[n]||r:s=aS(i,n)||r,e&&(s=e(s,r,i)),s}function Ai(i){const{prop:e,cssProperty:n=i.prop,themeKey:r,transform:s}=i,o=a=>{if(a[e]==null)return null;const l=a[e],c=a.theme,u=aS(c,r)||{};return Lo(a,l,h=>{let f=Nb(u,s,h);return h===f&&typeof h=="string"&&(f=Nb(u,s,`${e}${h==="default"?"":We(h)}`,h)),n===!1?f:{[n]:f}})};return o.propTypes={},o.filterProps=[e],o}function xX(i){const e={};return n=>(e[n]===void 0&&(e[n]=i(n)),e[n])}const _X={m:"margin",p:"padding"},bX={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},KL={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},SX=xX(i=>{if(i.length>2)if(KL[i])i=KL[i];else return[i];const[e,n]=i.split(""),r=_X[e],s=bX[n]||"";return Array.isArray(s)?s.map(o=>r+o):[r+s]}),WP=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],jP=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...WP,...jP];function C0(i,e,n,r){var s;const o=(s=aS(i,e,!1))!=null?s:n;return typeof o=="number"?a=>typeof a=="string"?a:o*a:Array.isArray(o)?a=>typeof a=="string"?a:o[a]:typeof o=="function"?o:()=>{}}function w5(i){return C0(i,"spacing",8)}function R0(i,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=i(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function wX(i,e){return n=>i.reduce((r,s)=>(r[s]=R0(e,n),r),{})}function TX(i,e,n,r){if(e.indexOf(n)===-1)return null;const s=SX(n),o=wX(s,r),a=i[n];return Lo(i,a,o)}function T5(i,e){const n=w5(i.theme);return Object.keys(i).map(r=>TX(i,e,r,n)).reduce(zg,{})}function fi(i){return T5(i,WP)}fi.propTypes={};fi.filterProps=WP;function pi(i){return T5(i,jP)}pi.propTypes={};pi.filterProps=jP;function EX(i=8){if(i.mui)return i;const e=w5({spacing:i}),n=(...r)=>(r.length===0?[1]:r).map(o=>{const a=e(o);return typeof a=="number"?`${a}px`:a}).join(" ");return n.mui=!0,n}function lS(...i){const e=i.reduce((r,s)=>(s.filterProps.forEach(o=>{r[o]=s}),r),{}),n=r=>Object.keys(r).reduce((s,o)=>e[o]?zg(s,e[o](r)):s,{});return n.propTypes={},n.filterProps=i.reduce((r,s)=>r.concat(s.filterProps),[]),n}function bo(i){return typeof i!="number"?i:`${i}px solid`}function Oo(i,e){return Ai({prop:i,themeKey:"borders",transform:e})}const MX=Oo("border",bo),AX=Oo("borderTop",bo),CX=Oo("borderRight",bo),RX=Oo("borderBottom",bo),PX=Oo("borderLeft",bo),NX=Oo("borderColor"),kX=Oo("borderTopColor"),LX=Oo("borderRightColor"),IX=Oo("borderBottomColor"),DX=Oo("borderLeftColor"),OX=Oo("outline",bo),FX=Oo("outlineColor"),cS=i=>{if(i.borderRadius!==void 0&&i.borderRadius!==null){const e=C0(i.theme,"shape.borderRadius",4),n=r=>({borderRadius:R0(e,r)});return Lo(i,i.borderRadius,n)}return null};cS.propTypes={};cS.filterProps=["borderRadius"];lS(MX,AX,CX,RX,PX,NX,kX,LX,IX,DX,cS,OX,FX);const uS=i=>{if(i.gap!==void 0&&i.gap!==null){const e=C0(i.theme,"spacing",8),n=r=>({gap:R0(e,r)});return Lo(i,i.gap,n)}return null};uS.propTypes={};uS.filterProps=["gap"];const dS=i=>{if(i.columnGap!==void 0&&i.columnGap!==null){const e=C0(i.theme,"spacing",8),n=r=>({columnGap:R0(e,r)});return Lo(i,i.columnGap,n)}return null};dS.propTypes={};dS.filterProps=["columnGap"];const hS=i=>{if(i.rowGap!==void 0&&i.rowGap!==null){const e=C0(i.theme,"spacing",8),n=r=>({rowGap:R0(e,r)});return Lo(i,i.rowGap,n)}return null};hS.propTypes={};hS.filterProps=["rowGap"];const BX=Ai({prop:"gridColumn"}),UX=Ai({prop:"gridRow"}),zX=Ai({prop:"gridAutoFlow"}),VX=Ai({prop:"gridAutoColumns"}),$X=Ai({prop:"gridAutoRows"}),GX=Ai({prop:"gridTemplateColumns"}),HX=Ai({prop:"gridTemplateRows"}),WX=Ai({prop:"gridTemplateAreas"}),jX=Ai({prop:"gridArea"});lS(uS,dS,hS,BX,UX,zX,VX,$X,GX,HX,WX,jX);function If(i,e){return e==="grey"?e:i}const qX=Ai({prop:"color",themeKey:"palette",transform:If}),XX=Ai({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:If}),KX=Ai({prop:"backgroundColor",themeKey:"palette",transform:If});lS(qX,XX,KX);function js(i){return i<=1&&i!==0?`${i*100}%`:i}const YX=Ai({prop:"width",transform:js}),qP=i=>{if(i.maxWidth!==void 0&&i.maxWidth!==null){const e=n=>{var r,s;const o=((r=i.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||HP[n];return o?((s=i.theme)==null||(s=s.breakpoints)==null?void 0:s.unit)!=="px"?{maxWidth:`${o}${i.theme.breakpoints.unit}`}:{maxWidth:o}:{maxWidth:js(n)}};return Lo(i,i.maxWidth,e)}return null};qP.filterProps=["maxWidth"];const ZX=Ai({prop:"minWidth",transform:js}),QX=Ai({prop:"height",transform:js}),JX=Ai({prop:"maxHeight",transform:js}),eK=Ai({prop:"minHeight",transform:js});Ai({prop:"size",cssProperty:"width",transform:js});Ai({prop:"size",cssProperty:"height",transform:js});const tK=Ai({prop:"boxSizing"});lS(YX,qP,ZX,QX,JX,eK,tK);const nK={border:{themeKey:"borders",transform:bo},borderTop:{themeKey:"borders",transform:bo},borderRight:{themeKey:"borders",transform:bo},borderBottom:{themeKey:"borders",transform:bo},borderLeft:{themeKey:"borders",transform:bo},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:bo},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:cS},color:{themeKey:"palette",transform:If},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:If},backgroundColor:{themeKey:"palette",transform:If},p:{style:pi},pt:{style:pi},pr:{style:pi},pb:{style:pi},pl:{style:pi},px:{style:pi},py:{style:pi},padding:{style:pi},paddingTop:{style:pi},paddingRight:{style:pi},paddingBottom:{style:pi},paddingLeft:{style:pi},paddingX:{style:pi},paddingY:{style:pi},paddingInline:{style:pi},paddingInlineStart:{style:pi},paddingInlineEnd:{style:pi},paddingBlock:{style:pi},paddingBlockStart:{style:pi},paddingBlockEnd:{style:pi},m:{style:fi},mt:{style:fi},mr:{style:fi},mb:{style:fi},ml:{style:fi},mx:{style:fi},my:{style:fi},margin:{style:fi},marginTop:{style:fi},marginRight:{style:fi},marginBottom:{style:fi},marginLeft:{style:fi},marginX:{style:fi},marginY:{style:fi},marginInline:{style:fi},marginInlineStart:{style:fi},marginInlineEnd:{style:fi},marginBlock:{style:fi},marginBlockStart:{style:fi},marginBlockEnd:{style:fi},displayPrint:{cssProperty:!1,transform:i=>({"@media print":{display:i}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:uS},rowGap:{style:hS},columnGap:{style:dS},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:js},maxWidth:{style:qP},minWidth:{transform:js},height:{transform:js},maxHeight:{transform:js},minHeight:{transform:js},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},P0=nK;function iK(...i){const e=i.reduce((r,s)=>r.concat(Object.keys(s)),[]),n=new Set(e);return i.every(r=>n.size===Object.keys(r).length)}function rK(i,e){return typeof i=="function"?i(e):i}function E5(){function i(n,r,s,o){const a={[n]:r,theme:s},l=o[n];if(!l)return{[n]:r};const{cssProperty:c=n,themeKey:u,transform:d,style:h}=l;if(r==null)return null;if(u==="typography"&&r==="inherit")return{[n]:r};const f=aS(s,u)||{};return h?h(a):Lo(a,r,m=>{let y=Nb(f,d,m);return m===y&&typeof m=="string"&&(y=Nb(f,d,`${n}${m==="default"?"":We(m)}`,m)),c===!1?y:{[c]:y}})}function e(n){var r;const{sx:s,theme:o={}}=n||{};if(!s)return null;const a=(r=o.unstable_sxConfig)!=null?r:P0;function l(c){let u=c;if(typeof c=="function")u=c(o);else if(typeof c!="object")return c;if(!u)return null;const d=mX(o.breakpoints),h=Object.keys(d);let f=d;return Object.keys(u).forEach(p=>{const m=rK(u[p],o);if(m!=null)if(typeof m=="object")if(a[p])f=zg(f,i(p,m,o,a));else{const y=Lo({theme:o},m,v=>({[p]:v}));iK(y,m)?f[p]=e({sx:m,theme:o}):f=zg(f,y)}else f=zg(f,i(p,m,o,a))}),gX(h,f)}return Array.isArray(s)?s.map(l):l(s)}return e}const M5=E5();M5.filterProps=["sx"];const N0=M5;function A5(i,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(i).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===i?e:{}}const sK=["breakpoints","palette","spacing","shape"];function k0(i={},...e){const{breakpoints:n={},palette:r={},spacing:s,shape:o={}}=i,a=rt(i,sK),l=S5(n),c=EX(s);let u=Js({breakpoints:l,direction:"ltr",components:{},palette:z({mode:"light"},r),spacing:c,shape:z({},pX,o)},a);return u.applyStyles=A5,u=e.reduce((d,h)=>Js(d,h),u),u.unstable_sxConfig=z({},P0,a==null?void 0:a.unstable_sxConfig),u.unstable_sx=function(h){return N0({sx:h,theme:this})},u}const oK=Object.freeze(Object.defineProperty({__proto__:null,default:k0,private_createBreakpoints:S5,unstable_applyStyles:A5},Symbol.toStringTag,{value:"Module"}));function aK(i){return Object.keys(i).length===0}function C5(i=null){const e=I.useContext($p);return!e||aK(e)?i:e}const lK=k0();function fS(i=lK){return C5(i)}function cK({styles:i,themeId:e,defaultTheme:n={}}){const r=fS(n),s=typeof i=="function"?i(e&&r[e]||r):i;return Y(x5,{styles:s})}const uK=["sx"],dK=i=>{var e,n;const r={systemProps:{},otherProps:{}},s=(e=i==null||(n=i.theme)==null?void 0:n.unstable_sxConfig)!=null?e:P0;return Object.keys(i).forEach(o=>{s[o]?r.systemProps[o]=i[o]:r.otherProps[o]=i[o]}),r};function pS(i){const{sx:e}=i,n=rt(i,uK),{systemProps:r,otherProps:s}=dK(n);let o;return Array.isArray(e)?o=[r,...e]:typeof e=="function"?o=(...a)=>{const l=e(...a);return Al(l)?z({},r,l):r}:o=z({},r,e),z({},s,{sx:o})}const hK=Object.freeze(Object.defineProperty({__proto__:null,default:N0,extendSxProp:pS,unstable_createStyleFunctionSx:E5,unstable_defaultSxConfig:P0},Symbol.toStringTag,{value:"Module"})),YL=i=>i,fK=()=>{let i=YL;return{configure(e){i=e},generate(e){return i(e)},reset(){i=YL}}},pK=fK(),R5=pK;function P5(i){var e,n,r="";if(typeof i=="string"||typeof i=="number")r+=i;else if(typeof i=="object")if(Array.isArray(i)){var s=i.length;for(e=0;e<s;e++)i[e]&&(n=P5(i[e]))&&(r&&(r+=" "),r+=n)}else for(n in i)i[n]&&(r&&(r+=" "),r+=n);return r}function ft(){for(var i,e,n=0,r="",s=arguments.length;n<s;n++)(i=arguments[n])&&(e=P5(i))&&(r&&(r+=" "),r+=e);return r}const mK=["className","component"];function gK(i={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:s}=i,o=GP("div",{shouldForwardProp:l=>l!=="theme"&&l!=="sx"&&l!=="as"})(N0);return I.forwardRef(function(c,u){const d=fS(n),h=pS(c),{className:f,component:p="div"}=h,m=rt(h,mK);return Y(o,z({as:p,ref:u,className:ft(f,s?s(r):r),theme:e&&d[e]||d},m))})}const yK={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Zt(i,e,n="Mui"){const r=yK[e];return r?`${n}-${r}`:`${R5.generate(i)}-${e}`}function jt(i,e,n="Mui"){const r={};return e.forEach(s=>{r[s]=Zt(i,s,n)}),r}var N5={exports:{}},Fn={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XP=Symbol.for("react.transitional.element"),KP=Symbol.for("react.portal"),mS=Symbol.for("react.fragment"),gS=Symbol.for("react.strict_mode"),yS=Symbol.for("react.profiler"),vS=Symbol.for("react.consumer"),xS=Symbol.for("react.context"),_S=Symbol.for("react.forward_ref"),bS=Symbol.for("react.suspense"),SS=Symbol.for("react.suspense_list"),wS=Symbol.for("react.memo"),TS=Symbol.for("react.lazy"),vK=Symbol.for("react.view_transition"),xK=Symbol.for("react.client.reference");function Fo(i){if(typeof i=="object"&&i!==null){var e=i.$$typeof;switch(e){case XP:switch(i=i.type,i){case mS:case yS:case gS:case bS:case SS:case vK:return i;default:switch(i=i&&i.$$typeof,i){case xS:case _S:case TS:case wS:return i;case vS:return i;default:return e}}case KP:return e}}}Fn.ContextConsumer=vS;Fn.ContextProvider=xS;Fn.Element=XP;Fn.ForwardRef=_S;Fn.Fragment=mS;Fn.Lazy=TS;Fn.Memo=wS;Fn.Portal=KP;Fn.Profiler=yS;Fn.StrictMode=gS;Fn.Suspense=bS;Fn.SuspenseList=SS;Fn.isContextConsumer=function(i){return Fo(i)===vS};Fn.isContextProvider=function(i){return Fo(i)===xS};Fn.isElement=function(i){return typeof i=="object"&&i!==null&&i.$$typeof===XP};Fn.isForwardRef=function(i){return Fo(i)===_S};Fn.isFragment=function(i){return Fo(i)===mS};Fn.isLazy=function(i){return Fo(i)===TS};Fn.isMemo=function(i){return Fo(i)===wS};Fn.isPortal=function(i){return Fo(i)===KP};Fn.isProfiler=function(i){return Fo(i)===yS};Fn.isStrictMode=function(i){return Fo(i)===gS};Fn.isSuspense=function(i){return Fo(i)===bS};Fn.isSuspenseList=function(i){return Fo(i)===SS};Fn.isValidElementType=function(i){return typeof i=="string"||typeof i=="function"||i===mS||i===yS||i===gS||i===bS||i===SS||typeof i=="object"&&i!==null&&(i.$$typeof===TS||i.$$typeof===wS||i.$$typeof===xS||i.$$typeof===vS||i.$$typeof===_S||i.$$typeof===xK||i.getModuleId!==void 0)};Fn.typeOf=Fo;N5.exports=Fn;var ZL=N5.exports;const _K=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function k5(i){const e=`${i}`.match(_K);return e&&e[1]||""}function L5(i,e=""){return i.displayName||i.name||k5(i)||e}function QL(i,e,n){const r=L5(e);return i.displayName||(r!==""?`${n}(${r})`:n)}function bK(i){if(i!=null){if(typeof i=="string")return i;if(typeof i=="function")return L5(i,"Component");if(typeof i=="object")switch(i.$$typeof){case ZL.ForwardRef:return QL(i,i.render,"ForwardRef");case ZL.Memo:return QL(i,i.type,"memo");default:return}}}const SK=Object.freeze(Object.defineProperty({__proto__:null,default:bK,getFunctionName:k5},Symbol.toStringTag,{value:"Module"})),wK=["ownerState"],TK=["variants"],EK=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function MK(i){return Object.keys(i).length===0}function AK(i){return typeof i=="string"&&i.charCodeAt(0)>96}function mT(i){return i!=="ownerState"&&i!=="theme"&&i!=="sx"&&i!=="as"}const CK=k0(),RK=i=>i&&i.charAt(0).toLowerCase()+i.slice(1);function Rv({defaultTheme:i,theme:e,themeId:n}){return MK(e)?i:e[n]||e}function PK(i){return i?(e,n)=>n[i]:null}function C_(i,e){let{ownerState:n}=e,r=rt(e,wK);const s=typeof i=="function"?i(z({ownerState:n},r)):i;if(Array.isArray(s))return s.flatMap(o=>C_(o,z({ownerState:n},r)));if(s&&typeof s=="object"&&Array.isArray(s.variants)){const{variants:o=[]}=s;let l=rt(s,TK);return o.forEach(c=>{let u=!0;typeof c.props=="function"?u=c.props(z({ownerState:n},r,n)):Object.keys(c.props).forEach(d=>{(n==null?void 0:n[d])!==c.props[d]&&r[d]!==c.props[d]&&(u=!1)}),u&&(Array.isArray(l)||(l=[l]),l.push(typeof c.style=="function"?c.style(z({ownerState:n},r,n)):c.style))}),l}return s}function NK(i={}){const{themeId:e,defaultTheme:n=CK,rootShouldForwardProp:r=mT,slotShouldForwardProp:s=mT}=i,o=a=>N0(z({},a,{theme:Rv(z({},a,{defaultTheme:n,themeId:e}))}));return o.__mui_systemSx=!0,(a,l={})=>{_5(a,S=>S.filter(T=>!(T!=null&&T.__mui_systemSx)));const{name:c,slot:u,skipVariantsResolver:d,skipSx:h,overridesResolver:f=PK(RK(u))}=l,p=rt(l,EK),m=d!==void 0?d:u&&u!=="Root"&&u!=="root"||!1,y=h||!1;let v,g=mT;u==="Root"||u==="root"?g=r:u?g=s:AK(a)&&(g=void 0);const _=GP(a,z({shouldForwardProp:g,label:v},p)),x=S=>typeof S=="function"&&S.__emotion_real!==S||Al(S)?T=>C_(S,z({},T,{theme:Rv({theme:T.theme,defaultTheme:n,themeId:e})})):S,b=(S,...T)=>{let w=x(S);const E=T?T.map(x):[];c&&f&&E.push(R=>{const F=Rv(z({},R,{defaultTheme:n,themeId:e}));if(!F.components||!F.components[c]||!F.components[c].styleOverrides)return null;const B=F.components[c].styleOverrides,C={};return Object.entries(B).forEach(([L,P])=>{C[L]=C_(P,z({},R,{theme:F}))}),f(R,C)}),c&&!m&&E.push(R=>{var F;const B=Rv(z({},R,{defaultTheme:n,themeId:e})),C=B==null||(F=B.components)==null||(F=F[c])==null?void 0:F.variants;return C_({variants:C},z({},R,{theme:B}))}),y||E.push(o);const A=E.length-T.length;if(Array.isArray(S)&&A>0){const R=new Array(A).fill("");w=[...S,...R],w.raw=[...S.raw,...R]}const M=_(w,...E);return a.muiName&&(M.muiName=a.muiName),M};return _.withConfig&&(b.withConfig=_.withConfig),b}}const kK=NK(),LK=kK;function Ay(i,e){const n=z({},e);return Object.keys(i).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=z({},i[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const s=i[r]||{},o=e[r];n[r]={},!o||!Object.keys(o)?n[r]=s:!s||!Object.keys(s)?n[r]=o:(n[r]=z({},o),Object.keys(s).forEach(a=>{n[r][a]=Ay(s[a],o[a])}))}else n[r]===void 0&&(n[r]=i[r])}),n}function IK(i){const{theme:e,name:n,props:r}=i;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:Ay(e.components[n].defaultProps,r)}function DK({props:i,name:e,defaultTheme:n,themeId:r}){let s=fS(n);return r&&(s=s[r]||s),IK({theme:s,name:e,props:i})}const OK=typeof window<"u"?I.useLayoutEffect:I.useEffect,Ql=OK;function FK(i,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(i,n))}const BK=Object.freeze(Object.defineProperty({__proto__:null,default:FK},Symbol.toStringTag,{value:"Module"}));function JL(...i){return i.reduce((e,n)=>n==null?e:function(...s){e.apply(this,s),n.apply(this,s)},()=>{})}function ES(i,e=166){let n;function r(...s){const o=()=>{i.apply(this,s)};clearTimeout(n),n=setTimeout(o,e)}return r.clear=()=>{clearTimeout(n)},r}function R_(i,e){var n,r;return I.isValidElement(i)&&e.indexOf((n=i.type.muiName)!=null?n:(r=i.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function Sr(i){return i&&i.ownerDocument||document}function Jl(i){return Sr(i).defaultView||window}function oC(i,e){typeof i=="function"?i(e):i&&(i.current=e)}let eI=0;function UK(i){const[e,n]=I.useState(i),r=i||e;return I.useEffect(()=>{e==null&&(eI+=1,n(`mui-${eI}`))},[e]),r}const tI=ib["useId".toString()];function I5(i){if(tI!==void 0){const e=tI();return i??e}return UK(i)}function nI({controlled:i,default:e,name:n,state:r="value"}){const{current:s}=I.useRef(i!==void 0),[o,a]=I.useState(e),l=s?i:o,c=I.useCallback(u=>{s||a(u)},[]);return[l,c]}function Ks(i){const e=I.useRef(i);return Ql(()=>{e.current=i}),I.useRef((...n)=>(0,e.current)(...n)).current}function dr(...i){return I.useMemo(()=>i.every(e=>e==null)?null:e=>{i.forEach(n=>{oC(n,e)})},i)}const iI={};function zK(i,e){const n=I.useRef(iI);return n.current===iI&&(n.current=i(e)),n}const VK=[];function $K(i){I.useEffect(i,VK)}class MS{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new MS}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function YP(){const i=zK(MS.create).current;return $K(i.disposeEffect),i}let AS=!0,aC=!1;const GK=new MS,HK={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function WK(i){const{type:e,tagName:n}=i;return!!(n==="INPUT"&&HK[e]&&!i.readOnly||n==="TEXTAREA"&&!i.readOnly||i.isContentEditable)}function jK(i){i.metaKey||i.altKey||i.ctrlKey||(AS=!0)}function gT(){AS=!1}function qK(){this.visibilityState==="hidden"&&aC&&(AS=!0)}function XK(i){i.addEventListener("keydown",jK,!0),i.addEventListener("mousedown",gT,!0),i.addEventListener("pointerdown",gT,!0),i.addEventListener("touchstart",gT,!0),i.addEventListener("visibilitychange",qK,!0)}function KK(i){const{target:e}=i;try{return e.matches(":focus-visible")}catch{}return AS||WK(e)}function YK(){const i=I.useCallback(s=>{s!=null&&XK(s.ownerDocument)},[]),e=I.useRef(!1);function n(){return e.current?(aC=!0,GK.start(100,()=>{aC=!1}),e.current=!1,!0):!1}function r(s){return KK(s)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:i}}function D5(i){const e=i.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}let ih;function O5(){if(ih)return ih;const i=document.createElement("div"),e=document.createElement("div");return e.style.width="10px",e.style.height="1px",i.appendChild(e),i.dir="rtl",i.style.fontSize="14px",i.style.width="4px",i.style.height="1px",i.style.position="absolute",i.style.top="-1000px",i.style.overflow="scroll",document.body.appendChild(i),ih="reverse",i.scrollLeft>0?ih="default":(i.scrollLeft=1,i.scrollLeft===0&&(ih="negative")),document.body.removeChild(i),ih}function ZK(i,e){const n=i.scrollLeft;if(e!=="rtl")return n;switch(O5()){case"negative":return i.scrollWidth-i.clientWidth+n;case"reverse":return i.scrollWidth-i.clientWidth-n;default:return n}}function en(i,e,n=void 0){const r={};return Object.keys(i).forEach(s=>{r[s]=i[s].reduce((o,a)=>{if(a){const l=e(a);l!==""&&o.push(l),n&&n[a]&&o.push(n[a])}return o},[]).join(" ")}),r}function ap(i){return typeof i=="string"}function F5(i,e,n){return i===void 0||ap(i)?e:z({},e,{ownerState:z({},e.ownerState,n)})}function kb(i,e=[]){if(i===void 0)return{};const n={};return Object.keys(i).filter(r=>r.match(/^on[A-Z]/)&&typeof i[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=i[r]}),n}function rI(i){if(i===void 0)return{};const e={};return Object.keys(i).filter(n=>!(n.match(/^on[A-Z]/)&&typeof i[n]=="function")).forEach(n=>{e[n]=i[n]}),e}function B5(i){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:s,className:o}=i;if(!e){const p=ft(n==null?void 0:n.className,o,s==null?void 0:s.className,r==null?void 0:r.className),m=z({},n==null?void 0:n.style,s==null?void 0:s.style,r==null?void 0:r.style),y=z({},n,s,r);return p.length>0&&(y.className=p),Object.keys(m).length>0&&(y.style=m),{props:y,internalRef:void 0}}const a=kb(z({},s,r)),l=rI(r),c=rI(s),u=e(a),d=ft(u==null?void 0:u.className,n==null?void 0:n.className,o,s==null?void 0:s.className,r==null?void 0:r.className),h=z({},u==null?void 0:u.style,n==null?void 0:n.style,s==null?void 0:s.style,r==null?void 0:r.style),f=z({},u,n,c,l);return d.length>0&&(f.className=d),Object.keys(h).length>0&&(f.style=h),{props:f,internalRef:u.ref}}function U5(i,e,n){return typeof i=="function"?i(e,n):i}const QK=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function fa(i){var e;const{elementType:n,externalSlotProps:r,ownerState:s,skipResolvingSlotProps:o=!1}=i,a=rt(i,QK),l=o?{}:U5(r,s),{props:c,internalRef:u}=B5(z({},a,{externalSlotProps:l})),d=dr(u,l==null?void 0:l.ref,(e=i.additionalProps)==null?void 0:e.ref);return F5(n,z({},c,{ref:d}),s)}function Hp(i){if(parseInt(I.version,10)>=19){var e;return(i==null||(e=i.props)==null?void 0:e.ref)||null}return(i==null?void 0:i.ref)||null}const JK=I.createContext(null),z5=JK;function V5(){return I.useContext(z5)}const eY=typeof Symbol=="function"&&Symbol.for,tY=eY?Symbol.for("mui.nested"):"__THEME_NESTED__";function nY(i,e){return typeof e=="function"?e(i):z({},i,e)}function iY(i){const{children:e,theme:n}=i,r=V5(),s=I.useMemo(()=>{const o=r===null?n:nY(r,n);return o!=null&&(o[tY]=r!==null),o},[n,r]);return Y(z5.Provider,{value:s,children:e})}const rY=["value"],$5=I.createContext();function sY(i){let{value:e}=i,n=rt(i,rY);return Y($5.Provider,z({value:e??!0},n))}const ZP=()=>{const i=I.useContext($5);return i??!1},G5=I.createContext(void 0);function oY({value:i,children:e}){return Y(G5.Provider,{value:i,children:e})}function aY(i){const{theme:e,name:n,props:r}=i;if(!e||!e.components||!e.components[n])return r;const s=e.components[n];return s.defaultProps?Ay(s.defaultProps,r):!s.styleOverrides&&!s.variants?Ay(s,r):r}function lY({props:i,name:e}){const n=I.useContext(G5);return aY({props:i,name:e,theme:{components:n}})}const sI={};function oI(i,e,n,r=!1){return I.useMemo(()=>{const s=i&&e[i]||e;if(typeof n=="function"){const o=n(s),a=i?z({},e,{[i]:o}):o;return r?()=>a:a}return i?z({},e,{[i]:n}):z({},e,n)},[i,e,n,r])}function cY(i){const{children:e,theme:n,themeId:r}=i,s=C5(sI),o=V5()||sI,a=oI(r,s,n),l=oI(r,o,n,!0),c=a.direction==="rtl";return Y(iY,{theme:l,children:Y($p.Provider,{value:a,children:Y(sY,{value:c,children:Y(oY,{value:a==null?void 0:a.components,children:e})})})})}const uY=["className","component","disableGutters","fixed","maxWidth","classes"],dY=k0(),hY=LK("div",{name:"MuiContainer",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[`maxWidth${We(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),fY=i=>DK({props:i,name:"MuiContainer",defaultTheme:dY}),pY=(i,e)=>{const n=c=>Zt(e,c),{classes:r,fixed:s,disableGutters:o,maxWidth:a}=i,l={root:["root",a&&`maxWidth${We(String(a))}`,s&&"fixed",o&&"disableGutters"]};return en(l,n,r)};function mY(i={}){const{createStyledComponent:e=hY,useThemeProps:n=fY,componentName:r="MuiContainer"}=i,s=e(({theme:a,ownerState:l})=>z({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!l.disableGutters&&{paddingLeft:a.spacing(2),paddingRight:a.spacing(2),[a.breakpoints.up("sm")]:{paddingLeft:a.spacing(3),paddingRight:a.spacing(3)}}),({theme:a,ownerState:l})=>l.fixed&&Object.keys(a.breakpoints.values).reduce((c,u)=>{const d=u,h=a.breakpoints.values[d];return h!==0&&(c[a.breakpoints.up(d)]={maxWidth:`${h}${a.breakpoints.unit}`}),c},{}),({theme:a,ownerState:l})=>z({},l.maxWidth==="xs"&&{[a.breakpoints.up("xs")]:{maxWidth:Math.max(a.breakpoints.values.xs,444)}},l.maxWidth&&l.maxWidth!=="xs"&&{[a.breakpoints.up(l.maxWidth)]:{maxWidth:`${a.breakpoints.values[l.maxWidth]}${a.breakpoints.unit}`}}));return I.forwardRef(function(l,c){const u=n(l),{className:d,component:h="div",disableGutters:f=!1,fixed:p=!1,maxWidth:m="lg"}=u,y=rt(u,uY),v=z({},u,{component:h,disableGutters:f,fixed:p,maxWidth:m}),g=pY(v,r);return Y(s,z({as:h,ownerState:v,className:ft(g.root,d),ref:c},y))})}function gY(i,e){return z({toolbar:{minHeight:56,[i.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[i.up("sm")]:{minHeight:64}}},e)}var Ci={},H5={exports:{}};(function(i){function e(n){return n&&n.__esModule?n:{default:n}}i.exports=e,i.exports.__esModule=!0,i.exports.default=i.exports})(H5);var W5=H5.exports;const yY=sc(X7),vY=sc(BK);var j5=W5;Object.defineProperty(Ci,"__esModule",{value:!0});var si=Ci.alpha=Y5;Ci.blend=PY;Ci.colorChannel=void 0;var lC=Ci.darken=JP;Ci.decomposeColor=Io;var xY=Ci.emphasize=Z5,_Y=Ci.getContrastRatio=EY;Ci.getLuminance=Lb;Ci.hexToRgb=q5;Ci.hslToRgb=K5;var cC=Ci.lighten=eN;Ci.private_safeAlpha=MY;Ci.private_safeColorChannel=void 0;Ci.private_safeDarken=AY;Ci.private_safeEmphasize=RY;Ci.private_safeLighten=CY;Ci.recomposeColor=Wp;Ci.rgbToHex=TY;var aI=j5(yY),bY=j5(vY);function QP(i,e=0,n=1){return(0,bY.default)(i,e,n)}function q5(i){i=i.slice(1);const e=new RegExp(`.{1,${i.length>=6?2:1}}`,"g");let n=i.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,s)=>s<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function SY(i){const e=i.toString(16);return e.length===1?`0${e}`:e}function Io(i){if(i.type)return i;if(i.charAt(0)==="#")return Io(q5(i));const e=i.indexOf("("),n=i.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error((0,aI.default)(9,i));let r=i.substring(e+1,i.length-1),s;if(n==="color"){if(r=r.split(" "),s=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(s)===-1)throw new Error((0,aI.default)(10,s))}else r=r.split(",");return r=r.map(o=>parseFloat(o)),{type:n,values:r,colorSpace:s}}const X5=i=>{const e=Io(i);return e.values.slice(0,3).map((n,r)=>e.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};Ci.colorChannel=X5;const wY=(i,e)=>{try{return X5(i)}catch{return i}};Ci.private_safeColorChannel=wY;function Wp(i){const{type:e,colorSpace:n}=i;let{values:r}=i;return e.indexOf("rgb")!==-1?r=r.map((s,o)=>o<3?parseInt(s,10):s):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function TY(i){if(i.indexOf("#")===0)return i;const{values:e}=Io(i);return`#${e.map((n,r)=>SY(r===3?Math.round(255*n):n)).join("")}`}function K5(i){i=Io(i);const{values:e}=i,n=e[0],r=e[1]/100,s=e[2]/100,o=r*Math.min(s,1-s),a=(u,d=(u+n/30)%12)=>s-o*Math.max(Math.min(d-3,9-d,1),-1);let l="rgb";const c=[Math.round(a(0)*255),Math.round(a(8)*255),Math.round(a(4)*255)];return i.type==="hsla"&&(l+="a",c.push(e[3])),Wp({type:l,values:c})}function Lb(i){i=Io(i);let e=i.type==="hsl"||i.type==="hsla"?Io(K5(i)).values:i.values;return e=e.map(n=>(i.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function EY(i,e){const n=Lb(i),r=Lb(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function Y5(i,e){return i=Io(i),e=QP(e),(i.type==="rgb"||i.type==="hsl")&&(i.type+="a"),i.type==="color"?i.values[3]=`/${e}`:i.values[3]=e,Wp(i)}function MY(i,e,n){try{return Y5(i,e)}catch{return i}}function JP(i,e){if(i=Io(i),e=QP(e),i.type.indexOf("hsl")!==-1)i.values[2]*=1-e;else if(i.type.indexOf("rgb")!==-1||i.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)i.values[n]*=1-e;return Wp(i)}function AY(i,e,n){try{return JP(i,e)}catch{return i}}function eN(i,e){if(i=Io(i),e=QP(e),i.type.indexOf("hsl")!==-1)i.values[2]+=(100-i.values[2])*e;else if(i.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)i.values[n]+=(255-i.values[n])*e;else if(i.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)i.values[n]+=(1-i.values[n])*e;return Wp(i)}function CY(i,e,n){try{return eN(i,e)}catch{return i}}function Z5(i,e=.15){return Lb(i)>.5?JP(i,e):eN(i,e)}function RY(i,e,n){try{return Z5(i,e)}catch{return i}}function PY(i,e,n,r=1){const s=(c,u)=>Math.round((c**(1/r)*(1-n)+u**(1/r)*n)**r),o=Io(i),a=Io(e),l=[s(o.values[0],a.values[0]),s(o.values[1],a.values[1]),s(o.values[2],a.values[2])];return Wp({type:"rgb",values:l})}const NY={black:"#000",white:"#fff"},Cy=NY,kY={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},LY=kY,IY={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},rh=IY,DY={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},sh=DY,OY={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},wm=OY,FY={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},oh=FY,BY={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},ah=BY,UY={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},lh=UY,zY=["mode","contrastThreshold","tonalOffset"],lI={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Cy.white,default:Cy.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},yT={text:{primary:Cy.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Cy.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function cI(i,e,n,r){const s=r.light||r,o=r.dark||r*1.5;i[e]||(i.hasOwnProperty(n)?i[e]=i[n]:e==="light"?i.light=cC(i.main,s):e==="dark"&&(i.dark=lC(i.main,o)))}function VY(i="light"){return i==="dark"?{main:oh[200],light:oh[50],dark:oh[400]}:{main:oh[700],light:oh[400],dark:oh[800]}}function $Y(i="light"){return i==="dark"?{main:rh[200],light:rh[50],dark:rh[400]}:{main:rh[500],light:rh[300],dark:rh[700]}}function GY(i="light"){return i==="dark"?{main:sh[500],light:sh[300],dark:sh[700]}:{main:sh[700],light:sh[400],dark:sh[800]}}function HY(i="light"){return i==="dark"?{main:ah[400],light:ah[300],dark:ah[700]}:{main:ah[700],light:ah[500],dark:ah[900]}}function WY(i="light"){return i==="dark"?{main:lh[400],light:lh[300],dark:lh[700]}:{main:lh[800],light:lh[500],dark:lh[900]}}function jY(i="light"){return i==="dark"?{main:wm[400],light:wm[300],dark:wm[700]}:{main:"#ed6c02",light:wm[500],dark:wm[900]}}function qY(i){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=i,s=rt(i,zY),o=i.primary||VY(e),a=i.secondary||$Y(e),l=i.error||GY(e),c=i.info||HY(e),u=i.success||WY(e),d=i.warning||jY(e);function h(y){return _Y(y,yT.text.primary)>=n?yT.text.primary:lI.text.primary}const f=({color:y,name:v,mainShade:g=500,lightShade:_=300,darkShade:x=700})=>{if(y=z({},y),!y.main&&y[g]&&(y.main=y[g]),!y.hasOwnProperty("main"))throw new Error(kd(11,v?` (${v})`:"",g));if(typeof y.main!="string")throw new Error(kd(12,v?` (${v})`:"",JSON.stringify(y.main)));return cI(y,"light",_,r),cI(y,"dark",x,r),y.contrastText||(y.contrastText=h(y.main)),y},p={dark:yT,light:lI};return Js(z({common:z({},Cy),mode:e,primary:f({color:o,name:"primary"}),secondary:f({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:f({color:l,name:"error"}),warning:f({color:d,name:"warning"}),info:f({color:c,name:"info"}),success:f({color:u,name:"success"}),grey:LY,contrastThreshold:n,getContrastText:h,augmentColor:f,tonalOffset:r},p[e]),s)}const XY=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function KY(i){return Math.round(i*1e5)/1e5}const uI={textTransform:"uppercase"},dI='"Roboto", "Helvetica", "Arial", sans-serif';function YY(i,e){const n=typeof e=="function"?e(i):e,{fontFamily:r=dI,fontSize:s=14,fontWeightLight:o=300,fontWeightRegular:a=400,fontWeightMedium:l=500,fontWeightBold:c=700,htmlFontSize:u=16,allVariants:d,pxToRem:h}=n,f=rt(n,XY),p=s/14,m=h||(g=>`${g/u*p}rem`),y=(g,_,x,b,S)=>z({fontFamily:r,fontWeight:g,fontSize:m(_),lineHeight:x},r===dI?{letterSpacing:`${KY(b/_)}em`}:{},S,d),v={h1:y(o,96,1.167,-1.5),h2:y(o,60,1.2,-.5),h3:y(a,48,1.167,0),h4:y(a,34,1.235,.25),h5:y(a,24,1.334,0),h6:y(l,20,1.6,.15),subtitle1:y(a,16,1.75,.15),subtitle2:y(l,14,1.57,.1),body1:y(a,16,1.5,.15),body2:y(a,14,1.43,.15),button:y(l,14,1.75,.4,uI),caption:y(a,12,1.66,.4),overline:y(a,12,2.66,1,uI),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Js(z({htmlFontSize:u,pxToRem:m,fontFamily:r,fontSize:s,fontWeightLight:o,fontWeightRegular:a,fontWeightMedium:l,fontWeightBold:c},v),f,{clone:!1})}const ZY=.2,QY=.14,JY=.12;function Zn(...i){return[`${i[0]}px ${i[1]}px ${i[2]}px ${i[3]}px rgba(0,0,0,${ZY})`,`${i[4]}px ${i[5]}px ${i[6]}px ${i[7]}px rgba(0,0,0,${QY})`,`${i[8]}px ${i[9]}px ${i[10]}px ${i[11]}px rgba(0,0,0,${JY})`].join(",")}const eZ=["none",Zn(0,2,1,-1,0,1,1,0,0,1,3,0),Zn(0,3,1,-2,0,2,2,0,0,1,5,0),Zn(0,3,3,-2,0,3,4,0,0,1,8,0),Zn(0,2,4,-1,0,4,5,0,0,1,10,0),Zn(0,3,5,-1,0,5,8,0,0,1,14,0),Zn(0,3,5,-1,0,6,10,0,0,1,18,0),Zn(0,4,5,-2,0,7,10,1,0,2,16,1),Zn(0,5,5,-3,0,8,10,1,0,3,14,2),Zn(0,5,6,-3,0,9,12,1,0,3,16,2),Zn(0,6,6,-3,0,10,14,1,0,4,18,3),Zn(0,6,7,-4,0,11,15,1,0,4,20,3),Zn(0,7,8,-4,0,12,17,2,0,5,22,4),Zn(0,7,8,-4,0,13,19,2,0,5,24,4),Zn(0,7,9,-4,0,14,21,2,0,5,26,4),Zn(0,8,9,-5,0,15,22,2,0,6,28,5),Zn(0,8,10,-5,0,16,24,2,0,6,30,5),Zn(0,8,11,-5,0,17,26,2,0,6,32,5),Zn(0,9,11,-5,0,18,28,2,0,7,34,6),Zn(0,9,12,-6,0,19,29,2,0,7,36,6),Zn(0,10,13,-6,0,20,31,3,0,8,38,7),Zn(0,10,13,-6,0,21,33,3,0,8,40,7),Zn(0,10,14,-6,0,22,35,3,0,8,42,7),Zn(0,11,14,-7,0,23,36,3,0,9,44,8),Zn(0,11,15,-7,0,24,38,3,0,9,46,8)],tZ=eZ,nZ=["duration","easing","delay"],iZ={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},rZ={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function hI(i){return`${Math.round(i)}ms`}function sZ(i){if(!i)return 0;const e=i/36;return Math.round((4+15*e**.25+e/5)*10)}function oZ(i){const e=z({},iZ,i.easing),n=z({},rZ,i.duration);return z({getAutoHeightDuration:sZ,create:(s=["all"],o={})=>{const{duration:a=n.standard,easing:l=e.easeInOut,delay:c=0}=o;return rt(o,nZ),(Array.isArray(s)?s:[s]).map(u=>`${u} ${typeof a=="string"?a:hI(a)} ${l} ${typeof c=="string"?c:hI(c)}`).join(",")}},i,{easing:e,duration:n})}const aZ={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},lZ=aZ,cZ=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function tN(i={},...e){const{mixins:n={},palette:r={},transitions:s={},typography:o={}}=i,a=rt(i,cZ);if(i.vars&&i.generateCssVars===void 0)throw new Error(kd(18));const l=qY(r),c=k0(i);let u=Js(c,{mixins:gY(c.breakpoints,n),palette:l,shadows:tZ.slice(),typography:YY(l,o),transitions:oZ(s),zIndex:z({},lZ)});return u=Js(u,a),u=e.reduce((d,h)=>Js(d,h),u),u.unstable_sxConfig=z({},P0,a==null?void 0:a.unstable_sxConfig),u.unstable_sx=function(h){return N0({sx:h,theme:this})},u}const uZ=tN(),nN=uZ;function L0(){const i=fS(nN);return i[sp]||i}var I0={},vT={exports:{}},fI;function dZ(){return fI||(fI=1,function(i){function e(n,r){if(n==null)return{};var s={};for(var o in n)if({}.hasOwnProperty.call(n,o)){if(r.indexOf(o)!==-1)continue;s[o]=n[o]}return s}i.exports=e,i.exports.__esModule=!0,i.exports.default=i.exports}(vT)),vT.exports}const hZ=sc(cX),fZ=sc(uX),pZ=sc(vX),mZ=sc(SK),gZ=sc(oK),yZ=sc(hK);var jp=W5;Object.defineProperty(I0,"__esModule",{value:!0});var vZ=I0.default=NZ;I0.shouldForwardProp=P_;I0.systemDefaultTheme=void 0;var go=jp(m5()),uC=jp(dZ()),pI=EZ(hZ),xZ=fZ;jp(pZ);jp(mZ);var _Z=jp(gZ),bZ=jp(yZ);const SZ=["ownerState"],wZ=["variants"],TZ=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Q5(i){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Q5=function(r){return r?n:e})(i)}function EZ(i,e){if(!e&&i&&i.__esModule)return i;if(i===null||typeof i!="object"&&typeof i!="function")return{default:i};var n=Q5(e);if(n&&n.has(i))return n.get(i);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in i)if(o!=="default"&&Object.prototype.hasOwnProperty.call(i,o)){var a=s?Object.getOwnPropertyDescriptor(i,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=i[o]}return r.default=i,n&&n.set(i,r),r}function MZ(i){return Object.keys(i).length===0}function AZ(i){return typeof i=="string"&&i.charCodeAt(0)>96}function P_(i){return i!=="ownerState"&&i!=="theme"&&i!=="sx"&&i!=="as"}const CZ=I0.systemDefaultTheme=(0,_Z.default)(),RZ=i=>i&&i.charAt(0).toLowerCase()+i.slice(1);function Pv({defaultTheme:i,theme:e,themeId:n}){return MZ(e)?i:e[n]||e}function PZ(i){return i?(e,n)=>n[i]:null}function N_(i,e){let{ownerState:n}=e,r=(0,uC.default)(e,SZ);const s=typeof i=="function"?i((0,go.default)({ownerState:n},r)):i;if(Array.isArray(s))return s.flatMap(o=>N_(o,(0,go.default)({ownerState:n},r)));if(s&&typeof s=="object"&&Array.isArray(s.variants)){const{variants:o=[]}=s;let l=(0,uC.default)(s,wZ);return o.forEach(c=>{let u=!0;typeof c.props=="function"?u=c.props((0,go.default)({ownerState:n},r,n)):Object.keys(c.props).forEach(d=>{(n==null?void 0:n[d])!==c.props[d]&&r[d]!==c.props[d]&&(u=!1)}),u&&(Array.isArray(l)||(l=[l]),l.push(typeof c.style=="function"?c.style((0,go.default)({ownerState:n},r,n)):c.style))}),l}return s}function NZ(i={}){const{themeId:e,defaultTheme:n=CZ,rootShouldForwardProp:r=P_,slotShouldForwardProp:s=P_}=i,o=a=>(0,bZ.default)((0,go.default)({},a,{theme:Pv((0,go.default)({},a,{defaultTheme:n,themeId:e}))}));return o.__mui_systemSx=!0,(a,l={})=>{(0,pI.internal_processStyles)(a,S=>S.filter(T=>!(T!=null&&T.__mui_systemSx)));const{name:c,slot:u,skipVariantsResolver:d,skipSx:h,overridesResolver:f=PZ(RZ(u))}=l,p=(0,uC.default)(l,TZ),m=d!==void 0?d:u&&u!=="Root"&&u!=="root"||!1,y=h||!1;let v,g=P_;u==="Root"||u==="root"?g=r:u?g=s:AZ(a)&&(g=void 0);const _=(0,pI.default)(a,(0,go.default)({shouldForwardProp:g,label:v},p)),x=S=>typeof S=="function"&&S.__emotion_real!==S||(0,xZ.isPlainObject)(S)?T=>N_(S,(0,go.default)({},T,{theme:Pv({theme:T.theme,defaultTheme:n,themeId:e})})):S,b=(S,...T)=>{let w=x(S);const E=T?T.map(x):[];c&&f&&E.push(R=>{const F=Pv((0,go.default)({},R,{defaultTheme:n,themeId:e}));if(!F.components||!F.components[c]||!F.components[c].styleOverrides)return null;const B=F.components[c].styleOverrides,C={};return Object.entries(B).forEach(([L,P])=>{C[L]=N_(P,(0,go.default)({},R,{theme:F}))}),f(R,C)}),c&&!m&&E.push(R=>{var F;const B=Pv((0,go.default)({},R,{defaultTheme:n,themeId:e})),C=B==null||(F=B.components)==null||(F=F[c])==null?void 0:F.variants;return N_({variants:C},(0,go.default)({},R,{theme:B}))}),y||E.push(o);const A=E.length-T.length;if(Array.isArray(S)&&A>0){const R=new Array(A).fill("");w=[...S,...R],w.raw=[...S.raw,...R]}const M=_(w,...E);return a.muiName&&(M.muiName=a.muiName),M};return _.withConfig&&(b.withConfig=_.withConfig),b}}function J5(i){return i!=="ownerState"&&i!=="theme"&&i!=="sx"&&i!=="as"}const kZ=i=>J5(i)&&i!=="classes",xa=kZ,LZ=vZ({themeId:sp,defaultTheme:nN,rootShouldForwardProp:xa}),Qe=LZ,IZ=["theme"];function DZ(i){let{theme:e}=i,n=rt(i,IZ);const r=e[sp];let s=r||e;return typeof e!="function"&&(r&&!r.vars?s=z({},r,{vars:null}):e&&!e.vars&&(s=z({},e,{vars:null}))),Y(cY,z({},n,{themeId:r?sp:void 0,theme:s}))}const OZ=i=>{let e;return i<1?e=5.11916*i**2:e=4.5*Math.log(i+1)+2,(e/100).toFixed(2)},mI=OZ;function Qt(i){return lY(i)}function eV(i){return Y(cK,z({},i,{defaultTheme:nN,themeId:sp}))}const FZ=(i,e)=>z({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&!i.vars&&{colorScheme:i.palette.mode}),BZ=i=>z({color:(i.vars||i).palette.text.primary},i.typography.body1,{backgroundColor:(i.vars||i).palette.background.default,"@media print":{backgroundColor:(i.vars||i).palette.common.white}}),UZ=(i,e=!1)=>{var n;const r={};e&&i.colorSchemes&&Object.entries(i.colorSchemes).forEach(([a,l])=>{var c;r[i.getColorSchemeSelector(a).replace(/\s*&/,"")]={colorScheme:(c=l.palette)==null?void 0:c.mode}});let s=z({html:FZ(i,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:i.typography.fontWeightBold},body:z({margin:0},BZ(i),{"&::backdrop":{backgroundColor:(i.vars||i).palette.background.default}})},r);const o=(n=i.components)==null||(n=n.MuiCssBaseline)==null?void 0:n.styleOverrides;return o&&(s=[s,o]),s};function zZ(i){const e=Qt({props:i,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=e;return lt(I.Fragment,{children:[Y(eV,{styles:s=>UZ(s,r)}),n]})}const VZ=tN({palette:{primary:{main:"#3f51b5"},secondary:{main:"#f50057"},background:{default:"#f5f5f5"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"2.5rem",fontWeight:500},h2:{fontSize:"2rem",fontWeight:500},h3:{fontSize:"1.75rem",fontWeight:500}},components:{MuiButton:{styleOverrides:{root:{textTransform:"none"}}}}});function $Z(i){return Zt("MuiSvgIcon",i)}jt("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const GZ=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],HZ=i=>{const{color:e,fontSize:n,classes:r}=i,s={root:["root",e!=="inherit"&&`color${We(e)}`,`fontSize${We(n)}`]};return en(s,$Z,r)},WZ=Qe("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.color!=="inherit"&&e[`color${We(n.color)}`],e[`fontSize${We(n.fontSize)}`]]}})(({theme:i,ownerState:e})=>{var n,r,s,o,a,l,c,u,d,h,f,p,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=i.transitions)==null||(r=n.create)==null?void 0:r.call(n,"fill",{duration:(s=i.transitions)==null||(s=s.duration)==null?void 0:s.shorter}),fontSize:{inherit:"inherit",small:((o=i.typography)==null||(a=o.pxToRem)==null?void 0:a.call(o,20))||"1.25rem",medium:((l=i.typography)==null||(c=l.pxToRem)==null?void 0:c.call(l,24))||"1.5rem",large:((u=i.typography)==null||(d=u.pxToRem)==null?void 0:d.call(u,35))||"2.1875rem"}[e.fontSize],color:(h=(f=(i.vars||i).palette)==null||(f=f[e.color])==null?void 0:f.main)!=null?h:{action:(p=(i.vars||i).palette)==null||(p=p.action)==null?void 0:p.active,disabled:(m=(i.vars||i).palette)==null||(m=m.action)==null?void 0:m.disabled,inherit:void 0}[e.color]}}),tV=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiSvgIcon"}),{children:s,className:o,color:a="inherit",component:l="svg",fontSize:c="medium",htmlColor:u,inheritViewBox:d=!1,titleAccess:h,viewBox:f="0 0 24 24"}=r,p=rt(r,GZ),m=I.isValidElement(s)&&s.type==="svg",y=z({},r,{color:a,component:l,fontSize:c,instanceFontSize:e.fontSize,inheritViewBox:d,viewBox:f,hasSvgAsChild:m}),v={};d||(v.viewBox=f);const g=HZ(y);return lt(WZ,z({as:l,className:ft(g.root,o),focusable:"false",color:u,"aria-hidden":h?void 0:!0,role:h?"img":void 0,ref:n},v,p,m&&s.props,{ownerState:y,children:[m?s.props.children:s,h?Y("title",{children:h}):null]}))});tV.muiName="SvgIcon";const gI=tV;function lc(i,e){function n(r,s){return Y(gI,z({"data-testid":`${e}Icon`,ref:s},r,{children:i}))}return n.muiName=gI.muiName,I.memo(I.forwardRef(n))}function Ry(i,e){return Ry=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Ry(i,e)}function iN(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,Ry(i,e)}const yI={disabled:!1},Ib=ns.createContext(null);var jZ=function(e){return e.scrollTop},xg="unmounted",Ju="exited",ed="entering",Qh="entered",dC="exiting",cc=function(i){iN(e,i);function e(r,s){var o;o=i.call(this,r,s)||this;var a=s,l=a&&!a.isMounting?r.enter:r.appear,c;return o.appearStatus=null,r.in?l?(c=Ju,o.appearStatus=ed):c=Qh:r.unmountOnExit||r.mountOnEnter?c=xg:c=Ju,o.state={status:c},o.nextCallback=null,o}e.getDerivedStateFromProps=function(s,o){var a=s.in;return a&&o.status===xg?{status:Ju}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(s){var o=null;if(s!==this.props){var a=this.state.status;this.props.in?a!==ed&&a!==Qh&&(o=ed):(a===ed||a===Qh)&&(o=dC)}this.updateStatus(!1,o)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var s=this.props.timeout,o,a,l;return o=a=l=s,s!=null&&typeof s!="number"&&(o=s.exit,a=s.enter,l=s.appear!==void 0?s.appear:a),{exit:o,enter:a,appear:l}},n.updateStatus=function(s,o){if(s===void 0&&(s=!1),o!==null)if(this.cancelNextCallback(),o===ed){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:Av.findDOMNode(this);a&&jZ(a)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ju&&this.setState({status:xg})},n.performEnter=function(s){var o=this,a=this.props.enter,l=this.context?this.context.isMounting:s,c=this.props.nodeRef?[l]:[Av.findDOMNode(this),l],u=c[0],d=c[1],h=this.getTimeouts(),f=l?h.appear:h.enter;if(!s&&!a||yI.disabled){this.safeSetState({status:Qh},function(){o.props.onEntered(u)});return}this.props.onEnter(u,d),this.safeSetState({status:ed},function(){o.props.onEntering(u,d),o.onTransitionEnd(f,function(){o.safeSetState({status:Qh},function(){o.props.onEntered(u,d)})})})},n.performExit=function(){var s=this,o=this.props.exit,a=this.getTimeouts(),l=this.props.nodeRef?void 0:Av.findDOMNode(this);if(!o||yI.disabled){this.safeSetState({status:Ju},function(){s.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:dC},function(){s.props.onExiting(l),s.onTransitionEnd(a.exit,function(){s.safeSetState({status:Ju},function(){s.props.onExited(l)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(s,o){o=this.setNextCallback(o),this.setState(s,o)},n.setNextCallback=function(s){var o=this,a=!0;return this.nextCallback=function(l){a&&(a=!1,o.nextCallback=null,s(l))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},n.onTransitionEnd=function(s,o){this.setNextCallback(o);var a=this.props.nodeRef?this.props.nodeRef.current:Av.findDOMNode(this),l=s==null&&!this.props.addEndListener;if(!a||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],u=c[0],d=c[1];this.props.addEndListener(u,d)}s!=null&&setTimeout(this.nextCallback,s)},n.render=function(){var s=this.state.status;if(s===xg)return null;var o=this.props,a=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var l=rt(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return ns.createElement(Ib.Provider,{value:null},typeof a=="function"?a(s,l):ns.cloneElement(ns.Children.only(a),l))},e}(ns.Component);cc.contextType=Ib;cc.propTypes={};function ch(){}cc.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ch,onEntering:ch,onEntered:ch,onExit:ch,onExiting:ch,onExited:ch};cc.UNMOUNTED=xg;cc.EXITED=Ju;cc.ENTERING=ed;cc.ENTERED=Qh;cc.EXITING=dC;const nV=cc;function iV(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function rN(i,e){var n=function(o){return e&&I.isValidElement(o)?e(o):o},r=Object.create(null);return i&&I.Children.map(i,function(s){return s}).forEach(function(s){r[s.key]=n(s)}),r}function qZ(i,e){i=i||{},e=e||{};function n(d){return d in e?e[d]:i[d]}var r=Object.create(null),s=[];for(var o in i)o in e?s.length&&(r[o]=s,s=[]):s.push(o);var a,l={};for(var c in e){if(r[c])for(a=0;a<r[c].length;a++){var u=r[c][a];l[r[c][a]]=n(u)}l[c]=n(c)}for(a=0;a<s.length;a++)l[s[a]]=n(s[a]);return l}function md(i,e,n){return n[e]!=null?n[e]:i.props[e]}function XZ(i,e){return rN(i.children,function(n){return I.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:md(n,"appear",i),enter:md(n,"enter",i),exit:md(n,"exit",i)})})}function KZ(i,e,n){var r=rN(i.children),s=qZ(e,r);return Object.keys(s).forEach(function(o){var a=s[o];if(I.isValidElement(a)){var l=o in e,c=o in r,u=e[o],d=I.isValidElement(u)&&!u.props.in;c&&(!l||d)?s[o]=I.cloneElement(a,{onExited:n.bind(null,a),in:!0,exit:md(a,"exit",i),enter:md(a,"enter",i)}):!c&&l&&!d?s[o]=I.cloneElement(a,{in:!1}):c&&l&&I.isValidElement(u)&&(s[o]=I.cloneElement(a,{onExited:n.bind(null,a),in:u.props.in,exit:md(a,"exit",i),enter:md(a,"enter",i)}))}}),s}var YZ=Object.values||function(i){return Object.keys(i).map(function(e){return i[e]})},ZZ={component:"div",childFactory:function(e){return e}},sN=function(i){iN(e,i);function e(r,s){var o;o=i.call(this,r,s)||this;var a=o.handleExited.bind(iV(o));return o.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},o}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(s,o){var a=o.children,l=o.handleExited,c=o.firstRender;return{children:c?XZ(s,l):KZ(s,a,l),firstRender:!1}},n.handleExited=function(s,o){var a=rN(this.props.children);s.key in a||(s.props.onExited&&s.props.onExited(o),this.mounted&&this.setState(function(l){var c=z({},l.children);return delete c[s.key],{children:c}}))},n.render=function(){var s=this.props,o=s.component,a=s.childFactory,l=rt(s,["component","childFactory"]),c=this.state.contextValue,u=YZ(this.state.children).map(a);return delete l.appear,delete l.enter,delete l.exit,o===null?ns.createElement(Ib.Provider,{value:c},u):ns.createElement(Ib.Provider,{value:c},ns.createElement(o,l,u))},e}(ns.Component);sN.propTypes={};sN.defaultProps=ZZ;const QZ=sN,rV=i=>i.scrollTop;function Db(i,e){var n,r;const{timeout:s,easing:o,style:a={}}=i;return{duration:(n=a.transitionDuration)!=null?n:typeof s=="number"?s:s[e.mode]||0,easing:(r=a.transitionTimingFunction)!=null?r:typeof o=="object"?o[e.mode]:o,delay:a.transitionDelay}}function JZ(i){return Zt("MuiPaper",i)}jt("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const eQ=["className","component","elevation","square","variant"],tQ=i=>{const{square:e,elevation:n,variant:r,classes:s}=i,o={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return en(o,JZ,s)},nQ=Qe("div",{name:"MuiPaper",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:i,ownerState:e})=>{var n;return z({backgroundColor:(i.vars||i).palette.background.paper,color:(i.vars||i).palette.text.primary,transition:i.transitions.create("box-shadow")},!e.square&&{borderRadius:i.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(i.vars||i).palette.divider}`},e.variant==="elevation"&&z({boxShadow:(i.vars||i).shadows[e.elevation]},!i.vars&&i.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${si("#fff",mI(e.elevation))}, ${si("#fff",mI(e.elevation))})`},i.vars&&{backgroundImage:(n=i.vars.overlays)==null?void 0:n[e.elevation]}))}),iQ=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiPaper"}),{className:s,component:o="div",elevation:a=1,square:l=!1,variant:c="elevation"}=r,u=rt(r,eQ),d=z({},r,{component:o,elevation:a,square:l,variant:c}),h=tQ(d);return Y(nQ,z({as:o,ownerState:d,className:ft(h.root,s),ref:n},u))}),ec=iQ,rQ=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],sQ=["component","slots","slotProps"],oQ=["component"];function vI(i,e){const{className:n,elementType:r,ownerState:s,externalForwardedProps:o,getSlotOwnerState:a,internalForwardedProps:l}=e,c=rt(e,rQ),{component:u,slots:d={[i]:void 0},slotProps:h={[i]:void 0}}=o,f=rt(o,sQ),p=d[i]||r,m=U5(h[i],s),y=B5(z({className:n},c,{externalForwardedProps:i==="root"?f:void 0,externalSlotProps:m})),{props:{component:v},internalRef:g}=y,_=rt(y.props,oQ),x=dr(g,m==null?void 0:m.ref,e.ref),b=a?a(_):{},S=z({},s,b),T=i==="root"?v||u:v,w=F5(p,z({},i==="root"&&!u&&!d[i]&&l,i!=="root"&&!d[i]&&l,_,T&&{as:T},{ref:x}),S);return Object.keys(b).forEach(E=>{delete w[E]}),[p,w]}function aQ(i){const{className:e,classes:n,pulsate:r=!1,rippleX:s,rippleY:o,rippleSize:a,in:l,onExited:c,timeout:u}=i,[d,h]=I.useState(!1),f=ft(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),p={width:a,height:a,top:-(a/2)+o,left:-(a/2)+s},m=ft(n.child,d&&n.childLeaving,r&&n.childPulsate);return!l&&!d&&h(!0),I.useEffect(()=>{if(!l&&c!=null){const y=setTimeout(c,u);return()=>{clearTimeout(y)}}},[c,l,u]),Y("span",{className:f,style:p,children:Y("span",{className:m})})}const lQ=jt("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),yo=lQ,cQ=["center","classes","className"];let CS=i=>i,xI,_I,bI,SI;const hC=550,uQ=80,dQ=Gp(xI||(xI=CS`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),hQ=Gp(_I||(_I=CS`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),fQ=Gp(bI||(bI=CS`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),pQ=Qe("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),mQ=Qe(aQ,{name:"MuiTouchRipple",slot:"Ripple"})(SI||(SI=CS`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),yo.rippleVisible,dQ,hC,({theme:i})=>i.transitions.easing.easeInOut,yo.ripplePulsate,({theme:i})=>i.transitions.duration.shorter,yo.child,yo.childLeaving,hQ,hC,({theme:i})=>i.transitions.easing.easeInOut,yo.childPulsate,fQ,({theme:i})=>i.transitions.easing.easeInOut),gQ=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiTouchRipple"}),{center:s=!1,classes:o={},className:a}=r,l=rt(r,cQ),[c,u]=I.useState([]),d=I.useRef(0),h=I.useRef(null);I.useEffect(()=>{h.current&&(h.current(),h.current=null)},[c]);const f=I.useRef(!1),p=YP(),m=I.useRef(null),y=I.useRef(null),v=I.useCallback(b=>{const{pulsate:S,rippleX:T,rippleY:w,rippleSize:E,cb:A}=b;u(M=>[...M,Y(mQ,{classes:{ripple:ft(o.ripple,yo.ripple),rippleVisible:ft(o.rippleVisible,yo.rippleVisible),ripplePulsate:ft(o.ripplePulsate,yo.ripplePulsate),child:ft(o.child,yo.child),childLeaving:ft(o.childLeaving,yo.childLeaving),childPulsate:ft(o.childPulsate,yo.childPulsate)},timeout:hC,pulsate:S,rippleX:T,rippleY:w,rippleSize:E},d.current)]),d.current+=1,h.current=A},[o]),g=I.useCallback((b={},S={},T=()=>{})=>{const{pulsate:w=!1,center:E=s||S.pulsate,fakeElement:A=!1}=S;if((b==null?void 0:b.type)==="mousedown"&&f.current){f.current=!1;return}(b==null?void 0:b.type)==="touchstart"&&(f.current=!0);const M=A?null:y.current,R=M?M.getBoundingClientRect():{width:0,height:0,left:0,top:0};let F,B,C;if(E||b===void 0||b.clientX===0&&b.clientY===0||!b.clientX&&!b.touches)F=Math.round(R.width/2),B=Math.round(R.height/2);else{const{clientX:L,clientY:P}=b.touches&&b.touches.length>0?b.touches[0]:b;F=Math.round(L-R.left),B=Math.round(P-R.top)}if(E)C=Math.sqrt((2*R.width**2+R.height**2)/3),C%2===0&&(C+=1);else{const L=Math.max(Math.abs((M?M.clientWidth:0)-F),F)*2+2,P=Math.max(Math.abs((M?M.clientHeight:0)-B),B)*2+2;C=Math.sqrt(L**2+P**2)}b!=null&&b.touches?m.current===null&&(m.current=()=>{v({pulsate:w,rippleX:F,rippleY:B,rippleSize:C,cb:T})},p.start(uQ,()=>{m.current&&(m.current(),m.current=null)})):v({pulsate:w,rippleX:F,rippleY:B,rippleSize:C,cb:T})},[s,v,p]),_=I.useCallback(()=>{g({},{pulsate:!0})},[g]),x=I.useCallback((b,S)=>{if(p.clear(),(b==null?void 0:b.type)==="touchend"&&m.current){m.current(),m.current=null,p.start(0,()=>{x(b,S)});return}m.current=null,u(T=>T.length>0?T.slice(1):T),h.current=S},[p]);return I.useImperativeHandle(n,()=>({pulsate:_,start:g,stop:x}),[_,g,x]),Y(pQ,z({className:ft(yo.root,o.root,a),ref:y},l,{children:Y(QZ,{component:null,exit:!0,children:c})}))}),yQ=gQ;function vQ(i){return Zt("MuiButtonBase",i)}const xQ=jt("MuiButtonBase",["root","disabled","focusVisible"]),_Q=xQ,bQ=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],SQ=i=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:s}=i,a=en({root:["root",e&&"disabled",n&&"focusVisible"]},vQ,s);return n&&r&&(a.root+=` ${r}`),a},wQ=Qe("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(i,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${_Q.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),TQ=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiButtonBase"}),{action:s,centerRipple:o=!1,children:a,className:l,component:c="button",disabled:u=!1,disableRipple:d=!1,disableTouchRipple:h=!1,focusRipple:f=!1,LinkComponent:p="a",onBlur:m,onClick:y,onContextMenu:v,onDragLeave:g,onFocus:_,onFocusVisible:x,onKeyDown:b,onKeyUp:S,onMouseDown:T,onMouseLeave:w,onMouseUp:E,onTouchEnd:A,onTouchMove:M,onTouchStart:R,tabIndex:F=0,TouchRippleProps:B,touchRippleRef:C,type:L}=r,P=rt(r,bQ),W=I.useRef(null),D=I.useRef(null),X=dr(D,C),{isFocusVisibleRef:q,onFocus:J,onBlur:se,ref:de}=YK(),[G,Q]=I.useState(!1);u&&G&&Q(!1),I.useImperativeHandle(s,()=>({focusVisible:()=>{Q(!0),W.current.focus()}}),[]);const[ee,ie]=I.useState(!1);I.useEffect(()=>{ie(!0)},[]);const Se=ee&&!d&&!u;I.useEffect(()=>{G&&f&&!d&&ee&&D.current.pulsate()},[d,f,G,ee]);function Fe(Ce,vt,Ne=h){return Ks(st=>(vt&&vt(st),!Ne&&D.current&&D.current[Ce](st),!0))}const Be=Fe("start",T),ct=Fe("stop",v),xt=Fe("stop",g),He=Fe("stop",E),Z=Fe("stop",Ce=>{G&&Ce.preventDefault(),w&&w(Ce)}),Nt=Fe("start",R),Rt=Fe("stop",A),mt=Fe("stop",M),Je=Fe("stop",Ce=>{se(Ce),q.current===!1&&Q(!1),m&&m(Ce)},!1),qt=Ks(Ce=>{W.current||(W.current=Ce.currentTarget),J(Ce),q.current===!0&&(Q(!0),x&&x(Ce)),_&&_(Ce)}),et=()=>{const Ce=W.current;return c&&c!=="button"&&!(Ce.tagName==="A"&&Ce.href)},j=I.useRef(!1),O=Ks(Ce=>{f&&!j.current&&G&&D.current&&Ce.key===" "&&(j.current=!0,D.current.stop(Ce,()=>{D.current.start(Ce)})),Ce.target===Ce.currentTarget&&et()&&Ce.key===" "&&Ce.preventDefault(),b&&b(Ce),Ce.target===Ce.currentTarget&&et()&&Ce.key==="Enter"&&!u&&(Ce.preventDefault(),y&&y(Ce))}),ce=Ks(Ce=>{f&&Ce.key===" "&&D.current&&G&&!Ce.defaultPrevented&&(j.current=!1,D.current.stop(Ce,()=>{D.current.pulsate(Ce)})),S&&S(Ce),y&&Ce.target===Ce.currentTarget&&et()&&Ce.key===" "&&!Ce.defaultPrevented&&y(Ce)});let ye=c;ye==="button"&&(P.href||P.to)&&(ye=p);const Ae={};ye==="button"?(Ae.type=L===void 0?"button":L,Ae.disabled=u):(!P.href&&!P.to&&(Ae.role="button"),u&&(Ae["aria-disabled"]=u));const we=dr(n,de,W),ot=z({},r,{centerRipple:o,component:c,disabled:u,disableRipple:d,disableTouchRipple:h,focusRipple:f,tabIndex:F,focusVisible:G}),Pe=SQ(ot);return lt(wQ,z({as:ye,className:ft(Pe.root,l),ownerState:ot,onBlur:Je,onClick:y,onContextMenu:ct,onFocus:qt,onKeyDown:O,onKeyUp:ce,onMouseDown:Be,onMouseLeave:Z,onMouseUp:He,onDragLeave:xt,onTouchEnd:Rt,onTouchMove:mt,onTouchStart:Nt,ref:we,tabIndex:u?-1:F,type:L},Ae,P,{children:[a,Se?Y(yQ,z({ref:X,center:o},B)):null]}))}),Ld=TQ;function EQ(i){return Zt("MuiAlert",i)}const MQ=jt("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),wI=MQ;function AQ(i){return Zt("MuiIconButton",i)}const CQ=jt("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),RQ=CQ,PQ=["edge","children","className","color","disabled","disableFocusRipple","size"],NQ=i=>{const{classes:e,disabled:n,color:r,edge:s,size:o}=i,a={root:["root",n&&"disabled",r!=="default"&&`color${We(r)}`,s&&`edge${We(s)}`,`size${We(o)}`]};return en(a,AQ,e)},kQ=Qe(Ld,{name:"MuiIconButton",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.color!=="default"&&e[`color${We(n.color)}`],n.edge&&e[`edge${We(n.edge)}`],e[`size${We(n.size)}`]]}})(({theme:i,ownerState:e})=>z({textAlign:"center",flex:"0 0 auto",fontSize:i.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(i.vars||i).palette.action.active,transition:i.transitions.create("background-color",{duration:i.transitions.duration.shortest})},!e.disableRipple&&{"&:hover":{backgroundColor:i.vars?`rgba(${i.vars.palette.action.activeChannel} / ${i.vars.palette.action.hoverOpacity})`:si(i.palette.action.active,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.edge==="start"&&{marginLeft:e.size==="small"?-3:-12},e.edge==="end"&&{marginRight:e.size==="small"?-3:-12}),({theme:i,ownerState:e})=>{var n;const r=(n=(i.vars||i).palette)==null?void 0:n[e.color];return z({},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&e.color!=="default"&&z({color:r==null?void 0:r.main},!e.disableRipple&&{"&:hover":z({},r&&{backgroundColor:i.vars?`rgba(${r.mainChannel} / ${i.vars.palette.action.hoverOpacity})`:si(r.main,i.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),e.size==="small"&&{padding:5,fontSize:i.typography.pxToRem(18)},e.size==="large"&&{padding:12,fontSize:i.typography.pxToRem(28)},{[`&.${RQ.disabled}`]:{backgroundColor:"transparent",color:(i.vars||i).palette.action.disabled}})}),LQ=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiIconButton"}),{edge:s=!1,children:o,className:a,color:l="default",disabled:c=!1,disableFocusRipple:u=!1,size:d="medium"}=r,h=rt(r,PQ),f=z({},r,{edge:s,color:l,disabled:c,disableFocusRipple:u,size:d}),p=NQ(f);return Y(kQ,z({className:ft(p.root,a),centerRipple:!0,focusRipple:!u,disabled:c,ref:n},h,{ownerState:f,children:o}))}),IQ=LQ,DQ=lc(Y("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),OQ=lc(Y("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),FQ=lc(Y("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),BQ=lc(Y("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),UQ=lc(Y("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),zQ=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],VQ=i=>{const{variant:e,color:n,severity:r,classes:s}=i,o={root:["root",`color${We(n||r)}`,`${e}${We(n||r)}`,`${e}`],icon:["icon"],message:["message"],action:["action"]};return en(o,EQ,s)},$Q=Qe(ec,{name:"MuiAlert",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[n.variant],e[`${n.variant}${We(n.color||n.severity)}`]]}})(({theme:i})=>{const e=i.palette.mode==="light"?lC:cC,n=i.palette.mode==="light"?cC:lC;return z({},i.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(i.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"standard"},style:{color:i.vars?i.vars.palette.Alert[`${r}Color`]:e(i.palette[r].light,.6),backgroundColor:i.vars?i.vars.palette.Alert[`${r}StandardBg`]:n(i.palette[r].light,.9),[`& .${wI.icon}`]:i.vars?{color:i.vars.palette.Alert[`${r}IconColor`]}:{color:i.palette[r].main}}})),...Object.entries(i.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"outlined"},style:{color:i.vars?i.vars.palette.Alert[`${r}Color`]:e(i.palette[r].light,.6),border:`1px solid ${(i.vars||i).palette[r].light}`,[`& .${wI.icon}`]:i.vars?{color:i.vars.palette.Alert[`${r}IconColor`]}:{color:i.palette[r].main}}})),...Object.entries(i.palette).filter(([,r])=>r.main&&r.dark).map(([r])=>({props:{colorSeverity:r,variant:"filled"},style:z({fontWeight:i.typography.fontWeightMedium},i.vars?{color:i.vars.palette.Alert[`${r}FilledColor`],backgroundColor:i.vars.palette.Alert[`${r}FilledBg`]}:{backgroundColor:i.palette.mode==="dark"?i.palette[r].dark:i.palette[r].main,color:i.palette.getContrastText(i.palette[r].main)})}))]})}),GQ=Qe("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(i,e)=>e.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),HQ=Qe("div",{name:"MuiAlert",slot:"Message",overridesResolver:(i,e)=>e.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),TI=Qe("div",{name:"MuiAlert",slot:"Action",overridesResolver:(i,e)=>e.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),EI={success:Y(DQ,{fontSize:"inherit"}),warning:Y(OQ,{fontSize:"inherit"}),error:Y(FQ,{fontSize:"inherit"}),info:Y(BQ,{fontSize:"inherit"})},WQ=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiAlert"}),{action:s,children:o,className:a,closeText:l="Close",color:c,components:u={},componentsProps:d={},icon:h,iconMapping:f=EI,onClose:p,role:m="alert",severity:y="success",slotProps:v={},slots:g={},variant:_="standard"}=r,x=rt(r,zQ),b=z({},r,{color:c,severity:y,variant:_,colorSeverity:c||y}),S=VQ(b),T={slots:z({closeButton:u.CloseButton,closeIcon:u.CloseIcon},g),slotProps:z({},d,v)},[w,E]=vI("closeButton",{elementType:IQ,externalForwardedProps:T,ownerState:b}),[A,M]=vI("closeIcon",{elementType:UQ,externalForwardedProps:T,ownerState:b});return lt($Q,z({role:m,elevation:0,ownerState:b,className:ft(S.root,a),ref:n},x,{children:[h!==!1?Y(GQ,{ownerState:b,className:S.icon,children:h||f[y]||EI[y]}):null,Y(HQ,{ownerState:b,className:S.message,children:o}),s!=null?Y(TI,{ownerState:b,className:S.action,children:s}):null,s==null&&p?Y(TI,{ownerState:b,className:S.action,children:Y(w,z({size:"small","aria-label":l,title:l,color:"inherit",onClick:p},E,{children:Y(A,z({fontSize:"small"},M))}))}):null]}))}),Df=WQ;function jQ(i){return Zt("MuiTypography",i)}jt("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const qQ=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],XQ=i=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:s,variant:o,classes:a}=i,l={root:["root",o,i.align!=="inherit"&&`align${We(e)}`,n&&"gutterBottom",r&&"noWrap",s&&"paragraph"]};return en(l,jQ,a)},KQ=Qe("span",{name:"MuiTypography",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${We(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:i,ownerState:e})=>z({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&i.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),MI={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},YQ={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},ZQ=i=>YQ[i]||i,QQ=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiTypography"}),s=ZQ(r.color),o=pS(z({},r,{color:s})),{align:a="inherit",className:l,component:c,gutterBottom:u=!1,noWrap:d=!1,paragraph:h=!1,variant:f="body1",variantMapping:p=MI}=o,m=rt(o,qQ),y=z({},o,{align:a,color:s,className:l,component:c,gutterBottom:u,noWrap:d,paragraph:h,variant:f,variantMapping:p}),v=c||(h?"p":p[f]||MI[f])||"span",g=XQ(y);return Y(KQ,z({as:v,ref:n,ownerState:y,className:ft(g.root,l)},m))}),It=QQ;function JQ(i){return Zt("MuiAppBar",i)}jt("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const eJ=["className","color","enableColorOnDark","position"],tJ=i=>{const{color:e,position:n,classes:r}=i,s={root:["root",`color${We(e)}`,`position${We(n)}`]};return en(s,JQ,r)},Nv=(i,e)=>i?`${i==null?void 0:i.replace(")","")}, ${e})`:e,nJ=Qe(ec,{name:"MuiAppBar",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[`position${We(n.position)}`],e[`color${We(n.color)}`]]}})(({theme:i,ownerState:e})=>{const n=i.palette.mode==="light"?i.palette.grey[100]:i.palette.grey[900];return z({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},e.position==="fixed"&&{position:"fixed",zIndex:(i.vars||i).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},e.position==="absolute"&&{position:"absolute",zIndex:(i.vars||i).zIndex.appBar,top:0,left:"auto",right:0},e.position==="sticky"&&{position:"sticky",zIndex:(i.vars||i).zIndex.appBar,top:0,left:"auto",right:0},e.position==="static"&&{position:"static"},e.position==="relative"&&{position:"relative"},!i.vars&&z({},e.color==="default"&&{backgroundColor:n,color:i.palette.getContrastText(n)},e.color&&e.color!=="default"&&e.color!=="inherit"&&e.color!=="transparent"&&{backgroundColor:i.palette[e.color].main,color:i.palette[e.color].contrastText},e.color==="inherit"&&{color:"inherit"},i.palette.mode==="dark"&&!e.enableColorOnDark&&{backgroundColor:null,color:null},e.color==="transparent"&&z({backgroundColor:"transparent",color:"inherit"},i.palette.mode==="dark"&&{backgroundImage:"none"})),i.vars&&z({},e.color==="default"&&{"--AppBar-background":e.enableColorOnDark?i.vars.palette.AppBar.defaultBg:Nv(i.vars.palette.AppBar.darkBg,i.vars.palette.AppBar.defaultBg),"--AppBar-color":e.enableColorOnDark?i.vars.palette.text.primary:Nv(i.vars.palette.AppBar.darkColor,i.vars.palette.text.primary)},e.color&&!e.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":e.enableColorOnDark?i.vars.palette[e.color].main:Nv(i.vars.palette.AppBar.darkBg,i.vars.palette[e.color].main),"--AppBar-color":e.enableColorOnDark?i.vars.palette[e.color].contrastText:Nv(i.vars.palette.AppBar.darkColor,i.vars.palette[e.color].contrastText)},!["inherit","transparent"].includes(e.color)&&{backgroundColor:"var(--AppBar-background)"},{color:e.color==="inherit"?"inherit":"var(--AppBar-color)"},e.color==="transparent"&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))}),iJ=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiAppBar"}),{className:s,color:o="primary",enableColorOnDark:a=!1,position:l="fixed"}=r,c=rt(r,eJ),u=z({},r,{color:o,position:l,enableColorOnDark:a}),d=tJ(u);return Y(nJ,z({square:!0,component:"header",ownerState:u,elevation:4,className:ft(d.root,s,l==="fixed"&&"mui-fixed"),ref:n},c))}),rJ=iJ;function sJ(i){return typeof i=="function"?i():i}const oJ=I.forwardRef(function(e,n){const{children:r,container:s,disablePortal:o=!1}=e,[a,l]=I.useState(null),c=dr(I.isValidElement(r)?Hp(r):null,n);if(Ql(()=>{o||l(sJ(s)||document.body)},[s,o]),Ql(()=>{if(a&&!o)return oC(n,a),()=>{oC(n,null)}},[n,a,o]),o){if(I.isValidElement(r)){const u={ref:c};return I.cloneElement(r,u)}return Y(I.Fragment,{children:r})}return Y(I.Fragment,{children:a&&PP.createPortal(r,a)})}),aJ=oJ,lJ=lc(Y("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function cJ(i){return Zt("MuiChip",i)}const uJ=jt("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),yn=uJ,dJ=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],hJ=i=>{const{classes:e,disabled:n,size:r,color:s,iconColor:o,onDelete:a,clickable:l,variant:c}=i,u={root:["root",c,n&&"disabled",`size${We(r)}`,`color${We(s)}`,l&&"clickable",l&&`clickableColor${We(s)}`,a&&"deletable",a&&`deletableColor${We(s)}`,`${c}${We(s)}`],label:["label",`label${We(r)}`],avatar:["avatar",`avatar${We(r)}`,`avatarColor${We(s)}`],icon:["icon",`icon${We(r)}`,`iconColor${We(o)}`],deleteIcon:["deleteIcon",`deleteIcon${We(r)}`,`deleteIconColor${We(s)}`,`deleteIcon${We(c)}Color${We(s)}`]};return en(u,cJ,e)},fJ=Qe("div",{name:"MuiChip",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i,{color:r,iconColor:s,clickable:o,onDelete:a,size:l,variant:c}=n;return[{[`& .${yn.avatar}`]:e.avatar},{[`& .${yn.avatar}`]:e[`avatar${We(l)}`]},{[`& .${yn.avatar}`]:e[`avatarColor${We(r)}`]},{[`& .${yn.icon}`]:e.icon},{[`& .${yn.icon}`]:e[`icon${We(l)}`]},{[`& .${yn.icon}`]:e[`iconColor${We(s)}`]},{[`& .${yn.deleteIcon}`]:e.deleteIcon},{[`& .${yn.deleteIcon}`]:e[`deleteIcon${We(l)}`]},{[`& .${yn.deleteIcon}`]:e[`deleteIconColor${We(r)}`]},{[`& .${yn.deleteIcon}`]:e[`deleteIcon${We(c)}Color${We(r)}`]},e.root,e[`size${We(l)}`],e[`color${We(r)}`],o&&e.clickable,o&&r!=="default"&&e[`clickableColor${We(r)})`],a&&e.deletable,a&&r!=="default"&&e[`deletableColor${We(r)}`],e[c],e[`${c}${We(r)}`]]}})(({theme:i,ownerState:e})=>{const n=i.palette.mode==="light"?i.palette.grey[700]:i.palette.grey[300];return z({maxWidth:"100%",fontFamily:i.typography.fontFamily,fontSize:i.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(i.vars||i).palette.text.primary,backgroundColor:(i.vars||i).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:i.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${yn.disabled}`]:{opacity:(i.vars||i).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${yn.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:i.vars?i.vars.palette.Chip.defaultAvatarColor:n,fontSize:i.typography.pxToRem(12)},[`& .${yn.avatarColorPrimary}`]:{color:(i.vars||i).palette.primary.contrastText,backgroundColor:(i.vars||i).palette.primary.dark},[`& .${yn.avatarColorSecondary}`]:{color:(i.vars||i).palette.secondary.contrastText,backgroundColor:(i.vars||i).palette.secondary.dark},[`& .${yn.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:i.typography.pxToRem(10)},[`& .${yn.icon}`]:z({marginLeft:5,marginRight:-6},e.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},e.iconColor===e.color&&z({color:i.vars?i.vars.palette.Chip.defaultIconColor:n},e.color!=="default"&&{color:"inherit"})),[`& .${yn.deleteIcon}`]:z({WebkitTapHighlightColor:"transparent",color:i.vars?`rgba(${i.vars.palette.text.primaryChannel} / 0.26)`:si(i.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:i.vars?`rgba(${i.vars.palette.text.primaryChannel} / 0.4)`:si(i.palette.text.primary,.4)}},e.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},e.color!=="default"&&{color:i.vars?`rgba(${i.vars.palette[e.color].contrastTextChannel} / 0.7)`:si(i.palette[e.color].contrastText,.7),"&:hover, &:active":{color:(i.vars||i).palette[e.color].contrastText}})},e.size==="small"&&{height:24},e.color!=="default"&&{backgroundColor:(i.vars||i).palette[e.color].main,color:(i.vars||i).palette[e.color].contrastText},e.onDelete&&{[`&.${yn.focusVisible}`]:{backgroundColor:i.vars?`rgba(${i.vars.palette.action.selectedChannel} / calc(${i.vars.palette.action.selectedOpacity} + ${i.vars.palette.action.focusOpacity}))`:si(i.palette.action.selected,i.palette.action.selectedOpacity+i.palette.action.focusOpacity)}},e.onDelete&&e.color!=="default"&&{[`&.${yn.focusVisible}`]:{backgroundColor:(i.vars||i).palette[e.color].dark}})},({theme:i,ownerState:e})=>z({},e.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:i.vars?`rgba(${i.vars.palette.action.selectedChannel} / calc(${i.vars.palette.action.selectedOpacity} + ${i.vars.palette.action.hoverOpacity}))`:si(i.palette.action.selected,i.palette.action.selectedOpacity+i.palette.action.hoverOpacity)},[`&.${yn.focusVisible}`]:{backgroundColor:i.vars?`rgba(${i.vars.palette.action.selectedChannel} / calc(${i.vars.palette.action.selectedOpacity} + ${i.vars.palette.action.focusOpacity}))`:si(i.palette.action.selected,i.palette.action.selectedOpacity+i.palette.action.focusOpacity)},"&:active":{boxShadow:(i.vars||i).shadows[1]}},e.clickable&&e.color!=="default"&&{[`&:hover, &.${yn.focusVisible}`]:{backgroundColor:(i.vars||i).palette[e.color].dark}}),({theme:i,ownerState:e})=>z({},e.variant==="outlined"&&{backgroundColor:"transparent",border:i.vars?`1px solid ${i.vars.palette.Chip.defaultBorder}`:`1px solid ${i.palette.mode==="light"?i.palette.grey[400]:i.palette.grey[700]}`,[`&.${yn.clickable}:hover`]:{backgroundColor:(i.vars||i).palette.action.hover},[`&.${yn.focusVisible}`]:{backgroundColor:(i.vars||i).palette.action.focus},[`& .${yn.avatar}`]:{marginLeft:4},[`& .${yn.avatarSmall}`]:{marginLeft:2},[`& .${yn.icon}`]:{marginLeft:4},[`& .${yn.iconSmall}`]:{marginLeft:2},[`& .${yn.deleteIcon}`]:{marginRight:5},[`& .${yn.deleteIconSmall}`]:{marginRight:3}},e.variant==="outlined"&&e.color!=="default"&&{color:(i.vars||i).palette[e.color].main,border:`1px solid ${i.vars?`rgba(${i.vars.palette[e.color].mainChannel} / 0.7)`:si(i.palette[e.color].main,.7)}`,[`&.${yn.clickable}:hover`]:{backgroundColor:i.vars?`rgba(${i.vars.palette[e.color].mainChannel} / ${i.vars.palette.action.hoverOpacity})`:si(i.palette[e.color].main,i.palette.action.hoverOpacity)},[`&.${yn.focusVisible}`]:{backgroundColor:i.vars?`rgba(${i.vars.palette[e.color].mainChannel} / ${i.vars.palette.action.focusOpacity})`:si(i.palette[e.color].main,i.palette.action.focusOpacity)},[`& .${yn.deleteIcon}`]:{color:i.vars?`rgba(${i.vars.palette[e.color].mainChannel} / 0.7)`:si(i.palette[e.color].main,.7),"&:hover, &:active":{color:(i.vars||i).palette[e.color].main}}})),pJ=Qe("span",{name:"MuiChip",slot:"Label",overridesResolver:(i,e)=>{const{ownerState:n}=i,{size:r}=n;return[e.label,e[`label${We(r)}`]]}})(({ownerState:i})=>z({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},i.variant==="outlined"&&{paddingLeft:11,paddingRight:11},i.size==="small"&&{paddingLeft:8,paddingRight:8},i.size==="small"&&i.variant==="outlined"&&{paddingLeft:7,paddingRight:7}));function AI(i){return i.key==="Backspace"||i.key==="Delete"}const mJ=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiChip"}),{avatar:s,className:o,clickable:a,color:l="default",component:c,deleteIcon:u,disabled:d=!1,icon:h,label:f,onClick:p,onDelete:m,onKeyDown:y,onKeyUp:v,size:g="medium",variant:_="filled",tabIndex:x,skipFocusWhenDisabled:b=!1}=r,S=rt(r,dJ),T=I.useRef(null),w=dr(T,n),E=X=>{X.stopPropagation(),m&&m(X)},A=X=>{X.currentTarget===X.target&&AI(X)&&X.preventDefault(),y&&y(X)},M=X=>{X.currentTarget===X.target&&(m&&AI(X)?m(X):X.key==="Escape"&&T.current&&T.current.blur()),v&&v(X)},R=a!==!1&&p?!0:a,F=R||m?Ld:c||"div",B=z({},r,{component:F,disabled:d,size:g,color:l,iconColor:I.isValidElement(h)&&h.props.color||l,onDelete:!!m,clickable:R,variant:_}),C=hJ(B),L=F===Ld?z({component:c||"div",focusVisibleClassName:C.focusVisible},m&&{disableRipple:!0}):{};let P=null;m&&(P=u&&I.isValidElement(u)?I.cloneElement(u,{className:ft(u.props.className,C.deleteIcon),onClick:E}):Y(lJ,{className:ft(C.deleteIcon),onClick:E}));let W=null;s&&I.isValidElement(s)&&(W=I.cloneElement(s,{className:ft(C.avatar,s.props.className)}));let D=null;return h&&I.isValidElement(h)&&(D=I.cloneElement(h,{className:ft(C.icon,h.props.className)})),lt(fJ,z({as:F,className:ft(C.root,o),disabled:R&&d?!0:void 0,onClick:p,onKeyDown:A,onKeyUp:M,ref:w,tabIndex:b&&d?-1:x,ownerState:B},L,S,{children:[W||D,Y(pJ,{className:ft(C.label),ownerState:B,children:f}),P]}))}),fC=mJ,gJ=["onChange","maxRows","minRows","style","value"];function kv(i){return parseInt(i,10)||0}const yJ={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function vJ(i){for(const e in i)return!1;return!0}function CI(i){return vJ(i)||i.outerHeightStyle===0&&!i.overflowing}const xJ=I.forwardRef(function(e,n){const{onChange:r,maxRows:s,minRows:o=1,style:a,value:l}=e,c=rt(e,gJ),{current:u}=I.useRef(l!=null),d=I.useRef(null),h=dr(n,d),f=I.useRef(null),p=I.useRef(null),m=I.useCallback(()=>{const x=d.current,b=p.current;if(!x||!b)return;const T=Jl(x).getComputedStyle(x);if(T.width==="0px")return{outerHeightStyle:0,overflowing:!1};b.style.width=T.width,b.value=x.value||e.placeholder||"x",b.value.slice(-1)===`
`&&(b.value+=" ");const w=T.boxSizing,E=kv(T.paddingBottom)+kv(T.paddingTop),A=kv(T.borderBottomWidth)+kv(T.borderTopWidth),M=b.scrollHeight;b.value="x";const R=b.scrollHeight;let F=M;o&&(F=Math.max(Number(o)*R,F)),s&&(F=Math.min(Number(s)*R,F)),F=Math.max(F,R);const B=F+(w==="border-box"?E+A:0),C=Math.abs(F-M)<=1;return{outerHeightStyle:B,overflowing:C}},[s,o,e.placeholder]),y=Ks(()=>{const x=d.current,b=m();if(!x||!b||CI(b))return!1;const S=b.outerHeightStyle;return f.current!=null&&f.current!==S}),v=I.useCallback(()=>{const x=d.current,b=m();if(!x||!b||CI(b))return;const S=b.outerHeightStyle;f.current!==S&&(f.current=S,x.style.height=`${S}px`),x.style.overflow=b.overflowing?"hidden":""},[m]),g=I.useRef(-1);Ql(()=>{const x=ES(v),b=d==null?void 0:d.current;if(!b)return;const S=Jl(b);S.addEventListener("resize",x);let T;return typeof ResizeObserver<"u"&&(T=new ResizeObserver(()=>{y()&&(T.unobserve(b),cancelAnimationFrame(g.current),v(),g.current=requestAnimationFrame(()=>{T.observe(b)}))}),T.observe(b)),()=>{x.clear(),cancelAnimationFrame(g.current),S.removeEventListener("resize",x),T&&T.disconnect()}},[m,v,y]),Ql(()=>{v()});const _=x=>{u||v(),r&&r(x)};return lt(I.Fragment,{children:[Y("textarea",z({value:l,onChange:_,ref:h,rows:o,style:a},c)),Y("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:p,tabIndex:-1,style:z({},yJ.shadow,a,{paddingTop:0,paddingBottom:0})})]})}),_J=xJ;function qp({props:i,states:e,muiFormControl:n}){return e.reduce((r,s)=>(r[s]=i[s],n&&typeof i[s]>"u"&&(r[s]=n[s]),r),{})}const bJ=I.createContext(void 0),oN=bJ;function Xp(){return I.useContext(oN)}function RI(i){return i!=null&&!(Array.isArray(i)&&i.length===0)}function Ob(i,e=!1){return i&&(RI(i.value)&&i.value!==""||e&&RI(i.defaultValue)&&i.defaultValue!=="")}function SJ(i){return i.startAdornment}function wJ(i){return Zt("MuiInputBase",i)}const TJ=jt("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),lp=TJ,EJ=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],RS=(i,e)=>{const{ownerState:n}=i;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${We(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},PS=(i,e)=>{const{ownerState:n}=i;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},MJ=i=>{const{classes:e,color:n,disabled:r,error:s,endAdornment:o,focused:a,formControl:l,fullWidth:c,hiddenLabel:u,multiline:d,readOnly:h,size:f,startAdornment:p,type:m}=i,y={root:["root",`color${We(n)}`,r&&"disabled",s&&"error",c&&"fullWidth",a&&"focused",l&&"formControl",f&&f!=="medium"&&`size${We(f)}`,d&&"multiline",p&&"adornedStart",o&&"adornedEnd",u&&"hiddenLabel",h&&"readOnly"],input:["input",r&&"disabled",m==="search"&&"inputTypeSearch",d&&"inputMultiline",f==="small"&&"inputSizeSmall",u&&"inputHiddenLabel",p&&"inputAdornedStart",o&&"inputAdornedEnd",h&&"readOnly"]};return en(y,wJ,e)},NS=Qe("div",{name:"MuiInputBase",slot:"Root",overridesResolver:RS})(({theme:i,ownerState:e})=>z({},i.typography.body1,{color:(i.vars||i).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${lp.disabled}`]:{color:(i.vars||i).palette.text.disabled,cursor:"default"}},e.multiline&&z({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),kS=Qe("input",{name:"MuiInputBase",slot:"Input",overridesResolver:PS})(({theme:i,ownerState:e})=>{const n=i.palette.mode==="light",r=z({color:"currentColor"},i.vars?{opacity:i.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},{transition:i.transitions.create("opacity",{duration:i.transitions.duration.shorter})}),s={opacity:"0 !important"},o=i.vars?{opacity:i.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return z({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${lp.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus:-ms-input-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${lp.disabled}`]:{opacity:1,WebkitTextFillColor:(i.vars||i).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),AJ=Y(eV,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),CJ=I.forwardRef(function(e,n){var r;const s=Qt({props:e,name:"MuiInputBase"}),{"aria-describedby":o,autoComplete:a,autoFocus:l,className:c,components:u={},componentsProps:d={},defaultValue:h,disabled:f,disableInjectingGlobalStyles:p,endAdornment:m,fullWidth:y=!1,id:v,inputComponent:g="input",inputProps:_={},inputRef:x,maxRows:b,minRows:S,multiline:T=!1,name:w,onBlur:E,onChange:A,onClick:M,onFocus:R,onKeyDown:F,onKeyUp:B,placeholder:C,readOnly:L,renderSuffix:P,rows:W,slotProps:D={},slots:X={},startAdornment:q,type:J="text",value:se}=s,de=rt(s,EJ),G=_.value!=null?_.value:se,{current:Q}=I.useRef(G!=null),ee=I.useRef(),ie=I.useCallback(Pe=>{},[]),Se=dr(ee,x,_.ref,ie),[Fe,Be]=I.useState(!1),ct=Xp(),xt=qp({props:s,muiFormControl:ct,states:["color","disabled","error","hiddenLabel","size","required","filled"]});xt.focused=ct?ct.focused:Fe,I.useEffect(()=>{!ct&&f&&Fe&&(Be(!1),E&&E())},[ct,f,Fe,E]);const He=ct&&ct.onFilled,Z=ct&&ct.onEmpty,Nt=I.useCallback(Pe=>{Ob(Pe)?He&&He():Z&&Z()},[He,Z]);Ql(()=>{Q&&Nt({value:G})},[G,Nt,Q]);const Rt=Pe=>{if(xt.disabled){Pe.stopPropagation();return}R&&R(Pe),_.onFocus&&_.onFocus(Pe),ct&&ct.onFocus?ct.onFocus(Pe):Be(!0)},mt=Pe=>{E&&E(Pe),_.onBlur&&_.onBlur(Pe),ct&&ct.onBlur?ct.onBlur(Pe):Be(!1)},Je=(Pe,...Ce)=>{if(!Q){const vt=Pe.target||ee.current;if(vt==null)throw new Error(kd(1));Nt({value:vt.value})}_.onChange&&_.onChange(Pe,...Ce),A&&A(Pe,...Ce)};I.useEffect(()=>{Nt(ee.current)},[]);const qt=Pe=>{ee.current&&Pe.currentTarget===Pe.target&&ee.current.focus(),M&&M(Pe)};let et=g,j=_;T&&et==="input"&&(W?j=z({type:void 0,minRows:W,maxRows:W},j):j=z({type:void 0,maxRows:b,minRows:S},j),et=_J);const O=Pe=>{Nt(Pe.animationName==="mui-auto-fill-cancel"?ee.current:{value:"x"})};I.useEffect(()=>{ct&&ct.setAdornedStart(!!q)},[ct,q]);const ce=z({},s,{color:xt.color||"primary",disabled:xt.disabled,endAdornment:m,error:xt.error,focused:xt.focused,formControl:ct,fullWidth:y,hiddenLabel:xt.hiddenLabel,multiline:T,size:xt.size,startAdornment:q,type:J}),ye=MJ(ce),Ae=X.root||u.Root||NS,we=D.root||d.root||{},ot=X.input||u.Input||kS;return j=z({},j,(r=D.input)!=null?r:d.input),lt(I.Fragment,{children:[!p&&AJ,lt(Ae,z({},we,!ap(Ae)&&{ownerState:z({},ce,we.ownerState)},{ref:n,onClick:qt},de,{className:ft(ye.root,we.className,c,L&&"MuiInputBase-readOnly"),children:[q,Y(oN.Provider,{value:null,children:Y(ot,z({ownerState:ce,"aria-invalid":xt.error,"aria-describedby":o,autoComplete:a,autoFocus:l,defaultValue:h,disabled:xt.disabled,id:v,onAnimationStart:O,name:w,placeholder:C,readOnly:L,required:xt.required,rows:W,value:G,onKeyDown:F,onKeyUp:B,type:J},j,!ap(ot)&&{as:et,ownerState:z({},ce,j.ownerState)},{ref:Se,className:ft(ye.input,j.className,L&&"MuiInputBase-readOnly"),onBlur:mt,onChange:Je,onFocus:Rt}))}),m,P?P(z({},xt,{startAdornment:q})):null]}))]})}),aN=CJ;function RJ(i){return Zt("MuiInput",i)}const PJ=z({},lp,jt("MuiInput",["root","underline","input"])),Tm=PJ;function NJ(i){return Zt("MuiOutlinedInput",i)}const kJ=z({},lp,jt("MuiOutlinedInput",["root","notchedOutline","input"])),gc=kJ;function LJ(i){return Zt("MuiFilledInput",i)}const IJ=z({},lp,jt("MuiFilledInput",["root","underline","input"])),Iu=IJ,DJ=lc(Y("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),OJ=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],FJ={entering:{opacity:1},entered:{opacity:1}},BJ=I.forwardRef(function(e,n){const r=L0(),s={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:o,appear:a=!0,children:l,easing:c,in:u,onEnter:d,onEntered:h,onEntering:f,onExit:p,onExited:m,onExiting:y,style:v,timeout:g=s,TransitionComponent:_=nV}=e,x=rt(e,OJ),b=I.useRef(null),S=dr(b,Hp(l),n),T=C=>L=>{if(C){const P=b.current;L===void 0?C(P):C(P,L)}},w=T(f),E=T((C,L)=>{rV(C);const P=Db({style:v,timeout:g,easing:c},{mode:"enter"});C.style.webkitTransition=r.transitions.create("opacity",P),C.style.transition=r.transitions.create("opacity",P),d&&d(C,L)}),A=T(h),M=T(y),R=T(C=>{const L=Db({style:v,timeout:g,easing:c},{mode:"exit"});C.style.webkitTransition=r.transitions.create("opacity",L),C.style.transition=r.transitions.create("opacity",L),p&&p(C)}),F=T(m);return Y(_,z({appear:a,in:u,nodeRef:b,onEnter:E,onEntered:A,onEntering:w,onExit:R,onExited:F,onExiting:M,addEndListener:C=>{o&&o(b.current,C)},timeout:g},x,{children:(C,L)=>I.cloneElement(l,z({style:z({opacity:0,visibility:C==="exited"&&!u?"hidden":void 0},FJ[C],v,l.props.style),ref:S},L))}))}),UJ=BJ;function zJ(i){return Zt("MuiBackdrop",i)}jt("MuiBackdrop",["root","invisible"]);const VJ=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],$J=i=>{const{classes:e,invisible:n}=i;return en({root:["root",n&&"invisible"]},zJ,e)},GJ=Qe("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.invisible&&e.invisible]}})(({ownerState:i})=>z({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},i.invisible&&{backgroundColor:"transparent"})),HJ=I.forwardRef(function(e,n){var r,s,o;const a=Qt({props:e,name:"MuiBackdrop"}),{children:l,className:c,component:u="div",components:d={},componentsProps:h={},invisible:f=!1,open:p,slotProps:m={},slots:y={},TransitionComponent:v=UJ,transitionDuration:g}=a,_=rt(a,VJ),x=z({},a,{component:u,invisible:f}),b=$J(x),S=(r=m.root)!=null?r:h.root;return Y(v,z({in:p,timeout:g},_,{children:Y(GJ,z({"aria-hidden":!0},S,{as:(s=(o=y.root)!=null?o:d.Root)!=null?s:u,className:ft(b.root,c,S==null?void 0:S.className),ownerState:z({},x,S==null?void 0:S.ownerState),classes:b,ref:n,children:l}))}))}),WJ=HJ,jJ=jt("MuiBox",["root"]),qJ=jJ,XJ=tN(),KJ=gK({themeId:sp,defaultTheme:XJ,defaultClassName:qJ.root,generateClassName:R5.generate}),An=KJ;function YJ(i){return Zt("MuiButton",i)}const ZJ=jt("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Lv=ZJ,QJ=I.createContext({}),JJ=QJ,eee=I.createContext(void 0),tee=eee,nee=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],iee=i=>{const{color:e,disableElevation:n,fullWidth:r,size:s,variant:o,classes:a}=i,l={root:["root",o,`${o}${We(e)}`,`size${We(s)}`,`${o}Size${We(s)}`,`color${We(e)}`,n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${We(s)}`],endIcon:["icon","endIcon",`iconSize${We(s)}`]},c=en(l,YJ,a);return z({},a,c)},sV=i=>z({},i.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},i.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},i.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),ree=Qe(Ld,{shouldForwardProp:i=>xa(i)||i==="classes",name:"MuiButton",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[n.variant],e[`${n.variant}${We(n.color)}`],e[`size${We(n.size)}`],e[`${n.variant}Size${We(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:i,ownerState:e})=>{var n,r;const s=i.palette.mode==="light"?i.palette.grey[300]:i.palette.grey[800],o=i.palette.mode==="light"?i.palette.grey.A100:i.palette.grey[700];return z({},i.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(i.vars||i).shape.borderRadius,transition:i.transitions.create(["background-color","box-shadow","border-color","color"],{duration:i.transitions.duration.short}),"&:hover":z({textDecoration:"none",backgroundColor:i.vars?`rgba(${i.vars.palette.text.primaryChannel} / ${i.vars.palette.action.hoverOpacity})`:si(i.palette.text.primary,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:i.vars?`rgba(${i.vars.palette[e.color].mainChannel} / ${i.vars.palette.action.hoverOpacity})`:si(i.palette[e.color].main,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(i.vars||i).palette[e.color].main}`,backgroundColor:i.vars?`rgba(${i.vars.palette[e.color].mainChannel} / ${i.vars.palette.action.hoverOpacity})`:si(i.palette[e.color].main,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:i.vars?i.vars.palette.Button.inheritContainedHoverBg:o,boxShadow:(i.vars||i).shadows[4],"@media (hover: none)":{boxShadow:(i.vars||i).shadows[2],backgroundColor:(i.vars||i).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(i.vars||i).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(i.vars||i).palette[e.color].main}}),"&:active":z({},e.variant==="contained"&&{boxShadow:(i.vars||i).shadows[8]}),[`&.${Lv.focusVisible}`]:z({},e.variant==="contained"&&{boxShadow:(i.vars||i).shadows[6]}),[`&.${Lv.disabled}`]:z({color:(i.vars||i).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(i.vars||i).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(i.vars||i).palette.action.disabled,boxShadow:(i.vars||i).shadows[0],backgroundColor:(i.vars||i).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(i.vars||i).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(i.vars||i).palette[e.color].main,border:i.vars?`1px solid rgba(${i.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${si(i.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:i.vars?i.vars.palette.text.primary:(n=(r=i.palette).getContrastText)==null?void 0:n.call(r,i.palette.grey[300]),backgroundColor:i.vars?i.vars.palette.Button.inheritContainedBg:s,boxShadow:(i.vars||i).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(i.vars||i).palette[e.color].contrastText,backgroundColor:(i.vars||i).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:i.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:i.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:i.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:i.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:i.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:i.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:i})=>i.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Lv.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Lv.disabled}`]:{boxShadow:"none"}}),see=Qe("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.startIcon,e[`iconSize${We(n.size)}`]]}})(({ownerState:i})=>z({display:"inherit",marginRight:8,marginLeft:-4},i.size==="small"&&{marginLeft:-2},sV(i))),oee=Qe("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.endIcon,e[`iconSize${We(n.size)}`]]}})(({ownerState:i})=>z({display:"inherit",marginRight:-4,marginLeft:8},i.size==="small"&&{marginRight:-2},sV(i))),aee=I.forwardRef(function(e,n){const r=I.useContext(JJ),s=I.useContext(tee),o=Ay(r,e),a=Qt({props:o,name:"MuiButton"}),{children:l,color:c="primary",component:u="button",className:d,disabled:h=!1,disableElevation:f=!1,disableFocusRipple:p=!1,endIcon:m,focusVisibleClassName:y,fullWidth:v=!1,size:g="medium",startIcon:_,type:x,variant:b="text"}=a,S=rt(a,nee),T=z({},a,{color:c,component:u,disabled:h,disableElevation:f,disableFocusRipple:p,fullWidth:v,size:g,type:x,variant:b}),w=iee(T),E=_&&Y(see,{className:w.startIcon,ownerState:T,children:_}),A=m&&Y(oee,{className:w.endIcon,ownerState:T,children:m}),M=s||"";return lt(ree,z({ownerState:T,className:ft(r.className,w.root,d,M),component:u,disabled:h,focusRipple:!p,focusVisibleClassName:ft(w.focusVisible,y),ref:n,type:x},S,{classes:w,children:[E,l,A]}))}),Ys=aee;function lee(i){return Zt("MuiCard",i)}jt("MuiCard",["root"]);const cee=["className","raised"],uee=i=>{const{classes:e}=i;return en({root:["root"]},lee,e)},dee=Qe(ec,{name:"MuiCard",slot:"Root",overridesResolver:(i,e)=>e.root})(()=>({overflow:"hidden"})),hee=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiCard"}),{className:s,raised:o=!1}=r,a=rt(r,cee),l=z({},r,{raised:o}),c=uee(l);return Y(dee,z({className:ft(c.root,s),elevation:o?8:void 0,ref:n,ownerState:l},a))}),oV=hee;function fee(i){return Zt("MuiCardActions",i)}jt("MuiCardActions",["root","spacing"]);const pee=["disableSpacing","className"],mee=i=>{const{classes:e,disableSpacing:n}=i;return en({root:["root",!n&&"spacing"]},fee,e)},gee=Qe("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,!n.disableSpacing&&e.spacing]}})(({ownerState:i})=>z({display:"flex",alignItems:"center",padding:8},!i.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),yee=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiCardActions"}),{disableSpacing:s=!1,className:o}=r,a=rt(r,pee),l=z({},r,{disableSpacing:s}),c=mee(l);return Y(gee,z({className:ft(c.root,o),ownerState:l,ref:n},a))}),vee=yee;function xee(i){return Zt("MuiCardContent",i)}jt("MuiCardContent",["root"]);const _ee=["className","component"],bee=i=>{const{classes:e}=i;return en({root:["root"]},xee,e)},See=Qe("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(i,e)=>e.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),wee=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiCardContent"}),{className:s,component:o="div"}=r,a=rt(r,_ee),l=z({},r,{component:o}),c=bee(l);return Y(See,z({as:o,className:ft(c.root,s),ownerState:l,ref:n},a))}),aV=wee;function Tee(i){return Zt("MuiCircularProgress",i)}jt("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Eee=["className","color","disableShrink","size","style","thickness","value","variant"];let LS=i=>i,PI,NI,kI,LI;const yc=44,Mee=Gp(PI||(PI=LS`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),Aee=Gp(NI||(NI=LS`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),Cee=i=>{const{classes:e,variant:n,color:r,disableShrink:s}=i,o={root:["root",n,`color${We(r)}`],svg:["svg"],circle:["circle",`circle${We(n)}`,s&&"circleDisableShrink"]};return en(o,Tee,e)},Ree=Qe("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[n.variant],e[`color${We(n.color)}`]]}})(({ownerState:i,theme:e})=>z({display:"inline-block"},i.variant==="determinate"&&{transition:e.transitions.create("transform")},i.color!=="inherit"&&{color:(e.vars||e).palette[i.color].main}),({ownerState:i})=>i.variant==="indeterminate"&&sS(kI||(kI=LS`
      animation: ${0} 1.4s linear infinite;
    `),Mee)),Pee=Qe("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(i,e)=>e.svg})({display:"block"}),Nee=Qe("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.circle,e[`circle${We(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(({ownerState:i,theme:e})=>z({stroke:"currentColor"},i.variant==="determinate"&&{transition:e.transitions.create("stroke-dashoffset")},i.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:i})=>i.variant==="indeterminate"&&!i.disableShrink&&sS(LI||(LI=LS`
      animation: ${0} 1.4s ease-in-out infinite;
    `),Aee)),kee=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiCircularProgress"}),{className:s,color:o="primary",disableShrink:a=!1,size:l=40,style:c,thickness:u=3.6,value:d=0,variant:h="indeterminate"}=r,f=rt(r,Eee),p=z({},r,{color:o,disableShrink:a,size:l,thickness:u,value:d,variant:h}),m=Cee(p),y={},v={},g={};if(h==="determinate"){const _=2*Math.PI*((yc-u)/2);y.strokeDasharray=_.toFixed(3),g["aria-valuenow"]=Math.round(d),y.strokeDashoffset=`${((100-d)/100*_).toFixed(3)}px`,v.transform="rotate(-90deg)"}return Y(Ree,z({className:ft(m.root,s),style:z({width:l,height:l},v,c),ownerState:p,ref:n,role:"progressbar"},g,f,{children:Y(Pee,{className:m.svg,ownerState:p,viewBox:`${yc/2} ${yc/2} ${yc} ${yc}`,children:Y(Nee,{className:m.circle,style:y,ownerState:p,cx:yc,cy:yc,r:(yc-u)/2,fill:"none",strokeWidth:u})})}))}),Py=kee;function II(i){return i.substring(2).toLowerCase()}function Lee(i,e){return e.documentElement.clientWidth<i.clientX||e.documentElement.clientHeight<i.clientY}function Iee(i){const{children:e,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:s,touchEvent:o="onTouchEnd"}=i,a=I.useRef(!1),l=I.useRef(null),c=I.useRef(!1),u=I.useRef(!1);I.useEffect(()=>(setTimeout(()=>{c.current=!0},0),()=>{c.current=!1}),[]);const d=dr(Hp(e),l),h=Ks(m=>{const y=u.current;u.current=!1;const v=Sr(l.current);if(!c.current||!l.current||"clientX"in m&&Lee(m,v))return;if(a.current){a.current=!1;return}let g;m.composedPath?g=m.composedPath().indexOf(l.current)>-1:g=!v.documentElement.contains(m.target)||l.current.contains(m.target),!g&&(n||!y)&&s(m)}),f=m=>y=>{u.current=!0;const v=e.props[m];v&&v(y)},p={ref:d};return o!==!1&&(p[o]=f(o)),I.useEffect(()=>{if(o!==!1){const m=II(o),y=Sr(l.current),v=()=>{a.current=!0};return y.addEventListener(m,h),y.addEventListener("touchmove",v),()=>{y.removeEventListener(m,h),y.removeEventListener("touchmove",v)}}},[h,o]),r!==!1&&(p[r]=f(r)),I.useEffect(()=>{if(r!==!1){const m=II(r),y=Sr(l.current);return y.addEventListener(m,h),()=>{y.removeEventListener(m,h)}}},[h,r]),Y(I.Fragment,{children:I.cloneElement(e,p)})}const Dee=mY({createStyledComponent:Qe("div",{name:"MuiContainer",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[`maxWidth${We(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),useThemeProps:i=>Qt({props:i,name:"MuiContainer"})}),DI=Dee;function Oee(i){const e=Sr(i);return e.body===i?Jl(i).innerWidth>e.documentElement.clientWidth:i.scrollHeight>i.clientHeight}function Vg(i,e){e?i.setAttribute("aria-hidden","true"):i.removeAttribute("aria-hidden")}function OI(i){return parseInt(Jl(i).getComputedStyle(i).paddingRight,10)||0}function Fee(i){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(i.tagName)!==-1,r=i.tagName==="INPUT"&&i.getAttribute("type")==="hidden";return n||r}function FI(i,e,n,r,s){const o=[e,n,...r];[].forEach.call(i.children,a=>{const l=o.indexOf(a)===-1,c=!Fee(a);l&&c&&Vg(a,s)})}function xT(i,e){let n=-1;return i.some((r,s)=>e(r)?(n=s,!0):!1),n}function Bee(i,e){const n=[],r=i.container;if(!e.disableScrollLock){if(Oee(r)){const a=D5(Sr(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${OI(r)+a}px`;const l=Sr(r).querySelectorAll(".mui-fixed");[].forEach.call(l,c=>{n.push({value:c.style.paddingRight,property:"padding-right",el:c}),c.style.paddingRight=`${OI(c)+a}px`})}let o;if(r.parentNode instanceof DocumentFragment)o=Sr(r).body;else{const a=r.parentElement,l=Jl(r);o=(a==null?void 0:a.nodeName)==="HTML"&&l.getComputedStyle(a).overflowY==="scroll"?a:r}n.push({value:o.style.overflow,property:"overflow",el:o},{value:o.style.overflowX,property:"overflow-x",el:o},{value:o.style.overflowY,property:"overflow-y",el:o}),o.style.overflow="hidden"}return()=>{n.forEach(({value:o,el:a,property:l})=>{o?a.style.setProperty(l,o):a.style.removeProperty(l)})}}function Uee(i){const e=[];return[].forEach.call(i.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class zee{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&Vg(e.modalRef,!1);const s=Uee(n);FI(n,e.mount,e.modalRef,s,!0);const o=xT(this.containers,a=>a.container===n);return o!==-1?(this.containers[o].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:s}),r)}mount(e,n){const r=xT(this.containers,o=>o.modals.indexOf(e)!==-1),s=this.containers[r];s.restore||(s.restore=Bee(s,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const s=xT(this.containers,a=>a.modals.indexOf(e)!==-1),o=this.containers[s];if(o.modals.splice(o.modals.indexOf(e),1),this.modals.splice(r,1),o.modals.length===0)o.restore&&o.restore(),e.modalRef&&Vg(e.modalRef,n),FI(o.container,e.mount,e.modalRef,o.hiddenSiblings,!1),this.containers.splice(s,1);else{const a=o.modals[o.modals.length-1];a.modalRef&&Vg(a.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const Vee=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function $ee(i){const e=parseInt(i.getAttribute("tabindex")||"",10);return Number.isNaN(e)?i.contentEditable==="true"||(i.nodeName==="AUDIO"||i.nodeName==="VIDEO"||i.nodeName==="DETAILS")&&i.getAttribute("tabindex")===null?0:i.tabIndex:e}function Gee(i){if(i.tagName!=="INPUT"||i.type!=="radio"||!i.name)return!1;const e=r=>i.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${i.name}"]:checked`);return n||(n=e(`[name="${i.name}"]`)),n!==i}function Hee(i){return!(i.disabled||i.tagName==="INPUT"&&i.type==="hidden"||Gee(i))}function Wee(i){const e=[],n=[];return Array.from(i.querySelectorAll(Vee)).forEach((r,s)=>{const o=$ee(r);o===-1||!Hee(r)||(o===0?e.push(r):n.push({documentOrder:s,tabIndex:o,node:r}))}),n.sort((r,s)=>r.tabIndex===s.tabIndex?r.documentOrder-s.documentOrder:r.tabIndex-s.tabIndex).map(r=>r.node).concat(e)}function jee(){return!0}function qee(i){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:s=!1,getTabbable:o=Wee,isEnabled:a=jee,open:l}=i,c=I.useRef(!1),u=I.useRef(null),d=I.useRef(null),h=I.useRef(null),f=I.useRef(null),p=I.useRef(!1),m=I.useRef(null),y=dr(Hp(e),m),v=I.useRef(null);I.useEffect(()=>{!l||!m.current||(p.current=!n)},[n,l]),I.useEffect(()=>{if(!l||!m.current)return;const x=Sr(m.current);return m.current.contains(x.activeElement)||(m.current.hasAttribute("tabIndex")||m.current.setAttribute("tabIndex","-1"),p.current&&m.current.focus()),()=>{s||(h.current&&h.current.focus&&(c.current=!0,h.current.focus()),h.current=null)}},[l]),I.useEffect(()=>{if(!l||!m.current)return;const x=Sr(m.current),b=w=>{v.current=w,!(r||!a()||w.key!=="Tab")&&x.activeElement===m.current&&w.shiftKey&&(c.current=!0,d.current&&d.current.focus())},S=()=>{const w=m.current;if(w===null)return;if(!x.hasFocus()||!a()||c.current){c.current=!1;return}if(w.contains(x.activeElement)||r&&x.activeElement!==u.current&&x.activeElement!==d.current)return;if(x.activeElement!==f.current)f.current=null;else if(f.current!==null)return;if(!p.current)return;let E=[];if((x.activeElement===u.current||x.activeElement===d.current)&&(E=o(m.current)),E.length>0){var A,M;const R=!!((A=v.current)!=null&&A.shiftKey&&((M=v.current)==null?void 0:M.key)==="Tab"),F=E[0],B=E[E.length-1];typeof F!="string"&&typeof B!="string"&&(R?B.focus():F.focus())}else w.focus()};x.addEventListener("focusin",S),x.addEventListener("keydown",b,!0);const T=setInterval(()=>{x.activeElement&&x.activeElement.tagName==="BODY"&&S()},50);return()=>{clearInterval(T),x.removeEventListener("focusin",S),x.removeEventListener("keydown",b,!0)}},[n,r,s,a,l,o]);const g=x=>{h.current===null&&(h.current=x.relatedTarget),p.current=!0,f.current=x.target;const b=e.props.onFocus;b&&b(x)},_=x=>{h.current===null&&(h.current=x.relatedTarget),p.current=!0};return lt(I.Fragment,{children:[Y("div",{tabIndex:l?0:-1,onFocus:_,ref:u,"data-testid":"sentinelStart"}),I.cloneElement(e,{ref:y,onFocus:g}),Y("div",{tabIndex:l?0:-1,onFocus:_,ref:d,"data-testid":"sentinelEnd"})]})}function Xee(i){return typeof i=="function"?i():i}function Kee(i){return i?i.props.hasOwnProperty("in"):!1}const Yee=new zee;function Zee(i){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:s=Yee,closeAfterTransition:o=!1,onTransitionEnter:a,onTransitionExited:l,children:c,onClose:u,open:d,rootRef:h}=i,f=I.useRef({}),p=I.useRef(null),m=I.useRef(null),y=dr(m,h),[v,g]=I.useState(!d),_=Kee(c);let x=!0;(i["aria-hidden"]==="false"||i["aria-hidden"]===!1)&&(x=!1);const b=()=>Sr(p.current),S=()=>(f.current.modalRef=m.current,f.current.mount=p.current,f.current),T=()=>{s.mount(S(),{disableScrollLock:r}),m.current&&(m.current.scrollTop=0)},w=Ks(()=>{const P=Xee(e)||b().body;s.add(S(),P),m.current&&T()}),E=I.useCallback(()=>s.isTopModal(S()),[s]),A=Ks(P=>{p.current=P,P&&(d&&E()?T():m.current&&Vg(m.current,x))}),M=I.useCallback(()=>{s.remove(S(),x)},[x,s]);I.useEffect(()=>()=>{M()},[M]),I.useEffect(()=>{d?w():(!_||!o)&&M()},[d,M,_,o,w]);const R=P=>W=>{var D;(D=P.onKeyDown)==null||D.call(P,W),!(W.key!=="Escape"||W.which===229||!E())&&(n||(W.stopPropagation(),u&&u(W,"escapeKeyDown")))},F=P=>W=>{var D;(D=P.onClick)==null||D.call(P,W),W.target===W.currentTarget&&u&&u(W,"backdropClick")};return{getRootProps:(P={})=>{const W=kb(i);delete W.onTransitionEnter,delete W.onTransitionExited;const D=z({},W,P);return z({role:"presentation"},D,{onKeyDown:R(D),ref:y})},getBackdropProps:(P={})=>{const W=P;return z({"aria-hidden":!0},W,{onClick:F(W),open:d})},getTransitionProps:()=>{const P=()=>{g(!1),a&&a()},W=()=>{g(!0),l&&l(),o&&M()};return{onEnter:JL(P,c==null?void 0:c.props.onEnter),onExited:JL(W,c==null?void 0:c.props.onExited)}},rootRef:y,portalRef:A,isTopModal:E,exited:v,hasTransition:_}}function Qee(i){return Zt("MuiModal",i)}jt("MuiModal",["root","hidden","backdrop"]);const Jee=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],ete=i=>{const{open:e,exited:n,classes:r}=i;return en({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},Qee,r)},tte=Qe("div",{name:"MuiModal",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:i,ownerState:e})=>z({position:"fixed",zIndex:(i.vars||i).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),nte=Qe(WJ,{name:"MuiModal",slot:"Backdrop",overridesResolver:(i,e)=>e.backdrop})({zIndex:-1}),ite=I.forwardRef(function(e,n){var r,s,o,a,l,c;const u=Qt({name:"MuiModal",props:e}),{BackdropComponent:d=nte,BackdropProps:h,className:f,closeAfterTransition:p=!1,children:m,container:y,component:v,components:g={},componentsProps:_={},disableAutoFocus:x=!1,disableEnforceFocus:b=!1,disableEscapeKeyDown:S=!1,disablePortal:T=!1,disableRestoreFocus:w=!1,disableScrollLock:E=!1,hideBackdrop:A=!1,keepMounted:M=!1,onBackdropClick:R,open:F,slotProps:B,slots:C}=u,L=rt(u,Jee),P=z({},u,{closeAfterTransition:p,disableAutoFocus:x,disableEnforceFocus:b,disableEscapeKeyDown:S,disablePortal:T,disableRestoreFocus:w,disableScrollLock:E,hideBackdrop:A,keepMounted:M}),{getRootProps:W,getBackdropProps:D,getTransitionProps:X,portalRef:q,isTopModal:J,exited:se,hasTransition:de}=Zee(z({},P,{rootRef:n})),G=z({},P,{exited:se}),Q=ete(G),ee={};if(m.props.tabIndex===void 0&&(ee.tabIndex="-1"),de){const{onEnter:He,onExited:Z}=X();ee.onEnter=He,ee.onExited=Z}const ie=(r=(s=C==null?void 0:C.root)!=null?s:g.Root)!=null?r:tte,Se=(o=(a=C==null?void 0:C.backdrop)!=null?a:g.Backdrop)!=null?o:d,Fe=(l=B==null?void 0:B.root)!=null?l:_.root,Be=(c=B==null?void 0:B.backdrop)!=null?c:_.backdrop,ct=fa({elementType:ie,externalSlotProps:Fe,externalForwardedProps:L,getSlotProps:W,additionalProps:{ref:n,as:v},ownerState:G,className:ft(f,Fe==null?void 0:Fe.className,Q==null?void 0:Q.root,!G.open&&G.exited&&(Q==null?void 0:Q.hidden))}),xt=fa({elementType:Se,externalSlotProps:Be,additionalProps:h,getSlotProps:He=>D(z({},He,{onClick:Z=>{R&&R(Z),He!=null&&He.onClick&&He.onClick(Z)}})),className:ft(Be==null?void 0:Be.className,h==null?void 0:h.className,Q==null?void 0:Q.backdrop),ownerState:G});return!M&&!F&&(!de||se)?null:Y(aJ,{ref:q,container:y,disablePortal:T,children:lt(ie,z({},ct,{children:[!A&&d?Y(Se,z({},xt)):null,Y(qee,{disableEnforceFocus:b,disableAutoFocus:x,disableRestoreFocus:w,isEnabled:J,open:F,children:I.cloneElement(m,ee)})]}))})}),rte=ite;function ste(i){return Zt("MuiDivider",i)}jt("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);const ote=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],ate=i=>{const{absolute:e,children:n,classes:r,flexItem:s,light:o,orientation:a,textAlign:l,variant:c}=i;return en({root:["root",e&&"absolute",c,o&&"light",a==="vertical"&&"vertical",s&&"flexItem",n&&"withChildren",n&&a==="vertical"&&"withChildrenVertical",l==="right"&&a!=="vertical"&&"textAlignRight",l==="left"&&a!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",a==="vertical"&&"wrapperVertical"]},ste,r)},lte=Qe("div",{name:"MuiDivider",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.absolute&&e.absolute,e[n.variant],n.light&&e.light,n.orientation==="vertical"&&e.vertical,n.flexItem&&e.flexItem,n.children&&e.withChildren,n.children&&n.orientation==="vertical"&&e.withChildrenVertical,n.textAlign==="right"&&n.orientation!=="vertical"&&e.textAlignRight,n.textAlign==="left"&&n.orientation!=="vertical"&&e.textAlignLeft]}})(({theme:i,ownerState:e})=>z({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(i.vars||i).palette.divider,borderBottomWidth:"thin"},e.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},e.light&&{borderColor:i.vars?`rgba(${i.vars.palette.dividerChannel} / 0.08)`:si(i.palette.divider,.08)},e.variant==="inset"&&{marginLeft:72},e.variant==="middle"&&e.orientation==="horizontal"&&{marginLeft:i.spacing(2),marginRight:i.spacing(2)},e.variant==="middle"&&e.orientation==="vertical"&&{marginTop:i.spacing(1),marginBottom:i.spacing(1)},e.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},e.flexItem&&{alignSelf:"stretch",height:"auto"}),({ownerState:i})=>z({},i.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}),({theme:i,ownerState:e})=>z({},e.children&&e.orientation!=="vertical"&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(i.vars||i).palette.divider}`,borderTopStyle:"inherit"}}),({theme:i,ownerState:e})=>z({},e.children&&e.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(i.vars||i).palette.divider}`,borderLeftStyle:"inherit"}}),({ownerState:i})=>z({},i.textAlign==="right"&&i.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},i.textAlign==="left"&&i.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),cte=Qe("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.wrapper,n.orientation==="vertical"&&e.wrapperVertical]}})(({theme:i,ownerState:e})=>z({display:"inline-block",paddingLeft:`calc(${i.spacing(1)} * 1.2)`,paddingRight:`calc(${i.spacing(1)} * 1.2)`},e.orientation==="vertical"&&{paddingTop:`calc(${i.spacing(1)} * 1.2)`,paddingBottom:`calc(${i.spacing(1)} * 1.2)`})),lV=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiDivider"}),{absolute:s=!1,children:o,className:a,component:l=o?"div":"hr",flexItem:c=!1,light:u=!1,orientation:d="horizontal",role:h=l!=="hr"?"separator":void 0,textAlign:f="center",variant:p="fullWidth"}=r,m=rt(r,ote),y=z({},r,{absolute:s,component:l,flexItem:c,light:u,orientation:d,role:h,textAlign:f,variant:p}),v=ate(y);return Y(lte,z({as:l,className:ft(v.root,a),role:h,ref:n,ownerState:y},m,{children:o?Y(cte,{className:v.wrapper,ownerState:y,children:o}):null}))});lV.muiSkipListHighlight=!0;const _T=lV,ute=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],dte=i=>{const{classes:e,disableUnderline:n}=i,s=en({root:["root",!n&&"underline"],input:["input"]},LJ,e);return z({},e,s)},hte=Qe(NS,{shouldForwardProp:i=>xa(i)||i==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[...RS(i,e),!n.disableUnderline&&e.underline]}})(({theme:i,ownerState:e})=>{var n;const r=i.palette.mode==="light",s=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",o=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",a=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return z({position:"relative",backgroundColor:i.vars?i.vars.palette.FilledInput.bg:o,borderTopLeftRadius:(i.vars||i).shape.borderRadius,borderTopRightRadius:(i.vars||i).shape.borderRadius,transition:i.transitions.create("background-color",{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut}),"&:hover":{backgroundColor:i.vars?i.vars.palette.FilledInput.hoverBg:a,"@media (hover: none)":{backgroundColor:i.vars?i.vars.palette.FilledInput.bg:o}},[`&.${Iu.focused}`]:{backgroundColor:i.vars?i.vars.palette.FilledInput.bg:o},[`&.${Iu.disabled}`]:{backgroundColor:i.vars?i.vars.palette.FilledInput.disabledBg:l}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(n=(i.vars||i).palette[e.color||"primary"])==null?void 0:n.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:i.transitions.create("transform",{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Iu.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Iu.error}`]:{"&::before, &::after":{borderBottomColor:(i.vars||i).palette.error.main}},"&::before":{borderBottom:`1px solid ${i.vars?`rgba(${i.vars.palette.common.onBackgroundChannel} / ${i.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:i.transitions.create("border-bottom-color",{duration:i.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Iu.disabled}, .${Iu.error}):before`]:{borderBottom:`1px solid ${(i.vars||i).palette.text.primary}`},[`&.${Iu.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&z({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9}))}),fte=Qe(kS,{name:"MuiFilledInput",slot:"Input",overridesResolver:PS})(({theme:i,ownerState:e})=>z({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!i.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:i.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:i.palette.mode==="light"?null:"#fff",caretColor:i.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},i.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[i.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),cV=I.forwardRef(function(e,n){var r,s,o,a;const l=Qt({props:e,name:"MuiFilledInput"}),{components:c={},componentsProps:u,fullWidth:d=!1,inputComponent:h="input",multiline:f=!1,slotProps:p,slots:m={},type:y="text"}=l,v=rt(l,ute),g=z({},l,{fullWidth:d,inputComponent:h,multiline:f,type:y}),_=dte(l),x={root:{ownerState:g},input:{ownerState:g}},b=p??u?Js(x,p??u):x,S=(r=(s=m.root)!=null?s:c.Root)!=null?r:hte,T=(o=(a=m.input)!=null?a:c.Input)!=null?o:fte;return Y(aN,z({slots:{root:S,input:T},componentsProps:b,fullWidth:d,inputComponent:h,multiline:f,ref:n,type:y},v,{classes:_}))});cV.muiName="Input";const uV=cV;function pte(i){return Zt("MuiFormControl",i)}jt("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const mte=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],gte=i=>{const{classes:e,margin:n,fullWidth:r}=i,s={root:["root",n!=="none"&&`margin${We(n)}`,r&&"fullWidth"]};return en(s,pte,e)},yte=Qe("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:i},e)=>z({},e.root,e[`margin${We(i.margin)}`],i.fullWidth&&e.fullWidth)})(({ownerState:i})=>z({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},i.margin==="normal"&&{marginTop:16,marginBottom:8},i.margin==="dense"&&{marginTop:8,marginBottom:4},i.fullWidth&&{width:"100%"})),vte=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiFormControl"}),{children:s,className:o,color:a="primary",component:l="div",disabled:c=!1,error:u=!1,focused:d,fullWidth:h=!1,hiddenLabel:f=!1,margin:p="none",required:m=!1,size:y="medium",variant:v="outlined"}=r,g=rt(r,mte),_=z({},r,{color:a,component:l,disabled:c,error:u,fullWidth:h,hiddenLabel:f,margin:p,required:m,size:y,variant:v}),x=gte(_),[b,S]=I.useState(()=>{let B=!1;return s&&I.Children.forEach(s,C=>{if(!R_(C,["Input","Select"]))return;const L=R_(C,["Select"])?C.props.input:C;L&&SJ(L.props)&&(B=!0)}),B}),[T,w]=I.useState(()=>{let B=!1;return s&&I.Children.forEach(s,C=>{R_(C,["Input","Select"])&&(Ob(C.props,!0)||Ob(C.props.inputProps,!0))&&(B=!0)}),B}),[E,A]=I.useState(!1);c&&E&&A(!1);const M=d!==void 0&&!c?d:E;let R;const F=I.useMemo(()=>({adornedStart:b,setAdornedStart:S,color:a,disabled:c,error:u,filled:T,focused:M,fullWidth:h,hiddenLabel:f,size:y,onBlur:()=>{A(!1)},onEmpty:()=>{w(!1)},onFilled:()=>{w(!0)},onFocus:()=>{A(!0)},registerEffect:R,required:m,variant:v}),[b,a,c,u,T,M,h,f,R,m,y,v]);return Y(oN.Provider,{value:F,children:Y(yte,z({as:l,ownerState:_,className:ft(x.root,o),ref:n},g,{children:s}))})}),xte=vte;function _te(i){return Zt("MuiFormHelperText",i)}const bte=jt("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),BI=bte;var UI;const Ste=["children","className","component","disabled","error","filled","focused","margin","required","variant"],wte=i=>{const{classes:e,contained:n,size:r,disabled:s,error:o,filled:a,focused:l,required:c}=i,u={root:["root",s&&"disabled",o&&"error",r&&`size${We(r)}`,n&&"contained",l&&"focused",a&&"filled",c&&"required"]};return en(u,_te,e)},Tte=Qe("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.size&&e[`size${We(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(({theme:i,ownerState:e})=>z({color:(i.vars||i).palette.text.secondary},i.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${BI.disabled}`]:{color:(i.vars||i).palette.text.disabled},[`&.${BI.error}`]:{color:(i.vars||i).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),Ete=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiFormHelperText"}),{children:s,className:o,component:a="p"}=r,l=rt(r,Ste),c=Xp(),u=qp({props:r,muiFormControl:c,states:["variant","size","disabled","error","filled","focused","required"]}),d=z({},r,{component:a,contained:u.variant==="filled"||u.variant==="outlined",variant:u.variant,size:u.size,disabled:u.disabled,error:u.error,filled:u.filled,focused:u.focused,required:u.required}),h=wte(d);return Y(Tte,z({as:a,ownerState:d,className:ft(h.root,o),ref:n},l,{children:s===" "?UI||(UI=Y("span",{className:"notranslate",children:"​"})):s}))}),Mte=Ete;function Ate(i){return Zt("MuiFormLabel",i)}const Cte=jt("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),$g=Cte,Rte=["children","className","color","component","disabled","error","filled","focused","required"],Pte=i=>{const{classes:e,color:n,focused:r,disabled:s,error:o,filled:a,required:l}=i,c={root:["root",`color${We(n)}`,s&&"disabled",o&&"error",a&&"filled",r&&"focused",l&&"required"],asterisk:["asterisk",o&&"error"]};return en(c,Ate,e)},Nte=Qe("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:i},e)=>z({},e.root,i.color==="secondary"&&e.colorSecondary,i.filled&&e.filled)})(({theme:i,ownerState:e})=>z({color:(i.vars||i).palette.text.secondary},i.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${$g.focused}`]:{color:(i.vars||i).palette[e.color].main},[`&.${$g.disabled}`]:{color:(i.vars||i).palette.text.disabled},[`&.${$g.error}`]:{color:(i.vars||i).palette.error.main}})),kte=Qe("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(i,e)=>e.asterisk})(({theme:i})=>({[`&.${$g.error}`]:{color:(i.vars||i).palette.error.main}})),Lte=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiFormLabel"}),{children:s,className:o,component:a="label"}=r,l=rt(r,Rte),c=Xp(),u=qp({props:r,muiFormControl:c,states:["color","required","focused","disabled","error","filled"]}),d=z({},r,{color:u.color||"primary",component:a,disabled:u.disabled,error:u.error,filled:u.filled,focused:u.focused,required:u.required}),h=Pte(d);return lt(Nte,z({as:a,ownerState:d,className:ft(h.root,o),ref:n},l,{children:[s,u.required&&lt(kte,{ownerState:d,"aria-hidden":!0,className:h.asterisk,children:[" ","*"]})]}))}),Ite=Lte,Dte=I.createContext(),zI=Dte;function Ote(i){return Zt("MuiGrid",i)}const Fte=[0,1,2,3,4,5,6,7,8,9,10],Bte=["column-reverse","column","row-reverse","row"],Ute=["nowrap","wrap-reverse","wrap"],Em=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],zte=jt("MuiGrid",["root","container","item","zeroMinWidth",...Fte.map(i=>`spacing-xs-${i}`),...Bte.map(i=>`direction-xs-${i}`),...Ute.map(i=>`wrap-xs-${i}`),...Em.map(i=>`grid-xs-${i}`),...Em.map(i=>`grid-sm-${i}`),...Em.map(i=>`grid-md-${i}`),...Em.map(i=>`grid-lg-${i}`),...Em.map(i=>`grid-xl-${i}`)]),Ny=zte,Vte=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function Of(i){const e=parseFloat(i);return`${e}${String(i).replace(String(e),"")||"px"}`}function $te({theme:i,ownerState:e}){let n;return i.breakpoints.keys.reduce((r,s)=>{let o={};if(e[s]&&(n=e[s]),!n)return r;if(n===!0)o={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(n==="auto")o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const a=oS({values:e.columns,breakpoints:i.breakpoints.values}),l=typeof a=="object"?a[s]:a;if(l==null)return r;const c=`${Math.round(n/l*1e8)/1e6}%`;let u={};if(e.container&&e.item&&e.columnSpacing!==0){const d=i.spacing(e.columnSpacing);if(d!=="0px"){const h=`calc(${c} + ${Of(d)})`;u={flexBasis:h,maxWidth:h}}}o=z({flexBasis:c,flexGrow:0,maxWidth:c},u)}return i.breakpoints.values[s]===0?Object.assign(r,o):r[i.breakpoints.up(s)]=o,r},{})}function Gte({theme:i,ownerState:e}){const n=oS({values:e.direction,breakpoints:i.breakpoints.values});return Lo({theme:i},n,r=>{const s={flexDirection:r};return r.indexOf("column")===0&&(s[`& > .${Ny.item}`]={maxWidth:"none"}),s})}function dV({breakpoints:i,values:e}){let n="";Object.keys(e).forEach(s=>{n===""&&e[s]!==0&&(n=s)});const r=Object.keys(i).sort((s,o)=>i[s]-i[o]);return r.slice(0,r.indexOf(n))}function Hte({theme:i,ownerState:e}){const{container:n,rowSpacing:r}=e;let s={};if(n&&r!==0){const o=oS({values:r,breakpoints:i.breakpoints.values});let a;typeof o=="object"&&(a=dV({breakpoints:i.breakpoints.values,values:o})),s=Lo({theme:i},o,(l,c)=>{var u;const d=i.spacing(l);return d!=="0px"?{marginTop:`-${Of(d)}`,[`& > .${Ny.item}`]:{paddingTop:Of(d)}}:(u=a)!=null&&u.includes(c)?{}:{marginTop:0,[`& > .${Ny.item}`]:{paddingTop:0}}})}return s}function Wte({theme:i,ownerState:e}){const{container:n,columnSpacing:r}=e;let s={};if(n&&r!==0){const o=oS({values:r,breakpoints:i.breakpoints.values});let a;typeof o=="object"&&(a=dV({breakpoints:i.breakpoints.values,values:o})),s=Lo({theme:i},o,(l,c)=>{var u;const d=i.spacing(l);return d!=="0px"?{width:`calc(100% + ${Of(d)})`,marginLeft:`-${Of(d)}`,[`& > .${Ny.item}`]:{paddingLeft:Of(d)}}:(u=a)!=null&&u.includes(c)?{}:{width:"100%",marginLeft:0,[`& > .${Ny.item}`]:{paddingLeft:0}}})}return s}function jte(i,e,n={}){if(!i||i<=0)return[];if(typeof i=="string"&&!Number.isNaN(Number(i))||typeof i=="number")return[n[`spacing-xs-${String(i)}`]];const r=[];return e.forEach(s=>{const o=i[s];Number(o)>0&&r.push(n[`spacing-${s}-${String(o)}`])}),r}const qte=Qe("div",{name:"MuiGrid",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i,{container:r,direction:s,item:o,spacing:a,wrap:l,zeroMinWidth:c,breakpoints:u}=n;let d=[];r&&(d=jte(a,u,e));const h=[];return u.forEach(f=>{const p=n[f];p&&h.push(e[`grid-${f}-${String(p)}`])}),[e.root,r&&e.container,o&&e.item,c&&e.zeroMinWidth,...d,s!=="row"&&e[`direction-xs-${String(s)}`],l!=="wrap"&&e[`wrap-xs-${String(l)}`],...h]}})(({ownerState:i})=>z({boxSizing:"border-box"},i.container&&{display:"flex",flexWrap:"wrap",width:"100%"},i.item&&{margin:0},i.zeroMinWidth&&{minWidth:0},i.wrap!=="wrap"&&{flexWrap:i.wrap}),Gte,Hte,Wte,$te);function Xte(i,e){if(!i||i<=0)return[];if(typeof i=="string"&&!Number.isNaN(Number(i))||typeof i=="number")return[`spacing-xs-${String(i)}`];const n=[];return e.forEach(r=>{const s=i[r];if(Number(s)>0){const o=`spacing-${r}-${String(s)}`;n.push(o)}}),n}const Kte=i=>{const{classes:e,container:n,direction:r,item:s,spacing:o,wrap:a,zeroMinWidth:l,breakpoints:c}=i;let u=[];n&&(u=Xte(o,c));const d=[];c.forEach(f=>{const p=i[f];p&&d.push(`grid-${f}-${String(p)}`)});const h={root:["root",n&&"container",s&&"item",l&&"zeroMinWidth",...u,r!=="row"&&`direction-xs-${String(r)}`,a!=="wrap"&&`wrap-xs-${String(a)}`,...d]};return en(h,Ote,e)},Yte=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiGrid"}),{breakpoints:s}=L0(),o=pS(r),{className:a,columns:l,columnSpacing:c,component:u="div",container:d=!1,direction:h="row",item:f=!1,rowSpacing:p,spacing:m=0,wrap:y="wrap",zeroMinWidth:v=!1}=o,g=rt(o,Vte),_=p||m,x=c||m,b=I.useContext(zI),S=d?l||12:b,T={},w=z({},g);s.keys.forEach(M=>{g[M]!=null&&(T[M]=g[M],delete w[M])});const E=z({},o,{columns:S,container:d,direction:h,item:f,rowSpacing:_,columnSpacing:x,wrap:y,zeroMinWidth:v,spacing:m},T,{breakpoints:s.keys}),A=Kte(E);return Y(zI.Provider,{value:S,children:Y(qte,z({ownerState:E,className:ft(A.root,a),as:u,ref:n},w))})}),Fb=Yte,Zte=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function pC(i){return`scale(${i}, ${i**2})`}const Qte={entering:{opacity:1,transform:pC(1)},entered:{opacity:1,transform:"none"}},bT=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),hV=I.forwardRef(function(e,n){const{addEndListener:r,appear:s=!0,children:o,easing:a,in:l,onEnter:c,onEntered:u,onEntering:d,onExit:h,onExited:f,onExiting:p,style:m,timeout:y="auto",TransitionComponent:v=nV}=e,g=rt(e,Zte),_=YP(),x=I.useRef(),b=L0(),S=I.useRef(null),T=dr(S,Hp(o),n),w=L=>P=>{if(L){const W=S.current;P===void 0?L(W):L(W,P)}},E=w(d),A=w((L,P)=>{rV(L);const{duration:W,delay:D,easing:X}=Db({style:m,timeout:y,easing:a},{mode:"enter"});let q;y==="auto"?(q=b.transitions.getAutoHeightDuration(L.clientHeight),x.current=q):q=W,L.style.transition=[b.transitions.create("opacity",{duration:q,delay:D}),b.transitions.create("transform",{duration:bT?q:q*.666,delay:D,easing:X})].join(","),c&&c(L,P)}),M=w(u),R=w(p),F=w(L=>{const{duration:P,delay:W,easing:D}=Db({style:m,timeout:y,easing:a},{mode:"exit"});let X;y==="auto"?(X=b.transitions.getAutoHeightDuration(L.clientHeight),x.current=X):X=P,L.style.transition=[b.transitions.create("opacity",{duration:X,delay:W}),b.transitions.create("transform",{duration:bT?X:X*.666,delay:bT?W:W||X*.333,easing:D})].join(","),L.style.opacity=0,L.style.transform=pC(.75),h&&h(L)}),B=w(f);return Y(v,z({appear:s,in:l,nodeRef:S,onEnter:A,onEntered:M,onEntering:E,onExit:F,onExited:B,onExiting:R,addEndListener:L=>{y==="auto"&&_.start(x.current||0,L),r&&r(S.current,L)},timeout:y==="auto"?null:y},g,{children:(L,P)=>I.cloneElement(o,z({style:z({opacity:0,transform:pC(.75),visibility:L==="exited"&&!l?"hidden":void 0},Qte[L],m,o.props.style),ref:T},P))}))});hV.muiSupportAuto=!0;const fV=hV,Jte=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],ene=i=>{const{classes:e,disableUnderline:n}=i,s=en({root:["root",!n&&"underline"],input:["input"]},RJ,e);return z({},e,s)},tne=Qe(NS,{shouldForwardProp:i=>xa(i)||i==="classes",name:"MuiInput",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[...RS(i,e),!n.disableUnderline&&e.underline]}})(({theme:i,ownerState:e})=>{let r=i.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return i.vars&&(r=`rgba(${i.vars.palette.common.onBackgroundChannel} / ${i.vars.opacity.inputUnderline})`),z({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(i.vars||i).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:i.transitions.create("transform",{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Tm.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Tm.error}`]:{"&::before, &::after":{borderBottomColor:(i.vars||i).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:i.transitions.create("border-bottom-color",{duration:i.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Tm.disabled}, .${Tm.error}):before`]:{borderBottom:`2px solid ${(i.vars||i).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${Tm.disabled}:before`]:{borderBottomStyle:"dotted"}})}),nne=Qe(kS,{name:"MuiInput",slot:"Input",overridesResolver:PS})({}),pV=I.forwardRef(function(e,n){var r,s,o,a;const l=Qt({props:e,name:"MuiInput"}),{disableUnderline:c,components:u={},componentsProps:d,fullWidth:h=!1,inputComponent:f="input",multiline:p=!1,slotProps:m,slots:y={},type:v="text"}=l,g=rt(l,Jte),_=ene(l),b={root:{ownerState:{disableUnderline:c}}},S=m??d?Js(m??d,b):b,T=(r=(s=y.root)!=null?s:u.Root)!=null?r:tne,w=(o=(a=y.input)!=null?a:u.Input)!=null?o:nne;return Y(aN,z({slots:{root:T,input:w},slotProps:S,fullWidth:h,inputComponent:f,multiline:p,ref:n,type:v},g,{classes:_}))});pV.muiName="Input";const mV=pV;function ine(i){return Zt("MuiInputLabel",i)}jt("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const rne=["disableAnimation","margin","shrink","variant","className"],sne=i=>{const{classes:e,formControl:n,size:r,shrink:s,disableAnimation:o,variant:a,required:l}=i,c={root:["root",n&&"formControl",!o&&"animated",s&&"shrink",r&&r!=="normal"&&`size${We(r)}`,a],asterisk:[l&&"asterisk"]},u=en(c,ine,e);return z({},e,u)},one=Qe(Ite,{shouldForwardProp:i=>xa(i)||i==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[{[`& .${$g.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,n.focused&&e.focused,e[n.variant]]}})(({theme:i,ownerState:e})=>z({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:i.transitions.create(["color","transform","max-width"],{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut})},e.variant==="filled"&&z({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&z({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&z({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),ane=I.forwardRef(function(e,n){const r=Qt({name:"MuiInputLabel",props:e}),{disableAnimation:s=!1,shrink:o,className:a}=r,l=rt(r,rne),c=Xp();let u=o;typeof u>"u"&&c&&(u=c.filled||c.focused||c.adornedStart);const d=qp({props:r,muiFormControl:c,states:["size","variant","required","focused"]}),h=z({},r,{disableAnimation:s,formControl:c,shrink:u,size:d.size,variant:d.variant,required:d.required,focused:d.focused}),f=sne(h);return Y(one,z({"data-shrink":u,ownerState:h,ref:n,className:ft(f.root,a)},l,{classes:f}))}),lne=ane,cne=I.createContext({}),Ff=cne;function une(i){return Zt("MuiList",i)}jt("MuiList",["root","padding","dense","subheader"]);const dne=["children","className","component","dense","disablePadding","subheader"],hne=i=>{const{classes:e,disablePadding:n,dense:r,subheader:s}=i;return en({root:["root",!n&&"padding",r&&"dense",s&&"subheader"]},une,e)},fne=Qe("ul",{name:"MuiList",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})(({ownerState:i})=>z({listStyle:"none",margin:0,padding:0,position:"relative"},!i.disablePadding&&{paddingTop:8,paddingBottom:8},i.subheader&&{paddingTop:0})),pne=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiList"}),{children:s,className:o,component:a="ul",dense:l=!1,disablePadding:c=!1,subheader:u}=r,d=rt(r,dne),h=I.useMemo(()=>({dense:l}),[l]),f=z({},r,{component:a,dense:l,disablePadding:c}),p=hne(f);return Y(Ff.Provider,{value:h,children:lt(fne,z({as:a,className:ft(p.root,o),ref:n,ownerState:f},d,{children:[u,s]}))})}),k_=pne;function mne(i){return Zt("MuiListItem",i)}const gne=jt("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]),Jh=gne,yne=jt("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),vne=yne;function xne(i){return Zt("MuiListItemSecondaryAction",i)}jt("MuiListItemSecondaryAction",["root","disableGutters"]);const _ne=["className"],bne=i=>{const{disableGutters:e,classes:n}=i;return en({root:["root",e&&"disableGutters"]},xne,n)},Sne=Qe("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.disableGutters&&e.disableGutters]}})(({ownerState:i})=>z({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"},i.disableGutters&&{right:0})),gV=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiListItemSecondaryAction"}),{className:s}=r,o=rt(r,_ne),a=I.useContext(Ff),l=z({},r,{disableGutters:a.disableGutters}),c=bne(l);return Y(Sne,z({className:ft(c.root,s),ownerState:l,ref:n},o))});gV.muiName="ListItemSecondaryAction";const wne=gV,Tne=["className"],Ene=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected","slotProps","slots"],Mne=(i,e)=>{const{ownerState:n}=i;return[e.root,n.dense&&e.dense,n.alignItems==="flex-start"&&e.alignItemsFlexStart,n.divider&&e.divider,!n.disableGutters&&e.gutters,!n.disablePadding&&e.padding,n.button&&e.button,n.hasSecondaryAction&&e.secondaryAction]},Ane=i=>{const{alignItems:e,button:n,classes:r,dense:s,disabled:o,disableGutters:a,disablePadding:l,divider:c,hasSecondaryAction:u,selected:d}=i;return en({root:["root",s&&"dense",!a&&"gutters",!l&&"padding",c&&"divider",o&&"disabled",n&&"button",e==="flex-start"&&"alignItemsFlexStart",u&&"secondaryAction",d&&"selected"],container:["container"]},mne,r)},Cne=Qe("div",{name:"MuiListItem",slot:"Root",overridesResolver:Mne})(({theme:i,ownerState:e})=>z({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!e.disablePadding&&z({paddingTop:8,paddingBottom:8},e.dense&&{paddingTop:4,paddingBottom:4},!e.disableGutters&&{paddingLeft:16,paddingRight:16},!!e.secondaryAction&&{paddingRight:48}),!!e.secondaryAction&&{[`& > .${vne.root}`]:{paddingRight:48}},{[`&.${Jh.focusVisible}`]:{backgroundColor:(i.vars||i).palette.action.focus},[`&.${Jh.selected}`]:{backgroundColor:i.vars?`rgba(${i.vars.palette.primary.mainChannel} / ${i.vars.palette.action.selectedOpacity})`:si(i.palette.primary.main,i.palette.action.selectedOpacity),[`&.${Jh.focusVisible}`]:{backgroundColor:i.vars?`rgba(${i.vars.palette.primary.mainChannel} / calc(${i.vars.palette.action.selectedOpacity} + ${i.vars.palette.action.focusOpacity}))`:si(i.palette.primary.main,i.palette.action.selectedOpacity+i.palette.action.focusOpacity)}},[`&.${Jh.disabled}`]:{opacity:(i.vars||i).palette.action.disabledOpacity}},e.alignItems==="flex-start"&&{alignItems:"flex-start"},e.divider&&{borderBottom:`1px solid ${(i.vars||i).palette.divider}`,backgroundClip:"padding-box"},e.button&&{transition:i.transitions.create("background-color",{duration:i.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(i.vars||i).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Jh.selected}:hover`]:{backgroundColor:i.vars?`rgba(${i.vars.palette.primary.mainChannel} / calc(${i.vars.palette.action.selectedOpacity} + ${i.vars.palette.action.hoverOpacity}))`:si(i.palette.primary.main,i.palette.action.selectedOpacity+i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:i.vars?`rgba(${i.vars.palette.primary.mainChannel} / ${i.vars.palette.action.selectedOpacity})`:si(i.palette.primary.main,i.palette.action.selectedOpacity)}}},e.hasSecondaryAction&&{paddingRight:48})),Rne=Qe("li",{name:"MuiListItem",slot:"Container",overridesResolver:(i,e)=>e.container})({position:"relative"}),Pne=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiListItem"}),{alignItems:s="center",autoFocus:o=!1,button:a=!1,children:l,className:c,component:u,components:d={},componentsProps:h={},ContainerComponent:f="li",ContainerProps:{className:p}={},dense:m=!1,disabled:y=!1,disableGutters:v=!1,disablePadding:g=!1,divider:_=!1,focusVisibleClassName:x,secondaryAction:b,selected:S=!1,slotProps:T={},slots:w={}}=r,E=rt(r.ContainerProps,Tne),A=rt(r,Ene),M=I.useContext(Ff),R=I.useMemo(()=>({dense:m||M.dense||!1,alignItems:s,disableGutters:v}),[s,M.dense,m,v]),F=I.useRef(null);Ql(()=>{o&&F.current&&F.current.focus()},[o]);const B=I.Children.toArray(l),C=B.length&&R_(B[B.length-1],["ListItemSecondaryAction"]),L=z({},r,{alignItems:s,autoFocus:o,button:a,dense:R.dense,disabled:y,disableGutters:v,disablePadding:g,divider:_,hasSecondaryAction:C,selected:S}),P=Ane(L),W=dr(F,n),D=w.root||d.Root||Cne,X=T.root||h.root||{},q=z({className:ft(P.root,X.className,c),disabled:y},A);let J=u||"li";return a&&(q.component=u||"div",q.focusVisibleClassName=ft(Jh.focusVisible,x),J=Ld),C?(J=!q.component&&!u?"div":J,f==="li"&&(J==="li"?J="div":q.component==="li"&&(q.component="div")),Y(Ff.Provider,{value:R,children:lt(Rne,z({as:f,className:ft(P.container,p),ref:W,ownerState:L},E,{children:[Y(D,z({},X,!ap(D)&&{as:J,ownerState:z({},L,X.ownerState)},q,{children:B})),B.pop()]}))})):Y(Ff.Provider,{value:R,children:lt(D,z({},X,{as:J,ref:W},!ap(D)&&{ownerState:z({},L,X.ownerState)},q,{children:[B,b&&Y(wne,{children:b})]}))})}),ST=Pne;function Nne(i){return Zt("MuiListItemText",i)}const kne=jt("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),VI=kne,Lne=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],Ine=i=>{const{classes:e,inset:n,primary:r,secondary:s,dense:o}=i;return en({root:["root",n&&"inset",o&&"dense",r&&s&&"multiline"],primary:["primary"],secondary:["secondary"]},Nne,e)},Dne=Qe("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[{[`& .${VI.primary}`]:e.primary},{[`& .${VI.secondary}`]:e.secondary},e.root,n.inset&&e.inset,n.primary&&n.secondary&&e.multiline,n.dense&&e.dense]}})(({ownerState:i})=>z({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},i.primary&&i.secondary&&{marginTop:6,marginBottom:6},i.inset&&{paddingLeft:56})),One=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiListItemText"}),{children:s,className:o,disableTypography:a=!1,inset:l=!1,primary:c,primaryTypographyProps:u,secondary:d,secondaryTypographyProps:h}=r,f=rt(r,Lne),{dense:p}=I.useContext(Ff);let m=c??s,y=d;const v=z({},r,{disableTypography:a,inset:l,primary:!!m,secondary:!!y,dense:p}),g=Ine(v);return m!=null&&m.type!==It&&!a&&(m=Y(It,z({variant:p?"body2":"body1",className:g.primary,component:u!=null&&u.variant?void 0:"span",display:"block"},u,{children:m}))),y!=null&&y.type!==It&&!a&&(y=Y(It,z({variant:"body2",className:g.secondary,color:"text.secondary",display:"block"},h,{children:y}))),lt(Dne,z({className:ft(g.root,o),ownerState:v,ref:n},f,{children:[m,y]}))}),wT=One,Fne=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function TT(i,e,n){return i===e?i.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:i.firstChild}function $I(i,e,n){return i===e?n?i.firstChild:i.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:i.lastChild}function yV(i,e){if(e===void 0)return!0;let n=i.innerText;return n===void 0&&(n=i.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.indexOf(e.keys.join(""))===0}function Mm(i,e,n,r,s,o){let a=!1,l=s(i,e,e?n:!1);for(;l;){if(l===i.firstChild){if(a)return!1;a=!0}const c=r?!1:l.disabled||l.getAttribute("aria-disabled")==="true";if(!l.hasAttribute("tabindex")||!yV(l,o)||c)l=s(i,l,n);else return l.focus(),!0}return!1}const Bne=I.forwardRef(function(e,n){const{actions:r,autoFocus:s=!1,autoFocusItem:o=!1,children:a,className:l,disabledItemsFocusable:c=!1,disableListWrap:u=!1,onKeyDown:d,variant:h="selectedMenu"}=e,f=rt(e,Fne),p=I.useRef(null),m=I.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Ql(()=>{s&&p.current.focus()},[s]),I.useImperativeHandle(r,()=>({adjustStyleForScrollbar:(x,{direction:b})=>{const S=!p.current.style.width;if(x.clientHeight<p.current.clientHeight&&S){const T=`${D5(Sr(x))}px`;p.current.style[b==="rtl"?"paddingLeft":"paddingRight"]=T,p.current.style.width=`calc(100% + ${T})`}return p.current}}),[]);const y=x=>{const b=p.current,S=x.key,T=Sr(b).activeElement;if(S==="ArrowDown")x.preventDefault(),Mm(b,T,u,c,TT);else if(S==="ArrowUp")x.preventDefault(),Mm(b,T,u,c,$I);else if(S==="Home")x.preventDefault(),Mm(b,null,u,c,TT);else if(S==="End")x.preventDefault(),Mm(b,null,u,c,$I);else if(S.length===1){const w=m.current,E=S.toLowerCase(),A=performance.now();w.keys.length>0&&(A-w.lastTime>500?(w.keys=[],w.repeating=!0,w.previousKeyMatched=!0):w.repeating&&E!==w.keys[0]&&(w.repeating=!1)),w.lastTime=A,w.keys.push(E);const M=T&&!w.repeating&&yV(T,w);w.previousKeyMatched&&(M||Mm(b,T,!1,c,TT,w))?x.preventDefault():w.previousKeyMatched=!1}d&&d(x)},v=dr(p,n);let g=-1;I.Children.forEach(a,(x,b)=>{if(!I.isValidElement(x)){g===b&&(g+=1,g>=a.length&&(g=-1));return}x.props.disabled||(h==="selectedMenu"&&x.props.selected||g===-1)&&(g=b),g===b&&(x.props.disabled||x.props.muiSkipListHighlight||x.type.muiSkipListHighlight)&&(g+=1,g>=a.length&&(g=-1))});const _=I.Children.map(a,(x,b)=>{if(b===g){const S={};return o&&(S.autoFocus=!0),x.props.tabIndex===void 0&&h==="selectedMenu"&&(S.tabIndex=0),I.cloneElement(x,S)}return x});return Y(k_,z({role:"menu",ref:v,className:l,onKeyDown:y,tabIndex:s?0:-1},f,{children:_}))}),Une=Bne;function zne(i){return Zt("MuiPopover",i)}jt("MuiPopover",["root","paper"]);const Vne=["onEntering"],$ne=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Gne=["slotProps"];function GI(i,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=i.height/2:e==="bottom"&&(n=i.height),n}function HI(i,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=i.width/2:e==="right"&&(n=i.width),n}function WI(i){return[i.horizontal,i.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function ET(i){return typeof i=="function"?i():i}const Hne=i=>{const{classes:e}=i;return en({root:["root"],paper:["paper"]},zne,e)},Wne=Qe(rte,{name:"MuiPopover",slot:"Root",overridesResolver:(i,e)=>e.root})({}),vV=Qe(ec,{name:"MuiPopover",slot:"Paper",overridesResolver:(i,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),jne=I.forwardRef(function(e,n){var r,s,o;const a=Qt({props:e,name:"MuiPopover"}),{action:l,anchorEl:c,anchorOrigin:u={vertical:"top",horizontal:"left"},anchorPosition:d,anchorReference:h="anchorEl",children:f,className:p,container:m,elevation:y=8,marginThreshold:v=16,open:g,PaperProps:_={},slots:x,slotProps:b,transformOrigin:S={vertical:"top",horizontal:"left"},TransitionComponent:T=fV,transitionDuration:w="auto",TransitionProps:{onEntering:E}={},disableScrollLock:A=!1}=a,M=rt(a.TransitionProps,Vne),R=rt(a,$ne),F=(r=b==null?void 0:b.paper)!=null?r:_,B=I.useRef(),C=dr(B,F.ref),L=z({},a,{anchorOrigin:u,anchorReference:h,elevation:y,marginThreshold:v,externalPaperSlotProps:F,transformOrigin:S,TransitionComponent:T,transitionDuration:w,TransitionProps:M}),P=Hne(L),W=I.useCallback(()=>{if(h==="anchorPosition")return d;const He=ET(c),Nt=(He&&He.nodeType===1?He:Sr(B.current).body).getBoundingClientRect();return{top:Nt.top+GI(Nt,u.vertical),left:Nt.left+HI(Nt,u.horizontal)}},[c,u.horizontal,u.vertical,d,h]),D=I.useCallback(He=>({vertical:GI(He,S.vertical),horizontal:HI(He,S.horizontal)}),[S.horizontal,S.vertical]),X=I.useCallback(He=>{const Z={width:He.offsetWidth,height:He.offsetHeight},Nt=D(Z);if(h==="none")return{top:null,left:null,transformOrigin:WI(Nt)};const Rt=W();let mt=Rt.top-Nt.vertical,Je=Rt.left-Nt.horizontal;const qt=mt+Z.height,et=Je+Z.width,j=Jl(ET(c)),O=j.innerHeight-v,ce=j.innerWidth-v;if(v!==null&&mt<v){const ye=mt-v;mt-=ye,Nt.vertical+=ye}else if(v!==null&&qt>O){const ye=qt-O;mt-=ye,Nt.vertical+=ye}if(v!==null&&Je<v){const ye=Je-v;Je-=ye,Nt.horizontal+=ye}else if(et>ce){const ye=et-ce;Je-=ye,Nt.horizontal+=ye}return{top:`${Math.round(mt)}px`,left:`${Math.round(Je)}px`,transformOrigin:WI(Nt)}},[c,h,W,D,v]),[q,J]=I.useState(g),se=I.useCallback(()=>{const He=B.current;if(!He)return;const Z=X(He);Z.top!==null&&(He.style.top=Z.top),Z.left!==null&&(He.style.left=Z.left),He.style.transformOrigin=Z.transformOrigin,J(!0)},[X]);I.useEffect(()=>(A&&window.addEventListener("scroll",se),()=>window.removeEventListener("scroll",se)),[c,A,se]);const de=(He,Z)=>{E&&E(He,Z),se()},G=()=>{J(!1)};I.useEffect(()=>{g&&se()}),I.useImperativeHandle(l,()=>g?{updatePosition:()=>{se()}}:null,[g,se]),I.useEffect(()=>{if(!g)return;const He=ES(()=>{se()}),Z=Jl(c);return Z.addEventListener("resize",He),()=>{He.clear(),Z.removeEventListener("resize",He)}},[c,g,se]);let Q=w;w==="auto"&&!T.muiSupportAuto&&(Q=void 0);const ee=m||(c?Sr(ET(c)).body:void 0),ie=(s=x==null?void 0:x.root)!=null?s:Wne,Se=(o=x==null?void 0:x.paper)!=null?o:vV,Fe=fa({elementType:Se,externalSlotProps:z({},F,{style:q?F.style:z({},F.style,{opacity:0})}),additionalProps:{elevation:y,ref:C},ownerState:L,className:ft(P.paper,F==null?void 0:F.className)}),Be=fa({elementType:ie,externalSlotProps:(b==null?void 0:b.root)||{},externalForwardedProps:R,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:ee,open:g},ownerState:L,className:ft(P.root,p)}),{slotProps:ct}=Be,xt=rt(Be,Gne);return Y(ie,z({},xt,!ap(ie)&&{slotProps:ct,disableScrollLock:A},{children:Y(T,z({appear:!0,in:g,onEntering:de,onExited:G,timeout:Q},M,{children:Y(Se,z({},Fe,{children:f}))}))}))}),qne=jne;function Xne(i){return Zt("MuiMenu",i)}jt("MuiMenu",["root","paper","list"]);const Kne=["onEntering"],Yne=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],Zne={vertical:"top",horizontal:"right"},Qne={vertical:"top",horizontal:"left"},Jne=i=>{const{classes:e}=i;return en({root:["root"],paper:["paper"],list:["list"]},Xne,e)},eie=Qe(qne,{shouldForwardProp:i=>xa(i)||i==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(i,e)=>e.root})({}),tie=Qe(vV,{name:"MuiMenu",slot:"Paper",overridesResolver:(i,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),nie=Qe(Une,{name:"MuiMenu",slot:"List",overridesResolver:(i,e)=>e.list})({outline:0}),iie=I.forwardRef(function(e,n){var r,s;const o=Qt({props:e,name:"MuiMenu"}),{autoFocus:a=!0,children:l,className:c,disableAutoFocusItem:u=!1,MenuListProps:d={},onClose:h,open:f,PaperProps:p={},PopoverClasses:m,transitionDuration:y="auto",TransitionProps:{onEntering:v}={},variant:g="selectedMenu",slots:_={},slotProps:x={}}=o,b=rt(o.TransitionProps,Kne),S=rt(o,Yne),T=ZP(),w=z({},o,{autoFocus:a,disableAutoFocusItem:u,MenuListProps:d,onEntering:v,PaperProps:p,transitionDuration:y,TransitionProps:b,variant:g}),E=Jne(w),A=a&&!u&&f,M=I.useRef(null),R=(D,X)=>{M.current&&M.current.adjustStyleForScrollbar(D,{direction:T?"rtl":"ltr"}),v&&v(D,X)},F=D=>{D.key==="Tab"&&(D.preventDefault(),h&&h(D,"tabKeyDown"))};let B=-1;I.Children.map(l,(D,X)=>{I.isValidElement(D)&&(D.props.disabled||(g==="selectedMenu"&&D.props.selected||B===-1)&&(B=X))});const C=(r=_.paper)!=null?r:tie,L=(s=x.paper)!=null?s:p,P=fa({elementType:_.root,externalSlotProps:x.root,ownerState:w,className:[E.root,c]}),W=fa({elementType:C,externalSlotProps:L,ownerState:w,className:E.paper});return Y(eie,z({onClose:h,anchorOrigin:{vertical:"bottom",horizontal:T?"right":"left"},transformOrigin:T?Zne:Qne,slots:{paper:C,root:_.root},slotProps:{root:P,paper:W},open:f,ref:n,transitionDuration:y,TransitionProps:z({onEntering:R},b),ownerState:w},S,{classes:m,children:Y(nie,z({onKeyDown:F,actions:M,autoFocus:a&&(B===-1||u),autoFocusItem:A,variant:g},d,{className:ft(E.list,d.className),children:l}))}))}),rie=iie;function sie(i){return Zt("MuiNativeSelect",i)}const oie=jt("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),lN=oie,aie=["className","disabled","error","IconComponent","inputRef","variant"],lie=i=>{const{classes:e,variant:n,disabled:r,multiple:s,open:o,error:a}=i,l={select:["select",n,r&&"disabled",s&&"multiple",a&&"error"],icon:["icon",`icon${We(n)}`,o&&"iconOpen",r&&"disabled"]};return en(l,sie,e)},xV=({ownerState:i,theme:e})=>z({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":z({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${lN.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},i.variant==="filled"&&{"&&&":{paddingRight:32}},i.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),cie=Qe("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:xa,overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.select,e[n.variant],n.error&&e.error,{[`&.${lN.multiple}`]:e.multiple}]}})(xV),_V=({ownerState:i,theme:e})=>z({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${lN.disabled}`]:{color:(e.vars||e).palette.action.disabled}},i.open&&{transform:"rotate(180deg)"},i.variant==="filled"&&{right:7},i.variant==="outlined"&&{right:7}),uie=Qe("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.icon,n.variant&&e[`icon${We(n.variant)}`],n.open&&e.iconOpen]}})(_V),die=I.forwardRef(function(e,n){const{className:r,disabled:s,error:o,IconComponent:a,inputRef:l,variant:c="standard"}=e,u=rt(e,aie),d=z({},e,{disabled:s,variant:c,error:o}),h=lie(d);return lt(I.Fragment,{children:[Y(cie,z({ownerState:d,className:ft(h.select,r),disabled:s,ref:l||n},u)),e.multiple?null:Y(uie,{as:a,ownerState:d,className:h.icon})]})}),hie=die;var jI;const fie=["children","classes","className","label","notched"],pie=Qe("fieldset",{shouldForwardProp:xa})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),mie=Qe("legend",{shouldForwardProp:xa})(({ownerState:i,theme:e})=>z({float:"unset",width:"auto",overflow:"hidden"},!i.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},i.withLabel&&z({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},i.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function gie(i){const{className:e,label:n,notched:r}=i,s=rt(i,fie),o=n!=null&&n!=="",a=z({},i,{notched:r,withLabel:o});return Y(pie,z({"aria-hidden":!0,className:e,ownerState:a},s,{children:Y(mie,{ownerState:a,children:o?Y("span",{children:n}):jI||(jI=Y("span",{className:"notranslate",children:"​"}))})}))}const yie=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],vie=i=>{const{classes:e}=i,r=en({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},NJ,e);return z({},e,r)},xie=Qe(NS,{shouldForwardProp:i=>xa(i)||i==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:RS})(({theme:i,ownerState:e})=>{const n=i.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return z({position:"relative",borderRadius:(i.vars||i).shape.borderRadius,[`&:hover .${gc.notchedOutline}`]:{borderColor:(i.vars||i).palette.text.primary},"@media (hover: none)":{[`&:hover .${gc.notchedOutline}`]:{borderColor:i.vars?`rgba(${i.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${gc.focused} .${gc.notchedOutline}`]:{borderColor:(i.vars||i).palette[e.color].main,borderWidth:2},[`&.${gc.error} .${gc.notchedOutline}`]:{borderColor:(i.vars||i).palette.error.main},[`&.${gc.disabled} .${gc.notchedOutline}`]:{borderColor:(i.vars||i).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&z({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),_ie=Qe(gie,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(i,e)=>e.notchedOutline})(({theme:i})=>{const e=i.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:i.vars?`rgba(${i.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),bie=Qe(kS,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:PS})(({theme:i,ownerState:e})=>z({padding:"16.5px 14px"},!i.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:i.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:i.palette.mode==="light"?null:"#fff",caretColor:i.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},i.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[i.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),bV=I.forwardRef(function(e,n){var r,s,o,a,l;const c=Qt({props:e,name:"MuiOutlinedInput"}),{components:u={},fullWidth:d=!1,inputComponent:h="input",label:f,multiline:p=!1,notched:m,slots:y={},type:v="text"}=c,g=rt(c,yie),_=vie(c),x=Xp(),b=qp({props:c,muiFormControl:x,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),S=z({},c,{color:b.color||"primary",disabled:b.disabled,error:b.error,focused:b.focused,formControl:x,fullWidth:d,hiddenLabel:b.hiddenLabel,multiline:p,size:b.size,type:v}),T=(r=(s=y.root)!=null?s:u.Root)!=null?r:xie,w=(o=(a=y.input)!=null?a:u.Input)!=null?o:bie;return Y(aN,z({slots:{root:T,input:w},renderSuffix:E=>Y(_ie,{ownerState:S,className:_.notchedOutline,label:f!=null&&f!==""&&b.required?l||(l=lt(I.Fragment,{children:[f," ","*"]})):f,notched:typeof m<"u"?m:!!(E.startAdornment||E.filled||E.focused)}),fullWidth:d,inputComponent:h,multiline:p,ref:n,type:v},g,{classes:z({},_,{notchedOutline:null})}))});bV.muiName="Input";const SV=bV;function Sie(i){return Zt("MuiSelect",i)}const wie=jt("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Am=wie;var qI;const Tie=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],Eie=Qe("div",{name:"MuiSelect",slot:"Select",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[{[`&.${Am.select}`]:e.select},{[`&.${Am.select}`]:e[n.variant]},{[`&.${Am.error}`]:e.error},{[`&.${Am.multiple}`]:e.multiple}]}})(xV,{[`&.${Am.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Mie=Qe("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.icon,n.variant&&e[`icon${We(n.variant)}`],n.open&&e.iconOpen]}})(_V),Aie=Qe("input",{shouldForwardProp:i=>J5(i)&&i!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(i,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function XI(i,e){return typeof e=="object"&&e!==null?i===e:String(i)===String(e)}function Cie(i){return i==null||typeof i=="string"&&!i.trim()}const Rie=i=>{const{classes:e,variant:n,disabled:r,multiple:s,open:o,error:a}=i,l={select:["select",n,r&&"disabled",s&&"multiple",a&&"error"],icon:["icon",`icon${We(n)}`,o&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return en(l,Sie,e)},Pie=I.forwardRef(function(e,n){var r;const{"aria-describedby":s,"aria-label":o,autoFocus:a,autoWidth:l,children:c,className:u,defaultOpen:d,defaultValue:h,disabled:f,displayEmpty:p,error:m=!1,IconComponent:y,inputRef:v,labelId:g,MenuProps:_={},multiple:x,name:b,onBlur:S,onChange:T,onClose:w,onFocus:E,onOpen:A,open:M,readOnly:R,renderValue:F,SelectDisplayProps:B={},tabIndex:C,value:L,variant:P="standard"}=e,W=rt(e,Tie),[D,X]=nI({controlled:L,default:h,name:"Select"}),[q,J]=nI({controlled:M,default:d,name:"Select"}),se=I.useRef(null),de=I.useRef(null),[G,Q]=I.useState(null),{current:ee}=I.useRef(M!=null),[ie,Se]=I.useState(),Fe=dr(n,v),Be=I.useCallback(ke=>{de.current=ke,ke&&Q(ke)},[]),ct=G==null?void 0:G.parentNode;I.useImperativeHandle(Fe,()=>({focus:()=>{de.current.focus()},node:se.current,value:D}),[D]),I.useEffect(()=>{d&&q&&G&&!ee&&(Se(l?null:ct.clientWidth),de.current.focus())},[G,l]),I.useEffect(()=>{a&&de.current.focus()},[a]),I.useEffect(()=>{if(!g)return;const ke=Sr(de.current).getElementById(g);if(ke){const Ye=()=>{getSelection().isCollapsed&&de.current.focus()};return ke.addEventListener("click",Ye),()=>{ke.removeEventListener("click",Ye)}}},[g]);const xt=(ke,Ye)=>{ke?A&&A(Ye):w&&w(Ye),ee||(Se(l?null:ct.clientWidth),J(ke))},He=ke=>{ke.button===0&&(ke.preventDefault(),de.current.focus(),xt(!0,ke))},Z=ke=>{xt(!1,ke)},Nt=I.Children.toArray(c),Rt=ke=>{const Ye=Nt.find(pe=>pe.props.value===ke.target.value);Ye!==void 0&&(X(Ye.props.value),T&&T(ke,Ye))},mt=ke=>Ye=>{let pe;if(Ye.currentTarget.hasAttribute("tabindex")){if(x){pe=Array.isArray(D)?D.slice():[];const Ue=D.indexOf(ke.props.value);Ue===-1?pe.push(ke.props.value):pe.splice(Ue,1)}else pe=ke.props.value;if(ke.props.onClick&&ke.props.onClick(Ye),D!==pe&&(X(pe),T)){const Ue=Ye.nativeEvent||Ye,tt=new Ue.constructor(Ue.type,Ue);Object.defineProperty(tt,"target",{writable:!0,value:{value:pe,name:b}}),T(tt,ke)}x||xt(!1,Ye)}},Je=ke=>{R||[" ","ArrowUp","ArrowDown","Enter"].indexOf(ke.key)!==-1&&(ke.preventDefault(),xt(!0,ke))},qt=G!==null&&q,et=ke=>{!qt&&S&&(Object.defineProperty(ke,"target",{writable:!0,value:{value:D,name:b}}),S(ke))};delete W["aria-invalid"];let j,O;const ce=[];let ye=!1;(Ob({value:D})||p)&&(F?j=F(D):ye=!0);const Ae=Nt.map(ke=>{if(!I.isValidElement(ke))return null;let Ye;if(x){if(!Array.isArray(D))throw new Error(kd(2));Ye=D.some(pe=>XI(pe,ke.props.value)),Ye&&ye&&ce.push(ke.props.children)}else Ye=XI(D,ke.props.value),Ye&&ye&&(O=ke.props.children);return I.cloneElement(ke,{"aria-selected":Ye?"true":"false",onClick:mt(ke),onKeyUp:pe=>{pe.key===" "&&pe.preventDefault(),ke.props.onKeyUp&&ke.props.onKeyUp(pe)},role:"option",selected:Ye,value:void 0,"data-value":ke.props.value})});ye&&(x?ce.length===0?j=null:j=ce.reduce((ke,Ye,pe)=>(ke.push(Ye),pe<ce.length-1&&ke.push(", "),ke),[]):j=O);let we=ie;!l&&ee&&G&&(we=ct.clientWidth);let ot;typeof C<"u"?ot=C:ot=f?null:0;const Pe=B.id||(b?`mui-component-select-${b}`:void 0),Ce=z({},e,{variant:P,value:D,open:qt,error:m}),vt=Rie(Ce),Ne=z({},_.PaperProps,(r=_.slotProps)==null?void 0:r.paper),st=I5();return lt(I.Fragment,{children:[Y(Eie,z({ref:Be,tabIndex:ot,role:"combobox","aria-controls":st,"aria-disabled":f?"true":void 0,"aria-expanded":qt?"true":"false","aria-haspopup":"listbox","aria-label":o,"aria-labelledby":[g,Pe].filter(Boolean).join(" ")||void 0,"aria-describedby":s,onKeyDown:Je,onMouseDown:f||R?null:He,onBlur:et,onFocus:E},B,{ownerState:Ce,className:ft(B.className,vt.select,u),id:Pe,children:Cie(j)?qI||(qI=Y("span",{className:"notranslate",children:"​"})):j})),Y(Aie,z({"aria-invalid":m,value:Array.isArray(D)?D.join(","):D,name:b,ref:se,"aria-hidden":!0,onChange:Rt,tabIndex:-1,disabled:f,className:vt.nativeInput,autoFocus:a,ownerState:Ce},W)),Y(Mie,{as:y,className:vt.icon,ownerState:Ce}),Y(rie,z({id:`menu-${b||""}`,anchorEl:ct,open:qt,onClose:Z,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},_,{MenuListProps:z({"aria-labelledby":g,role:"listbox","aria-multiselectable":x?"true":void 0,disableListWrap:!0,id:st},_.MenuListProps),slotProps:z({},_.slotProps,{paper:z({},Ne,{style:z({minWidth:we},Ne!=null?Ne.style:null)})}),children:Ae}))]})}),Nie=Pie,kie=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],Lie=["root"],Iie=i=>{const{classes:e}=i;return e},cN={name:"MuiSelect",overridesResolver:(i,e)=>e.root,shouldForwardProp:i=>xa(i)&&i!=="variant",slot:"Root"},Die=Qe(mV,cN)(""),Oie=Qe(SV,cN)(""),Fie=Qe(uV,cN)(""),wV=I.forwardRef(function(e,n){const r=Qt({name:"MuiSelect",props:e}),{autoWidth:s=!1,children:o,classes:a={},className:l,defaultOpen:c=!1,displayEmpty:u=!1,IconComponent:d=DJ,id:h,input:f,inputProps:p,label:m,labelId:y,MenuProps:v,multiple:g=!1,native:_=!1,onClose:x,onOpen:b,open:S,renderValue:T,SelectDisplayProps:w,variant:E="outlined"}=r,A=rt(r,kie),M=_?hie:Nie,R=Xp(),F=qp({props:r,muiFormControl:R,states:["variant","error"]}),B=F.variant||E,C=z({},r,{variant:B,classes:a}),L=Iie(C),P=rt(L,Lie),W=f||{standard:Y(Die,{ownerState:C}),outlined:Y(Oie,{label:m,ownerState:C}),filled:Y(Fie,{ownerState:C})}[B],D=dr(n,Hp(W));return Y(I.Fragment,{children:I.cloneElement(W,z({inputComponent:M,inputProps:z({children:o,error:F.error,IconComponent:d,variant:B,type:void 0,multiple:g},_?{id:h}:{autoWidth:s,defaultOpen:c,displayEmpty:u,labelId:y,MenuProps:v,onClose:x,onOpen:b,open:S,renderValue:T,SelectDisplayProps:z({id:h},w)},p,{classes:p?Js(P,p.classes):P},f?f.props.inputProps:{})},(g&&_||u)&&B==="outlined"?{notched:!0}:{},{ref:D,className:ft(W.props.className,l,L.root)},!f&&{variant:B},A))})});wV.muiName="Select";const Bie=wV;function Uie(i={}){const{autoHideDuration:e=null,disableWindowBlurListener:n=!1,onClose:r,open:s,resumeHideDuration:o}=i,a=YP();I.useEffect(()=>{if(!s)return;function g(_){_.defaultPrevented||(_.key==="Escape"||_.key==="Esc")&&(r==null||r(_,"escapeKeyDown"))}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[s,r]);const l=Ks((g,_)=>{r==null||r(g,_)}),c=Ks(g=>{!r||g==null||a.start(g,()=>{l(null,"timeout")})});I.useEffect(()=>(s&&c(e),a.clear),[s,e,c,a]);const u=g=>{r==null||r(g,"clickaway")},d=a.clear,h=I.useCallback(()=>{e!=null&&c(o??e*.5)},[e,o,c]),f=g=>_=>{const x=g.onBlur;x==null||x(_),h()},p=g=>_=>{const x=g.onFocus;x==null||x(_),d()},m=g=>_=>{const x=g.onMouseEnter;x==null||x(_),d()},y=g=>_=>{const x=g.onMouseLeave;x==null||x(_),h()};return I.useEffect(()=>{if(!n&&s)return window.addEventListener("focus",h),window.addEventListener("blur",d),()=>{window.removeEventListener("focus",h),window.removeEventListener("blur",d)}},[n,s,h,d]),{getRootProps:(g={})=>{const _=z({},kb(i),kb(g));return z({role:"presentation"},g,_,{onBlur:f(_),onFocus:p(_),onMouseEnter:m(_),onMouseLeave:y(_)})},onClickAway:u}}function zie(i){return Zt("MuiSnackbarContent",i)}jt("MuiSnackbarContent",["root","message","action"]);const Vie=["action","className","message","role"],$ie=i=>{const{classes:e}=i;return en({root:["root"],action:["action"],message:["message"]},zie,e)},Gie=Qe(ec,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(i,e)=>e.root})(({theme:i})=>{const e=i.palette.mode==="light"?.8:.98,n=xY(i.palette.background.default,e);return z({},i.typography.body2,{color:i.vars?i.vars.palette.SnackbarContent.color:i.palette.getContrastText(n),backgroundColor:i.vars?i.vars.palette.SnackbarContent.bg:n,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(i.vars||i).shape.borderRadius,flexGrow:1,[i.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})}),Hie=Qe("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(i,e)=>e.message})({padding:"8px 0"}),Wie=Qe("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(i,e)=>e.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),jie=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiSnackbarContent"}),{action:s,className:o,message:a,role:l="alert"}=r,c=rt(r,Vie),u=r,d=$ie(u);return lt(Gie,z({role:l,square:!0,elevation:6,className:ft(d.root,o),ownerState:u,ref:n},c,{children:[Y(Hie,{className:d.message,ownerState:u,children:a}),s?Y(Wie,{className:d.action,ownerState:u,children:s}):null]}))}),qie=jie;function Xie(i){return Zt("MuiSnackbar",i)}jt("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Kie=["onEnter","onExited"],Yie=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],Zie=i=>{const{classes:e,anchorOrigin:n}=i,r={root:["root",`anchorOrigin${We(n.vertical)}${We(n.horizontal)}`]};return en(r,Xie,e)},KI=Qe("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[`anchorOrigin${We(n.anchorOrigin.vertical)}${We(n.anchorOrigin.horizontal)}`]]}})(({theme:i,ownerState:e})=>{const n={left:"50%",right:"auto",transform:"translateX(-50%)"};return z({zIndex:(i.vars||i).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},e.anchorOrigin.vertical==="top"?{top:8}:{bottom:8},e.anchorOrigin.horizontal==="left"&&{justifyContent:"flex-start"},e.anchorOrigin.horizontal==="right"&&{justifyContent:"flex-end"},{[i.breakpoints.up("sm")]:z({},e.anchorOrigin.vertical==="top"?{top:24}:{bottom:24},e.anchorOrigin.horizontal==="center"&&n,e.anchorOrigin.horizontal==="left"&&{left:24,right:"auto"},e.anchorOrigin.horizontal==="right"&&{right:24,left:"auto"})})}),Qie=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiSnackbar"}),s=L0(),o={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{action:a,anchorOrigin:{vertical:l,horizontal:c}={vertical:"bottom",horizontal:"left"},autoHideDuration:u=null,children:d,className:h,ClickAwayListenerProps:f,ContentProps:p,disableWindowBlurListener:m=!1,message:y,open:v,TransitionComponent:g=fV,transitionDuration:_=o,TransitionProps:{onEnter:x,onExited:b}={}}=r,S=rt(r.TransitionProps,Kie),T=rt(r,Yie),w=z({},r,{anchorOrigin:{vertical:l,horizontal:c},autoHideDuration:u,disableWindowBlurListener:m,TransitionComponent:g,transitionDuration:_}),E=Zie(w),{getRootProps:A,onClickAway:M}=Uie(z({},w)),[R,F]=I.useState(!0),B=fa({elementType:KI,getSlotProps:A,externalForwardedProps:T,ownerState:w,additionalProps:{ref:n},className:[E.root,h]}),C=P=>{F(!0),b&&b(P)},L=(P,W)=>{F(!1),x&&x(P,W)};return!v&&R?null:Y(Iee,z({onClickAway:M},f,{children:Y(KI,z({},B,{children:Y(g,z({appear:!0,in:v,timeout:_,direction:l==="top"?"down":"up",onEnter:L,onExited:C},S,{children:d||Y(qie,z({message:y,action:a},p))}))}))}))}),Jie=Qie;function ere(i){return Zt("MuiTab",i)}const tre=jt("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]),vc=tre,nre=["className","disabled","disableFocusRipple","fullWidth","icon","iconPosition","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"],ire=i=>{const{classes:e,textColor:n,fullWidth:r,wrapped:s,icon:o,label:a,selected:l,disabled:c}=i,u={root:["root",o&&a&&"labelIcon",`textColor${We(n)}`,r&&"fullWidth",s&&"wrapped",l&&"selected",c&&"disabled"],iconWrapper:["iconWrapper"]};return en(u,ere,e)},rre=Qe(Ld,{name:"MuiTab",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.label&&n.icon&&e.labelIcon,e[`textColor${We(n.textColor)}`],n.fullWidth&&e.fullWidth,n.wrapped&&e.wrapped,{[`& .${vc.iconWrapper}`]:e.iconWrapper}]}})(({theme:i,ownerState:e})=>z({},i.typography.button,{maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center"},e.label&&{flexDirection:e.iconPosition==="top"||e.iconPosition==="bottom"?"column":"row"},{lineHeight:1.25},e.icon&&e.label&&{minHeight:72,paddingTop:9,paddingBottom:9,[`& > .${vc.iconWrapper}`]:z({},e.iconPosition==="top"&&{marginBottom:6},e.iconPosition==="bottom"&&{marginTop:6},e.iconPosition==="start"&&{marginRight:i.spacing(1)},e.iconPosition==="end"&&{marginLeft:i.spacing(1)})},e.textColor==="inherit"&&{color:"inherit",opacity:.6,[`&.${vc.selected}`]:{opacity:1},[`&.${vc.disabled}`]:{opacity:(i.vars||i).palette.action.disabledOpacity}},e.textColor==="primary"&&{color:(i.vars||i).palette.text.secondary,[`&.${vc.selected}`]:{color:(i.vars||i).palette.primary.main},[`&.${vc.disabled}`]:{color:(i.vars||i).palette.text.disabled}},e.textColor==="secondary"&&{color:(i.vars||i).palette.text.secondary,[`&.${vc.selected}`]:{color:(i.vars||i).palette.secondary.main},[`&.${vc.disabled}`]:{color:(i.vars||i).palette.text.disabled}},e.fullWidth&&{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},e.wrapped&&{fontSize:i.typography.pxToRem(12)})),sre=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiTab"}),{className:s,disabled:o=!1,disableFocusRipple:a=!1,fullWidth:l,icon:c,iconPosition:u="top",indicator:d,label:h,onChange:f,onClick:p,onFocus:m,selected:y,selectionFollowsFocus:v,textColor:g="inherit",value:_,wrapped:x=!1}=r,b=rt(r,nre),S=z({},r,{disabled:o,disableFocusRipple:a,selected:y,icon:!!c,iconPosition:u,label:!!h,fullWidth:l,textColor:g,wrapped:x}),T=ire(S),w=c&&h&&I.isValidElement(c)?I.cloneElement(c,{className:ft(T.iconWrapper,c.props.className)}):c,E=M=>{!y&&f&&f(M,_),p&&p(M)},A=M=>{v&&!y&&f&&f(M,_),m&&m(M)};return lt(rre,z({focusRipple:!a,className:ft(T.root,s),ref:n,role:"tab","aria-selected":y,disabled:o,onClick:E,onFocus:A,ownerState:S,tabIndex:y?0:-1},b,{children:[u==="top"||u==="start"?lt(I.Fragment,{children:[w,h]}):lt(I.Fragment,{children:[h,w]}),d]}))}),MT=sre;function ore(i){return Zt("MuiToolbar",i)}jt("MuiToolbar",["root","gutters","regular","dense"]);const are=["className","component","disableGutters","variant"],lre=i=>{const{classes:e,disableGutters:n,variant:r}=i;return en({root:["root",!n&&"gutters",r]},ore,e)},cre=Qe("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,!n.disableGutters&&e.gutters,e[n.variant]]}})(({theme:i,ownerState:e})=>z({position:"relative",display:"flex",alignItems:"center"},!e.disableGutters&&{paddingLeft:i.spacing(2),paddingRight:i.spacing(2),[i.breakpoints.up("sm")]:{paddingLeft:i.spacing(3),paddingRight:i.spacing(3)}},e.variant==="dense"&&{minHeight:48}),({theme:i,ownerState:e})=>e.variant==="regular"&&i.mixins.toolbar),ure=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiToolbar"}),{className:s,component:o="div",disableGutters:a=!1,variant:l="regular"}=r,c=rt(r,are),u=z({},r,{component:o,disableGutters:a,variant:l}),d=lre(u);return Y(cre,z({as:o,className:ft(d.root,s),ref:n,ownerState:u},c))}),dre=ure,hre=lc(Y("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),fre=lc(Y("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight");function pre(i){return(1+Math.sin(Math.PI*i-Math.PI/2))/2}function mre(i,e,n,r={},s=()=>{}){const{ease:o=pre,duration:a=300}=r;let l=null;const c=e[i];let u=!1;const d=()=>{u=!0},h=f=>{if(u){s(new Error("Animation cancelled"));return}l===null&&(l=f);const p=Math.min(1,(f-l)/a);if(e[i]=o(p)*(n-c)+c,p>=1){requestAnimationFrame(()=>{s(null)});return}requestAnimationFrame(h)};return c===n?(s(new Error("Element already at target position")),d):(requestAnimationFrame(h),d)}const gre=["onChange"],yre={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function vre(i){const{onChange:e}=i,n=rt(i,gre),r=I.useRef(),s=I.useRef(null),o=()=>{r.current=s.current.offsetHeight-s.current.clientHeight};return Ql(()=>{const a=ES(()=>{const c=r.current;o(),c!==r.current&&e(r.current)}),l=Jl(s.current);return l.addEventListener("resize",a),()=>{a.clear(),l.removeEventListener("resize",a)}},[e]),I.useEffect(()=>{o(),e(r.current)},[e]),Y("div",z({style:yre},n,{ref:s}))}function xre(i){return Zt("MuiTabScrollButton",i)}const _re=jt("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),bre=_re,Sre=["className","slots","slotProps","direction","orientation","disabled"],wre=i=>{const{classes:e,orientation:n,disabled:r}=i;return en({root:["root",n,r&&"disabled"]},xre,e)},Tre=Qe(Ld,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.orientation&&e[n.orientation]]}})(({ownerState:i})=>z({width:40,flexShrink:0,opacity:.8,[`&.${bre.disabled}`]:{opacity:0}},i.orientation==="vertical"&&{width:"100%",height:40,"& svg":{transform:`rotate(${i.isRtl?-90:90}deg)`}})),Ere=I.forwardRef(function(e,n){var r,s;const o=Qt({props:e,name:"MuiTabScrollButton"}),{className:a,slots:l={},slotProps:c={},direction:u}=o,d=rt(o,Sre),h=ZP(),f=z({isRtl:h},o),p=wre(f),m=(r=l.StartScrollButtonIcon)!=null?r:hre,y=(s=l.EndScrollButtonIcon)!=null?s:fre,v=fa({elementType:m,externalSlotProps:c.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:f}),g=fa({elementType:y,externalSlotProps:c.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:f});return Y(Tre,z({component:"div",className:ft(p.root,a),ref:n,role:null,ownerState:f,tabIndex:null},d,{children:u==="left"?Y(m,z({},v)):Y(y,z({},g))}))}),Mre=Ere;function Are(i){return Zt("MuiTabs",i)}const Cre=jt("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),AT=Cre,Rre=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","slots","slotProps","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],YI=(i,e)=>i===e?i.firstChild:e&&e.nextElementSibling?e.nextElementSibling:i.firstChild,ZI=(i,e)=>i===e?i.lastChild:e&&e.previousElementSibling?e.previousElementSibling:i.lastChild,Iv=(i,e,n)=>{let r=!1,s=n(i,e);for(;s;){if(s===i.firstChild){if(r)return;r=!0}const o=s.disabled||s.getAttribute("aria-disabled")==="true";if(!s.hasAttribute("tabindex")||o)s=n(i,s);else{s.focus();return}}},Pre=i=>{const{vertical:e,fixed:n,hideScrollbar:r,scrollableX:s,scrollableY:o,centered:a,scrollButtonsHideMobile:l,classes:c}=i;return en({root:["root",e&&"vertical"],scroller:["scroller",n&&"fixed",r&&"hideScrollbar",s&&"scrollableX",o&&"scrollableY"],flexContainer:["flexContainer",e&&"flexContainerVertical",a&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",l&&"scrollButtonsHideMobile"],scrollableX:[s&&"scrollableX"],hideScrollbar:[r&&"hideScrollbar"]},Are,c)},Nre=Qe("div",{name:"MuiTabs",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[{[`& .${AT.scrollButtons}`]:e.scrollButtons},{[`& .${AT.scrollButtons}`]:n.scrollButtonsHideMobile&&e.scrollButtonsHideMobile},e.root,n.vertical&&e.vertical]}})(({ownerState:i,theme:e})=>z({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},i.vertical&&{flexDirection:"column"},i.scrollButtonsHideMobile&&{[`& .${AT.scrollButtons}`]:{[e.breakpoints.down("sm")]:{display:"none"}}})),kre=Qe("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.scroller,n.fixed&&e.fixed,n.hideScrollbar&&e.hideScrollbar,n.scrollableX&&e.scrollableX,n.scrollableY&&e.scrollableY]}})(({ownerState:i})=>z({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},i.fixed&&{overflowX:"hidden",width:"100%"},i.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},i.scrollableX&&{overflowX:"auto",overflowY:"hidden"},i.scrollableY&&{overflowY:"auto",overflowX:"hidden"})),Lre=Qe("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.flexContainer,n.vertical&&e.flexContainerVertical,n.centered&&e.centered]}})(({ownerState:i})=>z({display:"flex"},i.vertical&&{flexDirection:"column"},i.centered&&{justifyContent:"center"})),Ire=Qe("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(i,e)=>e.indicator})(({ownerState:i,theme:e})=>z({position:"absolute",height:2,bottom:0,width:"100%",transition:e.transitions.create()},i.indicatorColor==="primary"&&{backgroundColor:(e.vars||e).palette.primary.main},i.indicatorColor==="secondary"&&{backgroundColor:(e.vars||e).palette.secondary.main},i.vertical&&{height:"100%",width:2,right:0})),Dre=Qe(vre)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),QI={},Ore=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiTabs"}),s=L0(),o=ZP(),{"aria-label":a,"aria-labelledby":l,action:c,centered:u=!1,children:d,className:h,component:f="div",allowScrollButtonsMobile:p=!1,indicatorColor:m="primary",onChange:y,orientation:v="horizontal",ScrollButtonComponent:g=Mre,scrollButtons:_="auto",selectionFollowsFocus:x,slots:b={},slotProps:S={},TabIndicatorProps:T={},TabScrollButtonProps:w={},textColor:E="primary",value:A,variant:M="standard",visibleScrollbar:R=!1}=r,F=rt(r,Rre),B=M==="scrollable",C=v==="vertical",L=C?"scrollTop":"scrollLeft",P=C?"top":"left",W=C?"bottom":"right",D=C?"clientHeight":"clientWidth",X=C?"height":"width",q=z({},r,{component:f,allowScrollButtonsMobile:p,indicatorColor:m,orientation:v,vertical:C,scrollButtons:_,textColor:E,variant:M,visibleScrollbar:R,fixed:!B,hideScrollbar:B&&!R,scrollableX:B&&!C,scrollableY:B&&C,centered:u&&!B,scrollButtonsHideMobile:!p}),J=Pre(q),se=fa({elementType:b.StartScrollButtonIcon,externalSlotProps:S.startScrollButtonIcon,ownerState:q}),de=fa({elementType:b.EndScrollButtonIcon,externalSlotProps:S.endScrollButtonIcon,ownerState:q}),[G,Q]=I.useState(!1),[ee,ie]=I.useState(QI),[Se,Fe]=I.useState(!1),[Be,ct]=I.useState(!1),[xt,He]=I.useState(!1),[Z,Nt]=I.useState({overflow:"hidden",scrollbarWidth:0}),Rt=new Map,mt=I.useRef(null),Je=I.useRef(null),qt=()=>{const pe=mt.current;let Ue;if(pe){const _t=pe.getBoundingClientRect();Ue={clientWidth:pe.clientWidth,scrollLeft:pe.scrollLeft,scrollTop:pe.scrollTop,scrollLeftNormalized:ZK(pe,o?"rtl":"ltr"),scrollWidth:pe.scrollWidth,top:_t.top,bottom:_t.bottom,left:_t.left,right:_t.right}}let tt;if(pe&&A!==!1){const _t=Je.current.children;if(_t.length>0){const ne=_t[Rt.get(A)];tt=ne?ne.getBoundingClientRect():null}}return{tabsMeta:Ue,tabMeta:tt}},et=Ks(()=>{const{tabsMeta:pe,tabMeta:Ue}=qt();let tt=0,_t;if(C)_t="top",Ue&&pe&&(tt=Ue.top-pe.top+pe.scrollTop);else if(_t=o?"right":"left",Ue&&pe){const $e=o?pe.scrollLeftNormalized+pe.clientWidth-pe.scrollWidth:pe.scrollLeft;tt=(o?-1:1)*(Ue[_t]-pe[_t]+$e)}const ne={[_t]:tt,[X]:Ue?Ue[X]:0};if(isNaN(ee[_t])||isNaN(ee[X]))ie(ne);else{const $e=Math.abs(ee[_t]-ne[_t]),me=Math.abs(ee[X]-ne[X]);($e>=1||me>=1)&&ie(ne)}}),j=(pe,{animation:Ue=!0}={})=>{Ue?mre(L,mt.current,pe,{duration:s.transitions.duration.standard}):mt.current[L]=pe},O=pe=>{let Ue=mt.current[L];C?Ue+=pe:(Ue+=pe*(o?-1:1),Ue*=o&&O5()==="reverse"?-1:1),j(Ue)},ce=()=>{const pe=mt.current[D];let Ue=0;const tt=Array.from(Je.current.children);for(let _t=0;_t<tt.length;_t+=1){const ne=tt[_t];if(Ue+ne[D]>pe){_t===0&&(Ue=pe);break}Ue+=ne[D]}return Ue},ye=()=>{O(-1*ce())},Ae=()=>{O(ce())},we=I.useCallback(pe=>{Nt({overflow:null,scrollbarWidth:pe})},[]),ot=()=>{const pe={};pe.scrollbarSizeListener=B?Y(Dre,{onChange:we,className:ft(J.scrollableX,J.hideScrollbar)}):null;const tt=B&&(_==="auto"&&(Se||Be)||_===!0);return pe.scrollButtonStart=tt?Y(g,z({slots:{StartScrollButtonIcon:b.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:se},orientation:v,direction:o?"right":"left",onClick:ye,disabled:!Se},w,{className:ft(J.scrollButtons,w.className)})):null,pe.scrollButtonEnd=tt?Y(g,z({slots:{EndScrollButtonIcon:b.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:de},orientation:v,direction:o?"left":"right",onClick:Ae,disabled:!Be},w,{className:ft(J.scrollButtons,w.className)})):null,pe},Pe=Ks(pe=>{const{tabsMeta:Ue,tabMeta:tt}=qt();if(!(!tt||!Ue)){if(tt[P]<Ue[P]){const _t=Ue[L]+(tt[P]-Ue[P]);j(_t,{animation:pe})}else if(tt[W]>Ue[W]){const _t=Ue[L]+(tt[W]-Ue[W]);j(_t,{animation:pe})}}}),Ce=Ks(()=>{B&&_!==!1&&He(!xt)});I.useEffect(()=>{const pe=ES(()=>{mt.current&&et()});let Ue;const tt=$e=>{$e.forEach(me=>{me.removedNodes.forEach(Me=>{var Xe;(Xe=Ue)==null||Xe.unobserve(Me)}),me.addedNodes.forEach(Me=>{var Xe;(Xe=Ue)==null||Xe.observe(Me)})}),pe(),Ce()},_t=Jl(mt.current);_t.addEventListener("resize",pe);let ne;return typeof ResizeObserver<"u"&&(Ue=new ResizeObserver(pe),Array.from(Je.current.children).forEach($e=>{Ue.observe($e)})),typeof MutationObserver<"u"&&(ne=new MutationObserver(tt),ne.observe(Je.current,{childList:!0})),()=>{var $e,me;pe.clear(),_t.removeEventListener("resize",pe),($e=ne)==null||$e.disconnect(),(me=Ue)==null||me.disconnect()}},[et,Ce]),I.useEffect(()=>{const pe=Array.from(Je.current.children),Ue=pe.length;if(typeof IntersectionObserver<"u"&&Ue>0&&B&&_!==!1){const tt=pe[0],_t=pe[Ue-1],ne={root:mt.current,threshold:.99},$e=Ze=>{Fe(!Ze[0].isIntersecting)},me=new IntersectionObserver($e,ne);me.observe(tt);const Me=Ze=>{ct(!Ze[0].isIntersecting)},Xe=new IntersectionObserver(Me,ne);return Xe.observe(_t),()=>{me.disconnect(),Xe.disconnect()}}},[B,_,xt,d==null?void 0:d.length]),I.useEffect(()=>{Q(!0)},[]),I.useEffect(()=>{et()}),I.useEffect(()=>{Pe(QI!==ee)},[Pe,ee]),I.useImperativeHandle(c,()=>({updateIndicator:et,updateScrollButtons:Ce}),[et,Ce]);const vt=Y(Ire,z({},T,{className:ft(J.indicator,T.className),ownerState:q,style:z({},ee,T.style)}));let Ne=0;const st=I.Children.map(d,pe=>{if(!I.isValidElement(pe))return null;const Ue=pe.props.value===void 0?Ne:pe.props.value;Rt.set(Ue,Ne);const tt=Ue===A;return Ne+=1,I.cloneElement(pe,z({fullWidth:M==="fullWidth",indicator:tt&&!G&&vt,selected:tt,selectionFollowsFocus:x,onChange:y,textColor:E,value:Ue},Ne===1&&A===!1&&!pe.props.tabIndex?{tabIndex:0}:{}))}),ke=pe=>{const Ue=Je.current,tt=Sr(Ue).activeElement;if(tt.getAttribute("role")!=="tab")return;let ne=v==="horizontal"?"ArrowLeft":"ArrowUp",$e=v==="horizontal"?"ArrowRight":"ArrowDown";switch(v==="horizontal"&&o&&(ne="ArrowRight",$e="ArrowLeft"),pe.key){case ne:pe.preventDefault(),Iv(Ue,tt,ZI);break;case $e:pe.preventDefault(),Iv(Ue,tt,YI);break;case"Home":pe.preventDefault(),Iv(Ue,null,YI);break;case"End":pe.preventDefault(),Iv(Ue,null,ZI);break}},Ye=ot();return lt(Nre,z({className:ft(J.root,h),ownerState:q,ref:n,as:f},F,{children:[Ye.scrollButtonStart,Ye.scrollbarSizeListener,lt(kre,{className:J.scroller,ownerState:q,style:{overflow:Z.overflow,[C?`margin${o?"Left":"Right"}`:"marginBottom"]:R?void 0:-Z.scrollbarWidth},ref:mt,children:[Y(Lre,{"aria-label":a,"aria-labelledby":l,"aria-orientation":v==="vertical"?"vertical":null,className:J.flexContainer,ownerState:q,onKeyDown:ke,ref:Je,role:"tablist",children:st}),G&&vt]}),Ye.scrollButtonEnd]}))}),Fre=Ore;function Bre(i){return Zt("MuiTextField",i)}jt("MuiTextField",["root"]);const Ure=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],zre={standard:mV,filled:uV,outlined:SV},Vre=i=>{const{classes:e}=i;return en({root:["root"]},Bre,e)},$re=Qe(xte,{name:"MuiTextField",slot:"Root",overridesResolver:(i,e)=>e.root})({}),Gre=I.forwardRef(function(e,n){const r=Qt({props:e,name:"MuiTextField"}),{autoComplete:s,autoFocus:o=!1,children:a,className:l,color:c="primary",defaultValue:u,disabled:d=!1,error:h=!1,FormHelperTextProps:f,fullWidth:p=!1,helperText:m,id:y,InputLabelProps:v,inputProps:g,InputProps:_,inputRef:x,label:b,maxRows:S,minRows:T,multiline:w=!1,name:E,onBlur:A,onChange:M,onFocus:R,placeholder:F,required:B=!1,rows:C,select:L=!1,SelectProps:P,type:W,value:D,variant:X="outlined"}=r,q=rt(r,Ure),J=z({},r,{autoFocus:o,color:c,disabled:d,error:h,fullWidth:p,multiline:w,required:B,select:L,variant:X}),se=Vre(J),de={};X==="outlined"&&(v&&typeof v.shrink<"u"&&(de.notched=v.shrink),de.label=b),L&&((!P||!P.native)&&(de.id=void 0),de["aria-describedby"]=void 0);const G=I5(y),Q=m&&G?`${G}-helper-text`:void 0,ee=b&&G?`${G}-label`:void 0,ie=zre[X],Se=Y(ie,z({"aria-describedby":Q,autoComplete:s,autoFocus:o,defaultValue:u,fullWidth:p,multiline:w,name:E,rows:C,maxRows:S,minRows:T,type:W,value:D,id:G,inputRef:x,onBlur:A,onChange:M,onFocus:R,placeholder:F,inputProps:g},de,_));return lt($re,z({className:ft(se.root,l),disabled:d,error:h,fullWidth:p,ref:n,required:B,color:c,variant:X,ownerState:J},q,{children:[b!=null&&b!==""&&Y(lne,z({htmlFor:G,id:ee},v,{children:b})),L?Y(Bie,z({"aria-describedby":Q,id:G,labelId:ee,value:D,input:Se},P,{children:a})):Se,m&&Y(Mte,z({id:Q},f,{children:m}))]}))}),Hre=Gre,Wre=()=>lt(An,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[Y(rJ,{position:"static",children:lt(dre,{children:[Y(It,{variant:"h6",component:"div",sx:{flexGrow:1},children:Y(Vl,{to:"/",style:{color:"white",textDecoration:"none"},children:"Microservice Migration AI"})}),Y(Ys,{color:"inherit",component:Vl,to:"/",children:"Home"}),Y(Ys,{color:"inherit",component:Vl,to:"/analyze",children:"Analyze Repository"})]})}),Y(DI,{component:"main",sx:{flexGrow:1,py:4},children:Y(D7,{})}),Y(An,{component:"footer",sx:{py:3,px:2,mt:"auto",backgroundColor:"rgba(0, 0, 0, 0.03)"},children:Y(DI,{maxWidth:"sm",children:lt(It,{variant:"body2",color:"text.secondary",align:"center",children:["© ",new Date().getFullYear()," Microservice Migration AI"]})})})]});function TV(i,e){return function(){return i.apply(e,arguments)}}const{toString:jre}=Object.prototype,{getPrototypeOf:uN}=Object,{iterator:IS,toStringTag:EV}=Symbol,DS=(i=>e=>{const n=jre.call(e);return i[n]||(i[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),_a=i=>(i=i.toLowerCase(),e=>DS(e)===i),OS=i=>e=>typeof e===i,{isArray:Kp}=Array,ky=OS("undefined");function qre(i){return i!==null&&!ky(i)&&i.constructor!==null&&!ky(i.constructor)&&As(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}const MV=_a("ArrayBuffer");function Xre(i){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(i):e=i&&i.buffer&&MV(i.buffer),e}const Kre=OS("string"),As=OS("function"),AV=OS("number"),FS=i=>i!==null&&typeof i=="object",Yre=i=>i===!0||i===!1,L_=i=>{if(DS(i)!=="object")return!1;const e=uN(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(EV in i)&&!(IS in i)},Zre=_a("Date"),Qre=_a("File"),Jre=_a("Blob"),ese=_a("FileList"),tse=i=>FS(i)&&As(i.pipe),nse=i=>{let e;return i&&(typeof FormData=="function"&&i instanceof FormData||As(i.append)&&((e=DS(i))==="formdata"||e==="object"&&As(i.toString)&&i.toString()==="[object FormData]"))},ise=_a("URLSearchParams"),[rse,sse,ose,ase]=["ReadableStream","Request","Response","Headers"].map(_a),lse=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function D0(i,e,{allOwnKeys:n=!1}={}){if(i===null||typeof i>"u")return;let r,s;if(typeof i!="object"&&(i=[i]),Kp(i))for(r=0,s=i.length;r<s;r++)e.call(null,i[r],r,i);else{const o=n?Object.getOwnPropertyNames(i):Object.keys(i),a=o.length;let l;for(r=0;r<a;r++)l=o[r],e.call(null,i[l],l,i)}}function CV(i,e){e=e.toLowerCase();const n=Object.keys(i);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const gd=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),RV=i=>!ky(i)&&i!==gd;function mC(){const{caseless:i}=RV(this)&&this||{},e={},n=(r,s)=>{const o=i&&CV(e,s)||s;L_(e[o])&&L_(r)?e[o]=mC(e[o],r):L_(r)?e[o]=mC({},r):Kp(r)?e[o]=r.slice():e[o]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&D0(arguments[r],n);return e}const cse=(i,e,n,{allOwnKeys:r}={})=>(D0(e,(s,o)=>{n&&As(s)?i[o]=TV(s,n):i[o]=s},{allOwnKeys:r}),i),use=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),dse=(i,e,n,r)=>{i.prototype=Object.create(e.prototype,r),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:e.prototype}),n&&Object.assign(i.prototype,n)},hse=(i,e,n,r)=>{let s,o,a;const l={};if(e=e||{},i==null)return e;do{for(s=Object.getOwnPropertyNames(i),o=s.length;o-- >0;)a=s[o],(!r||r(a,i,e))&&!l[a]&&(e[a]=i[a],l[a]=!0);i=n!==!1&&uN(i)}while(i&&(!n||n(i,e))&&i!==Object.prototype);return e},fse=(i,e,n)=>{i=String(i),(n===void 0||n>i.length)&&(n=i.length),n-=e.length;const r=i.indexOf(e,n);return r!==-1&&r===n},pse=i=>{if(!i)return null;if(Kp(i))return i;let e=i.length;if(!AV(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=i[e];return n},mse=(i=>e=>i&&e instanceof i)(typeof Uint8Array<"u"&&uN(Uint8Array)),gse=(i,e)=>{const r=(i&&i[IS]).call(i);let s;for(;(s=r.next())&&!s.done;){const o=s.value;e.call(i,o[0],o[1])}},yse=(i,e)=>{let n;const r=[];for(;(n=i.exec(e))!==null;)r.push(n);return r},vse=_a("HTMLFormElement"),xse=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),JI=(({hasOwnProperty:i})=>(e,n)=>i.call(e,n))(Object.prototype),_se=_a("RegExp"),PV=(i,e)=>{const n=Object.getOwnPropertyDescriptors(i),r={};D0(n,(s,o)=>{let a;(a=e(s,o,i))!==!1&&(r[o]=a||s)}),Object.defineProperties(i,r)},bse=i=>{PV(i,(e,n)=>{if(As(i)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=i[n];if(As(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Sse=(i,e)=>{const n={},r=s=>{s.forEach(o=>{n[o]=!0})};return Kp(i)?r(i):r(String(i).split(e)),n},wse=()=>{},Tse=(i,e)=>i!=null&&Number.isFinite(i=+i)?i:e;function Ese(i){return!!(i&&As(i.append)&&i[EV]==="FormData"&&i[IS])}const Mse=i=>{const e=new Array(10),n=(r,s)=>{if(FS(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const o=Kp(r)?[]:{};return D0(r,(a,l)=>{const c=n(a,s+1);!ky(c)&&(o[l]=c)}),e[s]=void 0,o}}return r};return n(i,0)},Ase=_a("AsyncFunction"),Cse=i=>i&&(FS(i)||As(i))&&As(i.then)&&As(i.catch),NV=((i,e)=>i?setImmediate:e?((n,r)=>(gd.addEventListener("message",({source:s,data:o})=>{s===gd&&o===n&&r.length&&r.shift()()},!1),s=>{r.push(s),gd.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",As(gd.postMessage)),Rse=typeof queueMicrotask<"u"?queueMicrotask.bind(gd):typeof process<"u"&&process.nextTick||NV,Pse=i=>i!=null&&As(i[IS]),ve={isArray:Kp,isArrayBuffer:MV,isBuffer:qre,isFormData:nse,isArrayBufferView:Xre,isString:Kre,isNumber:AV,isBoolean:Yre,isObject:FS,isPlainObject:L_,isReadableStream:rse,isRequest:sse,isResponse:ose,isHeaders:ase,isUndefined:ky,isDate:Zre,isFile:Qre,isBlob:Jre,isRegExp:_se,isFunction:As,isStream:tse,isURLSearchParams:ise,isTypedArray:mse,isFileList:ese,forEach:D0,merge:mC,extend:cse,trim:lse,stripBOM:use,inherits:dse,toFlatObject:hse,kindOf:DS,kindOfTest:_a,endsWith:fse,toArray:pse,forEachEntry:gse,matchAll:yse,isHTMLForm:vse,hasOwnProperty:JI,hasOwnProp:JI,reduceDescriptors:PV,freezeMethods:bse,toObjectSet:Sse,toCamelCase:xse,noop:wse,toFiniteNumber:Tse,findKey:CV,global:gd,isContextDefined:RV,isSpecCompliantForm:Ese,toJSONObject:Mse,isAsyncFn:Ase,isThenable:Cse,setImmediate:NV,asap:Rse,isIterable:Pse};function Kt(i,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}ve.inherits(Kt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ve.toJSONObject(this.config),code:this.code,status:this.status}}});const kV=Kt.prototype,LV={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{LV[i]={value:i}});Object.defineProperties(Kt,LV);Object.defineProperty(kV,"isAxiosError",{value:!0});Kt.from=(i,e,n,r,s,o)=>{const a=Object.create(kV);return ve.toFlatObject(i,a,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),Kt.call(a,i.message,e,n,r,s),a.cause=i,a.name=i.name,o&&Object.assign(a,o),a};const Nse=null;function gC(i){return ve.isPlainObject(i)||ve.isArray(i)}function IV(i){return ve.endsWith(i,"[]")?i.slice(0,-2):i}function eD(i,e,n){return i?i.concat(e).map(function(s,o){return s=IV(s),!n&&o?"["+s+"]":s}).join(n?".":""):e}function kse(i){return ve.isArray(i)&&!i.some(gC)}const Lse=ve.toFlatObject(ve,{},null,function(e){return/^is[A-Z]/.test(e)});function BS(i,e,n){if(!ve.isObject(i))throw new TypeError("target must be an object");e=e||new FormData,n=ve.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,v){return!ve.isUndefined(v[y])});const r=n.metaTokens,s=n.visitor||d,o=n.dots,a=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&ve.isSpecCompliantForm(e);if(!ve.isFunction(s))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(ve.isDate(m))return m.toISOString();if(!c&&ve.isBlob(m))throw new Kt("Blob is not supported. Use a Buffer instead.");return ve.isArrayBuffer(m)||ve.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,y,v){let g=m;if(m&&!v&&typeof m=="object"){if(ve.endsWith(y,"{}"))y=r?y:y.slice(0,-2),m=JSON.stringify(m);else if(ve.isArray(m)&&kse(m)||(ve.isFileList(m)||ve.endsWith(y,"[]"))&&(g=ve.toArray(m)))return y=IV(y),g.forEach(function(x,b){!(ve.isUndefined(x)||x===null)&&e.append(a===!0?eD([y],b,o):a===null?y:y+"[]",u(x))}),!1}return gC(m)?!0:(e.append(eD(v,y,o),u(m)),!1)}const h=[],f=Object.assign(Lse,{defaultVisitor:d,convertValue:u,isVisitable:gC});function p(m,y){if(!ve.isUndefined(m)){if(h.indexOf(m)!==-1)throw Error("Circular reference detected in "+y.join("."));h.push(m),ve.forEach(m,function(g,_){(!(ve.isUndefined(g)||g===null)&&s.call(e,g,ve.isString(_)?_.trim():_,y,f))===!0&&p(g,y?y.concat(_):[_])}),h.pop()}}if(!ve.isObject(i))throw new TypeError("data must be an object");return p(i),e}function tD(i){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function dN(i,e){this._pairs=[],i&&BS(i,this,e)}const DV=dN.prototype;DV.append=function(e,n){this._pairs.push([e,n])};DV.toString=function(e){const n=e?function(r){return e.call(this,r,tD)}:tD;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function Ise(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function OV(i,e,n){if(!e)return i;const r=n&&n.encode||Ise;ve.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let o;if(s?o=s(e,n):o=ve.isURLSearchParams(e)?e.toString():new dN(e,n).toString(r),o){const a=i.indexOf("#");a!==-1&&(i=i.slice(0,a)),i+=(i.indexOf("?")===-1?"?":"&")+o}return i}class Dse{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ve.forEach(this.handlers,function(r){r!==null&&e(r)})}}const nD=Dse,FV={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ose=typeof URLSearchParams<"u"?URLSearchParams:dN,Fse=typeof FormData<"u"?FormData:null,Bse=typeof Blob<"u"?Blob:null,Use={isBrowser:!0,classes:{URLSearchParams:Ose,FormData:Fse,Blob:Bse},protocols:["http","https","file","blob","url","data"]},hN=typeof window<"u"&&typeof document<"u",yC=typeof navigator=="object"&&navigator||void 0,zse=hN&&(!yC||["ReactNative","NativeScript","NS"].indexOf(yC.product)<0),Vse=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),$se=hN&&window.location.href||"http://localhost",Gse=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:hN,hasStandardBrowserEnv:zse,hasStandardBrowserWebWorkerEnv:Vse,navigator:yC,origin:$se},Symbol.toStringTag,{value:"Module"})),Br={...Gse,...Use};function Hse(i,e){return BS(i,new Br.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,o){return Br.isNode&&ve.isBuffer(n)?(this.append(r,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function Wse(i){return ve.matchAll(/\w+|\[(\w*)]/g,i).map(e=>e[0]==="[]"?"":e[1]||e[0])}function jse(i){const e={},n=Object.keys(i);let r;const s=n.length;let o;for(r=0;r<s;r++)o=n[r],e[o]=i[o];return e}function BV(i){function e(n,r,s,o){let a=n[o++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),c=o>=n.length;return a=!a&&ve.isArray(s)?s.length:a,c?(ve.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!l):((!s[a]||!ve.isObject(s[a]))&&(s[a]=[]),e(n,r,s[a],o)&&ve.isArray(s[a])&&(s[a]=jse(s[a])),!l)}if(ve.isFormData(i)&&ve.isFunction(i.entries)){const n={};return ve.forEachEntry(i,(r,s)=>{e(Wse(r),s,n,0)}),n}return null}function qse(i,e,n){if(ve.isString(i))try{return(e||JSON.parse)(i),ve.trim(i)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(i)}const fN={transitional:FV,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,o=ve.isObject(e);if(o&&ve.isHTMLForm(e)&&(e=new FormData(e)),ve.isFormData(e))return s?JSON.stringify(BV(e)):e;if(ve.isArrayBuffer(e)||ve.isBuffer(e)||ve.isStream(e)||ve.isFile(e)||ve.isBlob(e)||ve.isReadableStream(e))return e;if(ve.isArrayBufferView(e))return e.buffer;if(ve.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Hse(e,this.formSerializer).toString();if((l=ve.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return BS(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return o||s?(n.setContentType("application/json",!1),qse(e)):e}],transformResponse:[function(e){const n=this.transitional||fN.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(ve.isResponse(e)||ve.isReadableStream(e))return e;if(e&&ve.isString(e)&&(r&&!this.responseType||s)){const a=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(a)throw l.name==="SyntaxError"?Kt.from(l,Kt.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Br.classes.FormData,Blob:Br.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ve.forEach(["delete","get","head","post","put","patch"],i=>{fN.headers[i]={}});const pN=fN,Xse=ve.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Kse=i=>{const e={};let n,r,s;return i&&i.split(`
`).forEach(function(a){s=a.indexOf(":"),n=a.substring(0,s).trim().toLowerCase(),r=a.substring(s+1).trim(),!(!n||e[n]&&Xse[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},iD=Symbol("internals");function Cm(i){return i&&String(i).trim().toLowerCase()}function I_(i){return i===!1||i==null?i:ve.isArray(i)?i.map(I_):String(i)}function Yse(i){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(i);)e[r[1]]=r[2];return e}const Zse=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function CT(i,e,n,r,s){if(ve.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!ve.isString(e)){if(ve.isString(r))return e.indexOf(r)!==-1;if(ve.isRegExp(r))return r.test(e)}}function Qse(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function Jse(i,e){const n=ve.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(i,r+n,{value:function(s,o,a){return this[r].call(this,e,s,o,a)},configurable:!0})})}class US{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function o(l,c,u){const d=Cm(c);if(!d)throw new Error("header name must be a non-empty string");const h=ve.findKey(s,d);(!h||s[h]===void 0||u===!0||u===void 0&&s[h]!==!1)&&(s[h||c]=I_(l))}const a=(l,c)=>ve.forEach(l,(u,d)=>o(u,d,c));if(ve.isPlainObject(e)||e instanceof this.constructor)a(e,n);else if(ve.isString(e)&&(e=e.trim())&&!Zse(e))a(Kse(e),n);else if(ve.isObject(e)&&ve.isIterable(e)){let l={},c,u;for(const d of e){if(!ve.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?ve.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}a(l,n)}else e!=null&&o(n,e,r);return this}get(e,n){if(e=Cm(e),e){const r=ve.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return Yse(s);if(ve.isFunction(n))return n.call(this,s,r);if(ve.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Cm(e),e){const r=ve.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||CT(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function o(a){if(a=Cm(a),a){const l=ve.findKey(r,a);l&&(!n||CT(r,r[l],l,n))&&(delete r[l],s=!0)}}return ve.isArray(e)?e.forEach(o):o(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const o=n[r];(!e||CT(this,this[o],o,e,!0))&&(delete this[o],s=!0)}return s}normalize(e){const n=this,r={};return ve.forEach(this,(s,o)=>{const a=ve.findKey(r,o);if(a){n[a]=I_(s),delete n[o];return}const l=e?Qse(o):String(o).trim();l!==o&&delete n[o],n[l]=I_(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return ve.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&ve.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[iD]=this[iD]={accessors:{}}).accessors,s=this.prototype;function o(a){const l=Cm(a);r[l]||(Jse(s,a),r[l]=!0)}return ve.isArray(e)?e.forEach(o):o(e),this}}US.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ve.reduceDescriptors(US.prototype,({value:i},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>i,set(r){this[n]=r}}});ve.freezeMethods(US);const ua=US;function RT(i,e){const n=this||pN,r=e||n,s=ua.from(r.headers);let o=r.data;return ve.forEach(i,function(l){o=l.call(n,o,s.normalize(),e?e.status:void 0)}),s.normalize(),o}function UV(i){return!!(i&&i.__CANCEL__)}function Yp(i,e,n){Kt.call(this,i??"canceled",Kt.ERR_CANCELED,e,n),this.name="CanceledError"}ve.inherits(Yp,Kt,{__CANCEL__:!0});function zV(i,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?i(n):e(new Kt("Request failed with status code "+n.status,[Kt.ERR_BAD_REQUEST,Kt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function eoe(i){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return e&&e[1]||""}function toe(i,e){i=i||10;const n=new Array(i),r=new Array(i);let s=0,o=0,a;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=r[o];a||(a=u),n[s]=c,r[s]=u;let h=o,f=0;for(;h!==s;)f+=n[h++],h=h%i;if(s=(s+1)%i,s===o&&(o=(o+1)%i),u-a<e)return;const p=d&&u-d;return p?Math.round(f*1e3/p):void 0}}function noe(i,e){let n=0,r=1e3/e,s,o;const a=(u,d=Date.now())=>{n=d,s=null,o&&(clearTimeout(o),o=null),i.apply(null,u)};return[(...u)=>{const d=Date.now(),h=d-n;h>=r?a(u,d):(s=u,o||(o=setTimeout(()=>{o=null,a(s)},r-h)))},()=>s&&a(s)]}const Bb=(i,e,n=3)=>{let r=0;const s=toe(50,250);return noe(o=>{const a=o.loaded,l=o.lengthComputable?o.total:void 0,c=a-r,u=s(c),d=a<=l;r=a;const h={loaded:a,total:l,progress:l?a/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-a)/u:void 0,event:o,lengthComputable:l!=null,[e?"download":"upload"]:!0};i(h)},n)},rD=(i,e)=>{const n=i!=null;return[r=>e[0]({lengthComputable:n,total:i,loaded:r}),e[1]]},sD=i=>(...e)=>ve.asap(()=>i(...e)),ioe=Br.hasStandardBrowserEnv?((i,e)=>n=>(n=new URL(n,Br.origin),i.protocol===n.protocol&&i.host===n.host&&(e||i.port===n.port)))(new URL(Br.origin),Br.navigator&&/(msie|trident)/i.test(Br.navigator.userAgent)):()=>!0,roe=Br.hasStandardBrowserEnv?{write(i,e,n,r,s,o){const a=[i+"="+encodeURIComponent(e)];ve.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),ve.isString(r)&&a.push("path="+r),ve.isString(s)&&a.push("domain="+s),o===!0&&a.push("secure"),document.cookie=a.join("; ")},read(i){const e=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(i){this.write(i,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function soe(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function ooe(i,e){return e?i.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):i}function VV(i,e,n){let r=!soe(e);return i&&(r||n==!1)?ooe(i,e):e}const oD=i=>i instanceof ua?{...i}:i;function Id(i,e){e=e||{};const n={};function r(u,d,h,f){return ve.isPlainObject(u)&&ve.isPlainObject(d)?ve.merge.call({caseless:f},u,d):ve.isPlainObject(d)?ve.merge({},d):ve.isArray(d)?d.slice():d}function s(u,d,h,f){if(ve.isUndefined(d)){if(!ve.isUndefined(u))return r(void 0,u,h,f)}else return r(u,d,h,f)}function o(u,d){if(!ve.isUndefined(d))return r(void 0,d)}function a(u,d){if(ve.isUndefined(d)){if(!ve.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,h){if(h in e)return r(u,d);if(h in i)return r(void 0,u)}const c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(u,d,h)=>s(oD(u),oD(d),h,!0)};return ve.forEach(Object.keys(Object.assign({},i,e)),function(d){const h=c[d]||s,f=h(i[d],e[d],d);ve.isUndefined(f)&&h!==l||(n[d]=f)}),n}const $V=i=>{const e=Id({},i);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:o,headers:a,auth:l}=e;e.headers=a=ua.from(a),e.url=OV(VV(e.baseURL,e.url,e.allowAbsoluteUrls),i.params,i.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(ve.isFormData(n)){if(Br.hasStandardBrowserEnv||Br.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((c=a.getContentType())!==!1){const[u,...d]=c?c.split(";").map(h=>h.trim()).filter(Boolean):[];a.setContentType([u||"multipart/form-data",...d].join("; "))}}if(Br.hasStandardBrowserEnv&&(r&&ve.isFunction(r)&&(r=r(e)),r||r!==!1&&ioe(e.url))){const u=s&&o&&roe.read(o);u&&a.set(s,u)}return e},aoe=typeof XMLHttpRequest<"u",loe=aoe&&function(i){return new Promise(function(n,r){const s=$V(i);let o=s.data;const a=ua.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,h,f,p,m;function y(){p&&p(),m&&m(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function g(){if(!v)return;const x=ua.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),S={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:x,config:i,request:v};zV(function(w){n(w),y()},function(w){r(w),y()},S),v=null}"onloadend"in v?v.onloadend=g:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(g)},v.onabort=function(){v&&(r(new Kt("Request aborted",Kt.ECONNABORTED,i,v)),v=null)},v.onerror=function(){r(new Kt("Network Error",Kt.ERR_NETWORK,i,v)),v=null},v.ontimeout=function(){let b=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const S=s.transitional||FV;s.timeoutErrorMessage&&(b=s.timeoutErrorMessage),r(new Kt(b,S.clarifyTimeoutError?Kt.ETIMEDOUT:Kt.ECONNABORTED,i,v)),v=null},o===void 0&&a.setContentType(null),"setRequestHeader"in v&&ve.forEach(a.toJSON(),function(b,S){v.setRequestHeader(S,b)}),ve.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),l&&l!=="json"&&(v.responseType=s.responseType),u&&([f,m]=Bb(u,!0),v.addEventListener("progress",f)),c&&v.upload&&([h,p]=Bb(c),v.upload.addEventListener("progress",h),v.upload.addEventListener("loadend",p)),(s.cancelToken||s.signal)&&(d=x=>{v&&(r(!x||x.type?new Yp(null,i,v):x),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const _=eoe(s.url);if(_&&Br.protocols.indexOf(_)===-1){r(new Kt("Unsupported protocol "+_+":",Kt.ERR_BAD_REQUEST,i));return}v.send(o||null)})},coe=(i,e)=>{const{length:n}=i=i?i.filter(Boolean):[];if(e||n){let r=new AbortController,s;const o=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;r.abort(d instanceof Kt?d:new Yp(d instanceof Error?d.message:d))}};let a=e&&setTimeout(()=>{a=null,o(new Kt(`timeout ${e} of ms exceeded`,Kt.ETIMEDOUT))},e);const l=()=>{i&&(a&&clearTimeout(a),a=null,i.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),i=null)};i.forEach(u=>u.addEventListener("abort",o));const{signal:c}=r;return c.unsubscribe=()=>ve.asap(l),c}},uoe=coe,doe=function*(i,e){let n=i.byteLength;if(!e||n<e){yield i;return}let r=0,s;for(;r<n;)s=r+e,yield i.slice(r,s),r=s},hoe=async function*(i,e){for await(const n of foe(i))yield*doe(n,e)},foe=async function*(i){if(i[Symbol.asyncIterator]){yield*i;return}const e=i.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},aD=(i,e,n,r)=>{const s=hoe(i,e);let o=0,a,l=c=>{a||(a=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let h=d.byteLength;if(n){let f=o+=h;n(f)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},zS=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",GV=zS&&typeof ReadableStream=="function",poe=zS&&(typeof TextEncoder=="function"?(i=>e=>i.encode(e))(new TextEncoder):async i=>new Uint8Array(await new Response(i).arrayBuffer())),HV=(i,...e)=>{try{return!!i(...e)}catch{return!1}},moe=GV&&HV(()=>{let i=!1;const e=new Request(Br.origin,{body:new ReadableStream,method:"POST",get duplex(){return i=!0,"half"}}).headers.has("Content-Type");return i&&!e}),lD=64*1024,vC=GV&&HV(()=>ve.isReadableStream(new Response("").body)),Ub={stream:vC&&(i=>i.body)};zS&&(i=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Ub[e]&&(Ub[e]=ve.isFunction(i[e])?n=>n[e]():(n,r)=>{throw new Kt(`Response type '${e}' is not supported`,Kt.ERR_NOT_SUPPORT,r)})})})(new Response);const goe=async i=>{if(i==null)return 0;if(ve.isBlob(i))return i.size;if(ve.isSpecCompliantForm(i))return(await new Request(Br.origin,{method:"POST",body:i}).arrayBuffer()).byteLength;if(ve.isArrayBufferView(i)||ve.isArrayBuffer(i))return i.byteLength;if(ve.isURLSearchParams(i)&&(i=i+""),ve.isString(i))return(await poe(i)).byteLength},yoe=async(i,e)=>{const n=ve.toFiniteNumber(i.getContentLength());return n??goe(e)},voe=zS&&(async i=>{let{url:e,method:n,data:r,signal:s,cancelToken:o,timeout:a,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:h="same-origin",fetchOptions:f}=$V(i);u=u?(u+"").toLowerCase():"text";let p=uoe([s,o&&o.toAbortSignal()],a),m;const y=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let v;try{if(c&&moe&&n!=="get"&&n!=="head"&&(v=await yoe(d,r))!==0){let S=new Request(e,{method:"POST",body:r,duplex:"half"}),T;if(ve.isFormData(r)&&(T=S.headers.get("content-type"))&&d.setContentType(T),S.body){const[w,E]=rD(v,Bb(sD(c)));r=aD(S.body,lD,w,E)}}ve.isString(h)||(h=h?"include":"omit");const g="credentials"in Request.prototype;m=new Request(e,{...f,signal:p,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:g?h:void 0});let _=await fetch(m);const x=vC&&(u==="stream"||u==="response");if(vC&&(l||x&&y)){const S={};["status","statusText","headers"].forEach(A=>{S[A]=_[A]});const T=ve.toFiniteNumber(_.headers.get("content-length")),[w,E]=l&&rD(T,Bb(sD(l),!0))||[];_=new Response(aD(_.body,lD,w,()=>{E&&E(),y&&y()}),S)}u=u||"text";let b=await Ub[ve.findKey(Ub,u)||"text"](_,i);return!x&&y&&y(),await new Promise((S,T)=>{zV(S,T,{data:b,headers:ua.from(_.headers),status:_.status,statusText:_.statusText,config:i,request:m})})}catch(g){throw y&&y(),g&&g.name==="TypeError"&&/Load failed|fetch/i.test(g.message)?Object.assign(new Kt("Network Error",Kt.ERR_NETWORK,i,m),{cause:g.cause||g}):Kt.from(g,g&&g.code,i,m)}}),xC={http:Nse,xhr:loe,fetch:voe};ve.forEach(xC,(i,e)=>{if(i){try{Object.defineProperty(i,"name",{value:e})}catch{}Object.defineProperty(i,"adapterName",{value:e})}});const cD=i=>`- ${i}`,xoe=i=>ve.isFunction(i)||i===null||i===!1,WV={getAdapter:i=>{i=ve.isArray(i)?i:[i];const{length:e}=i;let n,r;const s={};for(let o=0;o<e;o++){n=i[o];let a;if(r=n,!xoe(n)&&(r=xC[(a=String(n)).toLowerCase()],r===void 0))throw new Kt(`Unknown adapter '${a}'`);if(r)break;s[a||"#"+o]=r}if(!r){const o=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=e?o.length>1?`since :
`+o.map(cD).join(`
`):" "+cD(o[0]):"as no adapter specified";throw new Kt("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:xC};function PT(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new Yp(null,i)}function uD(i){return PT(i),i.headers=ua.from(i.headers),i.data=RT.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),WV.getAdapter(i.adapter||pN.adapter)(i).then(function(r){return PT(i),r.data=RT.call(i,i.transformResponse,r),r.headers=ua.from(r.headers),r},function(r){return UV(r)||(PT(i),r&&r.response&&(r.response.data=RT.call(i,i.transformResponse,r.response),r.response.headers=ua.from(r.response.headers))),Promise.reject(r)})}const jV="1.9.0",VS={};["object","boolean","number","function","string","symbol"].forEach((i,e)=>{VS[i]=function(r){return typeof r===i||"a"+(e<1?"n ":" ")+i}});const dD={};VS.transitional=function(e,n,r){function s(o,a){return"[Axios v"+jV+"] Transitional option '"+o+"'"+a+(r?". "+r:"")}return(o,a,l)=>{if(e===!1)throw new Kt(s(a," has been removed"+(n?" in "+n:"")),Kt.ERR_DEPRECATED);return n&&!dD[a]&&(dD[a]=!0,console.warn(s(a," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(o,a,l):!0}};VS.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function _oe(i,e,n){if(typeof i!="object")throw new Kt("options must be an object",Kt.ERR_BAD_OPTION_VALUE);const r=Object.keys(i);let s=r.length;for(;s-- >0;){const o=r[s],a=e[o];if(a){const l=i[o],c=l===void 0||a(l,o,i);if(c!==!0)throw new Kt("option "+o+" must be "+c,Kt.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Kt("Unknown option "+o,Kt.ERR_BAD_OPTION)}}const D_={assertOptions:_oe,validators:VS},Ta=D_.validators;class zb{constructor(e){this.defaults=e||{},this.interceptors={request:new nD,response:new nD}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const o=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Id(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:o}=n;r!==void 0&&D_.assertOptions(r,{silentJSONParsing:Ta.transitional(Ta.boolean),forcedJSONParsing:Ta.transitional(Ta.boolean),clarifyTimeoutError:Ta.transitional(Ta.boolean)},!1),s!=null&&(ve.isFunction(s)?n.paramsSerializer={serialize:s}:D_.assertOptions(s,{encode:Ta.function,serialize:Ta.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),D_.assertOptions(n,{baseUrl:Ta.spelling("baseURL"),withXsrfToken:Ta.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=o&&ve.merge(o.common,o[n.method]);o&&ve.forEach(["delete","get","head","post","put","patch","common"],m=>{delete o[m]}),n.headers=ua.concat(a,o);const l=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(n)===!1||(c=c&&y.synchronous,l.unshift(y.fulfilled,y.rejected))});const u=[];this.interceptors.response.forEach(function(y){u.push(y.fulfilled,y.rejected)});let d,h=0,f;if(!c){const m=[uD.bind(this),void 0];for(m.unshift.apply(m,l),m.push.apply(m,u),f=m.length,d=Promise.resolve(n);h<f;)d=d.then(m[h++],m[h++]);return d}f=l.length;let p=n;for(h=0;h<f;){const m=l[h++],y=l[h++];try{p=m(p)}catch(v){y.call(this,v);break}}try{d=uD.call(this,p)}catch(m){return Promise.reject(m)}for(h=0,f=u.length;h<f;)d=d.then(u[h++],u[h++]);return d}getUri(e){e=Id(this.defaults,e);const n=VV(e.baseURL,e.url,e.allowAbsoluteUrls);return OV(n,e.params,e.paramsSerializer)}}ve.forEach(["delete","get","head","options"],function(e){zb.prototype[e]=function(n,r){return this.request(Id(r||{},{method:e,url:n,data:(r||{}).data}))}});ve.forEach(["post","put","patch"],function(e){function n(r){return function(o,a,l){return this.request(Id(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:a}))}}zb.prototype[e]=n(),zb.prototype[e+"Form"]=n(!0)});const O_=zb;class mN{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const r=this;this.promise.then(s=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](s);r._listeners=null}),this.promise.then=s=>{let o;const a=new Promise(l=>{r.subscribe(l),o=l}).then(s);return a.cancel=function(){r.unsubscribe(o)},a},e(function(o,a,l){r.reason||(r.reason=new Yp(o,a,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new mN(function(s){e=s}),cancel:e}}}const boe=mN;function Soe(i){return function(n){return i.apply(null,n)}}function woe(i){return ve.isObject(i)&&i.isAxiosError===!0}const _C={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_C).forEach(([i,e])=>{_C[e]=i});const Toe=_C;function qV(i){const e=new O_(i),n=TV(O_.prototype.request,e);return ve.extend(n,O_.prototype,e,{allOwnKeys:!0}),ve.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return qV(Id(i,s))},n}const Ui=qV(pN);Ui.Axios=O_;Ui.CanceledError=Yp;Ui.CancelToken=boe;Ui.isCancel=UV;Ui.VERSION=jV;Ui.toFormData=BS;Ui.AxiosError=Kt;Ui.Cancel=Ui.CanceledError;Ui.all=function(e){return Promise.all(e)};Ui.spread=Soe;Ui.isAxiosError=woe;Ui.mergeConfig=Id;Ui.AxiosHeaders=ua;Ui.formToJSON=i=>BV(ve.isHTMLForm(i)?new FormData(i):i);Ui.getAdapter=WV.getAdapter;Ui.HttpStatusCode=Toe;Ui.default=Ui;const Eoe=Ui,O0=Eoe.create({baseURL:"/api",headers:{"Content-Type":"application/json"}}),Moe=async i=>{try{return(await O0.post("/analyze",{repo_url:i})).data}catch(e){throw console.error("Error analyzing repository:",e),e}},Aoe=async i=>{try{return(await O0.get(`/analysis/${i}`)).data}catch(e){throw console.error("Error fetching analysis results:",e),e}},Coe=async i=>{try{return(await O0.get(`/services/${i}`)).data}catch(e){throw console.error("Error fetching service boundaries:",e),e}},Roe=async i=>{try{return(await O0.get(`/dependencies/${i}`)).data}catch(e){throw console.error("Error fetching service dependencies:",e),e}},Poe=async()=>{try{return(await O0.get("/analyses")).data}catch(i){throw console.error("Error listing analyses:",i),i}},Noe=()=>{const[i,e]=I.useState([]),[n,r]=I.useState(!0),[s,o]=I.useState(null);return I.useEffect(()=>{(async()=>{try{r(!0);const l=await Poe();e(l.analyses||[]),o(null)}catch(l){o("Failed to load analyses. Please try again later."),console.error(l)}finally{r(!1)}})()},[]),lt(An,{children:[lt(An,{sx:{textAlign:"center",mb:6},children:[Y(It,{variant:"h2",component:"h1",gutterBottom:!0,children:"Microservice Migration AI"}),Y(It,{variant:"h5",component:"h2",color:"text.secondary",paragraph:!0,children:"An AI-powered tool for migrating monolithic applications to microservices"}),Y(Ys,{variant:"contained",color:"primary",size:"large",component:Vl,to:"/analyze",sx:{mt:2},children:"Analyze Repository"})]}),lt(An,{sx:{mt:6},children:[Y(It,{variant:"h4",component:"h2",gutterBottom:!0,children:"Recent Analyses"}),n?Y(An,{sx:{display:"flex",justifyContent:"center",mt:4},children:Y(Py,{})}):s?Y(It,{color:"error",children:s}):i.length===0?Y(It,{children:"No analyses found. Start by analyzing a repository."}):Y(Fb,{container:!0,spacing:3,children:i.map(a=>Y(Fb,{item:!0,xs:12,md:6,children:Y(oV,{children:lt(aV,{children:[Y(It,{variant:"h6",component:"h3",gutterBottom:!0,children:a.repo_url.split("/").pop()}),Y(It,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:a.repo_url}),lt(It,{variant:"body2",gutterBottom:!0,children:["Status: ",a.status]}),lt(It,{variant:"body2",gutterBottom:!0,children:["Analyzed: ",new Date(a.timestamp).toLocaleString()]}),Y(Ys,{variant:"outlined",component:Vl,to:`/analysis/${a.repo_id}`,sx:{mt:2},disabled:a.status!=="completed",children:"View Results"})]})})},a.repo_id))})]})]})},koe=()=>{const[i,e]=I.useState(""),[n,r]=I.useState(!1),[s,o]=I.useState(null),[a,l]=I.useState(!1),c=j4();return lt(An,{children:[Y(It,{variant:"h4",component:"h1",gutterBottom:!0,children:"Analyze Repository"}),Y(It,{variant:"body1",paragraph:!0,children:"Enter the URL of a Git repository to analyze its structure and identify potential microservice boundaries."}),Y(ec,{sx:{p:3,mt:3},children:lt("form",{onSubmit:async d=>{var h,f;if(d.preventDefault(),!i){o("Please enter a repository URL");return}try{r(!0),o(null);const p=await Moe(i);l(!0),setTimeout(()=>{c(`/analysis/${p.repo_id}`)},1500)}catch(p){o(((f=(h=p.response)==null?void 0:h.data)==null?void 0:f.detail)||"Failed to analyze repository. Please try again."),console.error(p)}finally{r(!1)}},children:[Y(Hre,{label:"Repository URL",variant:"outlined",fullWidth:!0,value:i,onChange:d=>e(d.target.value),placeholder:"https://github.com/username/repository.git",disabled:n,error:!!s,helperText:s,sx:{mb:3}}),Y(Ys,{type:"submit",variant:"contained",color:"primary",size:"large",disabled:n,startIcon:n?Y(Py,{size:20,color:"inherit"}):null,children:n?"Analyzing...":"Analyze Repository"})]})}),lt(An,{sx:{mt:4},children:[Y(It,{variant:"h6",gutterBottom:!0,children:"Example Repositories"}),Y(It,{variant:"body2",paragraph:!0,children:"Try analyzing one of these example repositories:"}),lt(An,{component:"ul",children:[Y(An,{component:"li",children:Y(Ys,{variant:"text",onClick:()=>e("https://github.com/dotnet-architecture/eShopOnWeb.git"),children:"eShopOnWeb (.NET)"})}),Y(An,{component:"li",children:Y(Ys,{variant:"text",onClick:()=>e("https://github.com/spring-projects/spring-petclinic.git"),children:"Spring PetClinic (Java)"})}),Y(An,{component:"li",children:Y(Ys,{variant:"text",onClick:()=>e("https://github.com/gothinkster/realworld.git"),children:"RealWorld (Various Languages)"})})]})]}),Y(Jie,{open:a,autoHideDuration:3e3,onClose:()=>l(!1),children:Y(Df,{severity:"success",sx:{width:"100%"},children:"Repository analysis started successfully!"})})]})},NT=({children:i,value:e,index:n,...r})=>Y("div",{role:"tabpanel",hidden:e!==n,id:`tabpanel-${n}`,"aria-labelledby":`tab-${n}`,...r,children:e===n&&Y(An,{sx:{pt:2},children:i})}),Loe=()=>{var y,v,g,_;const{repoId:i}=q4(),[e,n]=I.useState(null),[r,s]=I.useState(!0),[o,a]=I.useState(null),[l,c]=I.useState(0),u=I.useRef(null),d=async()=>{var x,b;if(i)try{const S=await Aoe(i);n(S),S.status!=="processing"&&u.current&&(window.clearInterval(u.current),u.current=null),a(null)}catch(S){a(((b=(x=S.response)==null?void 0:x.data)==null?void 0:b.detail)||"Failed to fetch analysis results"),console.error(S),u.current&&(window.clearInterval(u.current),u.current=null)}finally{s(!1)}};I.useEffect(()=>(d(),u.current||(u.current=window.setInterval(d,5e3)),()=>{u.current&&window.clearInterval(u.current)}),[i]);const h=(x,b)=>{c(b)};if(r&&!e)return Y(An,{sx:{display:"flex",justifyContent:"center",mt:4},children:Y(Py,{})});if(o)return Y(Df,{severity:"error",sx:{mt:2},children:o});if(!e)return Y(Df,{severity:"warning",sx:{mt:2},children:"No analysis data found"});if(e.status==="processing")return lt(An,{children:[Y(It,{variant:"h4",component:"h1",gutterBottom:!0,children:"Analysis in Progress"}),lt(ec,{sx:{p:3,mt:3,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Y(Py,{sx:{mb:2}}),lt(It,{children:["Analyzing repository: ",e.repo_url||"Unknown repository"]}),Y(It,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This may take several minutes depending on the repository size."})]})]});if(e.status==="failed")return lt(An,{children:[Y(It,{variant:"h4",component:"h1",gutterBottom:!0,children:"Analysis Failed"}),Y(Df,{severity:"error",sx:{mt:2},children:e.error||"An unknown error occurred during analysis"}),Y(Ys,{component:Vl,to:"/analyze",variant:"contained",sx:{mt:3},children:"Try Again"})]});const f=((y=e.analysis)==null?void 0:y.potential_services)||[],p=((v=e.analysis)==null?void 0:v.entities)||[],m=((g=e.analysis)==null?void 0:g.api_endpoints)||[];return lt(An,{children:[Y(It,{variant:"h4",component:"h1",gutterBottom:!0,children:"Analysis Results"}),lt(ec,{sx:{p:3,mt:3},children:[lt(It,{variant:"h6",gutterBottom:!0,children:["Repository: ",e.repo_url]}),lt(It,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Analyzed on: ",new Date(e.timestamp).toLocaleString()]}),lt(An,{sx:{mt:3},children:[lt(It,{variant:"subtitle1",gutterBottom:!0,children:["Architecture Type: ",((_=e.analysis)==null?void 0:_.architecture_type)||"Unknown"]}),Y(Ys,{variant:"contained",component:Vl,to:`/services/${i}`,sx:{mt:2},children:"View Service Boundaries"})]})]}),lt(An,{sx:{mt:4},children:[lt(Fre,{value:l,onChange:h,children:[Y(MT,{label:"Potential Services"}),Y(MT,{label:"Entities"}),Y(MT,{label:"API Endpoints"})]}),lt(NT,{value:l,index:0,children:[Y(It,{variant:"h6",gutterBottom:!0,children:"Potential Microservices"}),f.length>0?Y(k_,{children:f.map((x,b)=>{var S;return lt(ns.Fragment,{children:[Y(ST,{children:Y(wT,{primary:x.name,secondary:lt(An,{children:[Y(It,{variant:"body2",component:"span",children:x.description||"No description available"}),Y(An,{sx:{mt:1},children:(S=x.entities)==null?void 0:S.map(T=>Y(fC,{label:T,size:"small",sx:{mr:.5,mb:.5}},T))})]})})}),b<f.length-1&&Y(_T,{})]},x.name||b)})}):Y(It,{children:"No potential services identified"})]}),lt(NT,{value:l,index:1,children:[Y(It,{variant:"h6",gutterBottom:!0,children:"Entities"}),p.length>0?Y(k_,{children:p.map((x,b)=>lt(ns.Fragment,{children:[Y(ST,{children:Y(wT,{primary:x.name,secondary:lt(An,{children:[lt(It,{variant:"body2",component:"span",children:["Type: ",x.type||"Unknown"]}),x.namespace&&lt(It,{variant:"body2",component:"div",children:["Namespace: ",x.namespace]})]})})}),b<p.length-1&&Y(_T,{})]},x.name||b))}):Y(It,{children:"No entities identified"})]}),lt(NT,{value:l,index:2,children:[Y(It,{variant:"h6",gutterBottom:!0,children:"API Endpoints"}),m.length>0?Y(k_,{children:m.map((x,b)=>lt(ns.Fragment,{children:[Y(ST,{children:Y(wT,{primary:lt(An,{sx:{display:"flex",alignItems:"center"},children:[Y(fC,{label:x.method,size:"small",color:x.method==="GET"?"primary":x.method==="POST"?"success":x.method==="PUT"?"warning":x.method==="DELETE"?"error":"default",sx:{mr:1}}),Y(It,{component:"span",children:x.route})]}),secondary:x.handler?`Handler: ${x.handler}`:null})}),b<m.length-1&&Y(_T,{})]},b))}):Y(It,{children:"No API endpoints identified"})]})]})]})};function Ioe(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function Doe(i,e,n){return e=Goe(e),e in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function hD(i,e){return Boe(i)||Ioe(i,e)||XV(i,e)||Voe()}function Ooe(i){return Foe(i)||Uoe(i)||XV(i)||zoe()}function Foe(i){if(Array.isArray(i))return bC(i)}function Boe(i){if(Array.isArray(i))return i}function Uoe(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function XV(i,e){if(i){if(typeof i=="string")return bC(i,e);var n=Object.prototype.toString.call(i).slice(8,-1);if(n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set")return Array.from(i);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bC(i,e)}}function bC(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=i[n];return r}function zoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Voe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $oe(i,e){if(typeof i!="object"||i===null)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Goe(i){var e=$oe(i,"string");return typeof e=="symbol"?e:String(e)}var Hoe=function(e,n){var r=new Set(n);return Object.assign.apply(Object,[{}].concat(Ooe(Object.entries(e).filter(function(s){var o=hD(s,1),a=o[0];return!r.has(a)}).map(function(s){var o=hD(s,2),a=o[0],l=o[1];return Doe({},a,l)}))))};function SC(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function Woe(i){if(Array.isArray(i))return i}function joe(i){if(Array.isArray(i))return SC(i)}function qoe(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Xoe(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function Koe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zoe(i,e){return Woe(i)||Xoe(i,e)||KV(i,e)||Koe()}function fD(i){return joe(i)||qoe(i)||KV(i)||Yoe()}function KV(i,e){if(i){if(typeof i=="string")return SC(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?SC(i,e):void 0}}function $S(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.wrapperElementType,r=n===void 0?"div":n,s=e.nodeMapper,o=s===void 0?function(d){return d}:s,a=e.methodNames,l=a===void 0?[]:a,c=e.initPropNames,u=c===void 0?[]:c;return I.forwardRef(function(d,h){var f=I.useRef(),p=I.useMemo(function(){var v=Object.fromEntries(u.filter(function(g){return d.hasOwnProperty(g)}).map(function(g){return[g,d[g]]}));return i(v)},[]);pD(function(){p(o(f.current))},I.useLayoutEffect),pD(function(){return p._destructor instanceof Function?p._destructor:void 0});var m=I.useCallback(function(v){for(var g=arguments.length,_=new Array(g>1?g-1:0),x=1;x<g;x++)_[x-1]=arguments[x];return p[v]instanceof Function?p[v].apply(p,_):void 0},[p]),y=I.useRef({});return Object.keys(Hoe(d,[].concat(fD(l),fD(u)))).filter(function(v){return y.current[v]!==d[v]}).forEach(function(v){return m(v,d[v])}),y.current=d,I.useImperativeHandle(h,function(){return Object.fromEntries(l.map(function(v){return[v,function(){for(var g=arguments.length,_=new Array(g),x=0;x<g;x++)_[x]=arguments[x];return m.apply(void 0,[v].concat(_))}]}))},[m]),ns.createElement(r,{ref:f})})}function pD(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:I.useEffect,n=I.useRef(),r=I.useRef(!1),s=I.useRef(!1),o=I.useState(0),a=Zoe(o,2);a[0];var l=a[1];r.current&&(s.current=!0),e(function(){return r.current||(n.current=i(),r.current=!0),l(function(c){return c+1}),function(){s.current&&n.current&&n.current()}},[])}const mD=.1;AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(i){const e=this.el;if(this.active&&this.checkpoint!==i){if(this.checkpoint&&e.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=i,this.sync(),this.position.distanceTo(this.targetPosition)<mD){this.checkpoint=null;return}e.emit("navigation-start",{checkpoint:i}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,e.emit("navigation-end",{checkpoint:i}),e.components["movement-controls"].updateNavLocation())}},isVelocityActive:function(){return!!(this.active&&this.checkpoint)},getVelocity:function(){if(!this.active)return;const i=this.data,e=this.offset,n=this.position,r=this.targetPosition,s=this.checkpoint;return this.sync(),n.distanceTo(r)<mD?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:s}),e.set(0,0,0)):(e.setLength(i.animateSpeed),e)},sync:function(){const i=this.offset,e=this.position,n=this.targetPosition;e.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(n),n.add(this.checkpoint.components.checkpoint.getOffset()),i.copy(n).sub(e)}});var Qoe=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16});function Joe(i,e,n){this.type=i,this.index=e,this.pressed=n.pressed,this.value=n.value}var eae=Joe;const uh=Qoe,kT=eae,xc=.2,rl={LEFT:"left",RIGHT:"right"},sl={MOVEMENT:1,ROTATION:2};AFRAME.registerComponent("gamepad-controls",{GamepadButton:uh,schema:{enabled:{default:!0},rotationSensitivity:{default:2}},init:function(){const i=this.el.sceneEl;this.system=i.systems["tracked-controls"]||i.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};const e=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=e.x,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=e.y,this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,i.addBehavior(this)},update:function(){this.tick()},tick:function(i,e){this.updateButtonState(),this.updateRotation(e)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const i=this._dpadVector,e=this._moveVector;this.getDpad(i),this.getJoystick(sl.MOVEMENT,e);const n=i.x||e.x,r=i.y||e.y;return Math.abs(n)>xc||Math.abs(r)>xc},getVelocityDelta:function(){const i=this._dpadVector,e=this._moveVector;this.getDpad(i),this.getJoystick(sl.MOVEMENT,e);const n=i.x||e.x,r=i.y||e.y,s=new THREE.Vector3;return Math.abs(n)>xc&&(s.x+=n),Math.abs(r)>xc&&(s.z+=r),s},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const i=this._lookVector;return this.getJoystick(sl.ROTATION,i),Math.abs(i.x)>xc||Math.abs(i.y)>xc},updateRotation:function(i){if(!this.isRotationActive())return;const e=this.data,n=this.yaw,r=this.pitch;n.rotation.y=this.el.object3D.rotation.y,r.rotation.x=this.el.object3D.rotation.x;const s=this._lookVector;this.getJoystick(sl.ROTATION,s),Math.abs(s.x)<=xc&&(s.x=0),Math.abs(s.y)<=xc&&(s.y=0),s.multiplyScalar(e.rotationSensitivity*i/1e3),n.rotation.y-=s.x,r.rotation.x-=s.y,r.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,r.rotation.x)),this.el.object3D.rotation.set(r.rotation.x,n.rotation.y,0)},updateButtonState:function(){const i=this.getGamepad(rl.RIGHT);if(this.data.enabled&&i)for(var e=0;e<i.buttons.length;e++)i.buttons[e].pressed&&!this.buttons[e]?this.emit(new kT("gamepadbuttondown",e,i.buttons[e])):!i.buttons[e].pressed&&this.buttons[e]&&this.emit(new kT("gamepadbuttonup",e,i.buttons[e])),this.buttons[e]=i.buttons[e].pressed;else for(const n in this.buttons)this.buttons[n]=!1},emit:function(i){this.el.emit(i.type,i),this.el.emit(i.type+":"+i.index,new kT(i.type,i.index,i))},getGamepad:function(){const i=[],e=[];return function(n){const r=this.el.sceneEl.components["proxy-controls"],s=r&&r.isConnected()&&r.getGamepad(0);if(s)return s;i.length=0;for(let a=0;a<this.system.controllers.length;a++){const l=this.system.controllers[a],c=l?l.gamepad:null;if(i.push(c),c&&l.handedness===n)return c}const o=navigator.getGamepads?navigator.getGamepads():e;for(let a=0;a<o.length;a++){const l=o[a];if(l&&l.hand===n)return l}return i[0]||o[0]}}(),getButton:function(i){return this.getGamepad(rl.RIGHT).buttons[i]},getAxis:function(i){return this.getGamepad(i>1?rl.RIGHT:rl.LEFT).axes[i]},getJoystick:function(i,e){const n=this.getGamepad(i===sl.MOVEMENT?rl.LEFT:rl.RIGHT);if(!n)return e.set(0,0);if(n.mapping==="xr-standard")switch(i){case sl.MOVEMENT:return e.set(n.axes[2],n.axes[3]);case sl.ROTATION:return e.set(n.axes[2],0)}else switch(i){case sl.MOVEMENT:return e.set(n.axes[0],n.axes[1]);case sl.ROTATION:return e.set(n.axes[2],n.axes[3])}throw new Error('Unexpected joystick index "%d".',i)},getDpad:function(i){const e=this.getGamepad(rl.LEFT);return!e||!e.buttons[uh.DPAD_RIGHT]?i.set(0,0):i.set((e.buttons[uh.DPAD_RIGHT].pressed?1:0)+(e.buttons[uh.DPAD_LEFT].pressed?-1:0),(e.buttons[uh.DPAD_UP].pressed?-1:0)+(e.buttons[uh.DPAD_DOWN].pressed?1:0))},isConnected:function(){const i=this.getGamepad(rl.LEFT);return!!(i&&i.connected)},getID:function(){return this.getGamepad(rl.LEFT).id}});(function(i){var e="KeyboardEvent"in i;e||(i.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in i.KeyboardEvent||(i.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in i.KeyboardEvent||(i.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in i.KeyboardEvent||(i.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in i.KeyboardEvent||(i.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var n=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,r=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,s=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,o=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function a(S,T){return String(S).indexOf(T)!==-1}var l=function(){return a(navigator.platform,"Win")?"win":a(navigator.platform,"Mac")?"mac":a(navigator.platform,"CrOS")?"cros":a(navigator.platform,"Linux")?"linux":a(navigator.userAgent,"iPad")||a(navigator.platform,"iPod")||a(navigator.platform,"iPhone")?"ios":""}(),c=function(){return a(navigator.userAgent,"Chrome/")?"chrome":a(navigator.vendor,"Apple")?"safari":a(navigator.userAgent,"MSIE")?"ie":a(navigator.userAgent,"Gecko/")?"moz":a(navigator.userAgent,"Opera/")?"opera":""}(),u=c+"-"+l;function d(S,T,w){(u===T||c===T||l===T)&&Object.keys(w).forEach(function(E){S[E]=w[E]})}function h(S,T){var w={};return Object.keys(S).forEach(function(E){var A=S[E];T in A&&(w[A[T]]=A)}),w}var f={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:r},92:{code:"OSRight",location:s},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:o},97:{code:"Numpad1",keyCap:"1",location:o},98:{code:"Numpad2",keyCap:"2",location:o},99:{code:"Numpad3",keyCap:"3",location:o},100:{code:"Numpad4",keyCap:"4",location:o},101:{code:"Numpad5",keyCap:"5",location:o},102:{code:"Numpad6",keyCap:"6",location:o},103:{code:"Numpad7",keyCap:"7",location:o},104:{code:"Numpad8",keyCap:"8",location:o},105:{code:"Numpad9",keyCap:"9",location:o},106:{code:"NumpadMultiply",keyCap:"*",location:o},107:{code:"NumpadAdd",keyCap:"+",location:o},108:{code:"NumpadComma",keyCap:",",location:o},109:{code:"NumpadSubtract",keyCap:"-",location:o},110:{code:"NumpadDecimal",keyCap:".",location:o},111:{code:"NumpadDivide",keyCap:"/",location:o},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:o},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:r},161:{code:"ShiftRight",location:s},162:{code:"ControlLeft",location:r},163:{code:"ControlRight",location:s},164:{code:"AltLeft",location:r},165:{code:"AltRight",location:s},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};d(f,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:o},189:{code:"NumpadSubtract",keyCap:"-",location:o}}),d(f,"moz-mac",{12:{code:"NumLock",location:o},173:{code:"Minus",keyCap:"-"}}),d(f,"moz-win",{173:{code:"Minus",keyCap:"-"}}),d(f,"chrome-mac",{93:{code:"OSRight",location:s}}),d(f,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),d(f,"ios",{10:{code:"Enter",location:n}}),d(f,"safari-mac",{91:{code:"OSLeft",location:r},93:{code:"OSRight",location:s},229:{code:"KeyQ",keyCap:"Q"}});var p={};l==="cros"&&(p["U+00A0"]={code:"ShiftLeft",location:r},p["U+00A1"]={code:"ShiftRight",location:s},p["U+00A2"]={code:"ControlLeft",location:r},p["U+00A3"]={code:"ControlRight",location:s},p["U+00A4"]={code:"AltLeft",location:r},p["U+00A5"]={code:"AltRight",location:s}),u==="chrome-mac"&&(p["U+0010"]={code:"ContextMenu"}),u==="safari-mac"&&(p["U+0010"]={code:"ContextMenu"}),l==="ios"&&(p["U+0010"]={code:"Function"},p["U+001C"]={code:"ArrowLeft"},p["U+001D"]={code:"ArrowRight"},p["U+001E"]={code:"ArrowUp"},p["U+001F"]={code:"ArrowDown"},p["U+0001"]={code:"Home"},p["U+0004"]={code:"End"},p["U+000B"]={code:"PageUp"},p["U+000C"]={code:"PageDown"});var m=[];m[r]={16:{code:"ShiftLeft",location:r},17:{code:"ControlLeft",location:r},18:{code:"AltLeft",location:r}},m[s]={16:{code:"ShiftRight",location:s},17:{code:"ControlRight",location:s},18:{code:"AltRight",location:s}},m[o]={13:{code:"NumpadEnter",location:o}},d(m[o],"moz",{109:{code:"NumpadSubtract",location:o},107:{code:"NumpadAdd",location:o}}),d(m[r],"moz-mac",{224:{code:"OSLeft",location:r}}),d(m[s],"moz-mac",{224:{code:"OSRight",location:s}}),d(m[s],"moz-win",{91:{code:"OSRight",location:s}}),d(m[s],"mac",{93:{code:"OSRight",location:s}}),d(m[o],"chrome-mac",{12:{code:"NumLock",location:o}}),d(m[o],"safari-mac",{12:{code:"NumLock",location:o},187:{code:"NumpadAdd",location:o},189:{code:"NumpadSubtract",location:o},190:{code:"NumpadDecimal",location:o},191:{code:"NumpadDivide",location:o}});var y={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};d(y,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var v={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},g=h(f,"code");try{var _=e&&"location"in new KeyboardEvent("")}catch{}function x(S){var T="keyCode"in S?S.keyCode:"which"in S?S.which:0,w=function(){if(_||"keyLocation"in S){var A=_?S.location:S.keyLocation;if(A&&T in m[A])return m[A][T]}return"keyIdentifier"in S&&S.keyIdentifier in p?p[S.keyIdentifier]:T in f?f[T]:null}();if(!w)return null;var E=function(){var A=y[w.code];return A?S.shiftKey&&"shiftKey"in A?A.shiftKey:A.key:w.code}();return{code:w.code,key:E,location:w.location,keyCap:w.keyCap}}function b(S,T){if(S=String(S),!g.hasOwnProperty(S))return"Undefined";if(T&&String(T).toLowerCase()!=="en-us")throw Error("Unsupported locale");var w=g[S];return w.keyCap||w.code||"Undefined"}"KeyboardEvent"in i&&"defineProperty"in Object&&function(){function S(w,E,A){E in w||Object.defineProperty(w,E,A)}if(S(KeyboardEvent.prototype,"code",{get:function(){var w=x(this);return w?w.code:""}}),"key"in KeyboardEvent.prototype){var T=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var w=T.get.call(this);return v.hasOwnProperty(w)?v[w]:w}})}S(KeyboardEvent.prototype,"key",{get:function(){var w=x(this);return w&&"key"in w?w.key:"Unidentified"}}),S(KeyboardEvent.prototype,"location",{get:function(){var w=x(this);return w&&"location"in w?w.location:n}}),S(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in i.KeyboardEvent||(i.KeyboardEvent.queryKeyCap=b),i.identifyKey=function(S){if(!("code"in S)){var T=x(S);S.code=T?T.code:"",S.key=T&&"key"in T?T.key:"Unidentified",S.location="location"in S?S.location:"keyLocation"in S?S.keyLocation:T&&"location"in T?T.location:n,S.locale=""}}})(window);const tae="__keyboard-controls-proxy",nae=window.KeyboardEvent;AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this),onContextMenu:this.onContextMenu.bind(this)}},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){const i=this.data,e=this.getKeys();return this.dVelocity.set(0,0,0),i.enabled&&((e.KeyW||e.ArrowUp)&&(this.dVelocity.z-=1),(e.KeyA||e.ArrowLeft)&&(this.dVelocity.x-=1),(e.KeyS||e.ArrowDown)&&(this.dVelocity.z+=1),(e.KeyD||e.ArrowRight)&&(this.dVelocity.x+=1),e.ShiftLeft&&(this.dVelocity=this.dVelocity.multiplyScalar(2))),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},attachEventListeners:function(){window.addEventListener("contextmenu",this.listeners.onContextMenu,!1),window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},onContextMenu:function(){for(const i in this.localKeys)this.localKeys.hasOwnProperty(i)&&delete this.localKeys[i]},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(i){AFRAME.utils.shouldCaptureKeyEvent(i)&&(this.localKeys[i.code]=!0,this.emit(i))},onKeyUp:function(i){AFRAME.utils.shouldCaptureKeyEvent(i)&&(delete this.localKeys[i.code],this.emit(i))},onBlur:function(){for(const i in this.localKeys)this.localKeys.hasOwnProperty(i)&&delete this.localKeys[i]},emit:function(i){tae in i&&this.el.emit(i.type,i),this.el.emit(i.type+":"+i.code,new nae(i.type,i)),this.data.debug&&console.log(i.type+":"+i.code)},isPressed:function(i){return i in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){const i=this.el.sceneEl.components["proxy-controls"];return i&&i.isConnected()}});AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const i=this.el.sceneEl,e=i.canvas;if(!e){i.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}e.addEventListener("touchstart",this.onTouchStart,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd,{passive:!0});const n=i.getAttribute("vr-mode-ui");n&&n.cardboardModeEnabled&&i.addEventListener("enter-vr",this.onEnterVR)},removeEventListeners:function(){const i=this.el.sceneEl&&this.el.sceneEl.canvas;i&&(i.removeEventListener("touchstart",this.onTouchStart),i.removeEventListener("touchend",this.onTouchEnd),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},onTouchStart:function(i){this.direction=-1,this.data.reverseEnabled&&i.touches&&i.touches.length===2&&(this.direction=1),i.preventDefault()},onTouchEnd:function(i){this.direction=0,i.preventDefault()},onEnterVR:function(){const i=this.el.sceneEl.xrSession;i&&(i.addEventListener("selectstart",this.onTouchStart),i.addEventListener("selectend",this.onTouchEnd))}});const LT="-controls",iae=.2,rae=1e-5,sae="moved";AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){const i=this.el;this.data.camera||(this.data.camera=i.querySelector("[camera]")),this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.eventDetail={},this.navGroup=null,this.navNode=null,i.sceneEl.hasLoaded?this.injectControls():i.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(i){const e=this.el,n=this.data,r=e.sceneEl.systems.nav;if(e.sceneEl.hasLoaded&&this.injectControls(),r&&n.constrainToNavMesh!==i.constrainToNavMesh&&(n.constrainToNavMesh?r.addAgent(this):r.removeAgent(this)),n.enabled!==i.enabled)for(let s=0;s<n.controls.length;s++){const o=n.controls[s]+LT;this.el.setAttribute(o,{enabled:this.data.enabled})}},injectControls:function(){const i=this.data;for(let e=0;e<i.controls.length;e++){const n=i.controls[e]+LT;this.el.setAttribute(n,{enabled:this.data.enabled})}},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){const i=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3;return function(r,s){if(!s)return;const o=this.el,a=this.data;if(!a.enabled)return;this.updateVelocityCtrl();const l=this.velocityCtrl,c=this.velocity;if(l)if(s/1e3>iae?c.set(0,0,0):this.updateVelocity(s),a.constrainToNavMesh&&l.isNavMeshConstrained!==!1){if(c.lengthSq()<rae)return;i.copy(o.object3D.position),e.copy(c).multiplyScalar(s/1e3).add(i);const u=o.sceneEl.systems.nav;this.navGroup=this.navGroup===null?u.getGroup(i):this.navGroup,this.navNode=this.navNode||u.getNode(i,this.navGroup),this.navNode=u.clampStep(i,e,this.navGroup,this.navNode,n),o.object3D.position.copy(n)}else o.hasAttribute("velocity")?o.setAttribute("velocity",c):(o.object3D.position.x+=c.x*s/1e3,o.object3D.position.y+=c.y*s/1e3,o.object3D.position.z+=c.z*s/1e3)}}(),updateVelocityCtrl:function(){const i=this.data;if(i.enabled){for(let e=0,n=i.controls.length;e<n;e++){const r=this.el.components[i.controls[e]+LT];if(r&&r.isVelocityActive()){this.velocityCtrl=r;return}}this.velocityCtrl=null}},updateVelocity:function(){const i=new THREE.Vector2,e=new THREE.Quaternion;return function(n){let r;const s=this.el,o=this.velocityCtrl,a=this.velocity,l=this.data;if(o)if(o.getVelocityDelta)r=o.getVelocityDelta(n);else if(o.getVelocity){a.copy(o.getVelocity());return}else if(o.getPositionDelta){a.copy(o.getPositionDelta(n).multiplyScalar(1e3/n));return}else throw new Error("Incompatible movement controls: ",o);if(s.hasAttribute("velocity")&&!l.constrainToNavMesh&&a.copy(this.el.getAttribute("velocity")),r&&l.enabled){const c=l.camera;e.copy(c.object3D.quaternion),e.premultiply(s.object3D.quaternion),r.applyQuaternion(e);const u=r.length();l.fly?(a.copy(r),a.multiplyScalar(this.data.speed*16.66667)):(i.set(r.x,r.z),i.setLength(u*this.data.speed*16.66667),a.x=i.x,a.y=0,a.z=i.y),(a.x!==0||a.y!==0||a.z!==0)&&(this.eventDetail.velocity=a,this.el.emit(sae,this.eventDetail))}}}()});AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const i=this.data,e=this.el.sceneEl;switch(e.addEventListener("axismove",this.onAxisMove),i.mode){case"swipe":case"touch":e.addEventListener("trackpadtouchstart",this.onTouchStart),e.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":e.addEventListener("trackpaddown",this.onTouchStart),e.addEventListener("trackpadup",this.onTouchEnd);break}},removeEventListeners:function(){const i=this.el.sceneEl;i.removeEventListener("axismove",this.onAxisMove),i.removeEventListener("trackpadtouchstart",this.onTouchStart),i.removeEventListener("trackpadtouchend",this.onTouchEnd),i.removeEventListener("trackpaddown",this.onTouchStart),i.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(i){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":this.isMoving=!0;break;case"press":this.isMoving=!0;break}i.preventDefault()},onTouchEnd:function(i){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,i.preventDefault()},onAxisMove:function(i){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(i);case"touch":case"press":return this.handleTouchAxis(i)}},handleSwipeAxis:function(i){const e=this.data,n=i.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=n[0],this.startingAxisData[1]=n[1]),this.startingAxisData.length>0){let r=0,s=0;e.enableNegX&&n[0]<this.startingAxisData[0]&&(r=-1),e.enablePosX&&n[0]>this.startingAxisData[0]&&(r=1),e.enablePosZ&&n[1]>this.startingAxisData[1]&&(s=-1),e.enableNegZ&&n[1]<this.startingAxisData[1]&&(s=1);const o=Math.abs(this.startingAxisData[1]-n[1]);Math.abs(this.startingAxisData[0]-n[0])>o?(this.zVel=0,this.xVel=r,this.isMoving=!0):(this.xVel=0,this.zVel=s,this.isMoving=!0)}},handleTouchAxis:function(i){const e=this.data,n=i.detail.axis;let r=0,s=0;e.enableNegX&&n[0]<0&&(r=-1),e.enablePosX&&n[0]>0&&(r=1),e.enablePosZ&&n[1]>0&&(s=-1),e.enableNegZ&&n[1]<0&&(s=1),Math.abs(n[0])>Math.abs(n[1])?(this.zVel=0,this.xVel=r):(this.xVel=0,this.zVel=s)}});const F_=(i,e)=>{const n=e.x-i.x,r=e.y-i.y;return Math.sqrt(n*n+r*r)},oae=(i,e)=>{const n=e.x-i.x,r=e.y-i.y;return lae(Math.atan2(r,n))},aae=(i,e,n)=>{const r={x:0,y:0};return n=wC(n),r.x=i.x-e*Math.cos(n),r.y=i.y-e*Math.sin(n),r},wC=i=>i*(Math.PI/180),lae=i=>i*(180/Math.PI),cae=i=>isNaN(i.buttons)?i.pressure!==0:i.buttons!==0,IT=new Map,gD=i=>{IT.has(i)&&clearTimeout(IT.get(i)),IT.set(i,setTimeout(i,100))},Vb=(i,e,n)=>{const r=e.split(/[ ,]+/g);let s;for(let o=0;o<r.length;o+=1)s=r[o],i.addEventListener?i.addEventListener(s,n,!1):i.attachEvent&&i.attachEvent(s,n)},yD=(i,e,n)=>{const r=e.split(/[ ,]+/g);let s;for(let o=0;o<r.length;o+=1)s=r[o],i.removeEventListener?i.removeEventListener(s,n):i.detachEvent&&i.detachEvent(s,n)},YV=i=>(i.preventDefault(),i.type.match(/^touch/)?i.changedTouches:i),vD=()=>{const i=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:i,y:e}},xD=(i,e)=>{e.top||e.right||e.bottom||e.left?(i.style.top=e.top,i.style.right=e.right,i.style.bottom=e.bottom,i.style.left=e.left):(i.style.left=e.x+"px",i.style.top=e.y+"px")},gN=(i,e,n)=>{const r=ZV(i);for(let s in r)if(r.hasOwnProperty(s))if(typeof e=="string")r[s]=e+" "+n;else{let o="";for(let a=0,l=e.length;a<l;a+=1)o+=e[a]+" "+n+", ";r[s]=o.slice(0,-2)}return r},uae=(i,e)=>{const n=ZV(i);for(let r in n)n.hasOwnProperty(r)&&(n[r]=e);return n},ZV=i=>{const e={};return e[i]="",["webkit","Moz","o"].forEach(function(r){e[r+i.charAt(0).toUpperCase()+i.slice(1)]=""}),e},DT=(i,e)=>{for(let n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i},dae=(i,e)=>{const n={};for(let r in i)i.hasOwnProperty(r)&&e.hasOwnProperty(r)?n[r]=e[r]:i.hasOwnProperty(r)&&(n[r]=i[r]);return n},TC=(i,e)=>{if(i.length)for(let n=0,r=i.length;n<r;n+=1)e(i[n]);else e(i)},hae=(i,e,n)=>({x:Math.min(Math.max(i.x,e.x-n),e.x+n),y:Math.min(Math.max(i.y,e.y-n),e.y+n)});var fae="ontouchstart"in window,pae=!!window.PointerEvent,mae=!!window.MSPointerEvent,Rm={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},mf,Ly={};pae?mf=Rm.pointer:mae?mf=Rm.MSPointer:fae?(mf=Rm.touch,Ly=Rm.mouse):mf=Rm.mouse;function uc(){}uc.prototype.on=function(i,e){var n=this,r=i.split(/[ ,]+/g),s;n._handlers_=n._handlers_||{};for(var o=0;o<r.length;o+=1)s=r[o],n._handlers_[s]=n._handlers_[s]||[],n._handlers_[s].push(e);return n};uc.prototype.off=function(i,e){var n=this;return n._handlers_=n._handlers_||{},i===void 0?n._handlers_={}:e===void 0?n._handlers_[i]=null:n._handlers_[i]&&n._handlers_[i].indexOf(e)>=0&&n._handlers_[i].splice(n._handlers_[i].indexOf(e),1),n};uc.prototype.trigger=function(i,e){var n=this,r=i.split(/[ ,]+/g),s;n._handlers_=n._handlers_||{};for(var o=0;o<r.length;o+=1)s=r[o],n._handlers_[s]&&n._handlers_[s].length&&n._handlers_[s].forEach(function(a){a.call(n,{type:s,target:n},e)})};uc.prototype.config=function(i){var e=this;e.options=e.defaults||{},i&&(e.options=dae(e.options,i))};uc.prototype.bindEvt=function(i,e){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[e]=function(){typeof n["on"+e]=="function"?n["on"+e].apply(n,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},Vb(i,mf[e],n._domHandlers_[e]),Ly[e]&&Vb(i,Ly[e],n._domHandlers_[e]),n};uc.prototype.unbindEvt=function(i,e){var n=this;return n._domHandlers_=n._domHandlers_||{},yD(i,mf[e],n._domHandlers_[e]),Ly[e]&&yD(i,Ly[e],n._domHandlers_[e]),delete n._domHandlers_[e],this};function Zi(i,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=i,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Zi.id,Zi.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Zi.prototype=new uc;Zi.constructor=Zi;Zi.id=0;Zi.prototype.buildEl=function(i){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Zi.prototype.stylize=function(){if(this.options.dataOnly)return this;var i=this.options.fadeTime+"ms",e=uae("borderRadius","50%"),n=gN("transition","opacity",i),r={};return r.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},r.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},r.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},DT(r.el,n),this.options.shape==="circle"&&DT(r.back,e),DT(r.front,e),this.applyStyles(r),this};Zi.prototype.applyStyles=function(i){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var n in i[e])this.ui[e].style[n]=i[e][n];return this};Zi.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Zi.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Zi.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Zi.prototype.show=function(i){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof i=="function"&&i.call(this)},e.options.fadeTime)),e};Zi.prototype.hide=function(i){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var n=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=n,typeof i=="function"&&i.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const n=e.options.restJoystick,r={};r.x=n===!0||n.x!==!1?0:e.instance.frontPosition.x,r.y=n===!0||n.y!==!1?0:e.instance.frontPosition.y,e.setPosition(i,r)}return e};Zi.prototype.setPosition=function(i,e){var n=this;n.frontPosition={x:e.x,y:e.y};var r=n.options.fadeTime+"ms",s={};s.front=gN("transition",["transform"],r);var o={front:{}};o.front={transform:"translate("+n.frontPosition.x+"px,"+n.frontPosition.y+"px)"},n.applyStyles(s),n.applyStyles(o),n.restTimeout=setTimeout(function(){typeof i=="function"&&i.call(n),n.restCallback()},n.options.fadeTime)};Zi.prototype.restCallback=function(){var i=this,e={};e.front=gN("transition","none",""),i.applyStyles(e),i.trigger("rested",i.instance)};Zi.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Zi.prototype.computeDirection=function(i){var e=i.angle.radian,n=Math.PI/4,r=Math.PI/2,s,o,a;if(e>n&&e<n*3&&!i.lockX?s="up":e>-n&&e<=n&&!i.lockY?s="left":e>-n*3&&e<=-n&&!i.lockX?s="down":i.lockY||(s="right"),i.lockY||(e>-r&&e<r?o="left":o="right"),i.lockX||(e>0?a="up":a="down"),i.force>this.options.threshold){var l={},c;for(c in this.direction)this.direction.hasOwnProperty(c)&&(l[c]=this.direction[c]);var u={};this.direction={x:o,y:a,angle:s},i.direction=this.direction;for(c in l)l[c]===this.direction[c]&&(u[c]=!0);if(u.x&&u.y&&u.angle)return i;(!u.x||!u.y)&&this.trigger("plain",i),u.x||this.trigger("plain:"+o,i),u.y||this.trigger("plain:"+a,i),u.angle||this.trigger("dir dir:"+s,i)}else this.resetDirection();return i};function Mi(i,e){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=i,n.id=Mi.id,Mi.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(e),(n.options.mode==="static"||n.options.mode==="semi")&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);const r=getComputedStyle(n.options.zone.parentElement);return r&&r.display==="flex"&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}Mi.prototype=new uc;Mi.constructor=Mi;Mi.id=0;Mi.prototype.prepareNipples=function(){var i=this,e=i.nipples;e.on=i.on.bind(i),e.off=i.off.bind(i),e.options=i.options,e.destroy=i.destroy.bind(i),e.ids=i.ids,e.id=i.id,e.processOnMove=i.processOnMove.bind(i),e.processOnEnd=i.processOnEnd.bind(i),e.get=function(n){if(n===void 0)return e[0];for(var r=0,s=e.length;r<s;r+=1)if(e[r].identifier===n)return e[r];return!1}};Mi.prototype.bindings=function(){var i=this;i.bindEvt(i.options.zone,"start"),i.options.zone.style.touchAction="none",i.options.zone.style.msTouchAction="none"};Mi.prototype.begin=function(){var i=this,e=i.options;if(e.mode==="static"){var n=i.createNipple(e.position,i.manager.getIdentifier());n.add(),i.idles.push(n)}};Mi.prototype.createNipple=function(i,e){var n=this,r=n.manager.scroll,s={},o=n.options,a={x:n.parentIsFlex?r.x:r.x+n.box.left,y:n.parentIsFlex?r.y:r.y+n.box.top};if(i.x&&i.y)s={x:i.x-a.x,y:i.y-a.y};else if(i.top||i.right||i.bottom||i.left){var l=document.createElement("DIV");l.style.display="hidden",l.style.top=i.top,l.style.right=i.right,l.style.bottom=i.bottom,l.style.left=i.left,l.style.position="absolute",o.zone.appendChild(l);var c=l.getBoundingClientRect();o.zone.removeChild(l),s=i,i={x:c.left+r.x,y:c.top+r.y}}var u=new Zi(n,{color:o.color,size:o.size,threshold:o.threshold,fadeTime:o.fadeTime,dataOnly:o.dataOnly,restJoystick:o.restJoystick,restOpacity:o.restOpacity,mode:o.mode,identifier:e,position:i,zone:o.zone,frontPosition:{x:0,y:0},shape:o.shape});return o.dataOnly||(xD(u.ui.el,s),xD(u.ui.front,u.frontPosition)),n.nipples.push(u),n.trigger("added "+u.identifier+":added",u),n.manager.trigger("added "+u.identifier+":added",u),n.bindNipple(u),u};Mi.prototype.updateBox=function(){var i=this;i.box=i.options.zone.getBoundingClientRect()};Mi.prototype.bindNipple=function(i){var e=this,n,r=function(s,o){n=s.type+" "+o.id+":"+s.type,e.trigger(n,o)};i.on("destroyed",e.onDestroyed.bind(e)),i.on("shown hidden rested dir plain",r),i.on("dir:up dir:right dir:down dir:left",r),i.on("plain:up plain:right plain:down plain:left",r)};Mi.prototype.pressureFn=function(i,e,n){var r=this,s=0;clearInterval(r.pressureIntervals[n]),r.pressureIntervals[n]=setInterval((function(){var o=i.force||i.pressure||i.webkitForce||0;o!==s&&(e.trigger("pressure",o),r.trigger("pressure "+e.identifier+":pressure",o),s=o)}).bind(r),100)};Mi.prototype.onstart=function(i){var e=this,n=e.options,r=i;i=YV(i),e.updateBox();var s=function(o){e.actives.length<n.maxNumberOfNipples?e.processOnStart(o):r.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(a){if(Object.values(r.touches).findIndex(function(c){return c.identifier===a})<0){var l=[i[0]];l.identifier=a,e.processOnEnd(l)}}),e.actives.length<n.maxNumberOfNipples&&e.processOnStart(o))};return TC(i,s),e.manager.bindDocument(),!1};Mi.prototype.processOnStart=function(i){var e=this,n=e.options,r,s=e.manager.getIdentifier(i),o=i.force||i.pressure||i.webkitForce||0,a={x:i.pageX,y:i.pageY},l=e.getOrCreate(s,a);l.identifier!==s&&e.manager.removeIdentifier(l.identifier),l.identifier=s;var c=function(d){d.trigger("start",d),e.trigger("start "+d.id+":start",d),d.show(),o>0&&e.pressureFn(i,d,d.identifier),e.processOnMove(i)};if((r=e.idles.indexOf(l))>=0&&e.idles.splice(r,1),e.actives.push(l),e.ids.push(l.identifier),n.mode!=="semi")c(l);else{var u=F_(a,l.position);if(u<=n.catchDistance)c(l);else{l.destroy(),e.processOnStart(i);return}}return l};Mi.prototype.getOrCreate=function(i,e){var n=this,r=n.options,s;return/(semi|static)/.test(r.mode)?(s=n.idles[0],s?(n.idles.splice(0,1),s):r.mode==="semi"?n.createNipple(e,i):(console.warn("Coudln't find the needed nipple."),!1)):(s=n.createNipple(e,i),s)};Mi.prototype.processOnMove=function(i){var e=this,n=e.options,r=e.manager.getIdentifier(i),s=e.nipples.get(r),o=e.manager.scroll;if(!cae(i)){this.processOnEnd(i);return}if(!s){console.error("Found zombie joystick with ID "+r),e.manager.removeIdentifier(r);return}if(n.dynamicPage){var a=s.el.getBoundingClientRect();s.position={x:o.x+a.left,y:o.y+a.top}}s.identifier=r;var l=s.options.size/2,c={x:i.pageX,y:i.pageY};n.lockX&&(c.y=s.position.y),n.lockY&&(c.x=s.position.x);var u=F_(c,s.position),d=oae(c,s.position),h=wC(d),f=u/l,p={distance:u,position:c},m,y;if(s.options.shape==="circle"?(m=Math.min(u,l),y=aae(s.position,m,d)):(y=hae(c,s.position,l),m=F_(y,s.position)),n.follow){if(u>l){let x=c.x-y.x,b=c.y-y.y;s.position.x+=x,s.position.y+=b,s.el.style.top=s.position.y-(e.box.top+o.y)+"px",s.el.style.left=s.position.x-(e.box.left+o.x)+"px",u=F_(c,s.position)}}else c=y,u=m;var v=c.x-s.position.x,g=c.y-s.position.y;s.frontPosition={x:v,y:g},n.dataOnly||(s.ui.front.style.transform="translate("+v+"px,"+g+"px)");var _={identifier:s.identifier,position:c,force:f,pressure:i.force||i.pressure||i.webkitForce||0,distance:u,angle:{radian:h,degree:d},vector:{x:v/l,y:-g/l},raw:p,instance:s,lockX:n.lockX,lockY:n.lockY};_=s.computeDirection(_),_.angle={radian:wC(180-d),degree:180-d},s.trigger("move",_),e.trigger("move "+s.id+":move",_)};Mi.prototype.processOnEnd=function(i){var e=this,n=e.options,r=e.manager.getIdentifier(i),s=e.nipples.get(r),o=e.manager.removeIdentifier(s.identifier);s&&(n.dataOnly||s.hide(function(){n.mode==="dynamic"&&(s.trigger("removed",s),e.trigger("removed "+s.id+":removed",s),e.manager.trigger("removed "+s.id+":removed",s),s.destroy())}),clearInterval(e.pressureIntervals[s.identifier]),s.resetDirection(),s.trigger("end",s),e.trigger("end "+s.id+":end",s),e.ids.indexOf(s.identifier)>=0&&e.ids.splice(e.ids.indexOf(s.identifier),1),e.actives.indexOf(s)>=0&&e.actives.splice(e.actives.indexOf(s),1),/(semi|static)/.test(n.mode)?e.idles.push(s):e.nipples.indexOf(s)>=0&&e.nipples.splice(e.nipples.indexOf(s),1),e.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(e.manager.ids[o.id]=o.identifier))};Mi.prototype.onDestroyed=function(i,e){var n=this;n.nipples.indexOf(e)>=0&&n.nipples.splice(n.nipples.indexOf(e),1),n.actives.indexOf(e)>=0&&n.actives.splice(n.actives.indexOf(e),1),n.idles.indexOf(e)>=0&&n.idles.splice(n.idles.indexOf(e),1),n.ids.indexOf(e.identifier)>=0&&n.ids.splice(n.ids.indexOf(e.identifier),1),n.manager.removeIdentifier(e.identifier),n.manager.unbindDocument()};Mi.prototype.destroy=function(){var i=this;i.unbindEvt(i.options.zone,"start"),i.nipples.forEach(function(n){n.destroy()});for(var e in i.pressureIntervals)i.pressureIntervals.hasOwnProperty(e)&&clearInterval(i.pressureIntervals[e]);i.trigger("destroyed",i.nipples),i.manager.unbindDocument(),i.off()};function hr(i){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=vD(),e.config(i),e.prepareCollections();var n=function(){var s;e.collections.forEach(function(o){o.forEach(function(a){s=a.el.getBoundingClientRect(),a.position={x:e.scroll.x+s.left,y:e.scroll.y+s.top}})})};Vb(window,"resize",function(){gD(n)});var r=function(){e.scroll=vD()};return Vb(window,"scroll",function(){gD(r)}),e.collections}hr.prototype=new uc;hr.constructor=hr;hr.prototype.prepareCollections=function(){var i=this;i.collections.create=i.create.bind(i),i.collections.on=i.on.bind(i),i.collections.off=i.off.bind(i),i.collections.destroy=i.destroy.bind(i),i.collections.get=function(e){var n;return i.collections.every(function(r){return n=r.get(e),!n}),n}};hr.prototype.create=function(i){return this.createCollection(i)};hr.prototype.createCollection=function(i){var e=this,n=new Mi(e,i);return e.bindCollection(n),e.collections.push(n),n};hr.prototype.bindCollection=function(i){var e=this,n,r=function(s,o){n=s.type+" "+o.id+":"+s.type,e.trigger(n,o)};i.on("destroyed",e.onDestroyed.bind(e)),i.on("shown hidden rested dir plain",r),i.on("dir:up dir:right dir:down dir:left",r),i.on("plain:up plain:right plain:down plain:left",r)};hr.prototype.bindDocument=function(){var i=this;i.binded||(i.bindEvt(document,"move").bindEvt(document,"end"),i.binded=!0)};hr.prototype.unbindDocument=function(i){var e=this;(!Object.keys(e.ids).length||i===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};hr.prototype.getIdentifier=function(i){var e;return i?(e=i.identifier===void 0?i.pointerId:i.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};hr.prototype.removeIdentifier=function(i){var e={};for(var n in this.ids)if(this.ids[n]===i){e.id=n,e.identifier=this.ids[n],delete this.ids[n];break}return e};hr.prototype.onmove=function(i){var e=this;return e.onAny("move",i),!1};hr.prototype.onend=function(i){var e=this;return e.onAny("end",i),!1};hr.prototype.oncancel=function(i){var e=this;return e.onAny("end",i),!1};hr.prototype.onAny=function(i,e){var n=this,r,s="processOn"+i.charAt(0).toUpperCase()+i.slice(1);e=YV(e);var o=function(l,c,u){u.ids.indexOf(c)>=0&&(u[s](l),l._found_=!0)},a=function(l){r=n.getIdentifier(l),TC(n.collections,o.bind(null,l,r)),l._found_||n.removeIdentifier(r)};return TC(e,a),!1};hr.prototype.destroy=function(){var i=this;i.unbindDocument(!0),i.ids={},i.index=0,i.collections.forEach(function(e){e.destroy()}),i.off()};hr.prototype.onDestroyed=function(i,e){var n=this;if(n.collections.indexOf(e)<0)return!1;n.collections.splice(n.collections.indexOf(e),1)};const _D=new hr,bD={create:function(i){return _D.create(i)},factory:_D};AFRAME.registerComponent("nipple-controls",{schema:{enabled:{default:!0},mode:{default:"dynamic",oneOf:["static","semi","dynamic"]},rotationSensitivity:{default:1},moveJoystickEnabled:{default:!0},lookJoystickEnabled:{default:!0},sideMargin:{default:"30px"},bottomMargin:{default:"70px"},moveJoystickPosition:{default:"left",oneOf:["left","right"]},lookJoystickPosition:{default:"right",oneOf:["left","right"]}},init(){this.dVelocity=new THREE.Vector3,this.lookVector=new THREE.Vector2;const i=this.el.querySelector("[look-controls]").components["look-controls"];this.pitchObject=i.pitchObject,this.yawObject=i.yawObject,this.rigRotation=this.el.object3D.rotation,this.moveData=void 0,this.lookData=void 0,this.moving=!1,this.rotating=!1},update(i){(this.data.moveJoystickPosition!==i.moveJoystickPosition||this.data.sideMargin!==i.sideMargin||this.data.bottomMargin!==i.bottomMargin||this.data.mode!==i.mode)&&this.removeMoveJoystick(),(this.data.lookJoystickPosition!==i.lookJoystickPosition||this.data.sideMargin!==i.sideMargin||this.data.bottomMargin!==i.bottomMargin||this.data.mode!==i.mode)&&this.removeLookJoystick(),this.data.enabled&&this.data.moveJoystickEnabled?this.createMoveJoystick():this.removeMoveJoystick(),this.data.enabled&&this.data.lookJoystickEnabled?this.createLookJoystick():this.removeLookJoystick()},pause(){this.moving=!1,this.rotating=!1},remove(){this.removeMoveJoystick(),this.removeLookJoystick()},isVelocityActive(){return this.data.enabled&&this.moving},getVelocityDelta(){if(this.dVelocity.set(0,0,0),this.isVelocityActive()){const i=this.moveData.force<1?this.moveData.force:1,e=this.moveData.angle.radian,n=Math.cos(e)*i,r=-Math.sin(e)*i;this.dVelocity.set(n,0,r)}return this.dVelocity},isRotationActive(){return this.data.enabled&&this.rotating},updateRotation(i){if(!this.isRotationActive())return;const e=this.lookData.force<1?this.lookData.force:1,n=this.lookData.angle.radian,r=this.lookVector;r.x=Math.cos(n)*e,r.y=Math.sin(n)*e,r.multiplyScalar(this.data.rotationSensitivity*i/1e3),this.yawObject.rotation.y-=r.x;let s=this.pitchObject.rotation.x+r.y;s=Math.max(-Math.PI/2,Math.min(Math.PI/2,s)),this.pitchObject.rotation.x=s},tick:function(i,e){this.updateRotation(e)},initLeftZone(){const i=document.createElement("div");i.setAttribute("id","joystickLeftZone"),i.setAttribute("style",`position:absolute;${this.data.moveJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(i),this.leftZone=i},initRightZone(){const i=document.createElement("div");i.setAttribute("id","joystickRightZone"),i.setAttribute("style",`position:absolute;${this.data.lookJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(i),this.rightZone=i},createMoveJoystick(){if(this.moveJoystick)return;this.initLeftZone();const i={mode:this.data.mode,zone:this.leftZone,color:"white",fadeTime:0};this.leftZone.style.width="100px",this.data.mode==="static"?(this.leftZone.style.height="100px",i.position={left:"50%",bottom:"50%"}):this.leftZone.style.height="400px",this.moveJoystick=bD.create(i),this.moveJoystick.on("move",(e,n)=>{this.moveData=n,this.moving=!0}),this.moveJoystick.on("end",(e,n)=>{this.moving=!1})},createLookJoystick(){if(this.lookJoystick)return;this.initRightZone();const i={mode:this.data.mode,zone:this.rightZone,color:"white",fadeTime:0};this.rightZone.style.width="100px",this.data.mode==="static"?(this.rightZone.style.height="100px",i.position={left:"50%",bottom:"50%"}):this.rightZone.style.height="400px",this.lookJoystick=bD.create(i),this.lookJoystick.on("move",(e,n)=>{this.lookData=n,this.rotating=!0}),this.lookJoystick.on("end",(e,n)=>{this.rotating=!1})},removeMoveJoystick(){this.moveJoystick&&(this.moveJoystick.destroy(),this.moveJoystick=void 0),this.moveData=void 0,this.leftZone&&this.leftZone.parentNode&&(this.leftZone.remove(),this.leftZone=void 0)},removeLookJoystick(){this.lookJoystick&&(this.lookJoystick.destroy(),this.lookJoystick=void 0),this.lookData=void 0,this.rightZone&&this.rightZone.parentNode&&(this.rightZone.remove(),this.rightZone=void 0)}});const OT={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},useRegExp:{default:!1},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(OT)},repetitions:{default:1/0,min:0},timeScale:{default:1},startAt:{default:0}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];const i=this.el.getObject3D("mesh");i?this.load(i):this.el.addEventListener("model-loaded",e=>{this.load(e.detail.model)})},load:function(i){const e=this.el;this.model=i,this.mixer=new THREE.AnimationMixer(i),this.mixer.addEventListener("loop",n=>{e.emit("animation-loop",{action:n.action,loopDelta:n.loopDelta})}),this.mixer.addEventListener("finished",n=>{e.emit("animation-finished",{action:n.action,direction:n.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(i){if(!i)return;const e=this.data,n=AFRAME.utils.diff(e,i);if("clip"in n){this.stopAction(),e.clip&&this.playAction();return}this.activeActions.forEach(r=>{"duration"in n&&e.duration&&r.setDuration(e.duration),"clampWhenFinished"in n&&(r.clampWhenFinished=e.clampWhenFinished),("loop"in n||"repetitions"in n)&&r.setLoop(OT[e.loop],e.repetitions),"timeScale"in n&&r.setEffectiveTimeScale(e.timeScale)})},stopAction:function(){const i=this.data;for(let e=0;e<this.activeActions.length;e++)i.crossFadeDuration?this.activeActions[e].fadeOut(i.crossFadeDuration):this.activeActions[e].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;const i=this.model,e=this.data,n=i.animations||(i.geometry||{}).animations||[];if(!n.length)return;const r=e.useRegExp?e.clip:gae(e.clip);for(let s,o=0;s=n[o];o++)if(s.name.match(r)){const a=this.mixer.clipAction(s,i);a.enabled=!0,a.clampWhenFinished=e.clampWhenFinished,e.duration&&a.setDuration(e.duration),e.timeScale!==1&&a.setEffectiveTimeScale(e.timeScale),a.startAt(this.mixer.time-e.startAt/1e3),a.setLoop(OT[e.loop],e.repetitions).fadeIn(e.crossFadeDuration).play(),this.activeActions.push(a)}},tick:function(i,e){this.mixer&&!isNaN(e)&&this.mixer.update(e/1e3)}});function gae(i){return new RegExp("^"+i.split(/\*+/).map(yae).join(".*")+"$")}function yae(i){return i.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const QV="164",$b=0,vae=1,xae=2,SD=1,wD=100,TD=204,ED=205,MD=3,yN=0,AD="attached",_ae="detached",JV=300,bae=303,Yc=1e3,Ba=1001,CD=1002,Gb=1003,B_=1006,vN=1008,Sae=1009,wae=1014,e$=1015,Tae=1020,t$=1023,FT=1026,RD=1027,Hb=2300,Wb=2301,BT=2302,PD=2400,ND=2401,kD=2402,Eae=2500,n$=0,i$="",Zr="srgb",xN="srgb-linear",Mae="display-p3",r$="display-p3-linear",EC="linear",LD="srgb",ID="rec709",DD="p3",dh=7680,OD=519,Aae=515,FD=35044,yd=2e3,MC=2001;let GS=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const o=s.indexOf(n);o!==-1&&s.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const s=r.slice(0);for(let o=0,a=s.length;o<a;o++)s[o].call(this,e);e.target=null}}};const Rr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let BD=1234567;const Gg=Math.PI/180,Iy=180/Math.PI;function wu(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Rr[i&255]+Rr[i>>8&255]+Rr[i>>16&255]+Rr[i>>24&255]+"-"+Rr[e&255]+Rr[e>>8&255]+"-"+Rr[e>>16&15|64]+Rr[e>>24&255]+"-"+Rr[n&63|128]+Rr[n>>8&255]+"-"+Rr[n>>16&255]+Rr[n>>24&255]+Rr[r&255]+Rr[r>>8&255]+Rr[r>>16&255]+Rr[r>>24&255]).toLowerCase()}function vr(i,e,n){return Math.max(e,Math.min(n,i))}function _N(i,e){return(i%e+e)%e}function Cae(i,e,n,r,s){return r+(i-e)*(s-r)/(n-e)}function Rae(i,e,n){return i!==e?(n-i)/(e-i):0}function Hg(i,e,n){return(1-n)*i+n*e}function Pae(i,e,n,r){return Hg(i,e,1-Math.exp(-n*r))}function Nae(i,e=1){return e-Math.abs(_N(i,e*2)-e)}function kae(i,e,n){return i<=e?0:i>=n?1:(i=(i-e)/(n-e),i*i*(3-2*i))}function Lae(i,e,n){return i<=e?0:i>=n?1:(i=(i-e)/(n-e),i*i*i*(i*(i*6-15)+10))}function Iae(i,e){return i+Math.floor(Math.random()*(e-i+1))}function Dae(i,e){return i+Math.random()*(e-i)}function Oae(i){return i*(.5-Math.random())}function Fae(i){i!==void 0&&(BD=i);let e=BD+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Bae(i){return i*Gg}function Uae(i){return i*Iy}function zae(i){return(i&i-1)===0&&i!==0}function Vae(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function $ae(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function Gae(i,e,n,r,s){const o=Math.cos,a=Math.sin,l=o(n/2),c=a(n/2),u=o((e+r)/2),d=a((e+r)/2),h=o((e-r)/2),f=a((e-r)/2),p=o((r-e)/2),m=a((r-e)/2);switch(s){case"XYX":i.set(l*d,c*h,c*f,l*u);break;case"YZY":i.set(c*f,l*d,c*h,l*u);break;case"ZXZ":i.set(c*h,c*f,l*d,l*u);break;case"XZX":i.set(l*d,c*m,c*p,l*u);break;case"YXY":i.set(c*p,l*d,c*m,l*u);break;case"ZYZ":i.set(c*m,c*p,l*d,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function ef(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Wr(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const ki={DEG2RAD:Gg,RAD2DEG:Iy,generateUUID:wu,clamp:vr,euclideanModulo:_N,mapLinear:Cae,inverseLerp:Rae,lerp:Hg,damp:Pae,pingpong:Nae,smoothstep:kae,smootherstep:Lae,randInt:Iae,randFloat:Dae,randFloatSpread:Oae,seededRandom:Fae,degToRad:Bae,radToDeg:Uae,isPowerOfTwo:zae,ceilPowerOfTwo:Vae,floorPowerOfTwo:$ae,setQuaternionFromProperEuler:Gae,normalize:Wr,denormalize:ef};let vi=class s${constructor(e=0,n=0){s$.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,s=e.elements;return this.x=s[0]*n+s[3]*r+s[6],this.y=s[1]*n+s[4]*r+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(vr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),s=Math.sin(n),o=this.x-e.x,a=this.y-e.y;return this.x=o*r-a*s+e.x,this.y=o*s+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Tu=class o${constructor(e,n,r,s,o,a,l,c,u){o$.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,s,o,a,l,c,u)}set(e,n,r,s,o,a,l,c,u){const d=this.elements;return d[0]=e,d[1]=s,d[2]=l,d[3]=n,d[4]=o,d[5]=c,d[6]=r,d[7]=a,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,s=n.elements,o=this.elements,a=r[0],l=r[3],c=r[6],u=r[1],d=r[4],h=r[7],f=r[2],p=r[5],m=r[8],y=s[0],v=s[3],g=s[6],_=s[1],x=s[4],b=s[7],S=s[2],T=s[5],w=s[8];return o[0]=a*y+l*_+c*S,o[3]=a*v+l*x+c*T,o[6]=a*g+l*b+c*w,o[1]=u*y+d*_+h*S,o[4]=u*v+d*x+h*T,o[7]=u*g+d*b+h*w,o[2]=f*y+p*_+m*S,o[5]=f*v+p*x+m*T,o[8]=f*g+p*b+m*w,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8];return n*a*d-n*l*u-r*o*d+r*l*c+s*o*u-s*a*c}invert(){const e=this.elements,n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=d*a-l*u,f=l*c-d*o,p=u*o-a*c,m=n*h+r*f+s*p;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/m;return e[0]=h*y,e[1]=(s*u-d*r)*y,e[2]=(l*r-s*a)*y,e[3]=f*y,e[4]=(d*n-s*c)*y,e[5]=(s*o-l*n)*y,e[6]=p*y,e[7]=(r*c-u*n)*y,e[8]=(a*n-r*o)*y,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,s,o,a,l){const c=Math.cos(o),u=Math.sin(o);return this.set(r*c,r*u,-r*(c*a+u*l)+a+e,-s*u,s*c,-s*(-u*a+c*l)+l+n,0,0,1),this}scale(e,n){return this.premultiply(UT.makeScale(e,n)),this}rotate(e){return this.premultiply(UT.makeRotation(-e)),this}translate(e,n){return this.premultiply(UT.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let s=0;s<9;s++)if(n[s]!==r[s])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const UT=new Tu;function Hae(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function AC(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}const UD={};function Wae(i){i in UD||(UD[i]=!0,console.warn(i))}const zD=new Tu().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),VD=new Tu().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Dv={[xN]:{transfer:EC,primaries:ID,toReference:i=>i,fromReference:i=>i},[Zr]:{transfer:LD,primaries:ID,toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[r$]:{transfer:EC,primaries:DD,toReference:i=>i.applyMatrix3(VD),fromReference:i=>i.applyMatrix3(zD)},[Mae]:{transfer:LD,primaries:DD,toReference:i=>i.convertSRGBToLinear().applyMatrix3(VD),fromReference:i=>i.applyMatrix3(zD).convertLinearToSRGB()}},jae=new Set([xN,r$]),zo={enabled:!0,_workingColorSpace:xN,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!jae.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,e,n){if(this.enabled===!1||e===n||!e||!n)return i;const r=Dv[e].toReference,s=Dv[n].fromReference;return s(r(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this._workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this._workingColorSpace)},getPrimaries:function(i){return Dv[i].primaries},getTransfer:function(i){return i===i$?EC:Dv[i].transfer}};function Bf(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function zT(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let hh,qae=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{hh===void 0&&(hh=AC("canvas")),hh.width=e.width,hh.height=e.height;const r=hh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=hh}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=AC("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const s=r.getImageData(0,0,e.width,e.height),o=s.data;for(let a=0;a<o.length;a++)o[a]=Bf(o[a]/255)*255;return r.putImageData(s,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(Bf(n[r]/255)*255):n[r]=Bf(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},Xae=0,Kae=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Xae++}),this.uuid=wu(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let a=0,l=s.length;a<l;a++)s[a].isDataTexture?o.push(VT(s[a].image)):o.push(VT(s[a]))}else o=VT(s);r.url=o}return n||(e.images[this.uuid]=r),r}};function VT(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?qae.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Yae=0,$l=class U_ extends GS{constructor(e=U_.DEFAULT_IMAGE,n=U_.DEFAULT_MAPPING,r=Ba,s=Ba,o=B_,a=vN,l=t$,c=Sae,u=U_.DEFAULT_ANISOTROPY,d=i$){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Yae++}),this.uuid=wu(),this.name="",this.source=new Kae(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new vi(0,0),this.repeat=new vi(1,1),this.center=new vi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Tu,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==JV)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Yc:e.x=e.x-Math.floor(e.x);break;case Ba:e.x=e.x<0?0:1;break;case CD:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Yc:e.y=e.y-Math.floor(e.y);break;case Ba:e.y=e.y<0?0:1;break;case CD:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};$l.DEFAULT_IMAGE=null;$l.DEFAULT_MAPPING=JV;$l.DEFAULT_ANISOTROPY=1;let gs=class a${constructor(e=0,n=0,r=0,s=1){a$.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,s){return this.x=e,this.y=n,this.z=r,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,s=this.z,o=this.w,a=e.elements;return this.x=a[0]*n+a[4]*r+a[8]*s+a[12]*o,this.y=a[1]*n+a[5]*r+a[9]*s+a[13]*o,this.z=a[2]*n+a[6]*r+a[10]*s+a[14]*o,this.w=a[3]*n+a[7]*r+a[11]*s+a[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,s,o;const c=e.elements,u=c[0],d=c[4],h=c[8],f=c[1],p=c[5],m=c[9],y=c[2],v=c[6],g=c[10];if(Math.abs(d-f)<.01&&Math.abs(h-y)<.01&&Math.abs(m-v)<.01){if(Math.abs(d+f)<.1&&Math.abs(h+y)<.1&&Math.abs(m+v)<.1&&Math.abs(u+p+g-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const x=(u+1)/2,b=(p+1)/2,S=(g+1)/2,T=(d+f)/4,w=(h+y)/4,E=(m+v)/4;return x>b&&x>S?x<.01?(r=0,s=.707106781,o=.707106781):(r=Math.sqrt(x),s=T/r,o=w/r):b>S?b<.01?(r=.707106781,s=0,o=.707106781):(s=Math.sqrt(b),r=T/s,o=E/s):S<.01?(r=.707106781,s=.707106781,o=0):(o=Math.sqrt(S),r=w/o,s=E/o),this.set(r,s,o,n),this}let _=Math.sqrt((v-m)*(v-m)+(h-y)*(h-y)+(f-d)*(f-d));return Math.abs(_)<.001&&(_=1),this.x=(v-m)/_,this.y=(h-y)/_,this.z=(f-d)/_,this.w=Math.acos((u+p+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Yr=class{constructor(e=0,n=0,r=0,s=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=s}static slerpFlat(e,n,r,s,o,a,l){let c=r[s+0],u=r[s+1],d=r[s+2],h=r[s+3];const f=o[a+0],p=o[a+1],m=o[a+2],y=o[a+3];if(l===0){e[n+0]=c,e[n+1]=u,e[n+2]=d,e[n+3]=h;return}if(l===1){e[n+0]=f,e[n+1]=p,e[n+2]=m,e[n+3]=y;return}if(h!==y||c!==f||u!==p||d!==m){let v=1-l;const g=c*f+u*p+d*m+h*y,_=g>=0?1:-1,x=1-g*g;if(x>Number.EPSILON){const S=Math.sqrt(x),T=Math.atan2(S,g*_);v=Math.sin(v*T)/S,l=Math.sin(l*T)/S}const b=l*_;if(c=c*v+f*b,u=u*v+p*b,d=d*v+m*b,h=h*v+y*b,v===1-l){const S=1/Math.sqrt(c*c+u*u+d*d+h*h);c*=S,u*=S,d*=S,h*=S}}e[n]=c,e[n+1]=u,e[n+2]=d,e[n+3]=h}static multiplyQuaternionsFlat(e,n,r,s,o,a){const l=r[s],c=r[s+1],u=r[s+2],d=r[s+3],h=o[a],f=o[a+1],p=o[a+2],m=o[a+3];return e[n]=l*m+d*h+c*p-u*f,e[n+1]=c*m+d*f+u*h-l*p,e[n+2]=u*m+d*p+l*f-c*h,e[n+3]=d*m-l*h-c*f-u*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,s){return this._x=e,this._y=n,this._z=r,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const r=e._x,s=e._y,o=e._z,a=e._order,l=Math.cos,c=Math.sin,u=l(r/2),d=l(s/2),h=l(o/2),f=c(r/2),p=c(s/2),m=c(o/2);switch(a){case"XYZ":this._x=f*d*h+u*p*m,this._y=u*p*h-f*d*m,this._z=u*d*m+f*p*h,this._w=u*d*h-f*p*m;break;case"YXZ":this._x=f*d*h+u*p*m,this._y=u*p*h-f*d*m,this._z=u*d*m-f*p*h,this._w=u*d*h+f*p*m;break;case"ZXY":this._x=f*d*h-u*p*m,this._y=u*p*h+f*d*m,this._z=u*d*m+f*p*h,this._w=u*d*h-f*p*m;break;case"ZYX":this._x=f*d*h-u*p*m,this._y=u*p*h+f*d*m,this._z=u*d*m-f*p*h,this._w=u*d*h+f*p*m;break;case"YZX":this._x=f*d*h+u*p*m,this._y=u*p*h+f*d*m,this._z=u*d*m-f*p*h,this._w=u*d*h-f*p*m;break;case"XZY":this._x=f*d*h-u*p*m,this._y=u*p*h-f*d*m,this._z=u*d*m+f*p*h,this._w=u*d*h+f*p*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,s=Math.sin(r);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],s=n[4],o=n[8],a=n[1],l=n[5],c=n[9],u=n[2],d=n[6],h=n[10],f=r+l+h;if(f>0){const p=.5/Math.sqrt(f+1);this._w=.25/p,this._x=(d-c)*p,this._y=(o-u)*p,this._z=(a-s)*p}else if(r>l&&r>h){const p=2*Math.sqrt(1+r-l-h);this._w=(d-c)/p,this._x=.25*p,this._y=(s+a)/p,this._z=(o+u)/p}else if(l>h){const p=2*Math.sqrt(1+l-r-h);this._w=(o-u)/p,this._x=(s+a)/p,this._y=.25*p,this._z=(c+d)/p}else{const p=2*Math.sqrt(1+h-r-l);this._w=(a-s)/p,this._x=(o+u)/p,this._y=(c+d)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(vr(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const s=Math.min(1,n/r);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,s=e._y,o=e._z,a=e._w,l=n._x,c=n._y,u=n._z,d=n._w;return this._x=r*d+a*l+s*u-o*c,this._y=s*d+a*c+o*l-r*u,this._z=o*d+a*u+r*c-s*l,this._w=a*d-r*l-s*c-o*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,s=this._y,o=this._z,a=this._w;let l=a*e._w+r*e._x+s*e._y+o*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=a,this._x=r,this._y=s,this._z=o,this;const c=1-l*l;if(c<=Number.EPSILON){const p=1-n;return this._w=p*a+n*this._w,this._x=p*r+n*this._x,this._y=p*s+n*this._y,this._z=p*o+n*this._z,this.normalize(),this}const u=Math.sqrt(c),d=Math.atan2(u,l),h=Math.sin((1-n)*d)/u,f=Math.sin(n*d)/u;return this._w=a*h+this._w*f,this._x=r*h+this._x*f,this._y=s*h+this._y*f,this._z=o*h+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),r=Math.random(),s=Math.sqrt(1-r),o=Math.sqrt(r);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(n),o*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},ue=class l${constructor(e=0,n=0,r=0){l$.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion($D.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion($D.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[3]*r+o[6]*s,this.y=o[1]*n+o[4]*r+o[7]*s,this.z=o[2]*n+o[5]*r+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,s=this.z,o=e.elements,a=1/(o[3]*n+o[7]*r+o[11]*s+o[15]);return this.x=(o[0]*n+o[4]*r+o[8]*s+o[12])*a,this.y=(o[1]*n+o[5]*r+o[9]*s+o[13])*a,this.z=(o[2]*n+o[6]*r+o[10]*s+o[14])*a,this}applyQuaternion(e){const n=this.x,r=this.y,s=this.z,o=e.x,a=e.y,l=e.z,c=e.w,u=2*(a*s-l*r),d=2*(l*n-o*s),h=2*(o*r-a*n);return this.x=n+c*u+a*h-l*d,this.y=r+c*d+l*u-o*h,this.z=s+c*h+o*d-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[4]*r+o[8]*s,this.y=o[1]*n+o[5]*r+o[9]*s,this.z=o[2]*n+o[6]*r+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,s=e.y,o=e.z,a=n.x,l=n.y,c=n.z;return this.x=s*c-o*l,this.y=o*a-r*c,this.z=r*l-s*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return $T.copy(this).projectOnVector(e),this.sub($T)}reflect(e){return this.sub($T.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(vr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,s=this.z-e.z;return n*n+r*r+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const s=Math.sin(n)*e;return this.x=s*Math.sin(r),this.y=Math.cos(n)*e,this.z=s*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=s,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,r=Math.sqrt(1-n*n);return this.x=r*Math.cos(e),this.y=n,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const $T=new ue,$D=new Yr;let Zp=class{constructor(e=new ue(1/0,1/0,1/0),n=new ue(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(Vo.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(Vo.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=Vo.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const o=r.getAttribute("position");if(n===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let a=0,l=o.count;a<l;a++)e.isMesh===!0?e.getVertexPosition(a,Vo):Vo.fromBufferAttribute(o,a),Vo.applyMatrix4(e.matrixWorld),this.expandByPoint(Vo);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Ov.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Ov.copy(r.boundingBox)),Ov.applyMatrix4(e.matrixWorld),this.union(Ov)}const s=e.children;for(let o=0,a=s.length;o<a;o++)this.expandByObject(s[o],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Vo),Vo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Pm),Fv.subVectors(this.max,Pm),fh.subVectors(e.a,Pm),ph.subVectors(e.b,Pm),mh.subVectors(e.c,Pm),_c.subVectors(ph,fh),bc.subVectors(mh,ph),Du.subVectors(fh,mh);let n=[0,-_c.z,_c.y,0,-bc.z,bc.y,0,-Du.z,Du.y,_c.z,0,-_c.x,bc.z,0,-bc.x,Du.z,0,-Du.x,-_c.y,_c.x,0,-bc.y,bc.x,0,-Du.y,Du.x,0];return!GT(n,fh,ph,mh,Fv)||(n=[1,0,0,0,1,0,0,0,1],!GT(n,fh,ph,mh,Fv))?!1:(Bv.crossVectors(_c,bc),n=[Bv.x,Bv.y,Bv.z],GT(n,fh,ph,mh,Fv))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Vo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Vo).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ol[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ol[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ol[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ol[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ol[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ol[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ol[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ol[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ol),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};const ol=[new ue,new ue,new ue,new ue,new ue,new ue,new ue,new ue],Vo=new ue,Ov=new Zp,fh=new ue,ph=new ue,mh=new ue,_c=new ue,bc=new ue,Du=new ue,Pm=new ue,Fv=new ue,Bv=new ue,Ou=new ue;function GT(i,e,n,r,s){for(let o=0,a=i.length-3;o<=a;o+=3){Ou.fromArray(i,o);const l=s.x*Math.abs(Ou.x)+s.y*Math.abs(Ou.y)+s.z*Math.abs(Ou.z),c=e.dot(Ou),u=n.dot(Ou),d=r.dot(Ou);if(Math.max(-Math.max(c,u,d),Math.min(c,u,d))>l)return!1}return!0}const Zae=new Zp,Nm=new ue,HT=new ue;let Qp=class{constructor(e=new ue,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):Zae.setFromPoints(e).getCenter(r);let s=0;for(let o=0,a=e.length;o<a;o++)s=Math.max(s,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Nm.subVectors(e,this.center);const n=Nm.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),s=(r-this.radius)*.5;this.center.addScaledVector(Nm,s/r),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(HT.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Nm.copy(e.center).add(HT)),this.expandByPoint(Nm.copy(e.center).sub(HT))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const al=new ue,WT=new ue,Uv=new ue,Sc=new ue,jT=new ue,zv=new ue,qT=new ue;let bN=class{constructor(e=new ue,n=new ue(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,al)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=al.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(al.copy(this.origin).addScaledVector(this.direction,n),al.distanceToSquared(e))}distanceSqToSegment(e,n,r,s){WT.copy(e).add(n).multiplyScalar(.5),Uv.copy(n).sub(e).normalize(),Sc.copy(this.origin).sub(WT);const o=e.distanceTo(n)*.5,a=-this.direction.dot(Uv),l=Sc.dot(this.direction),c=-Sc.dot(Uv),u=Sc.lengthSq(),d=Math.abs(1-a*a);let h,f,p,m;if(d>0)if(h=a*c-l,f=a*l-c,m=o*d,h>=0)if(f>=-m)if(f<=m){const y=1/d;h*=y,f*=y,p=h*(h+a*f+2*l)+f*(a*h+f+2*c)+u}else f=o,h=Math.max(0,-(a*f+l)),p=-h*h+f*(f+2*c)+u;else f=-o,h=Math.max(0,-(a*f+l)),p=-h*h+f*(f+2*c)+u;else f<=-m?(h=Math.max(0,-(-a*o+l)),f=h>0?-o:Math.min(Math.max(-o,-c),o),p=-h*h+f*(f+2*c)+u):f<=m?(h=0,f=Math.min(Math.max(-o,-c),o),p=f*(f+2*c)+u):(h=Math.max(0,-(a*o+l)),f=h>0?o:Math.min(Math.max(-o,-c),o),p=-h*h+f*(f+2*c)+u);else f=a>0?-o:o,h=Math.max(0,-(a*f+l)),p=-h*h+f*(f+2*c)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,h),s&&s.copy(WT).addScaledVector(Uv,f),p}intersectSphere(e,n){al.subVectors(e.center,this.origin);const r=al.dot(this.direction),s=al.dot(al)-r*r,o=e.radius*e.radius;if(s>o)return null;const a=Math.sqrt(o-s),l=r-a,c=r+a;return c<0?null:l<0?this.at(c,n):this.at(l,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,s,o,a,l,c;const u=1/this.direction.x,d=1/this.direction.y,h=1/this.direction.z,f=this.origin;return u>=0?(r=(e.min.x-f.x)*u,s=(e.max.x-f.x)*u):(r=(e.max.x-f.x)*u,s=(e.min.x-f.x)*u),d>=0?(o=(e.min.y-f.y)*d,a=(e.max.y-f.y)*d):(o=(e.max.y-f.y)*d,a=(e.min.y-f.y)*d),r>a||o>s||((o>r||isNaN(r))&&(r=o),(a<s||isNaN(s))&&(s=a),h>=0?(l=(e.min.z-f.z)*h,c=(e.max.z-f.z)*h):(l=(e.max.z-f.z)*h,c=(e.min.z-f.z)*h),r>c||l>s)||((l>r||r!==r)&&(r=l),(c<s||s!==s)&&(s=c),s<0)?null:this.at(r>=0?r:s,n)}intersectsBox(e){return this.intersectBox(e,al)!==null}intersectTriangle(e,n,r,s,o){jT.subVectors(n,e),zv.subVectors(r,e),qT.crossVectors(jT,zv);let a=this.direction.dot(qT),l;if(a>0){if(s)return null;l=1}else if(a<0)l=-1,a=-a;else return null;Sc.subVectors(this.origin,e);const c=l*this.direction.dot(zv.crossVectors(Sc,zv));if(c<0)return null;const u=l*this.direction.dot(jT.cross(Sc));if(u<0||c+u>a)return null;const d=-l*Sc.dot(qT);return d<0?null:this.at(d/a,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Ct=class CC{constructor(e,n,r,s,o,a,l,c,u,d,h,f,p,m,y,v){CC.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,s,o,a,l,c,u,d,h,f,p,m,y,v)}set(e,n,r,s,o,a,l,c,u,d,h,f,p,m,y,v){const g=this.elements;return g[0]=e,g[4]=n,g[8]=r,g[12]=s,g[1]=o,g[5]=a,g[9]=l,g[13]=c,g[2]=u,g[6]=d,g[10]=h,g[14]=f,g[3]=p,g[7]=m,g[11]=y,g[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new CC().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,s=1/gh.setFromMatrixColumn(e,0).length(),o=1/gh.setFromMatrixColumn(e,1).length(),a=1/gh.setFromMatrixColumn(e,2).length();return n[0]=r[0]*s,n[1]=r[1]*s,n[2]=r[2]*s,n[3]=0,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[7]=0,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,s=e.y,o=e.z,a=Math.cos(r),l=Math.sin(r),c=Math.cos(s),u=Math.sin(s),d=Math.cos(o),h=Math.sin(o);if(e.order==="XYZ"){const f=a*d,p=a*h,m=l*d,y=l*h;n[0]=c*d,n[4]=-c*h,n[8]=u,n[1]=p+m*u,n[5]=f-y*u,n[9]=-l*c,n[2]=y-f*u,n[6]=m+p*u,n[10]=a*c}else if(e.order==="YXZ"){const f=c*d,p=c*h,m=u*d,y=u*h;n[0]=f+y*l,n[4]=m*l-p,n[8]=a*u,n[1]=a*h,n[5]=a*d,n[9]=-l,n[2]=p*l-m,n[6]=y+f*l,n[10]=a*c}else if(e.order==="ZXY"){const f=c*d,p=c*h,m=u*d,y=u*h;n[0]=f-y*l,n[4]=-a*h,n[8]=m+p*l,n[1]=p+m*l,n[5]=a*d,n[9]=y-f*l,n[2]=-a*u,n[6]=l,n[10]=a*c}else if(e.order==="ZYX"){const f=a*d,p=a*h,m=l*d,y=l*h;n[0]=c*d,n[4]=m*u-p,n[8]=f*u+y,n[1]=c*h,n[5]=y*u+f,n[9]=p*u-m,n[2]=-u,n[6]=l*c,n[10]=a*c}else if(e.order==="YZX"){const f=a*c,p=a*u,m=l*c,y=l*u;n[0]=c*d,n[4]=y-f*h,n[8]=m*h+p,n[1]=h,n[5]=a*d,n[9]=-l*d,n[2]=-u*d,n[6]=p*h+m,n[10]=f-y*h}else if(e.order==="XZY"){const f=a*c,p=a*u,m=l*c,y=l*u;n[0]=c*d,n[4]=-h,n[8]=u*d,n[1]=f*h+y,n[5]=a*d,n[9]=p*h-m,n[2]=m*h-p,n[6]=l*d,n[10]=y*h+f}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Qae,e,Jae)}lookAt(e,n,r){const s=this.elements;return Ds.subVectors(e,n),Ds.lengthSq()===0&&(Ds.z=1),Ds.normalize(),wc.crossVectors(r,Ds),wc.lengthSq()===0&&(Math.abs(r.z)===1?Ds.x+=1e-4:Ds.z+=1e-4,Ds.normalize(),wc.crossVectors(r,Ds)),wc.normalize(),Vv.crossVectors(Ds,wc),s[0]=wc.x,s[4]=Vv.x,s[8]=Ds.x,s[1]=wc.y,s[5]=Vv.y,s[9]=Ds.y,s[2]=wc.z,s[6]=Vv.z,s[10]=Ds.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,s=n.elements,o=this.elements,a=r[0],l=r[4],c=r[8],u=r[12],d=r[1],h=r[5],f=r[9],p=r[13],m=r[2],y=r[6],v=r[10],g=r[14],_=r[3],x=r[7],b=r[11],S=r[15],T=s[0],w=s[4],E=s[8],A=s[12],M=s[1],R=s[5],F=s[9],B=s[13],C=s[2],L=s[6],P=s[10],W=s[14],D=s[3],X=s[7],q=s[11],J=s[15];return o[0]=a*T+l*M+c*C+u*D,o[4]=a*w+l*R+c*L+u*X,o[8]=a*E+l*F+c*P+u*q,o[12]=a*A+l*B+c*W+u*J,o[1]=d*T+h*M+f*C+p*D,o[5]=d*w+h*R+f*L+p*X,o[9]=d*E+h*F+f*P+p*q,o[13]=d*A+h*B+f*W+p*J,o[2]=m*T+y*M+v*C+g*D,o[6]=m*w+y*R+v*L+g*X,o[10]=m*E+y*F+v*P+g*q,o[14]=m*A+y*B+v*W+g*J,o[3]=_*T+x*M+b*C+S*D,o[7]=_*w+x*R+b*L+S*X,o[11]=_*E+x*F+b*P+S*q,o[15]=_*A+x*B+b*W+S*J,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],s=e[8],o=e[12],a=e[1],l=e[5],c=e[9],u=e[13],d=e[2],h=e[6],f=e[10],p=e[14],m=e[3],y=e[7],v=e[11],g=e[15];return m*(+o*c*h-s*u*h-o*l*f+r*u*f+s*l*p-r*c*p)+y*(+n*c*p-n*u*f+o*a*f-s*a*p+s*u*d-o*c*d)+v*(+n*u*h-n*l*p-o*a*h+r*a*p+o*l*d-r*u*d)+g*(-s*l*d-n*c*h+n*l*f+s*a*h-r*a*f+r*c*d)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=n,s[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],m=e[12],y=e[13],v=e[14],g=e[15],_=h*v*u-y*f*u+y*c*p-l*v*p-h*c*g+l*f*g,x=m*f*u-d*v*u-m*c*p+a*v*p+d*c*g-a*f*g,b=d*y*u-m*h*u+m*l*p-a*y*p-d*l*g+a*h*g,S=m*h*c-d*y*c-m*l*f+a*y*f+d*l*v-a*h*v,T=n*_+r*x+s*b+o*S;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/T;return e[0]=_*w,e[1]=(y*f*o-h*v*o-y*s*p+r*v*p+h*s*g-r*f*g)*w,e[2]=(l*v*o-y*c*o+y*s*u-r*v*u-l*s*g+r*c*g)*w,e[3]=(h*c*o-l*f*o-h*s*u+r*f*u+l*s*p-r*c*p)*w,e[4]=x*w,e[5]=(d*v*o-m*f*o+m*s*p-n*v*p-d*s*g+n*f*g)*w,e[6]=(m*c*o-a*v*o-m*s*u+n*v*u+a*s*g-n*c*g)*w,e[7]=(a*f*o-d*c*o+d*s*u-n*f*u-a*s*p+n*c*p)*w,e[8]=b*w,e[9]=(m*h*o-d*y*o-m*r*p+n*y*p+d*r*g-n*h*g)*w,e[10]=(a*y*o-m*l*o+m*r*u-n*y*u-a*r*g+n*l*g)*w,e[11]=(d*l*o-a*h*o-d*r*u+n*h*u+a*r*p-n*l*p)*w,e[12]=S*w,e[13]=(d*y*s-m*h*s+m*r*f-n*y*f-d*r*v+n*h*v)*w,e[14]=(m*l*s-a*y*s-m*r*c+n*y*c+a*r*v-n*l*v)*w,e[15]=(a*h*s-d*l*s+d*r*c-n*h*c-a*r*f+n*l*f)*w,this}scale(e){const n=this.elements,r=e.x,s=e.y,o=e.z;return n[0]*=r,n[4]*=s,n[8]*=o,n[1]*=r,n[5]*=s,n[9]*=o,n[2]*=r,n[6]*=s,n[10]*=o,n[3]*=r,n[7]*=s,n[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,s))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),s=Math.sin(n),o=1-r,a=e.x,l=e.y,c=e.z,u=o*a,d=o*l;return this.set(u*a+r,u*l-s*c,u*c+s*l,0,u*l+s*c,d*l+r,d*c-s*a,0,u*c-s*l,d*c+s*a,o*c*c+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,s,o,a){return this.set(1,r,o,0,e,1,a,0,n,s,1,0,0,0,0,1),this}compose(e,n,r){const s=this.elements,o=n._x,a=n._y,l=n._z,c=n._w,u=o+o,d=a+a,h=l+l,f=o*u,p=o*d,m=o*h,y=a*d,v=a*h,g=l*h,_=c*u,x=c*d,b=c*h,S=r.x,T=r.y,w=r.z;return s[0]=(1-(y+g))*S,s[1]=(p+b)*S,s[2]=(m-x)*S,s[3]=0,s[4]=(p-b)*T,s[5]=(1-(f+g))*T,s[6]=(v+_)*T,s[7]=0,s[8]=(m+x)*w,s[9]=(v-_)*w,s[10]=(1-(f+y))*w,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,n,r){const s=this.elements;let o=gh.set(s[0],s[1],s[2]).length();const a=gh.set(s[4],s[5],s[6]).length(),l=gh.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],$o.copy(this);const u=1/o,d=1/a,h=1/l;return $o.elements[0]*=u,$o.elements[1]*=u,$o.elements[2]*=u,$o.elements[4]*=d,$o.elements[5]*=d,$o.elements[6]*=d,$o.elements[8]*=h,$o.elements[9]*=h,$o.elements[10]*=h,n.setFromRotationMatrix($o),r.x=o,r.y=a,r.z=l,this}makePerspective(e,n,r,s,o,a,l=yd){const c=this.elements,u=2*o/(n-e),d=2*o/(r-s),h=(n+e)/(n-e),f=(r+s)/(r-s);let p,m;if(l===yd)p=-(a+o)/(a-o),m=-2*a*o/(a-o);else if(l===MC)p=-a/(a-o),m=-a*o/(a-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return c[0]=u,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=d,c[9]=f,c[13]=0,c[2]=0,c[6]=0,c[10]=p,c[14]=m,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,r,s,o,a,l=yd){const c=this.elements,u=1/(n-e),d=1/(r-s),h=1/(a-o),f=(n+e)*u,p=(r+s)*d;let m,y;if(l===yd)m=(a+o)*h,y=-2*h;else if(l===MC)m=o*h,y=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return c[0]=2*u,c[4]=0,c[8]=0,c[12]=-f,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-p,c[2]=0,c[6]=0,c[10]=y,c[14]=-m,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let s=0;s<16;s++)if(n[s]!==r[s])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}};const gh=new ue,$o=new Ct,Qae=new ue(0,0,0),Jae=new ue(1,1,1),wc=new ue,Vv=new ue,Ds=new ue,GD=new Ct,HD=new Yr;let xr=class c${constructor(e=0,n=0,r=0,s=c$.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,s=this._order){return this._x=e,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const s=e.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],d=s[9],h=s[2],f=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(vr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-vr(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(vr(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-vr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(vr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-vr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return GD.makeRotationFromQuaternion(e),this.setFromRotationMatrix(GD,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return HD.setFromEuler(this),this.setFromQuaternion(HD,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};xr.DEFAULT_ORDER="XYZ";let ele=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},tle=0;const WD=new ue,yh=new Yr,ll=new Ct,$v=new ue,km=new ue,nle=new ue,ile=new Yr,jD=new ue(1,0,0),qD=new ue(0,1,0),XD=new ue(0,0,1),KD={type:"added"},rle={type:"removed"},vh={type:"childadded",child:null},XT={type:"childremoved",child:null};let ur=class z_ extends GS{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:tle++}),this.uuid=wu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=z_.DEFAULT_UP.clone();const e=new ue,n=new xr,r=new Yr,s=new ue(1,1,1);function o(){r.setFromEuler(n,!1)}function a(){n.setFromQuaternion(r,void 0,!1)}n._onChange(o),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ct},normalMatrix:{value:new Tu}}),this.matrix=new Ct,this.matrixWorld=new Ct,this.matrixAutoUpdate=z_.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=z_.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new ele,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return yh.setFromAxisAngle(e,n),this.quaternion.multiply(yh),this}rotateOnWorldAxis(e,n){return yh.setFromAxisAngle(e,n),this.quaternion.premultiply(yh),this}rotateX(e){return this.rotateOnAxis(jD,e)}rotateY(e){return this.rotateOnAxis(qD,e)}rotateZ(e){return this.rotateOnAxis(XD,e)}translateOnAxis(e,n){return WD.copy(e).applyQuaternion(this.quaternion),this.position.add(WD.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(jD,e)}translateY(e){return this.translateOnAxis(qD,e)}translateZ(e){return this.translateOnAxis(XD,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ll.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?$v.copy(e):$v.set(e,n,r);const s=this.parent;this.updateWorldMatrix(!0,!1),km.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ll.lookAt(km,$v,this.up):ll.lookAt($v,km,this.up),this.quaternion.setFromRotationMatrix(ll),s&&(ll.extractRotation(s.matrixWorld),yh.setFromRotationMatrix(ll),this.quaternion.premultiply(yh.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(KD),vh.child=e,this.dispatchEvent(vh),vh.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(rle),XT.child=e,this.dispatchEvent(XT),XT.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ll.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ll.multiply(e.parent.matrixWorld)),e.applyMatrix4(ll),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(KD),vh.child=e,this.dispatchEvent(vh),vh.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,r=[]){this[e]===n&&r.push(this);const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(e,n,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(km,e,nle),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(km,ile,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,s=n.length;r<s;r++){const o=n[r];(o.matrixWorldAutoUpdate===!0||e===!0)&&o.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];l.matrixWorldAutoUpdate===!0&&l.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(l,c){return l[c.uuid]===void 0&&(l[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const c=l.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++){const h=c[u];o(e.shapes,h)}else o(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(e.materials,this.material[c]));s.material=l}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++){const c=this.animations[l];s.animations.push(o(e.animations,c))}}if(n){const l=a(e.geometries),c=a(e.materials),u=a(e.textures),d=a(e.images),h=a(e.shapes),f=a(e.skeletons),p=a(e.animations),m=a(e.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),m.length>0&&(r.nodes=m)}return r.object=s,r;function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const s=e.children[r];this.add(s.clone())}return this}};ur.DEFAULT_UP=new ue(0,1,0);ur.DEFAULT_MATRIX_AUTO_UPDATE=!0;ur.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Go=new ue,cl=new ue,KT=new ue,ul=new ue,xh=new ue,_h=new ue,YD=new ue,YT=new ue,ZT=new ue,QT=new ue;let Gv=class tf{constructor(e=new ue,n=new ue,r=new ue){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,s){s.subVectors(r,n),Go.subVectors(e,n),s.cross(Go);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,n,r,s,o){Go.subVectors(s,n),cl.subVectors(r,n),KT.subVectors(e,n);const a=Go.dot(Go),l=Go.dot(cl),c=Go.dot(KT),u=cl.dot(cl),d=cl.dot(KT),h=a*u-l*l;if(h===0)return o.set(0,0,0),null;const f=1/h,p=(u*c-l*d)*f,m=(a*d-l*c)*f;return o.set(1-p-m,m,p)}static containsPoint(e,n,r,s){return this.getBarycoord(e,n,r,s,ul)===null?!1:ul.x>=0&&ul.y>=0&&ul.x+ul.y<=1}static getInterpolation(e,n,r,s,o,a,l,c){return this.getBarycoord(e,n,r,s,ul)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,ul.x),c.addScaledVector(a,ul.y),c.addScaledVector(l,ul.z),c)}static isFrontFacing(e,n,r,s){return Go.subVectors(r,n),cl.subVectors(e,n),Go.cross(cl).dot(s)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,s){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,n,r,s){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Go.subVectors(this.c,this.b),cl.subVectors(this.a,this.b),Go.cross(cl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return tf.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return tf.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,r,s,o){return tf.getInterpolation(e,this.a,this.b,this.c,n,r,s,o)}containsPoint(e){return tf.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return tf.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,s=this.b,o=this.c;let a,l;xh.subVectors(s,r),_h.subVectors(o,r),YT.subVectors(e,r);const c=xh.dot(YT),u=_h.dot(YT);if(c<=0&&u<=0)return n.copy(r);ZT.subVectors(e,s);const d=xh.dot(ZT),h=_h.dot(ZT);if(d>=0&&h<=d)return n.copy(s);const f=c*h-d*u;if(f<=0&&c>=0&&d<=0)return a=c/(c-d),n.copy(r).addScaledVector(xh,a);QT.subVectors(e,o);const p=xh.dot(QT),m=_h.dot(QT);if(m>=0&&p<=m)return n.copy(o);const y=p*u-c*m;if(y<=0&&u>=0&&m<=0)return l=u/(u-m),n.copy(r).addScaledVector(_h,l);const v=d*m-p*h;if(v<=0&&h-d>=0&&p-m>=0)return YD.subVectors(o,s),l=(h-d)/(h-d+(p-m)),n.copy(s).addScaledVector(YD,l);const g=1/(v+y+f);return a=y*g,l=f*g,n.copy(r).addScaledVector(xh,a).addScaledVector(_h,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const u$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Tc={h:0,s:0,l:0},Hv={h:0,s:0,l:0};function JT(i,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?i+(e-i)*6*n:n<1/2?e:n<2/3?i+(e-i)*6*(2/3-n):i}let gi=class{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Zr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,zo.toWorkingColorSpace(this,n),this}setRGB(e,n,r,s=zo.workingColorSpace){return this.r=e,this.g=n,this.b=r,zo.toWorkingColorSpace(this,s),this}setHSL(e,n,r,s=zo.workingColorSpace){if(e=_N(e,1),n=vr(n,0,1),r=vr(r,0,1),n===0)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;this.r=JT(a,o,e+1/3),this.g=JT(a,o,e),this.b=JT(a,o,e-1/3)}return zo.toWorkingColorSpace(this,s),this}setStyle(e,n=Zr){function r(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=s[1],l=s[2];switch(a){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,n);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,n);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=s[1],a=o.length;if(a===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(o,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Zr){const r=u$[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Bf(e.r),this.g=Bf(e.g),this.b=Bf(e.b),this}copyLinearToSRGB(e){return this.r=zT(e.r),this.g=zT(e.g),this.b=zT(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Zr){return zo.fromWorkingColorSpace(Pr.copy(this),e),Math.round(vr(Pr.r*255,0,255))*65536+Math.round(vr(Pr.g*255,0,255))*256+Math.round(vr(Pr.b*255,0,255))}getHexString(e=Zr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=zo.workingColorSpace){zo.fromWorkingColorSpace(Pr.copy(this),n);const r=Pr.r,s=Pr.g,o=Pr.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,u;const d=(l+a)/2;if(l===a)c=0,u=0;else{const h=a-l;switch(u=d<=.5?h/(a+l):h/(2-a-l),a){case r:c=(s-o)/h+(s<o?6:0);break;case s:c=(o-r)/h+2;break;case o:c=(r-s)/h+4;break}c/=6}return e.h=c,e.s=u,e.l=d,e}getRGB(e,n=zo.workingColorSpace){return zo.fromWorkingColorSpace(Pr.copy(this),n),e.r=Pr.r,e.g=Pr.g,e.b=Pr.b,e}getStyle(e=Zr){zo.fromWorkingColorSpace(Pr.copy(this),e);const n=Pr.r,r=Pr.g,s=Pr.b;return e!==Zr?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(s*255)})`}offsetHSL(e,n,r){return this.getHSL(Tc),this.setHSL(Tc.h+e,Tc.s+n,Tc.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(Tc),e.getHSL(Hv);const r=Hg(Tc.h,Hv.h,n),s=Hg(Tc.s,Hv.s,n),o=Hg(Tc.l,Hv.l,n);return this.setHSL(r,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,s=this.b,o=e.elements;return this.r=o[0]*n+o[3]*r+o[6]*s,this.g=o[1]*n+o[4]*r+o[7]*s,this.b=o[2]*n+o[5]*r+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Pr=new gi;gi.NAMES=u$;let sle=0,HS=class extends GS{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:sle++}),this.uuid=wu(),this.name="",this.type="Material",this.blending=SD,this.side=$b,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=TD,this.blendDst=ED,this.blendEquation=wD,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new gi(0,0,0),this.blendAlpha=0,this.depthFunc=MD,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=OD,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=dh,this.stencilZFail=dh,this.stencilZPass=dh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const s=this[n];if(s===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==SD&&(r.blending=this.blending),this.side!==$b&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==TD&&(r.blendSrc=this.blendSrc),this.blendDst!==ED&&(r.blendDst=this.blendDst),this.blendEquation!==wD&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==MD&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==OD&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==dh&&(r.stencilFail=this.stencilFail),this.stencilZFail!==dh&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==dh&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function s(o){const a=[];for(const l in o){const c=o[l];delete c.metadata,a.push(c)}return a}if(n){const o=s(e.textures),a=s(e.images);o.length>0&&(r.textures=o),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const s=n.length;r=new Array(s);for(let o=0;o!==s;++o)r[o]=n[o].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},RC=class extends HS{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new gi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xr,this.combine=yN,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const Pi=new ue,Wv=new vi;let Uf=class{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=FD,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=e$,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Wae("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=n.array[r+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)Wv.fromBufferAttribute(this,n),Wv.applyMatrix3(e),this.setXY(n,Wv.x,Wv.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)Pi.fromBufferAttribute(this,n),Pi.applyMatrix3(e),this.setXYZ(n,Pi.x,Pi.y,Pi.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)Pi.fromBufferAttribute(this,n),Pi.applyMatrix4(e),this.setXYZ(n,Pi.x,Pi.y,Pi.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)Pi.fromBufferAttribute(this,n),Pi.applyNormalMatrix(e),this.setXYZ(n,Pi.x,Pi.y,Pi.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)Pi.fromBufferAttribute(this,n),Pi.transformDirection(e),this.setXYZ(n,Pi.x,Pi.y,Pi.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let r=this.array[e*this.itemSize+n];return this.normalized&&(r=ef(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=Wr(r,this.array)),this.array[e*this.itemSize+n]=r,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=ef(n,this.array)),n}setX(e,n){return this.normalized&&(n=Wr(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=ef(n,this.array)),n}setY(e,n){return this.normalized&&(n=Wr(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=ef(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Wr(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=ef(n,this.array)),n}setW(e,n){return this.normalized&&(n=Wr(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Wr(n,this.array),r=Wr(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,s){return e*=this.itemSize,this.normalized&&(n=Wr(n,this.array),r=Wr(r,this.array),s=Wr(s,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=s,this}setXYZW(e,n,r,s,o){return e*=this.itemSize,this.normalized&&(n=Wr(n,this.array),r=Wr(r,this.array),s=Wr(s,this.array),o=Wr(o,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==FD&&(e.usage=this.usage),e}},d$=class extends Uf{constructor(e,n,r){super(new Uint16Array(e),n,r)}},ole=class extends Uf{constructor(e,n,r){super(new Uint32Array(e),n,r)}},Or=class extends Uf{constructor(e,n,r){super(new Float32Array(e),n,r)}},ale=0;const ho=new Ct,eE=new ur,bh=new ue,Os=new Zp,Lm=new Zp,nr=new ue;let zf=class h$ extends GS{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ale++}),this.uuid=wu(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Hae(e)?ole:d$)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const o=new Tu().getNormalMatrix(e);r.applyNormalMatrix(o),r.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ho.makeRotationFromQuaternion(e),this.applyMatrix4(ho),this}rotateX(e){return ho.makeRotationX(e),this.applyMatrix4(ho),this}rotateY(e){return ho.makeRotationY(e),this.applyMatrix4(ho),this}rotateZ(e){return ho.makeRotationZ(e),this.applyMatrix4(ho),this}translate(e,n,r){return ho.makeTranslation(e,n,r),this.applyMatrix4(ho),this}scale(e,n,r){return ho.makeScale(e,n,r),this.applyMatrix4(ho),this}lookAt(e){return eE.lookAt(e),eE.updateMatrix(),this.applyMatrix4(eE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(bh).negate(),this.translate(bh.x,bh.y,bh.z),this}setFromPoints(e){const n=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];n.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Or(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Zp);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ue(-1/0,-1/0,-1/0),new ue(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,s=n.length;r<s;r++){const o=n[r];Os.setFromBufferAttribute(o),this.morphTargetsRelative?(nr.addVectors(this.boundingBox.min,Os.min),this.boundingBox.expandByPoint(nr),nr.addVectors(this.boundingBox.max,Os.max),this.boundingBox.expandByPoint(nr)):(this.boundingBox.expandByPoint(Os.min),this.boundingBox.expandByPoint(Os.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Qp);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ue,1/0);return}if(e){const r=this.boundingSphere.center;if(Os.setFromBufferAttribute(e),n)for(let o=0,a=n.length;o<a;o++){const l=n[o];Lm.setFromBufferAttribute(l),this.morphTargetsRelative?(nr.addVectors(Os.min,Lm.min),Os.expandByPoint(nr),nr.addVectors(Os.max,Lm.max),Os.expandByPoint(nr)):(Os.expandByPoint(Lm.min),Os.expandByPoint(Lm.max))}Os.getCenter(r);let s=0;for(let o=0,a=e.count;o<a;o++)nr.fromBufferAttribute(e,o),s=Math.max(s,r.distanceToSquared(nr));if(n)for(let o=0,a=n.length;o<a;o++){const l=n[o],c=this.morphTargetsRelative;for(let u=0,d=l.count;u<d;u++)nr.fromBufferAttribute(l,u),c&&(bh.fromBufferAttribute(e,u),nr.add(bh)),s=Math.max(s,r.distanceToSquared(nr))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=n.position,s=n.normal,o=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Uf(new Float32Array(4*r.count),4));const a=this.getAttribute("tangent"),l=[],c=[];for(let E=0;E<r.count;E++)l[E]=new ue,c[E]=new ue;const u=new ue,d=new ue,h=new ue,f=new vi,p=new vi,m=new vi,y=new ue,v=new ue;function g(E,A,M){u.fromBufferAttribute(r,E),d.fromBufferAttribute(r,A),h.fromBufferAttribute(r,M),f.fromBufferAttribute(o,E),p.fromBufferAttribute(o,A),m.fromBufferAttribute(o,M),d.sub(u),h.sub(u),p.sub(f),m.sub(f);const R=1/(p.x*m.y-m.x*p.y);isFinite(R)&&(y.copy(d).multiplyScalar(m.y).addScaledVector(h,-p.y).multiplyScalar(R),v.copy(h).multiplyScalar(p.x).addScaledVector(d,-m.x).multiplyScalar(R),l[E].add(y),l[A].add(y),l[M].add(y),c[E].add(v),c[A].add(v),c[M].add(v))}let _=this.groups;_.length===0&&(_=[{start:0,count:e.count}]);for(let E=0,A=_.length;E<A;++E){const M=_[E],R=M.start,F=M.count;for(let B=R,C=R+F;B<C;B+=3)g(e.getX(B+0),e.getX(B+1),e.getX(B+2))}const x=new ue,b=new ue,S=new ue,T=new ue;function w(E){S.fromBufferAttribute(s,E),T.copy(S);const A=l[E];x.copy(A),x.sub(S.multiplyScalar(S.dot(A))).normalize(),b.crossVectors(T,A);const R=b.dot(c[E])<0?-1:1;a.setXYZW(E,x.x,x.y,x.z,R)}for(let E=0,A=_.length;E<A;++E){const M=_[E],R=M.start,F=M.count;for(let B=R,C=R+F;B<C;B+=3)w(e.getX(B+0)),w(e.getX(B+1)),w(e.getX(B+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Uf(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let f=0,p=r.count;f<p;f++)r.setXYZ(f,0,0,0);const s=new ue,o=new ue,a=new ue,l=new ue,c=new ue,u=new ue,d=new ue,h=new ue;if(e)for(let f=0,p=e.count;f<p;f+=3){const m=e.getX(f+0),y=e.getX(f+1),v=e.getX(f+2);s.fromBufferAttribute(n,m),o.fromBufferAttribute(n,y),a.fromBufferAttribute(n,v),d.subVectors(a,o),h.subVectors(s,o),d.cross(h),l.fromBufferAttribute(r,m),c.fromBufferAttribute(r,y),u.fromBufferAttribute(r,v),l.add(d),c.add(d),u.add(d),r.setXYZ(m,l.x,l.y,l.z),r.setXYZ(y,c.x,c.y,c.z),r.setXYZ(v,u.x,u.y,u.z)}else for(let f=0,p=n.count;f<p;f+=3)s.fromBufferAttribute(n,f+0),o.fromBufferAttribute(n,f+1),a.fromBufferAttribute(n,f+2),d.subVectors(a,o),h.subVectors(s,o),d.cross(h),r.setXYZ(f+0,d.x,d.y,d.z),r.setXYZ(f+1,d.x,d.y,d.z),r.setXYZ(f+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)nr.fromBufferAttribute(e,n),nr.normalize(),e.setXYZ(n,nr.x,nr.y,nr.z)}toNonIndexed(){function e(l,c){const u=l.array,d=l.itemSize,h=l.normalized,f=new u.constructor(c.length*d);let p=0,m=0;for(let y=0,v=c.length;y<v;y++){l.isInterleavedBufferAttribute?p=c[y]*l.data.stride+l.offset:p=c[y]*d;for(let g=0;g<d;g++)f[m++]=u[p++]}return new Uf(f,d,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new h$,r=this.index.array,s=this.attributes;for(const l in s){const c=s[l],u=e(c,r);n.setAttribute(l,u)}const o=this.morphAttributes;for(const l in o){const c=[],u=o[l];for(let d=0,h=u.length;d<h;d++){const f=u[d],p=e(f,r);c.push(p)}n.morphAttributes[l]=c}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,c=a.length;l<c;l++){const u=a[l];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const u in c)c[u]!==void 0&&(e[u]=c[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const c in r){const u=r[c];e.data.attributes[c]=u.toJSON(e.data)}const s={};let o=!1;for(const c in this.morphAttributes){const u=this.morphAttributes[c],d=[];for(let h=0,f=u.length;h<f;h++){const p=u[h];d.push(p.toJSON(e.data))}d.length>0&&(s[c]=d,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(n));const s=e.attributes;for(const u in s){const d=s[u];this.setAttribute(u,d.clone(n))}const o=e.morphAttributes;for(const u in o){const d=[],h=o[u];for(let f=0,p=h.length;f<p;f++)d.push(h[f].clone(n));this.morphAttributes[u]=d}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,d=a.length;u<d;u++){const h=a[u];this.addGroup(h.start,h.count,h.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const ZD=new Ct,Fu=new bN,jv=new Qp,QD=new ue,Sh=new ue,wh=new ue,Th=new ue,tE=new ue,qv=new ue,Xv=new vi,Kv=new vi,Yv=new vi,JD=new ue,eO=new ue,tO=new ue,Zv=new ue,Qv=new ue;let SN=class extends ur{constructor(e=new zf,n=new RC){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const s=n[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}getVertexPosition(e,n){const r=this.geometry,s=r.attributes.position,o=r.morphAttributes.position,a=r.morphTargetsRelative;n.fromBufferAttribute(s,e);const l=this.morphTargetInfluences;if(o&&l){qv.set(0,0,0);for(let c=0,u=o.length;c<u;c++){const d=l[c],h=o[c];d!==0&&(tE.fromBufferAttribute(h,e),a?qv.addScaledVector(tE,d):qv.addScaledVector(tE.sub(n),d))}n.add(qv)}return n}raycast(e,n){const r=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),jv.copy(r.boundingSphere),jv.applyMatrix4(o),Fu.copy(e.ray).recast(e.near),!(jv.containsPoint(Fu.origin)===!1&&(Fu.intersectSphere(jv,QD)===null||Fu.origin.distanceToSquared(QD)>(e.far-e.near)**2))&&(ZD.copy(o).invert(),Fu.copy(e.ray).applyMatrix4(ZD),!(r.boundingBox!==null&&Fu.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,Fu)))}_computeIntersections(e,n,r){let s;const o=this.geometry,a=this.material,l=o.index,c=o.attributes.position,u=o.attributes.uv,d=o.attributes.uv1,h=o.attributes.normal,f=o.groups,p=o.drawRange;if(l!==null)if(Array.isArray(a))for(let m=0,y=f.length;m<y;m++){const v=f[m],g=a[v.materialIndex],_=Math.max(v.start,p.start),x=Math.min(l.count,Math.min(v.start+v.count,p.start+p.count));for(let b=_,S=x;b<S;b+=3){const T=l.getX(b),w=l.getX(b+1),E=l.getX(b+2);s=Jv(this,g,e,r,u,d,h,T,w,E),s&&(s.faceIndex=Math.floor(b/3),s.face.materialIndex=v.materialIndex,n.push(s))}}else{const m=Math.max(0,p.start),y=Math.min(l.count,p.start+p.count);for(let v=m,g=y;v<g;v+=3){const _=l.getX(v),x=l.getX(v+1),b=l.getX(v+2);s=Jv(this,a,e,r,u,d,h,_,x,b),s&&(s.faceIndex=Math.floor(v/3),n.push(s))}}else if(c!==void 0)if(Array.isArray(a))for(let m=0,y=f.length;m<y;m++){const v=f[m],g=a[v.materialIndex],_=Math.max(v.start,p.start),x=Math.min(c.count,Math.min(v.start+v.count,p.start+p.count));for(let b=_,S=x;b<S;b+=3){const T=b,w=b+1,E=b+2;s=Jv(this,g,e,r,u,d,h,T,w,E),s&&(s.faceIndex=Math.floor(b/3),s.face.materialIndex=v.materialIndex,n.push(s))}}else{const m=Math.max(0,p.start),y=Math.min(c.count,p.start+p.count);for(let v=m,g=y;v<g;v+=3){const _=v,x=v+1,b=v+2;s=Jv(this,a,e,r,u,d,h,_,x,b),s&&(s.faceIndex=Math.floor(v/3),n.push(s))}}}};function lle(i,e,n,r,s,o,a,l){let c;if(e.side===vae?c=r.intersectTriangle(a,o,s,!0,l):c=r.intersectTriangle(s,o,a,e.side===$b,l),c===null)return null;Qv.copy(l),Qv.applyMatrix4(i.matrixWorld);const u=n.ray.origin.distanceTo(Qv);return u<n.near||u>n.far?null:{distance:u,point:Qv.clone(),object:i}}function Jv(i,e,n,r,s,o,a,l,c,u){i.getVertexPosition(l,Sh),i.getVertexPosition(c,wh),i.getVertexPosition(u,Th);const d=lle(i,e,n,r,Sh,wh,Th,Zv);if(d){s&&(Xv.fromBufferAttribute(s,l),Kv.fromBufferAttribute(s,c),Yv.fromBufferAttribute(s,u),d.uv=Gv.getInterpolation(Zv,Sh,wh,Th,Xv,Kv,Yv,new vi)),o&&(Xv.fromBufferAttribute(o,l),Kv.fromBufferAttribute(o,c),Yv.fromBufferAttribute(o,u),d.uv1=Gv.getInterpolation(Zv,Sh,wh,Th,Xv,Kv,Yv,new vi)),a&&(JD.fromBufferAttribute(a,l),eO.fromBufferAttribute(a,c),tO.fromBufferAttribute(a,u),d.normal=Gv.getInterpolation(Zv,Sh,wh,Th,JD,eO,tO,new ue),d.normal.dot(r.direction)>0&&d.normal.multiplyScalar(-1));const h={a:l,b:c,c:u,normal:new ue,materialIndex:0};Gv.getNormal(Sh,wh,Th,h.normal),d.face=h}return d}let f$=class extends ur{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ct,this.projectionMatrix=new Ct,this.projectionMatrixInverse=new Ct,this.coordinateSystem=yd}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const Ec=new ue,nO=new vi,iO=new vi;let Dy=class extends f${constructor(e=50,n=1,r=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=s,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Iy*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Gg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Iy*2*Math.atan(Math.tan(Gg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,r){Ec.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Ec.x,Ec.y).multiplyScalar(-e/Ec.z),Ec.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Ec.x,Ec.y).multiplyScalar(-e/Ec.z)}getViewSize(e,n){return this.getViewBounds(e,nO,iO),n.subVectors(iO,nO)}setViewOffset(e,n,r,s,o,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Gg*.5*this.fov)/this.zoom,r=2*n,s=this.aspect*r,o=-.5*s;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,u=a.fullHeight;o+=a.offsetX*s/c,n-=a.offsetY*r/u,s*=a.width/c,r*=a.height/u}const l=this.filmOffset;l!==0&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,n,n-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const nE=new ue,cle=new ue,ule=new Tu;let Eh=class{constructor(e=new ue(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,s){return this.normal.set(e,n,r),this.constant=s,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const s=nE.subVectors(r,n).cross(cle.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(nE),s=this.normal.dot(r);if(s===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:n.copy(e.start).addScaledVector(r,o)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||ule.getNormalMatrix(e),s=this.coplanarPoint(nE).applyMatrix4(e),o=this.normal.applyMatrix3(r).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const Bu=new Qp,ex=new ue;let dle=class{constructor(e=new Eh,n=new Eh,r=new Eh,s=new Eh,o=new Eh,a=new Eh){this.planes=[e,n,r,s,o,a]}set(e,n,r,s,o,a){const l=this.planes;return l[0].copy(e),l[1].copy(n),l[2].copy(r),l[3].copy(s),l[4].copy(o),l[5].copy(a),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=yd){const r=this.planes,s=e.elements,o=s[0],a=s[1],l=s[2],c=s[3],u=s[4],d=s[5],h=s[6],f=s[7],p=s[8],m=s[9],y=s[10],v=s[11],g=s[12],_=s[13],x=s[14],b=s[15];if(r[0].setComponents(c-o,f-u,v-p,b-g).normalize(),r[1].setComponents(c+o,f+u,v+p,b+g).normalize(),r[2].setComponents(c+a,f+d,v+m,b+_).normalize(),r[3].setComponents(c-a,f-d,v-m,b-_).normalize(),r[4].setComponents(c-l,f-h,v-y,b-x).normalize(),n===yd)r[5].setComponents(c+l,f+h,v+y,b+x).normalize();else if(n===MC)r[5].setComponents(l,h,y,x).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Bu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Bu.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Bu)}intersectsSprite(e){return Bu.center.set(0,0,0),Bu.radius=.7071067811865476,Bu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Bu)}intersectsSphere(e){const n=this.planes,r=e.center,s=-e.radius;for(let o=0;o<6;o++)if(n[o].distanceToPoint(r)<s)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const s=n[r];if(ex.x=s.normal.x>0?e.max.x:e.min.x,ex.y=s.normal.y>0?e.max.y:e.min.y,ex.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(ex)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},wN=class extends f${constructor(e=-1,n=1,r=1,s=-1,o=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=s,this.near=o,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,s,o,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=r-e,a=r+e,l=s+n,c=s-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=u*this.view.offsetX,a=o+u*this.view.width,l-=d*this.view.offsetY,c=l-d*this.view.height}this.projectionMatrix.makeOrthographic(o,a,l,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}},hle=class extends $l{constructor(e,n,r,s,o,a,l,c,u,d){if(d=d!==void 0?d:FT,d!==FT&&d!==RD)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&d===FT&&(r=wae),r===void 0&&d===RD&&(r=Tae),super(null,s,o,a,l,c,d,r,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=l!==void 0?l:Gb,this.minFilter=c!==void 0?c:Gb,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}};const fle=new hle(1,1);fle.compareFunction=Aae;let jb=class extends ur{constructor(){super(),this.isGroup=!0,this.type="Group"}},ple=class extends ur{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new xr,this.environmentIntensity=1,this.environmentRotation=new xr,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}};const rO=new ue,sO=new gs,oO=new gs,mle=new ue,aO=new Ct,tx=new ue,iE=new Qp,lO=new Ct,rE=new bN;class p$ extends SN{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AD,this.bindMatrix=new Ct,this.bindMatrixInverse=new Ct,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Zp),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let r=0;r<n.count;r++)this.getVertexPosition(r,tx),this.boundingBox.expandByPoint(tx)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Qp),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let r=0;r<n.count;r++)this.getVertexPosition(r,tx),this.boundingSphere.expandByPoint(tx)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const r=this.material,s=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),iE.copy(this.boundingSphere),iE.applyMatrix4(s),e.ray.intersectsSphere(iE)!==!1&&(lO.copy(s).invert(),rE.copy(e.ray).applyMatrix4(lO),!(this.boundingBox!==null&&rE.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,rE)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new gs,n=this.geometry.attributes.skinWeight;for(let r=0,s=n.count;r<s;r++){e.fromBufferAttribute(n,r);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),n.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===AD?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===_ae?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const r=this.skeleton,s=this.geometry;sO.fromBufferAttribute(s.attributes.skinIndex,e),oO.fromBufferAttribute(s.attributes.skinWeight,e),rO.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let o=0;o<4;o++){const a=oO.getComponent(o);if(a!==0){const l=sO.getComponent(o);aO.multiplyMatrices(r.bones[l].matrixWorld,r.boneInverses[l]),n.addScaledVector(mle.copy(rO).applyMatrix4(aO),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}class qb extends ur{constructor(){super(),this.isBone=!0,this.type="Bone"}}let m$=class extends $l{constructor(e=null,n=1,r=1,s,o,a,l,c,u=Gb,d=Gb,h,f){super(null,a,l,c,u,d,s,o,h,f),this.isDataTexture=!0,this.image={data:e,width:n,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};const cO=new Ct,gle=new Ct;class WS{constructor(e=[],n=[]){this.uuid=wu(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,s=this.bones.length;r<s;r++)this.boneInverses.push(new Ct)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const r=new Ct;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,n=this.boneInverses,r=this.boneMatrices,s=this.boneTexture;for(let o=0,a=e.length;o<a;o++){const l=e[o]?e[o].matrixWorld:gle;cO.multiplyMatrices(l,n[o]),cO.toArray(r,o*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new WS(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const r=new m$(n,e,e,t$,e$);return r.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=r,this}getBoneByName(e){for(let n=0,r=this.bones.length;n<r;n++){const s=this.bones[n];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let r=0,s=e.bones.length;r<s;r++){const o=e.bones[r];let a=n[o];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),a=new qb),this.bones.push(a),this.boneInverses.push(new Ct().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,r=this.boneInverses;for(let s=0,o=n.length;s<o;s++){const a=n[s];e.bones.push(a.uuid);const l=r[s];e.boneInverses.push(l.toArray())}return e}}let Xb=class extends HS{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new gi(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};const Kb=new ue,Yb=new ue,uO=new Ct,Im=new bN,nx=new Qp,sE=new ue,dO=new ue;let TN=class extends ur{constructor(e=new zf,n=new Xb){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[0];for(let s=1,o=n.count;s<o;s++)Kb.fromBufferAttribute(n,s-1),Yb.fromBufferAttribute(n,s),r[s]=r[s-1],r[s]+=Kb.distanceTo(Yb);e.setAttribute("lineDistance",new Or(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const r=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),nx.copy(r.boundingSphere),nx.applyMatrix4(s),nx.radius+=o,e.ray.intersectsSphere(nx)===!1)return;uO.copy(s).invert(),Im.copy(e.ray).applyMatrix4(uO);const l=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,u=this.isLineSegments?2:1,d=r.index,f=r.attributes.position;if(d!==null){const p=Math.max(0,a.start),m=Math.min(d.count,a.start+a.count);for(let y=p,v=m-1;y<v;y+=u){const g=d.getX(y),_=d.getX(y+1),x=ix(this,e,Im,c,g,_);x&&n.push(x)}if(this.isLineLoop){const y=d.getX(m-1),v=d.getX(p),g=ix(this,e,Im,c,y,v);g&&n.push(g)}}else{const p=Math.max(0,a.start),m=Math.min(f.count,a.start+a.count);for(let y=p,v=m-1;y<v;y+=u){const g=ix(this,e,Im,c,y,y+1);g&&n.push(g)}if(this.isLineLoop){const y=ix(this,e,Im,c,m-1,p);y&&n.push(y)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const s=n[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}};function ix(i,e,n,r,s,o){const a=i.geometry.attributes.position;if(Kb.fromBufferAttribute(a,s),Yb.fromBufferAttribute(a,o),n.distanceSqToSegment(Kb,Yb,sE,dO)>r)return;sE.applyMatrix4(i.matrixWorld);const c=e.ray.origin.distanceTo(sE);if(!(c<e.near||c>e.far))return{distance:c,point:dO.clone().applyMatrix4(i.matrixWorld),index:s,face:null,faceIndex:null,object:i}}const hO=new ue,fO=new ue;class yle extends TN{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[];for(let s=0,o=n.count;s<o;s+=2)hO.fromBufferAttribute(n,s),fO.fromBufferAttribute(n,s+1),r[s]=s===0?0:r[s-1],r[s+1]=r[s]+hO.distanceTo(fO);e.setAttribute("lineDistance",new Or(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}let vle=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const r=this.getUtoTmapping(e);return this.getPoint(r,n)}getPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return n}getSpacedPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPointAt(r/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let r,s=this.getPoint(0),o=0;n.push(0);for(let a=1;a<=e;a++)r=this.getPoint(a/e),o+=r.distanceTo(s),n.push(o),s=r;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const r=this.getLengths();let s=0;const o=r.length;let a;n?a=n:a=e*r[o-1];let l=0,c=o-1,u;for(;l<=c;)if(s=Math.floor(l+(c-l)/2),u=r[s]-a,u<0)l=s+1;else if(u>0)c=s-1;else{c=s;break}if(s=c,r[s]===a)return s/(o-1);const d=r[s],f=r[s+1]-d,p=(a-d)/f;return(s+p)/(o-1)}getTangent(e,n){let s=e-1e-4,o=e+1e-4;s<0&&(s=0),o>1&&(o=1);const a=this.getPoint(s),l=this.getPoint(o),c=n||(a.isVector2?new vi:new ue);return c.copy(l).sub(a).normalize(),c}getTangentAt(e,n){const r=this.getUtoTmapping(e);return this.getTangent(r,n)}computeFrenetFrames(e,n){const r=new ue,s=[],o=[],a=[],l=new ue,c=new Ct;for(let p=0;p<=e;p++){const m=p/e;s[p]=this.getTangentAt(m,new ue)}o[0]=new ue,a[0]=new ue;let u=Number.MAX_VALUE;const d=Math.abs(s[0].x),h=Math.abs(s[0].y),f=Math.abs(s[0].z);d<=u&&(u=d,r.set(1,0,0)),h<=u&&(u=h,r.set(0,1,0)),f<=u&&r.set(0,0,1),l.crossVectors(s[0],r).normalize(),o[0].crossVectors(s[0],l),a[0].crossVectors(s[0],o[0]);for(let p=1;p<=e;p++){if(o[p]=o[p-1].clone(),a[p]=a[p-1].clone(),l.crossVectors(s[p-1],s[p]),l.length()>Number.EPSILON){l.normalize();const m=Math.acos(vr(s[p-1].dot(s[p]),-1,1));o[p].applyMatrix4(c.makeRotationAxis(l,m))}a[p].crossVectors(s[p],o[p])}if(n===!0){let p=Math.acos(vr(o[0].dot(o[e]),-1,1));p/=e,s[0].dot(l.crossVectors(o[0],o[e]))>0&&(p=-p);for(let m=1;m<=e;m++)o[m].applyMatrix4(c.makeRotationAxis(s[m],p*m)),a[m].crossVectors(s[m],o[m])}return{tangents:s,normals:o,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};const xle={triangulate:function(i,e,n=2){const r=e&&e.length,s=r?e[0]*n:i.length;let o=g$(i,0,s,n,!0);const a=[];if(!o||o.next===o.prev)return a;let l,c,u,d,h,f,p;if(r&&(o=Tle(i,e,o,n)),i.length>80*n){l=u=i[0],c=d=i[1];for(let m=n;m<s;m+=n)h=i[m],f=i[m+1],h<l&&(l=h),f<c&&(c=f),h>u&&(u=h),f>d&&(d=f);p=Math.max(u-l,d-c),p=p!==0?32767/p:0}return Oy(o,a,n,l,c,p,0),a}};function g$(i,e,n,r,s){let o,a;if(s===Dle(i,e,n,r)>0)for(o=e;o<n;o+=r)a=pO(o,i[o],i[o+1],a);else for(o=n-r;o>=e;o-=r)a=pO(o,i[o],i[o+1],a);return a&&jS(a,a.next)&&(By(a),a=a.next),a}function Dd(i,e){if(!i)return i;e||(e=i);let n=i,r;do if(r=!1,!n.steiner&&(jS(n,n.next)||li(n.prev,n,n.next)===0)){if(By(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Oy(i,e,n,r,s,o,a){if(!i)return;!a&&o&&Rle(i,r,s,o);let l=i,c,u;for(;i.prev!==i.next;){if(c=i.prev,u=i.next,o?ble(i,r,s,o):_le(i)){e.push(c.i/n|0),e.push(i.i/n|0),e.push(u.i/n|0),By(i),i=u.next,l=u.next;continue}if(i=u,i===l){a?a===1?(i=Sle(Dd(i),e,n),Oy(i,e,n,r,s,o,2)):a===2&&wle(i,e,n,r,s,o):Oy(Dd(i),e,n,r,s,o,1);break}}}function _le(i){const e=i.prev,n=i,r=i.next;if(li(e,n,r)>=0)return!1;const s=e.x,o=n.x,a=r.x,l=e.y,c=n.y,u=r.y,d=s<o?s<a?s:a:o<a?o:a,h=l<c?l<u?l:u:c<u?c:u,f=s>o?s>a?s:a:o>a?o:a,p=l>c?l>u?l:u:c>u?c:u;let m=r.next;for(;m!==e;){if(m.x>=d&&m.x<=f&&m.y>=h&&m.y<=p&&gf(s,l,o,c,a,u,m.x,m.y)&&li(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function ble(i,e,n,r){const s=i.prev,o=i,a=i.next;if(li(s,o,a)>=0)return!1;const l=s.x,c=o.x,u=a.x,d=s.y,h=o.y,f=a.y,p=l<c?l<u?l:u:c<u?c:u,m=d<h?d<f?d:f:h<f?h:f,y=l>c?l>u?l:u:c>u?c:u,v=d>h?d>f?d:f:h>f?h:f,g=PC(p,m,e,n,r),_=PC(y,v,e,n,r);let x=i.prevZ,b=i.nextZ;for(;x&&x.z>=g&&b&&b.z<=_;){if(x.x>=p&&x.x<=y&&x.y>=m&&x.y<=v&&x!==s&&x!==a&&gf(l,d,c,h,u,f,x.x,x.y)&&li(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=p&&b.x<=y&&b.y>=m&&b.y<=v&&b!==s&&b!==a&&gf(l,d,c,h,u,f,b.x,b.y)&&li(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=y&&x.y>=m&&x.y<=v&&x!==s&&x!==a&&gf(l,d,c,h,u,f,x.x,x.y)&&li(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=_;){if(b.x>=p&&b.x<=y&&b.y>=m&&b.y<=v&&b!==s&&b!==a&&gf(l,d,c,h,u,f,b.x,b.y)&&li(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Sle(i,e,n){let r=i;do{const s=r.prev,o=r.next.next;!jS(s,o)&&y$(s,r,r.next,o)&&Fy(s,o)&&Fy(o,s)&&(e.push(s.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),By(r),By(r.next),r=i=o),r=r.next}while(r!==i);return Dd(r)}function wle(i,e,n,r,s,o){let a=i;do{let l=a.next.next;for(;l!==a.prev;){if(a.i!==l.i&&kle(a,l)){let c=v$(a,l);a=Dd(a,a.next),c=Dd(c,c.next),Oy(a,e,n,r,s,o,0),Oy(c,e,n,r,s,o,0);return}l=l.next}a=a.next}while(a!==i)}function Tle(i,e,n,r){const s=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;o++)l=e[o]*r,c=o<a-1?e[o+1]*r:i.length,u=g$(i,l,c,r,!1),u===u.next&&(u.steiner=!0),s.push(Nle(u));for(s.sort(Ele),o=0;o<s.length;o++)n=Mle(s[o],n);return n}function Ele(i,e){return i.x-e.x}function Mle(i,e){const n=Ale(i,e);if(!n)return e;const r=v$(n,i);return Dd(r,r.next),Dd(n,n.next)}function Ale(i,e){let n=e,r=-1/0,s;const o=i.x,a=i.y;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){const f=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(f<=o&&f>r&&(r=f,s=n.x<n.next.x?n:n.next,f===o))return s}n=n.next}while(n!==e);if(!s)return null;const l=s,c=s.x,u=s.y;let d=1/0,h;n=s;do o>=n.x&&n.x>=c&&o!==n.x&&gf(a<u?o:r,a,c,u,a<u?r:o,a,n.x,n.y)&&(h=Math.abs(a-n.y)/(o-n.x),Fy(n,i)&&(h<d||h===d&&(n.x>s.x||n.x===s.x&&Cle(s,n)))&&(s=n,d=h)),n=n.next;while(n!==l);return s}function Cle(i,e){return li(i.prev,i,e.prev)<0&&li(e.next,i,i.next)<0}function Rle(i,e,n,r){let s=i;do s.z===0&&(s.z=PC(s.x,s.y,e,n,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,Ple(s)}function Ple(i){let e,n,r,s,o,a,l,c,u=1;do{for(n=i,i=null,o=null,a=0;n;){for(a++,r=n,l=0,e=0;e<u&&(l++,r=r.nextZ,!!r);e++);for(c=u;l>0||c>0&&r;)l!==0&&(c===0||!r||n.z<=r.z)?(s=n,n=n.nextZ,l--):(s=r,r=r.nextZ,c--),o?o.nextZ=s:i=s,s.prevZ=o,o=s;n=r}o.nextZ=null,u*=2}while(a>1);return i}function PC(i,e,n,r,s){return i=(i-n)*s|0,e=(e-r)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function Nle(i){let e=i,n=i;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==i);return n}function gf(i,e,n,r,s,o,a,l){return(s-a)*(e-l)>=(i-a)*(o-l)&&(i-a)*(r-l)>=(n-a)*(e-l)&&(n-a)*(o-l)>=(s-a)*(r-l)}function kle(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!Lle(i,e)&&(Fy(i,e)&&Fy(e,i)&&Ile(i,e)&&(li(i.prev,i,e.prev)||li(i,e.prev,e))||jS(i,e)&&li(i.prev,i,i.next)>0&&li(e.prev,e,e.next)>0)}function li(i,e,n){return(e.y-i.y)*(n.x-e.x)-(e.x-i.x)*(n.y-e.y)}function jS(i,e){return i.x===e.x&&i.y===e.y}function y$(i,e,n,r){const s=sx(li(i,e,n)),o=sx(li(i,e,r)),a=sx(li(n,r,i)),l=sx(li(n,r,e));return!!(s!==o&&a!==l||s===0&&rx(i,n,e)||o===0&&rx(i,r,e)||a===0&&rx(n,i,r)||l===0&&rx(n,e,r))}function rx(i,e,n){return e.x<=Math.max(i.x,n.x)&&e.x>=Math.min(i.x,n.x)&&e.y<=Math.max(i.y,n.y)&&e.y>=Math.min(i.y,n.y)}function sx(i){return i>0?1:i<0?-1:0}function Lle(i,e){let n=i;do{if(n.i!==i.i&&n.next.i!==i.i&&n.i!==e.i&&n.next.i!==e.i&&y$(n,n.next,i,e))return!0;n=n.next}while(n!==i);return!1}function Fy(i,e){return li(i.prev,i,i.next)<0?li(i,e,i.next)>=0&&li(i,i.prev,e)>=0:li(i,e,i.prev)<0||li(i,i.next,e)<0}function Ile(i,e){let n=i,r=!1;const s=(i.x+e.x)/2,o=(i.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&s<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==i);return r}function v$(i,e){const n=new NC(i.i,i.x,i.y),r=new NC(e.i,e.x,e.y),s=i.next,o=e.prev;return i.next=e,e.prev=i,n.next=s,s.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function pO(i,e,n,r){const s=new NC(i,e,n);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function By(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function NC(i,e,n){this.i=i,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Dle(i,e,n,r){let s=0;for(let o=e,a=n-r;o<n;o+=r)s+=(i[a]-i[o])*(i[o+1]+i[a+1]),a=o;return s}class EN{static area(e){const n=e.length;let r=0;for(let s=n-1,o=0;o<n;s=o++)r+=e[s].x*e[o].y-e[o].x*e[s].y;return r*.5}static isClockWise(e){return EN.area(e)<0}static triangulateShape(e,n){const r=[],s=[],o=[];mO(e),gO(r,e);let a=e.length;n.forEach(mO);for(let c=0;c<n.length;c++)s.push(a),a+=n[c].length,gO(r,n[c]);const l=xle.triangulate(r,s);for(let c=0;c<l.length;c+=3)o.push(l.slice(c,c+3));return o}}function mO(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function gO(i,e){for(let n=0;n<e.length;n++)i.push(e[n].x),i.push(e[n].y)}let Wg=class extends HS{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new gi(16777215),this.specular=new gi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=n$,this.normalScale=new vi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xr,this.combine=yN,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},x$=class extends HS{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new gi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=n$,this.normalScale=new vi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xr,this.combine=yN,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};function ox(i,e,n){return!i||!n&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function Ole(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function Fle(i){function e(s,o){return i[s]-i[o]}const n=i.length,r=new Array(n);for(let s=0;s!==n;++s)r[s]=s;return r.sort(e),r}function yO(i,e,n){const r=i.length,s=new i.constructor(r);for(let o=0,a=0;a!==r;++o){const l=n[o]*e;for(let c=0;c!==e;++c)s[a++]=i[l+c]}return s}function _$(i,e,n,r){let s=1,o=i[0];for(;o!==void 0&&o[r]===void 0;)o=i[s++];if(o===void 0)return;let a=o[r];if(a!==void 0)if(Array.isArray(a))do a=o[r],a!==void 0&&(e.push(o.time),n.push.apply(n,a)),o=i[s++];while(o!==void 0);else if(a.toArray!==void 0)do a=o[r],a!==void 0&&(e.push(o.time),a.toArray(n,n.length)),o=i[s++];while(o!==void 0);else do a=o[r],a!==void 0&&(e.push(o.time),n.push(a)),o=i[s++];while(o!==void 0)}class qS{constructor(e,n,r,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let r=this._cachedIndex,s=n[r],o=n[r-1];e:{t:{let a;n:{i:if(!(e<s)){for(let l=r+2;;){if(s===void 0){if(e<o)break i;return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===l)break;if(o=s,s=n[++r],e<s)break t}a=n.length;break n}if(!(e>=o)){const l=n[1];e<l&&(r=2,o=l);for(let c=r-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===c)break;if(s=o,o=n[--r-1],e>=o)break t}a=r,r=0;break n}break e}for(;r<a;){const l=r+a>>>1;e<n[l]?a=l:r=l+1}if(s=n[r],o=n[r-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,o,s)}return this.interpolate_(r,o,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,r=this.sampleValues,s=this.valueSize,o=e*s;for(let a=0;a!==s;++a)n[a]=r[o+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Ble extends qS{constructor(e,n,r,s){super(e,n,r,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:PD,endingEnd:PD}}intervalChanged_(e,n,r){const s=this.parameterPositions;let o=e-2,a=e+1,l=s[o],c=s[a];if(l===void 0)switch(this.getSettings_().endingStart){case ND:o=e,l=2*n-r;break;case kD:o=s.length-2,l=n+s[o]-s[o+1];break;default:o=e,l=r}if(c===void 0)switch(this.getSettings_().endingEnd){case ND:a=e,c=2*r-n;break;case kD:a=1,c=r+s[1]-s[0];break;default:a=e-1,c=n}const u=(r-n)*.5,d=this.valueSize;this._weightPrev=u/(n-l),this._weightNext=u/(c-r),this._offsetPrev=o*d,this._offsetNext=a*d}interpolate_(e,n,r,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,c=e*l,u=c-l,d=this._offsetPrev,h=this._offsetNext,f=this._weightPrev,p=this._weightNext,m=(r-n)/(s-n),y=m*m,v=y*m,g=-f*v+2*f*y-f*m,_=(1+f)*v+(-1.5-2*f)*y+(-.5+f)*m+1,x=(-1-p)*v+(1.5+p)*y+.5*m,b=p*v-p*y;for(let S=0;S!==l;++S)o[S]=g*a[d+S]+_*a[u+S]+x*a[c+S]+b*a[h+S];return o}}class Ule extends qS{constructor(e,n,r,s){super(e,n,r,s)}interpolate_(e,n,r,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,c=e*l,u=c-l,d=(r-n)/(s-n),h=1-d;for(let f=0;f!==l;++f)o[f]=a[u+f]*h+a[c+f]*d;return o}}class zle extends qS{constructor(e,n,r,s){super(e,n,r,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Qa{constructor(e,n,r,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ox(n,this.TimeBufferType),this.values=ox(r,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let r;if(n.toJSON!==this.toJSON)r=n.toJSON(e);else{r={name:e.name,times:ox(e.times,Array),values:ox(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(r.interpolation=s)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new zle(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Ule(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Ble(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case Hb:n=this.InterpolantFactoryMethodDiscrete;break;case Wb:n=this.InterpolantFactoryMethodLinear;break;case BT:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Hb;case this.InterpolantFactoryMethodLinear:return Wb;case this.InterpolantFactoryMethodSmooth:return BT}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let r=0,s=n.length;r!==s;++r)n[r]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let r=0,s=n.length;r!==s;++r)n[r]*=e}return this}trim(e,n){const r=this.times,s=r.length;let o=0,a=s-1;for(;o!==s&&r[o]<e;)++o;for(;a!==-1&&r[a]>n;)--a;if(++a,o!==0||a!==s){o>=a&&(a=Math.max(a,1),o=a-1);const l=this.getValueSize();this.times=r.slice(o,a),this.values=this.values.slice(o*l,a*l)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,s=this.values,o=r.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let l=0;l!==o;l++){const c=r[l];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,c),e=!1;break}if(a!==null&&a>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,c,a),e=!1;break}a=c}if(s!==void 0&&Ole(s))for(let l=0,c=s.length;l!==c;++l){const u=s[l];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),r=this.getValueSize(),s=this.getInterpolation()===BT,o=e.length-1;let a=1;for(let l=1;l<o;++l){let c=!1;const u=e[l],d=e[l+1];if(u!==d&&(l!==1||u!==e[0]))if(s)c=!0;else{const h=l*r,f=h-r,p=h+r;for(let m=0;m!==r;++m){const y=n[h+m];if(y!==n[f+m]||y!==n[p+m]){c=!0;break}}}if(c){if(l!==a){e[a]=e[l];const h=l*r,f=a*r;for(let p=0;p!==r;++p)n[f+p]=n[h+p]}++a}}if(o>0){e[a]=e[o];for(let l=o*r,c=a*r,u=0;u!==r;++u)n[c+u]=n[l+u];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*r)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),r=this.constructor,s=new r(this.name,e,n);return s.createInterpolant=this.createInterpolant,s}}Qa.prototype.TimeBufferType=Float32Array;Qa.prototype.ValueBufferType=Float32Array;Qa.prototype.DefaultInterpolation=Wb;class Jp extends Qa{}Jp.prototype.ValueTypeName="bool";Jp.prototype.ValueBufferType=Array;Jp.prototype.DefaultInterpolation=Hb;Jp.prototype.InterpolantFactoryMethodLinear=void 0;Jp.prototype.InterpolantFactoryMethodSmooth=void 0;class b$ extends Qa{}b$.prototype.ValueTypeName="color";class Uy extends Qa{}Uy.prototype.ValueTypeName="number";class Vle extends qS{constructor(e,n,r,s){super(e,n,r,s)}interpolate_(e,n,r,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,c=(r-n)/(s-n);let u=e*l;for(let d=u+l;u!==d;u+=4)Yr.slerpFlat(o,0,a,u-l,a,u,c);return o}}class fu extends Qa{InterpolantFactoryMethodLinear(e){return new Vle(this.times,this.values,this.getValueSize(),e)}}fu.prototype.ValueTypeName="quaternion";fu.prototype.DefaultInterpolation=Wb;fu.prototype.InterpolantFactoryMethodSmooth=void 0;class em extends Qa{}em.prototype.ValueTypeName="string";em.prototype.ValueBufferType=Array;em.prototype.DefaultInterpolation=Hb;em.prototype.InterpolantFactoryMethodLinear=void 0;em.prototype.InterpolantFactoryMethodSmooth=void 0;class Od extends Qa{}Od.prototype.ValueTypeName="vector";class kC{constructor(e="",n=-1,r=[],s=Eae){this.name=e,this.tracks=r,this.duration=n,this.blendMode=s,this.uuid=wu(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],r=e.tracks,s=1/(e.fps||1);for(let a=0,l=r.length;a!==l;++a)n.push(Gle(r[a]).scale(s));const o=new this(e.name,e.duration,n,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const n=[],r=e.tracks,s={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,a=r.length;o!==a;++o)n.push(Qa.toJSON(r[o]));return s}static CreateFromMorphTargetSequence(e,n,r,s){const o=n.length,a=[];for(let l=0;l<o;l++){let c=[],u=[];c.push((l+o-1)%o,l,(l+1)%o),u.push(0,1,0);const d=Fle(c);c=yO(c,1,d),u=yO(u,1,d),!s&&c[0]===0&&(c.push(o),u.push(u[0])),a.push(new Uy(".morphTargetInfluences["+n[l].name+"]",c,u).scale(1/r))}return new this(e,-1,a)}static findByName(e,n){let r=e;if(!Array.isArray(e)){const s=e;r=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<r.length;s++)if(r[s].name===n)return r[s];return null}static CreateClipsFromMorphTargetSequences(e,n,r){const s={},o=/^([\w-]*?)([\d]+)$/;for(let l=0,c=e.length;l<c;l++){const u=e[l],d=u.name.match(o);if(d&&d.length>1){const h=d[1];let f=s[h];f||(s[h]=f=[]),f.push(u)}}const a=[];for(const l in s)a.push(this.CreateFromMorphTargetSequence(l,s[l],n,r));return a}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(h,f,p,m,y){if(p.length!==0){const v=[],g=[];_$(p,v,g,m),v.length!==0&&y.push(new h(f,v,g))}},s=[],o=e.name||"default",a=e.fps||30,l=e.blendMode;let c=e.length||-1;const u=e.hierarchy||[];for(let h=0;h<u.length;h++){const f=u[h].keys;if(!(!f||f.length===0))if(f[0].morphTargets){const p={};let m;for(m=0;m<f.length;m++)if(f[m].morphTargets)for(let y=0;y<f[m].morphTargets.length;y++)p[f[m].morphTargets[y]]=-1;for(const y in p){const v=[],g=[];for(let _=0;_!==f[m].morphTargets.length;++_){const x=f[m];v.push(x.time),g.push(x.morphTarget===y?1:0)}s.push(new Uy(".morphTargetInfluence["+y+"]",v,g))}c=p.length*a}else{const p=".bones["+n[h].name+"]";r(Od,p+".position",f,"pos",s),r(fu,p+".quaternion",f,"rot",s),r(Od,p+".scale",f,"scl",s)}}return s.length===0?null:new this(o,c,s,l)}resetDuration(){const e=this.tracks;let n=0;for(let r=0,s=e.length;r!==s;++r){const o=this.tracks[r];n=Math.max(n,o.times[o.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function $le(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Uy;case"vector":case"vector2":case"vector3":case"vector4":return Od;case"color":return b$;case"quaternion":return fu;case"bool":case"boolean":return Jp;case"string":return em}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function Gle(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=$le(i.type);if(i.times===void 0){const n=[],r=[];_$(i.keys,n,r,"value"),i.times=n,i.values=r}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Zb={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};let Hle=class{constructor(e,n,r){const s=this;let o=!1,a=0,l=0,c;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=r,this.itemStart=function(d){l++,o===!1&&s.onStart!==void 0&&s.onStart(d,a,l),o=!0},this.itemEnd=function(d){a++,s.onProgress!==void 0&&s.onProgress(d,a,l),a===l&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(d){s.onError!==void 0&&s.onError(d)},this.resolveURL=function(d){return c?c(d):d},this.setURLModifier=function(d){return c=d,this},this.addHandler=function(d,h){return u.push(d,h),this},this.removeHandler=function(d){const h=u.indexOf(d);return h!==-1&&u.splice(h,2),this},this.getHandler=function(d){for(let h=0,f=u.length;h<f;h+=2){const p=u[h],m=u[h+1];if(p.global&&(p.lastIndex=0),p.test(d))return m}return null}}};const Wle=new Hle;let Xa=class{constructor(e){this.manager=e!==void 0?e:Wle,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const r=this;return new Promise(function(s,o){r.load(e,s,n,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};Xa.DEFAULT_MATERIAL_NAME="__DEFAULT";const dl={};class jle extends Error{constructor(e,n){super(e),this.response=n}}class MN extends Xa{constructor(e){super(e)}load(e,n,r,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=Zb.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(o),this.manager.itemEnd(e)},0),o;if(dl[e]!==void 0){dl[e].push({onLoad:n,onProgress:r,onError:s});return}dl[e]=[],dl[e].push({onLoad:n,onProgress:r,onError:s});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,c=this.responseType;fetch(a).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const d=dl[e],h=u.body.getReader(),f=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),p=f?parseInt(f):0,m=p!==0;let y=0;const v=new ReadableStream({start(g){_();function _(){h.read().then(({done:x,value:b})=>{if(x)g.close();else{y+=b.byteLength;const S=new ProgressEvent("progress",{lengthComputable:m,loaded:y,total:p});for(let T=0,w=d.length;T<w;T++){const E=d[T];E.onProgress&&E.onProgress(S)}g.enqueue(b),_()}})}}});return new Response(v)}else throw new jle(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(c){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(d=>new DOMParser().parseFromString(d,l));case"json":return u.json();default:if(l===void 0)return u.text();{const h=/charset="?([^;"\s]*)"?/i.exec(l),f=h&&h[1]?h[1].toLowerCase():void 0,p=new TextDecoder(f);return u.arrayBuffer().then(m=>p.decode(m))}}}).then(u=>{Zb.add(e,u);const d=dl[e];delete dl[e];for(let h=0,f=d.length;h<f;h++){const p=d[h];p.onLoad&&p.onLoad(u)}}).catch(u=>{const d=dl[e];if(d===void 0)throw this.manager.itemError(e),u;delete dl[e];for(let h=0,f=d.length;h<f;h++){const p=d[h];p.onError&&p.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}let qle=class extends Xa{constructor(e){super(e)}load(e,n,r,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=Zb.get(e);if(a!==void 0)return o.manager.itemStart(e),setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a;const l=AC("img");function c(){d(),Zb.add(e,this),n&&n(this),o.manager.itemEnd(e)}function u(h){d(),s&&s(h),o.manager.itemError(e),o.manager.itemEnd(e)}function d(){l.removeEventListener("load",c,!1),l.removeEventListener("error",u,!1)}return l.addEventListener("load",c,!1),l.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}};class Xle extends Xa{constructor(e){super(e)}load(e,n,r,s){const o=this,a=new m$,l=new MN(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(o.withCredentials),l.load(e,function(c){let u;try{u=o.parse(c)}catch(d){if(s!==void 0)s(d);else{console.error(d);return}}u.image!==void 0?a.image=u.image:u.data!==void 0&&(a.image.width=u.width,a.image.height=u.height,a.image.data=u.data),a.wrapS=u.wrapS!==void 0?u.wrapS:Ba,a.wrapT=u.wrapT!==void 0?u.wrapT:Ba,a.magFilter=u.magFilter!==void 0?u.magFilter:B_,a.minFilter=u.minFilter!==void 0?u.minFilter:B_,a.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0&&(a.colorSpace=u.colorSpace),u.flipY!==void 0&&(a.flipY=u.flipY),u.format!==void 0&&(a.format=u.format),u.type!==void 0&&(a.type=u.type),u.mipmaps!==void 0&&(a.mipmaps=u.mipmaps,a.minFilter=vN),u.mipmapCount===1&&(a.minFilter=B_),u.generateMipmaps!==void 0&&(a.generateMipmaps=u.generateMipmaps),a.needsUpdate=!0,n&&n(a,u)},r,s),a}}let S$=class extends Xa{constructor(e){super(e)}load(e,n,r,s){const o=new $l,a=new qle(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(l){o.image=l,o.needsUpdate=!0,n!==void 0&&n(o)},r,s),o}},XS=class extends ur{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new gi(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}};const oE=new Ct,vO=new ue,xO=new ue;let AN=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new vi(512,512),this.map=null,this.mapPass=null,this.matrix=new Ct,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new dle,this._frameExtents=new vi(1,1),this._viewportCount=1,this._viewports=[new gs(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,r=this.matrix;vO.setFromMatrixPosition(e.matrixWorld),n.position.copy(vO),xO.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(xO),n.updateMatrixWorld(),oE.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(oE),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(oE)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},Kle=class extends AN{constructor(){super(new Dy(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,r=Iy*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=e.distance||n.far;(r!==n.fov||s!==n.aspect||o!==n.far)&&(n.fov=r,n.aspect=s,n.far=o,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},w$=class extends XS{constructor(e,n,r=0,s=Math.PI/3,o=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ur.DEFAULT_UP),this.updateMatrix(),this.target=new ur,this.distance=r,this.angle=s,this.penumbra=o,this.decay=a,this.map=null,this.shadow=new Kle}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};const _O=new Ct,Dm=new ue,aE=new ue;let Yle=class extends AN{constructor(){super(new Dy(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new vi(4,2),this._viewportCount=6,this._viewports=[new gs(2,1,1,1),new gs(0,1,1,1),new gs(3,1,1,1),new gs(1,1,1,1),new gs(3,0,1,1),new gs(1,0,1,1)],this._cubeDirections=[new ue(1,0,0),new ue(-1,0,0),new ue(0,0,1),new ue(0,0,-1),new ue(0,1,0),new ue(0,-1,0)],this._cubeUps=[new ue(0,1,0),new ue(0,1,0),new ue(0,1,0),new ue(0,1,0),new ue(0,0,1),new ue(0,0,-1)]}updateMatrices(e,n=0){const r=this.camera,s=this.matrix,o=e.distance||r.far;o!==r.far&&(r.far=o,r.updateProjectionMatrix()),Dm.setFromMatrixPosition(e.matrixWorld),r.position.copy(Dm),aE.copy(r.position),aE.add(this._cubeDirections[n]),r.up.copy(this._cubeUps[n]),r.lookAt(aE),r.updateMatrixWorld(),s.makeTranslation(-Dm.x,-Dm.y,-Dm.z),_O.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_O)}},LC=class extends XS{constructor(e,n,r=0,s=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=s,this.shadow=new Yle}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},Zle=class extends AN{constructor(){super(new wN(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},T$=class extends XS{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ur.DEFAULT_UP),this.updateMatrix(),this.target=new ur,this.shadow=new Zle}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},E$=class extends XS{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}};class M${static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}const CN="\\[\\]\\.:\\/",Qle=new RegExp("["+CN+"]","g"),RN="[^"+CN+"]",Jle="[^"+CN.replace("\\.","")+"]",ece=/((?:WC+[\/:])*)/.source.replace("WC",RN),tce=/(WCOD+)?/.source.replace("WCOD",Jle),nce=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",RN),ice=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",RN),rce=new RegExp("^"+ece+tce+nce+ice+"$"),sce=["material","materials","bones","map"];class oce{constructor(e,n,r){const s=r||vn.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,s)}getValue(e,n){this.bind();const r=this._targetGroup.nCachedObjects_,s=this._bindings[r];s!==void 0&&s.getValue(e,n)}setValue(e,n){const r=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=r.length;s!==o;++s)r[s].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].unbind()}}class vn{constructor(e,n,r){this.path=n,this.parsedPath=r||vn.parseTrackName(n),this.node=vn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,r){return e&&e.isAnimationObjectGroup?new vn.Composite(e,n,r):new vn(e,n,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Qle,"")}static parseTrackName(e){const n=rce.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const o=r.nodeName.substring(s+1);sce.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(n);if(r!==void 0)return r}if(e.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===n||l.uuid===n)return l;const c=r(l.children);if(c)return c}return null},s=r(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)e[n++]=r[s]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(e||(e=vn.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=n.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===u){u=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const a=e[s];if(a===void 0){const u=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+s+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}vn.Composite=oce;vn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};vn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};vn.prototype.GetterByBindingType=[vn.prototype._getValue_direct,vn.prototype._getValue_array,vn.prototype._getValue_arrayElement,vn.prototype._getValue_toArray];vn.prototype.SetterByBindingTypeAndVersioning=[[vn.prototype._setValue_direct,vn.prototype._setValue_direct_setNeedsUpdate,vn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[vn.prototype._setValue_array,vn.prototype._setValue_array_setNeedsUpdate,vn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[vn.prototype._setValue_arrayElement,vn.prototype._setValue_arrayElement_setNeedsUpdate,vn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[vn.prototype._setValue_fromArray,vn.prototype._setValue_fromArray_setNeedsUpdate,vn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:QV}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=QV);class bO extends Xle{constructor(e){super(e)}parse(e){function n(P){switch(P.image_type){case f:case y:if(P.colormap_length>256||P.colormap_size!==24||P.colormap_type!==1)throw new Error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case p:case m:case v:case g:if(P.colormap_type)throw new Error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case h:throw new Error("THREE.TGALoader: No data.");default:throw new Error("THREE.TGALoader: Invalid type "+P.image_type)}if(P.width<=0||P.height<=0)throw new Error("THREE.TGALoader: Invalid image size.");if(P.pixel_size!==8&&P.pixel_size!==16&&P.pixel_size!==24&&P.pixel_size!==32)throw new Error("THREE.TGALoader: Invalid pixel size "+P.pixel_size)}function r(P,W,D,X,q){let J,se;const de=D.pixel_size>>3,G=D.width*D.height*de;if(W&&(se=q.subarray(X,X+=D.colormap_length*(D.colormap_size>>3))),P){J=new Uint8Array(G);let Q,ee,ie,Se=0;const Fe=new Uint8Array(de);for(;Se<G;)if(Q=q[X++],ee=(Q&127)+1,Q&128){for(ie=0;ie<de;++ie)Fe[ie]=q[X++];for(ie=0;ie<ee;++ie)J.set(Fe,Se+ie*de);Se+=de*ee}else{for(ee*=de,ie=0;ie<ee;++ie)J[Se+ie]=q[X++];Se+=ee}}else J=q.subarray(X,X+=W?D.width*D.height:G);return{pixel_data:J,palettes:se}}function s(P,W,D,X,q,J,se,de,G){const Q=G;let ee,ie=0,Se,Fe;const Be=M.width;for(Fe=W;Fe!==X;Fe+=D)for(Se=q;Se!==se;Se+=J,ie++)ee=de[ie],P[(Se+Be*Fe)*4+3]=255,P[(Se+Be*Fe)*4+2]=Q[ee*3+0],P[(Se+Be*Fe)*4+1]=Q[ee*3+1],P[(Se+Be*Fe)*4+0]=Q[ee*3+2];return P}function o(P,W,D,X,q,J,se,de){let G,Q=0,ee,ie;const Se=M.width;for(ie=W;ie!==X;ie+=D)for(ee=q;ee!==se;ee+=J,Q+=2)G=de[Q+0]+(de[Q+1]<<8),P[(ee+Se*ie)*4+0]=(G&31744)>>7,P[(ee+Se*ie)*4+1]=(G&992)>>2,P[(ee+Se*ie)*4+2]=(G&31)<<3,P[(ee+Se*ie)*4+3]=G&32768?0:255;return P}function a(P,W,D,X,q,J,se,de){let G=0,Q,ee;const ie=M.width;for(ee=W;ee!==X;ee+=D)for(Q=q;Q!==se;Q+=J,G+=3)P[(Q+ie*ee)*4+3]=255,P[(Q+ie*ee)*4+2]=de[G+0],P[(Q+ie*ee)*4+1]=de[G+1],P[(Q+ie*ee)*4+0]=de[G+2];return P}function l(P,W,D,X,q,J,se,de){let G=0,Q,ee;const ie=M.width;for(ee=W;ee!==X;ee+=D)for(Q=q;Q!==se;Q+=J,G+=4)P[(Q+ie*ee)*4+2]=de[G+0],P[(Q+ie*ee)*4+1]=de[G+1],P[(Q+ie*ee)*4+0]=de[G+2],P[(Q+ie*ee)*4+3]=de[G+3];return P}function c(P,W,D,X,q,J,se,de){let G,Q=0,ee,ie;const Se=M.width;for(ie=W;ie!==X;ie+=D)for(ee=q;ee!==se;ee+=J,Q++)G=de[Q],P[(ee+Se*ie)*4+0]=G,P[(ee+Se*ie)*4+1]=G,P[(ee+Se*ie)*4+2]=G,P[(ee+Se*ie)*4+3]=255;return P}function u(P,W,D,X,q,J,se,de){let G=0,Q,ee;const ie=M.width;for(ee=W;ee!==X;ee+=D)for(Q=q;Q!==se;Q+=J,G+=2)P[(Q+ie*ee)*4+0]=de[G+0],P[(Q+ie*ee)*4+1]=de[G+0],P[(Q+ie*ee)*4+2]=de[G+0],P[(Q+ie*ee)*4+3]=de[G+1];return P}function d(P,W,D,X,q){let J,se,de,G,Q,ee;switch((M.flags&_)>>x){default:case T:J=0,de=1,Q=W,se=0,G=1,ee=D;break;case b:J=0,de=1,Q=W,se=D-1,G=-1,ee=-1;break;case w:J=W-1,de=-1,Q=-1,se=0,G=1,ee=D;break;case S:J=W-1,de=-1,Q=-1,se=D-1,G=-1,ee=-1;break}if(B)switch(M.pixel_size){case 8:c(P,se,G,ee,J,de,Q,X);break;case 16:u(P,se,G,ee,J,de,Q,X);break;default:throw new Error("THREE.TGALoader: Format not supported.")}else switch(M.pixel_size){case 8:s(P,se,G,ee,J,de,Q,X,q);break;case 16:o(P,se,G,ee,J,de,Q,X);break;case 24:a(P,se,G,ee,J,de,Q,X);break;case 32:l(P,se,G,ee,J,de,Q,X);break;default:throw new Error("THREE.TGALoader: Format not supported.")}return P}const h=0,f=1,p=2,m=3,y=9,v=10,g=11,_=48,x=4,b=0,S=1,T=2,w=3;if(e.length<19)throw new Error("THREE.TGALoader: Not enough data to contain header.");let E=0;const A=new Uint8Array(e),M={id_length:A[E++],colormap_type:A[E++],image_type:A[E++],colormap_index:A[E++]|A[E++]<<8,colormap_length:A[E++]|A[E++]<<8,colormap_size:A[E++],origin:[A[E++]|A[E++]<<8,A[E++]|A[E++]<<8],width:A[E++]|A[E++]<<8,height:A[E++]|A[E++]<<8,pixel_size:A[E++],flags:A[E++]};if(n(M),M.id_length+E>e.length)throw new Error("THREE.TGALoader: No data.");E+=M.id_length;let R=!1,F=!1,B=!1;switch(M.image_type){case y:R=!0,F=!0;break;case f:F=!0;break;case v:R=!0;break;case p:break;case g:R=!0,B=!0;break;case m:B=!0;break}const C=new Uint8Array(M.width*M.height*4),L=r(R,F,M,E,A);return d(C,M.width,M.height,L.pixel_data,L.palettes),{data:C,width:M.width,height:M.height,flipY:!0,generateMipmaps:!0,minFilter:vN}}}class ace extends Xa{load(e,n,r,s){const o=this,a=o.path===""?M$.extractUrlBase(e):o.path,l=new MN(o.manager);l.setPath(o.path),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(c){try{n(o.parse(c,a))}catch(u){s?s(u):console.error(u),o.manager.itemError(e)}},r,s)}parse(e,n){function r(k,N){const V=[],U=k.childNodes;for(let H=0,ge=U.length;H<ge;H++){const Ee=U[H];Ee.nodeName===N&&V.push(Ee)}return V}function s(k){if(k.length===0)return[];const N=k.trim().split(/\s+/),V=new Array(N.length);for(let U=0,H=N.length;U<H;U++)V[U]=N[U];return V}function o(k){if(k.length===0)return[];const N=k.trim().split(/\s+/),V=new Array(N.length);for(let U=0,H=N.length;U<H;U++)V[U]=parseFloat(N[U]);return V}function a(k){if(k.length===0)return[];const N=k.trim().split(/\s+/),V=new Array(N.length);for(let U=0,H=N.length;U<H;U++)V[U]=parseInt(N[U]);return V}function l(k){return k.substring(1)}function c(){return"three_default_"+nl++}function u(k){return Object.keys(k).length===0}function d(k){return{unit:h(r(k,"unit")[0]),upAxis:f(r(k,"up_axis")[0])}}function h(k){return k!==void 0&&k.hasAttribute("meter")===!0?parseFloat(k.getAttribute("meter")):1}function f(k){return k!==void 0?k.textContent:"Y_UP"}function p(k,N,V,U){const H=r(k,N)[0];if(H!==void 0){const ge=r(H,V);for(let Ee=0;Ee<ge.length;Ee++)U(ge[Ee])}}function m(k,N){for(const V in k){const U=k[V];U.build=N(k[V])}}function y(k,N){return k.build!==void 0||(k.build=N(k)),k.build}function v(k){const N={sources:{},samplers:{},channels:{}};let V=!1;for(let U=0,H=k.childNodes.length;U<H;U++){const ge=k.childNodes[U];if(ge.nodeType!==1)continue;let Ee;switch(ge.nodeName){case"source":Ee=ge.getAttribute("id"),N.sources[Ee]=me(ge);break;case"sampler":Ee=ge.getAttribute("id"),N.samplers[Ee]=g(ge);break;case"channel":Ee=ge.getAttribute("target"),N.channels[Ee]=_(ge);break;case"animation":v(ge),V=!0;break;default:console.log(ge)}}V===!1&&(Ft.animations[k.getAttribute("id")||ki.generateUUID()]=N)}function g(k){const N={inputs:{}};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"input":const ge=l(H.getAttribute("source")),Ee=H.getAttribute("semantic");N.inputs[Ee]=ge;break}}return N}function _(k){const N={};let U=k.getAttribute("target").split("/");const H=U.shift();let ge=U.shift();const Ee=ge.indexOf("(")!==-1,dt=ge.indexOf(".")!==-1;if(dt)U=ge.split("."),ge=U.shift(),N.member=U.shift();else if(Ee){const Ke=ge.split("(");ge=Ke.shift();for(let at=0;at<Ke.length;at++)Ke[at]=parseInt(Ke[at].replace(/\)/,""));N.indices=Ke}return N.id=H,N.sid=ge,N.arraySyntax=Ee,N.memberSyntax=dt,N.sampler=l(k.getAttribute("source")),N}function x(k){const N=[],V=k.channels,U=k.samplers,H=k.sources;for(const ge in V)if(V.hasOwnProperty(ge)){const Ee=V[ge],dt=U[Ee.sampler],Ke=dt.inputs.INPUT,at=dt.inputs.OUTPUT,Tt=H[Ke],Ie=H[at],bt=S(Ee,Tt,Ie);M(bt,N)}return N}function b(k){return y(Ft.animations[k],x)}function S(k,N,V){const U=Ft.nodes[k.id],H=tn(U.id),ge=U.transforms[k.sid],Ee=U.matrix.clone().transpose();let dt,Ke,at,Tt,Ie,bt;const gt={};switch(ge){case"matrix":for(at=0,Tt=N.array.length;at<Tt;at++)if(dt=N.array[at],Ke=at*V.stride,gt[dt]===void 0&&(gt[dt]={}),k.arraySyntax===!0){const ri=V.array[Ke],Mn=k.indices[0]+4*k.indices[1];gt[dt][Mn]=ri}else for(Ie=0,bt=V.stride;Ie<bt;Ie++)gt[dt][Ie]=V.array[Ke+Ie];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',ge);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',ge);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',ge);break}const kt=T(gt,Ee);return{name:H.uuid,keyframes:kt}}function T(k,N){const V=[];for(const H in k)V.push({time:parseFloat(H),value:k[H]});V.sort(U);for(let H=0;H<16;H++)R(V,H,N.elements[H]);return V;function U(H,ge){return H.time-ge.time}}const w=new ue,E=new ue,A=new Yr;function M(k,N){const V=k.keyframes,U=k.name,H=[],ge=[],Ee=[],dt=[];for(let Ke=0,at=V.length;Ke<at;Ke++){const Tt=V[Ke],Ie=Tt.time,bt=Tt.value;re.fromArray(bt).transpose(),re.decompose(w,A,E),H.push(Ie),ge.push(w.x,w.y,w.z),Ee.push(A.x,A.y,A.z,A.w),dt.push(E.x,E.y,E.z)}return ge.length>0&&N.push(new Od(U+".position",H,ge)),Ee.length>0&&N.push(new fu(U+".quaternion",H,Ee)),dt.length>0&&N.push(new Od(U+".scale",H,dt)),N}function R(k,N,V){let U,H=!0,ge,Ee;for(ge=0,Ee=k.length;ge<Ee;ge++)U=k[ge],U.value[N]===void 0?U.value[N]=null:H=!1;if(H===!0)for(ge=0,Ee=k.length;ge<Ee;ge++)U=k[ge],U.value[N]=V;else F(k,N)}function F(k,N){let V,U;for(let H=0,ge=k.length;H<ge;H++){const Ee=k[H];if(Ee.value[N]===null){if(V=B(k,H,N),U=C(k,H,N),V===null){Ee.value[N]=U.value[N];continue}if(U===null){Ee.value[N]=V.value[N];continue}L(Ee,V,U,N)}}}function B(k,N,V){for(;N>=0;){const U=k[N];if(U.value[V]!==null)return U;N--}return null}function C(k,N,V){for(;N<k.length;){const U=k[N];if(U.value[V]!==null)return U;N++}return null}function L(k,N,V,U){if(V.time-N.time===0){k.value[U]=N.value[U];return}k.value[U]=(k.time-N.time)*(V.value[U]-N.value[U])/(V.time-N.time)+N.value[U]}function P(k){const N={name:k.getAttribute("id")||"default",start:parseFloat(k.getAttribute("start")||0),end:parseFloat(k.getAttribute("end")||0),animations:[]};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"instance_animation":N.animations.push(l(H.getAttribute("url")));break}}Ft.clips[k.getAttribute("id")]=N}function W(k){const N=[],V=k.name,U=k.end-k.start||-1,H=k.animations;for(let ge=0,Ee=H.length;ge<Ee;ge++){const dt=b(H[ge]);for(let Ke=0,at=dt.length;Ke<at;Ke++)N.push(dt[Ke])}return new kC(V,U,N)}function D(k){return y(Ft.clips[k],W)}function X(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"skin":N.id=l(H.getAttribute("source")),N.skin=q(H);break;case"morph":N.id=l(H.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}Ft.controllers[k.getAttribute("id")]=N}function q(k){const N={sources:{}};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"bind_shape_matrix":N.bindShapeMatrix=o(H.textContent);break;case"source":const ge=H.getAttribute("id");N.sources[ge]=me(H);break;case"joints":N.joints=J(H);break;case"vertex_weights":N.vertexWeights=se(H);break}}return N}function J(k){const N={inputs:{}};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"input":const ge=H.getAttribute("semantic"),Ee=l(H.getAttribute("source"));N.inputs[ge]=Ee;break}}return N}function se(k){const N={inputs:{}};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"input":const ge=H.getAttribute("semantic"),Ee=l(H.getAttribute("source")),dt=parseInt(H.getAttribute("offset"));N.inputs[ge]={id:Ee,offset:dt};break;case"vcount":N.vcount=a(H.textContent);break;case"v":N.v=a(H.textContent);break}}return N}function de(k){const N={id:k.id},V=Ft.geometries[N.id];return k.skin!==void 0&&(N.skin=G(k.skin),V.sources.skinIndices=N.skin.indices,V.sources.skinWeights=N.skin.weights),N}function G(k){const V={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},U=k.sources,H=k.vertexWeights,ge=H.vcount,Ee=H.v,dt=H.inputs.JOINT.offset,Ke=H.inputs.WEIGHT.offset,at=k.sources[k.joints.inputs.JOINT],Tt=k.sources[k.joints.inputs.INV_BIND_MATRIX],Ie=U[H.inputs.WEIGHT.id].array;let bt=0,gt,kt,At;for(gt=0,At=ge.length;gt<At;gt++){const Mn=ge[gt],mn=[];for(kt=0;kt<Mn;kt++){const gn=Ee[bt+dt],il=Ee[bt+Ke],fs=Ie[il];mn.push({index:gn,weight:fs}),bt+=2}for(mn.sort(ri),kt=0;kt<4;kt++){const gn=mn[kt];gn!==void 0?(V.indices.array.push(gn.index),V.weights.array.push(gn.weight)):(V.indices.array.push(0),V.weights.array.push(0))}}for(k.bindShapeMatrix?V.bindMatrix=new Ct().fromArray(k.bindShapeMatrix).transpose():V.bindMatrix=new Ct().identity(),gt=0,At=at.array.length;gt<At;gt++){const Mn=at.array[gt],mn=new Ct().fromArray(Tt.array,gt*Tt.stride).transpose();V.joints.push({name:Mn,boneInverse:mn})}return V;function ri(Mn,mn){return mn.weight-Mn.weight}}function Q(k){return y(Ft.controllers[k],de)}function ee(k){const N={init_from:r(k,"init_from")[0].textContent};Ft.images[k.getAttribute("id")]=N}function ie(k){return k.build!==void 0?k.build:k.init_from}function Se(k){const N=Ft.images[k];return N!==void 0?y(N,ie):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",k),null)}function Fe(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"profile_COMMON":N.profile=Be(H);break}}Ft.effects[k.getAttribute("id")]=N}function Be(k){const N={surfaces:{},samplers:{}};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"newparam":ct(H,N);break;case"technique":N.technique=Z(H);break;case"extra":N.extra=et(H);break}}return N}function ct(k,N){const V=k.getAttribute("sid");for(let U=0,H=k.childNodes.length;U<H;U++){const ge=k.childNodes[U];if(ge.nodeType===1)switch(ge.nodeName){case"surface":N.surfaces[V]=xt(ge);break;case"sampler2D":N.samplers[V]=He(ge);break}}}function xt(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"init_from":N.init_from=H.textContent;break}}return N}function He(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"source":N.source=H.textContent;break}}return N}function Z(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"constant":case"lambert":case"blinn":case"phong":N.type=H.nodeName,N.parameters=Nt(H);break;case"extra":N.extra=et(H);break}}return N}function Nt(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":N[H.nodeName]=Rt(H);break;case"transparent":N[H.nodeName]={opaque:H.hasAttribute("opaque")?H.getAttribute("opaque"):"A_ONE",data:Rt(H)};break}}return N}function Rt(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"color":N[H.nodeName]=o(H.textContent);break;case"float":N[H.nodeName]=parseFloat(H.textContent);break;case"texture":N[H.nodeName]={id:H.getAttribute("texture"),extra:mt(H)};break}}return N}function mt(k){const N={technique:{}};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"extra":Je(H,N);break}}return N}function Je(k,N){for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"technique":qt(H,N);break}}}function qt(k,N){for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":N.technique[H.nodeName]=parseFloat(H.textContent);break;case"wrapU":case"wrapV":H.textContent.toUpperCase()==="TRUE"?N.technique[H.nodeName]=1:H.textContent.toUpperCase()==="FALSE"?N.technique[H.nodeName]=0:N.technique[H.nodeName]=parseInt(H.textContent);break;case"bump":N[H.nodeName]=O(H);break}}}function et(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"technique":N.technique=j(H);break}}return N}function j(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"double_sided":N[H.nodeName]=parseInt(H.textContent);break;case"bump":N[H.nodeName]=O(H);break}}return N}function O(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"texture":N[H.nodeName]={id:H.getAttribute("texture"),texcoord:H.getAttribute("texcoord"),extra:mt(H)};break}}return N}function ce(k){return k}function ye(k){return y(Ft.effects[k],ce)}function Ae(k){const N={name:k.getAttribute("name")};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"instance_effect":N.url=l(H.getAttribute("url"));break}}Ft.materials[k.getAttribute("id")]=N}function we(k){let N,V=k.slice((k.lastIndexOf(".")-1>>>0)+2);switch(V=V.toLowerCase(),V){case"tga":N=Mr;break;default:N=Gr}return N}function ot(k){const N=ye(k.url),V=N.profile.technique;let U;switch(V.type){case"phong":case"blinn":U=new Wg;break;case"lambert":U=new x$;break;default:U=new RC;break}U.name=k.name||"";function H(Ke,at=null){const Tt=N.profile.samplers[Ke.id];let Ie=null;if(Tt!==void 0){const bt=N.profile.surfaces[Tt.source];Ie=Se(bt.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),Ie=Se(Ke.id);if(Ie!==null){const bt=we(Ie);if(bt!==void 0){const gt=bt.load(Ie),kt=Ke.extra;if(kt!==void 0&&kt.technique!==void 0&&u(kt.technique)===!1){const At=kt.technique;gt.wrapS=At.wrapU?Yc:Ba,gt.wrapT=At.wrapV?Yc:Ba,gt.offset.set(At.offsetU||0,At.offsetV||0),gt.repeat.set(At.repeatU||1,At.repeatV||1)}else gt.wrapS=Yc,gt.wrapT=Yc;return at!==null&&(gt.colorSpace=at),gt}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",Ie),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",Ke.id),null}const ge=V.parameters;for(const Ke in ge){const at=ge[Ke];switch(Ke){case"diffuse":at.color&&U.color.fromArray(at.color),at.texture&&(U.map=H(at.texture,Zr));break;case"specular":at.color&&U.specular&&U.specular.fromArray(at.color),at.texture&&(U.specularMap=H(at.texture));break;case"bump":at.texture&&(U.normalMap=H(at.texture));break;case"ambient":at.texture&&(U.lightMap=H(at.texture,Zr));break;case"shininess":at.float&&U.shininess&&(U.shininess=at.float);break;case"emission":at.color&&U.emissive&&U.emissive.fromArray(at.color),at.texture&&(U.emissiveMap=H(at.texture,Zr));break}}U.color.convertSRGBToLinear(),U.specular&&U.specular.convertSRGBToLinear(),U.emissive&&U.emissive.convertSRGBToLinear();let Ee=ge.transparent,dt=ge.transparency;if(dt===void 0&&Ee&&(dt={float:1}),Ee===void 0&&dt&&(Ee={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Ee&&dt)if(Ee.data.texture)U.transparent=!0;else{const Ke=Ee.data.color;switch(Ee.opaque){case"A_ONE":U.opacity=Ke[3]*dt.float;break;case"RGB_ZERO":U.opacity=1-Ke[0]*dt.float;break;case"A_ZERO":U.opacity=1-Ke[3]*dt.float;break;case"RGB_ONE":U.opacity=Ke[0]*dt.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Ee.opaque)}U.opacity<1&&(U.transparent=!0)}if(V.extra!==void 0&&V.extra.technique!==void 0){const Ke=V.extra.technique;for(const at in Ke){const Tt=Ke[at];switch(at){case"double_sided":U.side=Tt===1?xae:$b;break;case"bump":U.normalMap=H(Tt.texture),U.normalScale=new vi(1,1);break}}}return U}function Pe(k){return y(Ft.materials[k],ot)}function Ce(k){const N={name:k.getAttribute("name")};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"optics":N.optics=vt(H);break}}Ft.cameras[k.getAttribute("id")]=N}function vt(k){for(let N=0;N<k.childNodes.length;N++){const V=k.childNodes[N];switch(V.nodeName){case"technique_common":return Ne(V)}}return{}}function Ne(k){const N={};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];switch(U.nodeName){case"perspective":case"orthographic":N.technique=U.nodeName,N.parameters=st(U);break}}return N}function st(k){const N={};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];switch(U.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":N[U.nodeName]=parseFloat(U.textContent);break}}return N}function ke(k){let N;switch(k.optics.technique){case"perspective":N=new Dy(k.optics.parameters.yfov,k.optics.parameters.aspect_ratio,k.optics.parameters.znear,k.optics.parameters.zfar);break;case"orthographic":let V=k.optics.parameters.ymag,U=k.optics.parameters.xmag;const H=k.optics.parameters.aspect_ratio;U=U===void 0?V*H:U,V=V===void 0?U/H:V,U*=.5,V*=.5,N=new wN(-U,U,V,-V,k.optics.parameters.znear,k.optics.parameters.zfar);break;default:N=new Dy;break}return N.name=k.name||"",N}function Ye(k){const N=Ft.cameras[k];return N!==void 0?y(N,ke):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",k),null)}function pe(k){let N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"technique_common":N=Ue(H);break}}Ft.lights[k.getAttribute("id")]=N}function Ue(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"directional":case"point":case"spot":case"ambient":N.technique=H.nodeName,N.parameters=tt(H)}}return N}function tt(k){const N={};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"color":const ge=o(H.textContent);N.color=new gi().fromArray(ge).convertSRGBToLinear();break;case"falloff_angle":N.falloffAngle=parseFloat(H.textContent);break;case"quadratic_attenuation":const Ee=parseFloat(H.textContent);N.distance=Ee?Math.sqrt(1/Ee):0;break}}return N}function _t(k){let N;switch(k.technique){case"directional":N=new T$;break;case"point":N=new LC;break;case"spot":N=new w$;break;case"ambient":N=new E$;break}return k.parameters.color&&N.color.copy(k.parameters.color),k.parameters.distance&&(N.distance=k.parameters.distance),N}function ne(k){const N=Ft.lights[k];return N!==void 0?y(N,_t):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",k),null)}function $e(k){const N={name:k.getAttribute("name"),sources:{},vertices:{},primitives:[]},V=r(k,"mesh")[0];if(V!==void 0){for(let U=0;U<V.childNodes.length;U++){const H=V.childNodes[U];if(H.nodeType!==1)continue;const ge=H.getAttribute("id");switch(H.nodeName){case"source":N.sources[ge]=me(H);break;case"vertices":N.vertices=Me(H);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",H.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":N.primitives.push(Xe(H));break;default:console.log(H)}}Ft.geometries[k.getAttribute("id")]=N}}function me(k){const N={array:[],stride:3};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"float_array":N.array=o(U.textContent);break;case"Name_array":N.array=s(U.textContent);break;case"technique_common":const H=r(U,"accessor")[0];H!==void 0&&(N.stride=parseInt(H.getAttribute("stride")));break}}return N}function Me(k){const N={};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];U.nodeType===1&&(N[U.getAttribute("semantic")]=l(U.getAttribute("source")))}return N}function Xe(k){const N={type:k.nodeName,material:k.getAttribute("material"),count:parseInt(k.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let V=0,U=k.childNodes.length;V<U;V++){const H=k.childNodes[V];if(H.nodeType===1)switch(H.nodeName){case"input":const ge=l(H.getAttribute("source")),Ee=H.getAttribute("semantic"),dt=parseInt(H.getAttribute("offset")),Ke=parseInt(H.getAttribute("set")),at=Ke>0?Ee+Ke:Ee;N.inputs[at]={id:ge,offset:dt},N.stride=Math.max(N.stride,dt+1),Ee==="TEXCOORD"&&(N.hasUV=!0);break;case"vcount":N.vcount=a(H.textContent);break;case"p":N.p=a(H.textContent);break}}return N}function Ze(k){const N={};for(let V=0;V<k.length;V++){const U=k[V];N[U.type]===void 0&&(N[U.type]=[]),N[U.type].push(U)}return N}function Wt(k){let N=0;for(let V=0,U=k.length;V<U;V++)k[V].hasUV===!0&&N++;N>0&&N<k.length&&(k.uvsNeedsFix=!0)}function $n(k){const N={},V=k.sources,U=k.vertices,H=k.primitives;if(H.length===0)return{};const ge=Ze(H);for(const Ee in ge){const dt=ge[Ee];Wt(dt),N[Ee]=tr(dt,V,U)}return N}function tr(k,N,V){const U={},H={array:[],stride:0},ge={array:[],stride:0},Ee={array:[],stride:0},dt={array:[],stride:0},Ke={array:[],stride:0},at={array:[],stride:4},Tt={array:[],stride:4},Ie=new zf,bt=[];let gt=0;for(let kt=0;kt<k.length;kt++){const At=k[kt],ri=At.inputs;let Mn=0;switch(At.type){case"lines":case"linestrips":Mn=At.count*2;break;case"triangles":Mn=At.count*3;break;case"polylist":for(let mn=0;mn<At.count;mn++){const gn=At.vcount[mn];switch(gn){case 3:Mn+=3;break;case 4:Mn+=6;break;default:Mn+=(gn-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",At.type)}Ie.addGroup(gt,Mn,kt),gt+=Mn,At.material&&bt.push(At.material);for(const mn in ri){const gn=ri[mn];switch(mn){case"VERTEX":for(const il in V){const fs=V[il];switch(il){case"POSITION":const th=H.array.length;if(Jt(At,N[fs],gn.offset,H.array),H.stride=N[fs].stride,N.skinWeights&&N.skinIndices&&(Jt(At,N.skinIndices,gn.offset,at.array),Jt(At,N.skinWeights,gn.offset,Tt.array)),At.hasUV===!1&&k.uvsNeedsFix===!0){const yW=(H.array.length-th)/H.stride;for(let vk=0;vk<yW;vk++)Ee.array.push(0,0)}break;case"NORMAL":Jt(At,N[fs],gn.offset,ge.array),ge.stride=N[fs].stride;break;case"COLOR":Jt(At,N[fs],gn.offset,Ke.array),Ke.stride=N[fs].stride;break;case"TEXCOORD":Jt(At,N[fs],gn.offset,Ee.array),Ee.stride=N[fs].stride;break;case"TEXCOORD1":Jt(At,N[fs],gn.offset,dt.array),Ee.stride=N[fs].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',il)}}break;case"NORMAL":Jt(At,N[gn.id],gn.offset,ge.array),ge.stride=N[gn.id].stride;break;case"COLOR":Jt(At,N[gn.id],gn.offset,Ke.array,!0),Ke.stride=N[gn.id].stride;break;case"TEXCOORD":Jt(At,N[gn.id],gn.offset,Ee.array),Ee.stride=N[gn.id].stride;break;case"TEXCOORD1":Jt(At,N[gn.id],gn.offset,dt.array),dt.stride=N[gn.id].stride;break}}}return H.array.length>0&&Ie.setAttribute("position",new Or(H.array,H.stride)),ge.array.length>0&&Ie.setAttribute("normal",new Or(ge.array,ge.stride)),Ke.array.length>0&&Ie.setAttribute("color",new Or(Ke.array,Ke.stride)),Ee.array.length>0&&Ie.setAttribute("uv",new Or(Ee.array,Ee.stride)),dt.array.length>0&&Ie.setAttribute("uv1",new Or(dt.array,dt.stride)),at.array.length>0&&Ie.setAttribute("skinIndex",new Or(at.array,at.stride)),Tt.array.length>0&&Ie.setAttribute("skinWeight",new Or(Tt.array,Tt.stride)),U.data=Ie,U.type=k[0].type,U.materialKeys=bt,U}function Jt(k,N,V,U,H=!1){const ge=k.p,Ee=k.stride,dt=k.vcount;function Ke(Ie){let bt=ge[Ie+V]*Tt;const gt=bt+Tt;for(;bt<gt;bt++)U.push(at[bt]);if(H){const kt=U.length-Tt-1;Ri.setRGB(U[kt+0],U[kt+1],U[kt+2]).convertSRGBToLinear(),U[kt+0]=Ri.r,U[kt+1]=Ri.g,U[kt+2]=Ri.b}}const at=N.array,Tt=N.stride;if(k.vcount!==void 0){let Ie=0;for(let bt=0,gt=dt.length;bt<gt;bt++){const kt=dt[bt];if(kt===4){const At=Ie+Ee*0,ri=Ie+Ee*1,Mn=Ie+Ee*2,mn=Ie+Ee*3;Ke(At),Ke(ri),Ke(mn),Ke(ri),Ke(Mn),Ke(mn)}else if(kt===3){const At=Ie+Ee*0,ri=Ie+Ee*1,Mn=Ie+Ee*2;Ke(At),Ke(ri),Ke(Mn)}else if(kt>4)for(let At=1,ri=kt-2;At<=ri;At++){const Mn=Ie+Ee*0,mn=Ie+Ee*At,gn=Ie+Ee*(At+1);Ke(Mn),Ke(mn),Ke(gn)}Ie+=Ee*kt}}else for(let Ie=0,bt=ge.length;Ie<bt;Ie+=Ee)Ke(Ie)}function ds(k){return y(Ft.geometries[k],$n)}function Bo(k){const N={name:k.getAttribute("name")||"",joints:{},links:[]};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"technique_common":tl(U,N);break}}Ft.kinematicsModels[k.getAttribute("id")]=N}function rv(k){return k.build!==void 0?k.build:k}function sv(k){return y(Ft.kinematicsModels[k],rv)}function tl(k,N){for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"joint":N.joints[U.getAttribute("sid")]=dm(U);break;case"link":N.links.push(hm(U));break}}}function dm(k){let N;for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"prismatic":case"revolute":N=ov(U);break}}return N}function ov(k){const N={sid:k.getAttribute("sid"),name:k.getAttribute("name")||"",axis:new ue,limits:{min:0,max:0},type:k.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"axis":const H=o(U.textContent);N.axis.fromArray(H);break;case"limits":const ge=U.getElementsByTagName("max")[0],Ee=U.getElementsByTagName("min")[0];N.limits.max=parseFloat(ge.textContent),N.limits.min=parseFloat(Ee.textContent);break}}return N.limits.min>=N.limits.max&&(N.static=!0),N.middlePosition=(N.limits.min+N.limits.max)/2,N}function hm(k){const N={sid:k.getAttribute("sid"),name:k.getAttribute("name")||"",attachments:[],transforms:[]};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"attachment_full":N.attachments.push(Qd(U));break;case"matrix":case"translate":case"rotate":N.transforms.push(fm(U));break}}return N}function Qd(k){const N={joint:k.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"link":N.links.push(hm(U));break;case"matrix":case"translate":case"rotate":N.transforms.push(fm(U));break}}return N}function fm(k){const N={type:k.nodeName},V=o(k.textContent);switch(N.type){case"matrix":N.obj=new Ct,N.obj.fromArray(V).transpose();break;case"translate":N.obj=new ue,N.obj.fromArray(V);break;case"rotate":N.obj=new ue,N.obj.fromArray(V),N.angle=ki.degToRad(V[3]);break}return N}function Jd(k){const N={name:k.getAttribute("name")||"",rigidBodies:{}};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"rigid_body":N.rigidBodies[U.getAttribute("name")]={},av(U,N.rigidBodies[U.getAttribute("name")]);break}}Ft.physicsModels[k.getAttribute("id")]=N}function av(k,N){for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"technique_common":lv(U,N);break}}}function lv(k,N){for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"inertia":N.inertia=o(U.textContent);break;case"mass":N.mass=o(U.textContent)[0];break}}}function Iw(k){const N={bindJointAxis:[]};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"bind_joint_axis":N.bindJointAxis.push(Dw(U));break}}Ft.kinematicsScenes[l(k.getAttribute("url"))]=N}function Dw(k){const N={target:k.getAttribute("target").split("/").pop()};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType===1)switch(U.nodeName){case"axis":const H=U.getElementsByTagName("param")[0];N.axis=H.textContent;const ge=N.axis.split("inst_").pop().split("axis")[0];N.jointIndex=ge.substring(0,ge.length-1);break}}return N}function Ow(k){return k.build!==void 0?k.build:k}function Fw(k){return y(Ft.kinematicsScenes[k],Ow)}function Bw(){const k=Object.keys(Ft.kinematicsModels)[0],N=Object.keys(Ft.kinematicsScenes)[0],V=Object.keys(Ft.visualScenes)[0];if(k===void 0||N===void 0)return;const U=sv(k),H=Fw(N),ge=un(V),Ee=H.bindJointAxis,dt={};for(let Tt=0,Ie=Ee.length;Tt<Ie;Tt++){const bt=Ee[Tt],gt=Bn.querySelector('[sid="'+bt.target+'"]');if(gt){const kt=gt.parentElement;Ke(bt.jointIndex,kt)}}function Ke(Tt,Ie){const bt=Ie.getAttribute("name"),gt=U.joints[Tt];ge.traverse(function(kt){kt.name===bt&&(dt[Tt]={object:kt,transforms:Uw(Ie),joint:gt,position:gt.zeroPosition})})}const at=new Ct;eh={joints:U&&U.joints,getJointValue:function(Tt){const Ie=dt[Tt];if(Ie)return Ie.position;console.warn("THREE.ColladaLoader: Joint "+Tt+" doesn't exist.")},setJointValue:function(Tt,Ie){const bt=dt[Tt];if(bt){const gt=bt.joint;if(Ie>gt.limits.max||Ie<gt.limits.min)console.warn("THREE.ColladaLoader: Joint "+Tt+" value "+Ie+" outside of limits (min: "+gt.limits.min+", max: "+gt.limits.max+").");else if(gt.static)console.warn("THREE.ColladaLoader: Joint "+Tt+" is static.");else{const kt=bt.object,At=gt.axis,ri=bt.transforms;re.identity();for(let Mn=0;Mn<ri.length;Mn++){const mn=ri[Mn];if(mn.sid&&mn.sid.indexOf(Tt)!==-1)switch(gt.type){case"revolute":re.multiply(at.makeRotationAxis(At,ki.degToRad(Ie)));break;case"prismatic":re.multiply(at.makeTranslation(At.x*Ie,At.y*Ie,At.z*Ie));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+gt.type);break}else switch(mn.type){case"matrix":re.multiply(mn.obj);break;case"translate":re.multiply(at.makeTranslation(mn.obj.x,mn.obj.y,mn.obj.z));break;case"scale":re.scale(mn.obj);break;case"rotate":re.multiply(at.makeRotationAxis(mn.obj,mn.angle));break}}kt.matrix.copy(re),kt.matrix.decompose(kt.position,kt.quaternion,kt.scale),dt[Tt].position=Ie}}else console.log("THREE.ColladaLoader: "+Tt+" does not exist.")}}}function Uw(k){const N=[],V=Bn.querySelector('[id="'+k.id+'"]');for(let U=0;U<V.childNodes.length;U++){const H=V.childNodes[U];if(H.nodeType!==1)continue;let ge,Ee;switch(H.nodeName){case"matrix":ge=o(H.textContent);const dt=new Ct().fromArray(ge).transpose();N.push({sid:H.getAttribute("sid"),type:H.nodeName,obj:dt});break;case"translate":case"scale":ge=o(H.textContent),Ee=new ue().fromArray(ge),N.push({sid:H.getAttribute("sid"),type:H.nodeName,obj:Ee});break;case"rotate":ge=o(H.textContent),Ee=new ue().fromArray(ge);const Ke=ki.degToRad(ge[3]);N.push({sid:H.getAttribute("sid"),type:H.nodeName,obj:Ee,angle:Ke});break}}return N}function $(k){const N=k.getElementsByTagName("node");for(let V=0;V<N.length;V++){const U=N[V];U.hasAttribute("id")===!1&&U.setAttribute("id",c())}}const re=new Ct,he=new ue;function fe(k){const N={name:k.getAttribute("name")||"",type:k.getAttribute("type"),id:k.getAttribute("id"),sid:k.getAttribute("sid"),matrix:new Ct,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];if(U.nodeType!==1)continue;let H;switch(U.nodeName){case"node":N.nodes.push(U.getAttribute("id")),fe(U);break;case"instance_camera":N.instanceCameras.push(l(U.getAttribute("url")));break;case"instance_controller":N.instanceControllers.push(le(U));break;case"instance_light":N.instanceLights.push(l(U.getAttribute("url")));break;case"instance_geometry":N.instanceGeometries.push(le(U));break;case"instance_node":N.instanceNodes.push(l(U.getAttribute("url")));break;case"matrix":H=o(U.textContent),N.matrix.multiply(re.fromArray(H).transpose()),N.transforms[U.getAttribute("sid")]=U.nodeName;break;case"translate":H=o(U.textContent),he.fromArray(H),N.matrix.multiply(re.makeTranslation(he.x,he.y,he.z)),N.transforms[U.getAttribute("sid")]=U.nodeName;break;case"rotate":H=o(U.textContent);const ge=ki.degToRad(H[3]);N.matrix.multiply(re.makeRotationAxis(he.fromArray(H),ge)),N.transforms[U.getAttribute("sid")]=U.nodeName;break;case"scale":H=o(U.textContent),N.matrix.scale(he.fromArray(H)),N.transforms[U.getAttribute("sid")]=U.nodeName;break;case"extra":break;default:console.log(U)}}return Mt(N.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",N.id):Ft.nodes[N.id]=N,N}function le(k){const N={id:l(k.getAttribute("url")),materials:{},skeletons:[]};for(let V=0;V<k.childNodes.length;V++){const U=k.childNodes[V];switch(U.nodeName){case"bind_material":const H=U.getElementsByTagName("instance_material");for(let ge=0;ge<H.length;ge++){const Ee=H[ge],dt=Ee.getAttribute("symbol"),Ke=Ee.getAttribute("target");N.materials[dt]=l(Ke)}break;case"skeleton":N.skeletons.push(l(U.textContent));break}}return N}function Ve(k,N){const V=[],U=[];let H,ge,Ee;for(H=0;H<k.length;H++){const at=k[H];let Tt;if(Mt(at))Tt=tn(at),nt(Tt,N,V);else if(Yn(at)){const bt=Ft.visualScenes[at].children;for(let gt=0;gt<bt.length;gt++){const kt=bt[gt];if(kt.type==="JOINT"){const At=tn(kt.id);nt(At,N,V)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",at)}for(H=0;H<N.length;H++)for(ge=0;ge<V.length;ge++)if(Ee=V[ge],Ee.bone.name===N[H].name){U[H]=Ee,Ee.processed=!0;break}for(H=0;H<V.length;H++)Ee=V[H],Ee.processed===!1&&(U.push(Ee),Ee.processed=!0);const dt=[],Ke=[];for(H=0;H<U.length;H++)Ee=U[H],dt.push(Ee.bone),Ke.push(Ee.boneInverse);return new WS(dt,Ke)}function nt(k,N,V){k.traverse(function(U){if(U.isBone===!0){let H;for(let ge=0;ge<N.length;ge++){const Ee=N[ge];if(Ee.name===U.name){H=Ee.boneInverse;break}}H===void 0&&(H=new Ct),V.push({bone:U,boneInverse:H,processed:!1})}})}function ut(k){const N=[],V=k.matrix,U=k.nodes,H=k.type,ge=k.instanceCameras,Ee=k.instanceControllers,dt=k.instanceLights,Ke=k.instanceGeometries,at=k.instanceNodes;for(let Ie=0,bt=U.length;Ie<bt;Ie++)N.push(tn(U[Ie]));for(let Ie=0,bt=ge.length;Ie<bt;Ie++){const gt=Ye(ge[Ie]);gt!==null&&N.push(gt.clone())}for(let Ie=0,bt=Ee.length;Ie<bt;Ie++){const gt=Ee[Ie],kt=Q(gt.id),At=ds(kt.id),ri=Ot(At,gt.materials),Mn=gt.skeletons,mn=kt.skin.joints,gn=Ve(Mn,mn);for(let il=0,fs=ri.length;il<fs;il++){const th=ri[il];th.isSkinnedMesh&&(th.bind(gn,kt.skin.bindMatrix),th.normalizeSkinWeights()),N.push(th)}}for(let Ie=0,bt=dt.length;Ie<bt;Ie++){const gt=ne(dt[Ie]);gt!==null&&N.push(gt.clone())}for(let Ie=0,bt=Ke.length;Ie<bt;Ie++){const gt=Ke[Ie],kt=ds(gt.id),At=Ot(kt,gt.materials);for(let ri=0,Mn=At.length;ri<Mn;ri++)N.push(At[ri])}for(let Ie=0,bt=at.length;Ie<bt;Ie++)N.push(tn(at[Ie]).clone());let Tt;if(U.length===0&&N.length===1)Tt=N[0];else{Tt=H==="JOINT"?new qb:new jb;for(let Ie=0;Ie<N.length;Ie++)Tt.add(N[Ie])}return Tt.name=H==="JOINT"?k.sid:k.name,Tt.matrix.copy(V),Tt.matrix.decompose(Tt.position,Tt.quaternion,Tt.scale),Tt}const pt=new RC({name:Xa.DEFAULT_MATERIAL_NAME,color:16711935});function Bt(k,N){const V=[];for(let U=0,H=k.length;U<H;U++){const ge=N[k[U]];ge===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",k[U]),V.push(pt)):V.push(Pe(ge))}return V}function Ot(k,N){const V=[];for(const U in k){const H=k[U],ge=Bt(H.materialKeys,N);if(ge.length===0&&(U==="lines"||U==="linestrips"?ge.push(new Xb):ge.push(new Wg)),U==="lines"||U==="linestrips")for(let at=0,Tt=ge.length;at<Tt;at++){const Ie=ge[at];if(Ie.isMeshPhongMaterial===!0||Ie.isMeshLambertMaterial===!0){const bt=new Xb;bt.color.copy(Ie.color),bt.opacity=Ie.opacity,bt.transparent=Ie.transparent,ge[at]=bt}}const Ee=H.data.attributes.skinIndex!==void 0,dt=ge.length===1?ge[0]:ge;let Ke;switch(U){case"lines":Ke=new yle(H.data,dt);break;case"linestrips":Ke=new TN(H.data,dt);break;case"triangles":case"polylist":Ee?Ke=new p$(H.data,dt):Ke=new SN(H.data,dt);break}V.push(Ke)}return V}function Mt(k){return Ft.nodes[k]!==void 0}function tn(k){return y(Ft.nodes[k],ut)}function fn(k){const N={name:k.getAttribute("name"),children:[]};$(k);const V=r(k,"node");for(let U=0;U<V.length;U++)N.children.push(fe(V[U]));Ft.visualScenes[k.getAttribute("id")]=N}function ii(k){const N=new jb;N.name=k.name;const V=k.children;for(let U=0;U<V.length;U++){const H=V[U];N.add(tn(H.id))}return N}function Yn(k){return Ft.visualScenes[k]!==void 0}function un(k){return y(Ft.visualScenes[k],ii)}function Pt(k){const N=r(k,"instance_visual_scene")[0];return un(l(N.getAttribute("url")))}function $i(){const k=Ft.clips;if(u(k)===!0){if(u(Ft.animations)===!1){const N=[];for(const V in Ft.animations){const U=b(V);for(let H=0,ge=U.length;H<ge;H++)N.push(U[H])}Gi.push(new kC("default",-1,N))}}else for(const N in k)Gi.push(D(N))}function pn(k){let N="";const V=[k];for(;V.length;){const U=V.shift();U.nodeType===Node.TEXT_NODE?N+=U.textContent:(N+=`
`,V.push.apply(V,U.childNodes))}return N.trim()}if(e.length===0)return{scene:new ple};const hs=new DOMParser().parseFromString(e,"application/xml"),Bn=r(hs,"COLLADA")[0],pr=hs.getElementsByTagName("parsererror")[0];if(pr!==void 0){const k=r(pr,"div")[0];let N;return k?N=k.textContent:N=pn(pr),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,N),null}const Lu=Bn.getAttribute("version");console.debug("THREE.ColladaLoader: File version",Lu);const kn=d(r(Bn,"asset")[0]),Gr=new S$(this.manager);Gr.setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);let Mr;bO&&(Mr=new bO(this.manager),Mr.setPath(this.resourcePath||n));const Ri=new gi,Gi=[];let eh={},nl=0;const Ft={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};p(Bn,"library_animations","animation",v),p(Bn,"library_animation_clips","animation_clip",P),p(Bn,"library_controllers","controller",X),p(Bn,"library_images","image",ee),p(Bn,"library_effects","effect",Fe),p(Bn,"library_materials","material",Ae),p(Bn,"library_cameras","camera",Ce),p(Bn,"library_lights","light",pe),p(Bn,"library_geometries","geometry",$e),p(Bn,"library_nodes","node",fe),p(Bn,"library_visual_scenes","visual_scene",fn),p(Bn,"library_kinematics_models","kinematics_model",Bo),p(Bn,"library_physics_models","physics_model",Jd),p(Bn,"scene","instance_kinematics_scene",Iw),m(Ft.animations,x),m(Ft.clips,W),m(Ft.controllers,de),m(Ft.images,ie),m(Ft.effects,ce),m(Ft.materials,ot),m(Ft.cameras,ke),m(Ft.lights,_t),m(Ft.geometries,$n),m(Ft.visualScenes,ii),$i(),Bw();const cv=Pt(r(Bn,"scene")[0]);return cv.animations=Gi,kn.upAxis==="Z_UP"&&(console.warn("THREE.ColladaLoader: You are loading an asset with a Z-UP coordinate system. The loader just rotates the asset to transform it into Y-UP. The vertex data are not converted, see #24289."),cv.rotation.set(-Math.PI/2,0,0)),cv.scale.multiplyScalar(kn.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),Gi},kinematics:eh,library:Ft,scene:cv}}}THREE.ColladaLoader=ace;AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var i=this,e=this.el,n=this.data,r=this.el.sceneEl.systems.renderer;n&&(this.remove(),this.loader.load(n,function(s){i.model=s.scene,i.model.traverse(function(o){if(o.isMesh){var a=o.material;a.color&&r.applyColorCorrection(a.color),a.map&&r.applyColorCorrection(a.map),a.emissive&&r.applyColorCorrection(a.emissive),a.emissiveMap&&r.applyColorCorrection(a.emissiveMap)}}),e.setObject3D("mesh",i.model),e.emit("model-loaded",{format:"collada",model:i.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}});/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var wo=Uint8Array,yf=Uint16Array,lce=Int32Array,A$=new wo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),C$=new wo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cce=new wo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),R$=function(i,e){for(var n=new yf(31),r=0;r<31;++r)n[r]=e+=1<<i[r-1];for(var s=new lce(n[30]),r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)s[o]=o-n[r]<<5|r;return{b:n,r:s}},P$=R$(A$,2),N$=P$.b,uce=P$.r;N$[28]=258,uce[258]=28;var dce=R$(C$,0),hce=dce.b,IC=new yf(32768);for(var qn=0;qn<32768;++qn){var Mc=(qn&43690)>>1|(qn&21845)<<1;Mc=(Mc&52428)>>2|(Mc&13107)<<2,Mc=(Mc&61680)>>4|(Mc&3855)<<4,IC[qn]=((Mc&65280)>>8|(Mc&255)<<8)>>1}var jg=function(i,e,n){for(var r=i.length,s=0,o=new yf(e);s<r;++s)i[s]&&++o[i[s]-1];var a=new yf(e);for(s=1;s<e;++s)a[s]=a[s-1]+o[s-1]<<1;var l;if(n){l=new yf(1<<e);var c=15-e;for(s=0;s<r;++s)if(i[s])for(var u=s<<4|i[s],d=e-i[s],h=a[i[s]-1]++<<d,f=h|(1<<d)-1;h<=f;++h)l[IC[h]>>c]=u}else for(l=new yf(r),s=0;s<r;++s)i[s]&&(l[s]=IC[a[i[s]-1]++]>>15-i[s]);return l},F0=new wo(288);for(var qn=0;qn<144;++qn)F0[qn]=8;for(var qn=144;qn<256;++qn)F0[qn]=9;for(var qn=256;qn<280;++qn)F0[qn]=7;for(var qn=280;qn<288;++qn)F0[qn]=8;var k$=new wo(32);for(var qn=0;qn<32;++qn)k$[qn]=5;var fce=jg(F0,9,1),pce=jg(k$,5,1),lE=function(i){for(var e=i[0],n=1;n<i.length;++n)i[n]>e&&(e=i[n]);return e},Ho=function(i,e,n){var r=e/8|0;return(i[r]|i[r+1]<<8)>>(e&7)&n},cE=function(i,e){var n=e/8|0;return(i[n]|i[n+1]<<8|i[n+2]<<16)>>(e&7)},mce=function(i){return(i+7)/8|0},gce=function(i,e,n){return(e==null||e<0)&&(e=0),(n==null||n>i.length)&&(n=i.length),new wo(i.subarray(e,n))},yce=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Jo=function(i,e,n){var r=new Error(e||yce[i]);if(r.code=i,Error.captureStackTrace&&Error.captureStackTrace(r,Jo),!n)throw r;return r},vce=function(i,e,n,r){var s=i.length,o=r?r.length:0;if(!s||e.f&&!e.l)return n||new wo(0);var a=!n,l=a||e.i!=2,c=e.i;a&&(n=new wo(s*3));var u=function(ct){var xt=n.length;if(ct>xt){var He=new wo(Math.max(xt*2,ct));He.set(n),n=He}},d=e.f||0,h=e.p||0,f=e.b||0,p=e.l,m=e.d,y=e.m,v=e.n,g=s*8;do{if(!p){d=Ho(i,h,1);var _=Ho(i,h+1,3);if(h+=3,_)if(_==1)p=fce,m=pce,y=9,v=5;else if(_==2){var T=Ho(i,h,31)+257,w=Ho(i,h+10,15)+4,E=T+Ho(i,h+5,31)+1;h+=14;for(var A=new wo(E),M=new wo(19),R=0;R<w;++R)M[cce[R]]=Ho(i,h+R*3,7);h+=w*3;for(var F=lE(M),B=(1<<F)-1,C=jg(M,F,1),R=0;R<E;){var L=C[Ho(i,h,B)];h+=L&15;var x=L>>4;if(x<16)A[R++]=x;else{var P=0,W=0;for(x==16?(W=3+Ho(i,h,3),h+=2,P=A[R-1]):x==17?(W=3+Ho(i,h,7),h+=3):x==18&&(W=11+Ho(i,h,127),h+=7);W--;)A[R++]=P}}var D=A.subarray(0,T),X=A.subarray(T);y=lE(D),v=lE(X),p=jg(D,y,1),m=jg(X,v,1)}else Jo(1);else{var x=mce(h)+4,b=i[x-4]|i[x-3]<<8,S=x+b;if(S>s){c&&Jo(0);break}l&&u(f+b),n.set(i.subarray(x,S),f),e.b=f+=b,e.p=h=S*8,e.f=d;continue}if(h>g){c&&Jo(0);break}}l&&u(f+131072);for(var q=(1<<y)-1,J=(1<<v)-1,se=h;;se=h){var P=p[cE(i,h)&q],de=P>>4;if(h+=P&15,h>g){c&&Jo(0);break}if(P||Jo(2),de<256)n[f++]=de;else if(de==256){se=h,p=null;break}else{var G=de-254;if(de>264){var R=de-257,Q=A$[R];G=Ho(i,h,(1<<Q)-1)+N$[R],h+=Q}var ee=m[cE(i,h)&J],ie=ee>>4;ee||Jo(3),h+=ee&15;var X=hce[ie];if(ie>3){var Q=C$[ie];X+=cE(i,h)&(1<<Q)-1,h+=Q}if(h>g){c&&Jo(0);break}l&&u(f+131072);var Se=f+G;if(f<X){var Fe=o-X,Be=Math.min(X,Se);for(Fe+f<0&&Jo(3);f<Be;++f)n[f]=r[Fe+f]}for(;f<Se;++f)n[f]=n[f-X]}}e.l=p,e.p=se,e.b=f,e.f=d,p&&(d=1,e.m=y,e.d=m,e.n=v)}while(!d);return f!=n.length&&a?gce(n,0,f):n.subarray(0,f)},xce=new wo(0),_ce=function(i,e){return((i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31)&&Jo(6,"invalid zlib data"),(i[1]>>5&1)==+!e&&Jo(6,"invalid zlib data: "+(i[1]&32?"need":"unexpected")+" dictionary"),(i[1]>>3&4)+2};function bce(i,e){return vce(i.subarray(_ce(i,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}var Sce=typeof TextDecoder<"u"&&new TextDecoder,wce=0;try{Sce.decode(xce,{stream:!0}),wce=1}catch{}function L$(i,e,n){const r=n.length-i-1;if(e>=n[r])return r-1;if(e<=n[i])return i;let s=i,o=r,a=Math.floor((s+o)/2);for(;e<n[a]||e>=n[a+1];)e<n[a]?o=a:s=a,a=Math.floor((s+o)/2);return a}function Tce(i,e,n,r){const s=[],o=[],a=[];s[0]=1;for(let l=1;l<=n;++l){o[l]=e-r[i+1-l],a[l]=r[i+l]-e;let c=0;for(let u=0;u<l;++u){const d=a[u+1],h=o[l-u],f=s[u]/(d+h);s[u]=c+d*f,c=h*f}s[l]=c}return s}function Ece(i,e,n,r){const s=L$(i,r,e),o=Tce(s,r,i,e),a=new gs(0,0,0,0);for(let l=0;l<=i;++l){const c=n[s-i+l],u=o[l],d=c.w*u;a.x+=c.x*d,a.y+=c.y*d,a.z+=c.z*d,a.w+=c.w*u}return a}function Mce(i,e,n,r,s){const o=[];for(let h=0;h<=n;++h)o[h]=0;const a=[];for(let h=0;h<=r;++h)a[h]=o.slice(0);const l=[];for(let h=0;h<=n;++h)l[h]=o.slice(0);l[0][0]=1;const c=o.slice(0),u=o.slice(0);for(let h=1;h<=n;++h){c[h]=e-s[i+1-h],u[h]=s[i+h]-e;let f=0;for(let p=0;p<h;++p){const m=u[p+1],y=c[h-p];l[h][p]=m+y;const v=l[p][h-1]/l[h][p];l[p][h]=f+m*v,f=y*v}l[h][h]=f}for(let h=0;h<=n;++h)a[0][h]=l[h][n];for(let h=0;h<=n;++h){let f=0,p=1;const m=[];for(let y=0;y<=n;++y)m[y]=o.slice(0);m[0][0]=1;for(let y=1;y<=r;++y){let v=0;const g=h-y,_=n-y;h>=y&&(m[p][0]=m[f][0]/l[_+1][g],v=m[p][0]*l[g][_]);const x=g>=-1?1:-g,b=h-1<=_?y-1:n-h;for(let T=x;T<=b;++T)m[p][T]=(m[f][T]-m[f][T-1])/l[_+1][g+T],v+=m[p][T]*l[g+T][_];h<=_&&(m[p][y]=-m[f][y-1]/l[_+1][h],v+=m[p][y]*l[h][_]),a[y][h]=v;const S=f;f=p,p=S}}let d=n;for(let h=1;h<=r;++h){for(let f=0;f<=n;++f)a[h][f]*=d;d*=n-h}return a}function Ace(i,e,n,r,s){const o=s<i?s:i,a=[],l=L$(i,r,e),c=Mce(l,r,i,o,e),u=[];for(let d=0;d<n.length;++d){const h=n[d].clone(),f=h.w;h.x*=f,h.y*=f,h.z*=f,u[d]=h}for(let d=0;d<=o;++d){const h=u[l-i].clone().multiplyScalar(c[d][0]);for(let f=1;f<=i;++f)h.add(u[l-i+f].clone().multiplyScalar(c[d][f]));a[d]=h}for(let d=o+1;d<=s+1;++d)a[d]=new gs(0,0,0);return a}function Cce(i,e){let n=1;for(let s=2;s<=i;++s)n*=s;let r=1;for(let s=2;s<=e;++s)r*=s;for(let s=2;s<=i-e;++s)r*=s;return n/r}function Rce(i){const e=i.length,n=[],r=[];for(let o=0;o<e;++o){const a=i[o];n[o]=new ue(a.x,a.y,a.z),r[o]=a.w}const s=[];for(let o=0;o<e;++o){const a=n[o].clone();for(let l=1;l<=o;++l)a.sub(s[o-l].clone().multiplyScalar(Cce(o,l)*r[l]));s[o]=a.divideScalar(r[0])}return s}function Pce(i,e,n,r,s){const o=Ace(i,e,n,r,s);return Rce(o)}class Nce extends vle{constructor(e,n,r,s,o){super(),this.degree=e,this.knots=n,this.controlPoints=[],this.startKnot=s||0,this.endKnot=o||this.knots.length-1;for(let a=0;a<r.length;++a){const l=r[a];this.controlPoints[a]=new gs(l.x,l.y,l.z,l.w)}}getPoint(e,n=new ue){const r=n,s=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),o=Ece(this.degree,this.knots,this.controlPoints,s);return o.w!==1&&o.divideScalar(o.w),r.set(o.x,o.y,o.z)}getTangent(e,n=new ue){const r=n,s=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),o=Pce(this.degree,this.knots,this.controlPoints,s,1);return r.copy(o[1]).normalize(),r}}let on,_i,jr;class kce extends Xa{constructor(e){super(e)}load(e,n,r,s){const o=this,a=o.path===""?M$.extractUrlBase(e):o.path,l=new MN(this.manager);l.setPath(o.path),l.setResponseType("arraybuffer"),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(c){try{n(o.parse(c,a))}catch(u){s?s(u):console.error(u),o.manager.itemError(e)}},r,s)}parse(e,n){if(Bce(e))on=new Fce().parse(e);else{const s=F$(e);if(!Uce(s))throw new Error("THREE.FBXLoader: Unknown format.");if(wO(s)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+wO(s));on=new Oce().parse(s)}const r=new S$(this.manager).setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);return new Lce(r,this.manager).parse(on)}}class Lce{constructor(e,n){this.textureLoader=e,this.manager=n}parse(){_i=this.parseConnections();const e=this.parseImages(),n=this.parseTextures(e),r=this.parseMaterials(n),s=this.parseDeformers(),o=new Ice().parse(s);return this.parseScene(s,o,r),jr}parseConnections(){const e=new Map;return"Connections"in on&&on.Connections.connections.forEach(function(r){const s=r[0],o=r[1],a=r[2];e.has(s)||e.set(s,{parents:[],children:[]});const l={ID:o,relationship:a};e.get(s).parents.push(l),e.has(o)||e.set(o,{parents:[],children:[]});const c={ID:s,relationship:a};e.get(o).children.push(c)}),e}parseImages(){const e={},n={};if("Video"in on.Objects){const r=on.Objects.Video;for(const s in r){const o=r[s],a=parseInt(s);if(e[a]=o.RelativeFilename||o.Filename,"Content"in o){const l=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,c=typeof o.Content=="string"&&o.Content!=="";if(l||c){const u=this.parseImage(r[s]);n[o.RelativeFilename||o.Filename]=u}}}}for(const r in e){const s=e[r];n[s]!==void 0?e[r]=n[s]:e[r]=e[r].split("\\").pop()}return e}parseImage(e){const n=e.Content,r=e.RelativeFilename||e.Filename,s=r.slice(r.lastIndexOf(".")+1).toLowerCase();let o;switch(s){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",r),o="image/tga";break;default:console.warn('FBXLoader: Image type "'+s+'" is not supported.');return}if(typeof n=="string")return"data:"+o+";base64,"+n;{const a=new Uint8Array(n);return window.URL.createObjectURL(new Blob([a],{type:o}))}}parseTextures(e){const n=new Map;if("Texture"in on.Objects){const r=on.Objects.Texture;for(const s in r){const o=this.parseTexture(r[s],e);n.set(parseInt(s),o)}}return n}parseTexture(e,n){const r=this.loadTexture(e,n);r.ID=e.id,r.name=e.attrName;const s=e.WrapModeU,o=e.WrapModeV,a=s!==void 0?s.value:0,l=o!==void 0?o.value:0;if(r.wrapS=a===0?Yc:Ba,r.wrapT=l===0?Yc:Ba,"Scaling"in e){const c=e.Scaling.value;r.repeat.x=c[0],r.repeat.y=c[1]}if("Translation"in e){const c=e.Translation.value;r.offset.x=c[0],r.offset.y=c[1]}return r}loadTexture(e,n){let r;const s=this.textureLoader.path,o=_i.get(e.id).children;o!==void 0&&o.length>0&&n[o[0].ID]!==void 0&&(r=n[o[0].ID],(r.indexOf("blob:")===0||r.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let a;const l=e.FileName.slice(-3).toLowerCase();if(l==="tga"){const c=this.manager.getHandler(".tga");c===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),a=new $l):(c.setPath(this.textureLoader.path),a=c.load(r))}else if(l==="dds"){const c=this.manager.getHandler(".dds");c===null?(console.warn("FBXLoader: DDS loader not found, creating placeholder texture for",e.RelativeFilename),a=new $l):(c.setPath(this.textureLoader.path),a=c.load(r))}else l==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),a=new $l):a=this.textureLoader.load(r);return this.textureLoader.setPath(s),a}parseMaterials(e){const n=new Map;if("Material"in on.Objects){const r=on.Objects.Material;for(const s in r){const o=this.parseMaterial(r[s],e);o!==null&&n.set(parseInt(s),o)}}return n}parseMaterial(e,n){const r=e.id,s=e.attrName;let o=e.ShadingModel;if(typeof o=="object"&&(o=o.value),!_i.has(r))return null;const a=this.parseParameters(e,n,r);let l;switch(o.toLowerCase()){case"phong":l=new Wg;break;case"lambert":l=new x$;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),l=new Wg;break}return l.setValues(a),l.name=s,l}parseParameters(e,n,r){const s={};e.BumpFactor&&(s.bumpScale=e.BumpFactor.value),e.Diffuse?s.color=new gi().fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(s.color=new gi().fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(s.displacementScale=e.DisplacementFactor.value),e.Emissive?s.emissive=new gi().fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(s.emissive=new gi().fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(s.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(s.opacity=parseFloat(e.Opacity.value)),s.opacity<1&&(s.transparent=!0),e.ReflectionFactor&&(s.reflectivity=e.ReflectionFactor.value),e.Shininess&&(s.shininess=e.Shininess.value),e.Specular?s.specular=new gi().fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&e.SpecularColor.type==="Color"&&(s.specular=new gi().fromArray(e.SpecularColor.value).convertSRGBToLinear());const o=this;return _i.get(r).children.forEach(function(a){const l=a.relationship;switch(l){case"Bump":s.bumpMap=o.getTexture(n,a.ID);break;case"Maya|TEX_ao_map":s.aoMap=o.getTexture(n,a.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":s.map=o.getTexture(n,a.ID),s.map!==void 0&&(s.map.colorSpace=Zr);break;case"DisplacementColor":s.displacementMap=o.getTexture(n,a.ID);break;case"EmissiveColor":s.emissiveMap=o.getTexture(n,a.ID),s.emissiveMap!==void 0&&(s.emissiveMap.colorSpace=Zr);break;case"NormalMap":case"Maya|TEX_normal_map":s.normalMap=o.getTexture(n,a.ID);break;case"ReflectionColor":s.envMap=o.getTexture(n,a.ID),s.envMap!==void 0&&(s.envMap.mapping=bae,s.envMap.colorSpace=Zr);break;case"SpecularColor":s.specularMap=o.getTexture(n,a.ID),s.specularMap!==void 0&&(s.specularMap.colorSpace=Zr);break;case"TransparentColor":case"TransparencyFactor":s.alphaMap=o.getTexture(n,a.ID),s.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",l);break}}),s}getTexture(e,n){return"LayeredTexture"in on.Objects&&n in on.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=_i.get(n).children[0].ID),e.get(n)}parseDeformers(){const e={},n={};if("Deformer"in on.Objects){const r=on.Objects.Deformer;for(const s in r){const o=r[s],a=_i.get(parseInt(s));if(o.attrType==="Skin"){const l=this.parseSkeleton(a,r);l.ID=s,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=a.parents[0].ID,e[s]=l}else if(o.attrType==="BlendShape"){const l={id:s};l.rawTargets=this.parseMorphTargets(a,r),l.id=s,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[s]=l}}}return{skeletons:e,morphTargets:n}}parseSkeleton(e,n){const r=[];return e.children.forEach(function(s){const o=n[s.ID];if(o.attrType!=="Cluster")return;const a={ID:s.ID,indices:[],weights:[],transformLink:new Ct().fromArray(o.TransformLink.a)};"Indexes"in o&&(a.indices=o.Indexes.a,a.weights=o.Weights.a),r.push(a)}),{rawBones:r,bones:[]}}parseMorphTargets(e,n){const r=[];for(let s=0;s<e.children.length;s++){const o=e.children[s],a=n[o.ID],l={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if(a.attrType!=="BlendShapeChannel")return;l.geoID=_i.get(parseInt(o.ID)).children.filter(function(c){return c.relationship===void 0})[0].ID,r.push(l)}return r}parseScene(e,n,r){jr=new jb;const s=this.parseModels(e.skeletons,n,r),o=on.Objects.Model,a=this;s.forEach(function(c){const u=o[c.ID];a.setLookAtProperties(c,u),_i.get(c.ID).parents.forEach(function(h){const f=s.get(h.ID);f!==void 0&&f.add(c)}),c.parent===null&&jr.add(c)}),this.bindSkeleton(e.skeletons,n,s),this.addGlobalSceneSettings(),jr.traverse(function(c){if(c.userData.transformData){c.parent&&(c.userData.transformData.parentMatrix=c.parent.matrix,c.userData.transformData.parentMatrixWorld=c.parent.matrixWorld);const u=D$(c.userData.transformData);c.applyMatrix4(u),c.updateWorldMatrix()}});const l=new Dce().parse();jr.children.length===1&&jr.children[0].isGroup&&(jr.children[0].animations=l,jr=jr.children[0]),jr.animations=l}parseModels(e,n,r){const s=new Map,o=on.Objects.Model;for(const a in o){const l=parseInt(a),c=o[a],u=_i.get(l);let d=this.buildSkeleton(u,e,l,c.attrName);if(!d){switch(c.attrType){case"Camera":d=this.createCamera(u);break;case"Light":d=this.createLight(u);break;case"Mesh":d=this.createMesh(u,n,r);break;case"NurbsCurve":d=this.createCurve(u,n);break;case"LimbNode":case"Root":d=new qb;break;case"Null":default:d=new jb;break}d.name=c.attrName?vn.sanitizeNodeName(c.attrName):"",d.userData.originalName=c.attrName,d.ID=l}this.getTransformData(d,c),s.set(l,d)}return s}buildSkeleton(e,n,r,s){let o=null;return e.parents.forEach(function(a){for(const l in n){const c=n[l];c.rawBones.forEach(function(u,d){if(u.ID===a.ID){const h=o;o=new qb,o.matrixWorld.copy(u.transformLink),o.name=s?vn.sanitizeNodeName(s):"",o.userData.originalName=s,o.ID=r,c.bones[d]=o,h!==null&&o.add(h)}})}}),o}createCamera(e){let n,r;if(e.children.forEach(function(s){const o=on.Objects.NodeAttribute[s.ID];o!==void 0&&(r=o)}),r===void 0)n=new ur;else{let s=0;r.CameraProjectionType!==void 0&&r.CameraProjectionType.value===1&&(s=1);let o=1;r.NearPlane!==void 0&&(o=r.NearPlane.value/1e3);let a=1e3;r.FarPlane!==void 0&&(a=r.FarPlane.value/1e3);let l=window.innerWidth,c=window.innerHeight;r.AspectWidth!==void 0&&r.AspectHeight!==void 0&&(l=r.AspectWidth.value,c=r.AspectHeight.value);const u=l/c;let d=45;r.FieldOfView!==void 0&&(d=r.FieldOfView.value);const h=r.FocalLength?r.FocalLength.value:null;switch(s){case 0:n=new Dy(d,u,o,a),h!==null&&n.setFocalLength(h);break;case 1:n=new wN(-l/2,l/2,c/2,-c/2,o,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+s+"."),n=new ur;break}}return n}createLight(e){let n,r;if(e.children.forEach(function(s){const o=on.Objects.NodeAttribute[s.ID];o!==void 0&&(r=o)}),r===void 0)n=new ur;else{let s;r.LightType===void 0?s=0:s=r.LightType.value;let o=16777215;r.Color!==void 0&&(o=new gi().fromArray(r.Color.value).convertSRGBToLinear());let a=r.Intensity===void 0?1:r.Intensity.value/100;r.CastLightOnObject!==void 0&&r.CastLightOnObject.value===0&&(a=0);let l=0;r.FarAttenuationEnd!==void 0&&(r.EnableFarAttenuation!==void 0&&r.EnableFarAttenuation.value===0?l=0:l=r.FarAttenuationEnd.value);const c=1;switch(s){case 0:n=new LC(o,a,l,c);break;case 1:n=new T$(o,a);break;case 2:let u=Math.PI/3;r.InnerAngle!==void 0&&(u=ki.degToRad(r.InnerAngle.value));let d=0;r.OuterAngle!==void 0&&(d=ki.degToRad(r.OuterAngle.value),d=Math.max(d,1)),n=new w$(o,a,l,u,d,c);break;default:console.warn("THREE.FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a PointLight."),n=new LC(o,a);break}r.CastShadows!==void 0&&r.CastShadows.value===1&&(n.castShadow=!0)}return n}createMesh(e,n,r){let s,o=null,a=null;const l=[];return e.children.forEach(function(c){n.has(c.ID)&&(o=n.get(c.ID)),r.has(c.ID)&&l.push(r.get(c.ID))}),l.length>1?a=l:l.length>0?a=l[0]:(a=new Wg({name:Xa.DEFAULT_MATERIAL_NAME,color:13421772}),l.push(a)),"color"in o.attributes&&l.forEach(function(c){c.vertexColors=!0}),o.FBX_Deformer?(s=new p$(o,a),s.normalizeSkinWeights()):s=new SN(o,a),s}createCurve(e,n){const r=e.children.reduce(function(o,a){return n.has(a.ID)&&(o=n.get(a.ID)),o},null),s=new Xb({name:Xa.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new TN(r,s)}getTransformData(e,n){const r={};"InheritType"in n&&(r.inheritType=parseInt(n.InheritType.value)),"RotationOrder"in n?r.eulerOrder=O$(n.RotationOrder.value):r.eulerOrder="ZYX","Lcl_Translation"in n&&(r.translation=n.Lcl_Translation.value),"PreRotation"in n&&(r.preRotation=n.PreRotation.value),"Lcl_Rotation"in n&&(r.rotation=n.Lcl_Rotation.value),"PostRotation"in n&&(r.postRotation=n.PostRotation.value),"Lcl_Scaling"in n&&(r.scale=n.Lcl_Scaling.value),"ScalingOffset"in n&&(r.scalingOffset=n.ScalingOffset.value),"ScalingPivot"in n&&(r.scalingPivot=n.ScalingPivot.value),"RotationOffset"in n&&(r.rotationOffset=n.RotationOffset.value),"RotationPivot"in n&&(r.rotationPivot=n.RotationPivot.value),e.userData.transformData=r}setLookAtProperties(e,n){"LookAtProperty"in n&&_i.get(e.ID).children.forEach(function(s){if(s.relationship==="LookAtProperty"){const o=on.Objects.Model[s.ID];if("Lcl_Translation"in o){const a=o.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(a),jr.add(e.target)):e.lookAt(new ue().fromArray(a))}}})}bindSkeleton(e,n,r){const s=this.parsePoseNodes();for(const o in e){const a=e[o];_i.get(parseInt(a.ID)).parents.forEach(function(c){if(n.has(c.ID)){const u=c.ID;_i.get(u).parents.forEach(function(h){r.has(h.ID)&&r.get(h.ID).bind(new WS(a.bones),s[h.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in on.Objects){const n=on.Objects.Pose;for(const r in n)if(n[r].attrType==="BindPose"&&n[r].NbPoseNodes>0){const s=n[r].PoseNode;Array.isArray(s)?s.forEach(function(o){e[o.Node]=new Ct().fromArray(o.Matrix.a)}):e[s.Node]=new Ct().fromArray(s.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in on){if("AmbientColor"in on.GlobalSettings){const e=on.GlobalSettings.AmbientColor.value,n=e[0],r=e[1],s=e[2];if(n!==0||r!==0||s!==0){const o=new gi(n,r,s).convertSRGBToLinear();jr.add(new E$(o,1))}}"UnitScaleFactor"in on.GlobalSettings&&(jr.userData.unitScaleFactor=on.GlobalSettings.UnitScaleFactor.value)}}}class Ice{constructor(){this.negativeMaterialIndices=!1}parse(e){const n=new Map;if("Geometry"in on.Objects){const r=on.Objects.Geometry;for(const s in r){const o=_i.get(parseInt(s)),a=this.parseGeometry(o,r[s],e);n.set(parseInt(s),a)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),n}parseGeometry(e,n,r){switch(n.attrType){case"Mesh":return this.parseMeshGeometry(e,n,r);case"NurbsCurve":return this.parseNurbsGeometry(n)}}parseMeshGeometry(e,n,r){const s=r.skeletons,o=[],a=e.parents.map(function(h){return on.Objects.Model[h.ID]});if(a.length===0)return;const l=e.children.reduce(function(h,f){return s[f.ID]!==void 0&&(h=s[f.ID]),h},null);e.children.forEach(function(h){r.morphTargets[h.ID]!==void 0&&o.push(r.morphTargets[h.ID])});const c=a[0],u={};"RotationOrder"in c&&(u.eulerOrder=O$(c.RotationOrder.value)),"InheritType"in c&&(u.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(u.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(u.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(u.scale=c.GeometricScaling.value);const d=D$(u);return this.genGeometry(n,l,o,d)}genGeometry(e,n,r,s){const o=new zf;e.attrName&&(o.name=e.attrName);const a=this.parseGeoNode(e,n),l=this.genBuffers(a),c=new Or(l.vertex,3);if(c.applyMatrix4(s),o.setAttribute("position",c),l.colors.length>0&&o.setAttribute("color",new Or(l.colors,3)),n&&(o.setAttribute("skinIndex",new d$(l.weightsIndices,4)),o.setAttribute("skinWeight",new Or(l.vertexWeights,4)),o.FBX_Deformer=n),l.normal.length>0){const u=new Tu().getNormalMatrix(s),d=new Or(l.normal,3);d.applyNormalMatrix(u),o.setAttribute("normal",d)}if(l.uvs.forEach(function(u,d){const h=d===0?"uv":`uv${d}`;o.setAttribute(h,new Or(l.uvs[d],2))}),a.material&&a.material.mappingType!=="AllSame"){let u=l.materialIndex[0],d=0;if(l.materialIndex.forEach(function(h,f){h!==u&&(o.addGroup(d,f-d,u),u=h,d=f)}),o.groups.length>0){const h=o.groups[o.groups.length-1],f=h.start+h.count;f!==l.materialIndex.length&&o.addGroup(f,l.materialIndex.length-f,u)}o.groups.length===0&&o.addGroup(0,l.materialIndex.length,l.materialIndex[0])}return this.addMorphTargets(o,e,r,s),o}parseGeoNode(e,n){const r={};if(r.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],r.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];let s=0;for(;e.LayerElementUV[s];)e.LayerElementUV[s].UV&&r.uv.push(this.parseUVs(e.LayerElementUV[s])),s++}return r.weightTable={},n!==null&&(r.skeleton=n,n.rawBones.forEach(function(s,o){s.indices.forEach(function(a,l){r.weightTable[a]===void 0&&(r.weightTable[a]=[]),r.weightTable[a].push({id:o,weight:s.weights[l]})})})),r}genBuffers(e){const n={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let r=0,s=0,o=!1,a=[],l=[],c=[],u=[],d=[],h=[];const f=this;return e.vertexIndices.forEach(function(p,m){let y,v=!1;p<0&&(p=p^-1,v=!0);let g=[],_=[];if(a.push(p*3,p*3+1,p*3+2),e.color){const x=ax(m,r,p,e.color);c.push(x[0],x[1],x[2])}if(e.skeleton){if(e.weightTable[p]!==void 0&&e.weightTable[p].forEach(function(x){_.push(x.weight),g.push(x.id)}),_.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const x=[0,0,0,0],b=[0,0,0,0];_.forEach(function(S,T){let w=S,E=g[T];b.forEach(function(A,M,R){if(w>A){R[M]=w,w=A;const F=x[M];x[M]=E,E=F}})}),g=x,_=b}for(;_.length<4;)_.push(0),g.push(0);for(let x=0;x<4;++x)d.push(_[x]),h.push(g[x])}if(e.normal){const x=ax(m,r,p,e.normal);l.push(x[0],x[1],x[2])}e.material&&e.material.mappingType!=="AllSame"&&(y=ax(m,r,p,e.material)[0],y<0&&(f.negativeMaterialIndices=!0,y=0)),e.uv&&e.uv.forEach(function(x,b){const S=ax(m,r,p,x);u[b]===void 0&&(u[b]=[]),u[b].push(S[0]),u[b].push(S[1])}),s++,v&&(f.genFace(n,e,a,y,l,c,u,d,h,s),r++,s=0,a=[],l=[],c=[],u=[],d=[],h=[])}),n}getNormalNewell(e){const n=new ue(0,0,0);for(let r=0;r<e.length;r++){const s=e[r],o=e[(r+1)%e.length];n.x+=(s.y-o.y)*(s.z+o.z),n.y+=(s.z-o.z)*(s.x+o.x),n.z+=(s.x-o.x)*(s.y+o.y)}return n.normalize(),n}getNormalTangentAndBitangent(e){const n=this.getNormalNewell(e),s=(Math.abs(n.z)>.5?new ue(0,1,0):new ue(0,0,1)).cross(n).normalize(),o=n.clone().cross(s).normalize();return{normal:n,tangent:s,bitangent:o}}flattenVertex(e,n,r){return new vi(e.dot(n),e.dot(r))}genFace(e,n,r,s,o,a,l,c,u,d){let h;if(d>3){const f=[];for(let v=0;v<r.length;v+=3)f.push(new ue(n.vertexPositions[r[v]],n.vertexPositions[r[v+1]],n.vertexPositions[r[v+2]]));const{tangent:p,bitangent:m}=this.getNormalTangentAndBitangent(f),y=[];for(const v of f)y.push(this.flattenVertex(v,p,m));h=EN.triangulateShape(y,[])}else h=[[0,1,2]];for(const[f,p,m]of h)e.vertex.push(n.vertexPositions[r[f*3]]),e.vertex.push(n.vertexPositions[r[f*3+1]]),e.vertex.push(n.vertexPositions[r[f*3+2]]),e.vertex.push(n.vertexPositions[r[p*3]]),e.vertex.push(n.vertexPositions[r[p*3+1]]),e.vertex.push(n.vertexPositions[r[p*3+2]]),e.vertex.push(n.vertexPositions[r[m*3]]),e.vertex.push(n.vertexPositions[r[m*3+1]]),e.vertex.push(n.vertexPositions[r[m*3+2]]),n.skeleton&&(e.vertexWeights.push(c[f*4]),e.vertexWeights.push(c[f*4+1]),e.vertexWeights.push(c[f*4+2]),e.vertexWeights.push(c[f*4+3]),e.vertexWeights.push(c[p*4]),e.vertexWeights.push(c[p*4+1]),e.vertexWeights.push(c[p*4+2]),e.vertexWeights.push(c[p*4+3]),e.vertexWeights.push(c[m*4]),e.vertexWeights.push(c[m*4+1]),e.vertexWeights.push(c[m*4+2]),e.vertexWeights.push(c[m*4+3]),e.weightsIndices.push(u[f*4]),e.weightsIndices.push(u[f*4+1]),e.weightsIndices.push(u[f*4+2]),e.weightsIndices.push(u[f*4+3]),e.weightsIndices.push(u[p*4]),e.weightsIndices.push(u[p*4+1]),e.weightsIndices.push(u[p*4+2]),e.weightsIndices.push(u[p*4+3]),e.weightsIndices.push(u[m*4]),e.weightsIndices.push(u[m*4+1]),e.weightsIndices.push(u[m*4+2]),e.weightsIndices.push(u[m*4+3])),n.color&&(e.colors.push(a[f*3]),e.colors.push(a[f*3+1]),e.colors.push(a[f*3+2]),e.colors.push(a[p*3]),e.colors.push(a[p*3+1]),e.colors.push(a[p*3+2]),e.colors.push(a[m*3]),e.colors.push(a[m*3+1]),e.colors.push(a[m*3+2])),n.material&&n.material.mappingType!=="AllSame"&&(e.materialIndex.push(s),e.materialIndex.push(s),e.materialIndex.push(s)),n.normal&&(e.normal.push(o[f*3]),e.normal.push(o[f*3+1]),e.normal.push(o[f*3+2]),e.normal.push(o[p*3]),e.normal.push(o[p*3+1]),e.normal.push(o[p*3+2]),e.normal.push(o[m*3]),e.normal.push(o[m*3+1]),e.normal.push(o[m*3+2])),n.uv&&n.uv.forEach(function(y,v){e.uvs[v]===void 0&&(e.uvs[v]=[]),e.uvs[v].push(l[v][f*2]),e.uvs[v].push(l[v][f*2+1]),e.uvs[v].push(l[v][p*2]),e.uvs[v].push(l[v][p*2+1]),e.uvs[v].push(l[v][m*2]),e.uvs[v].push(l[v][m*2+1])})}addMorphTargets(e,n,r,s){if(r.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const o=this;r.forEach(function(a){a.rawTargets.forEach(function(l){const c=on.Objects.Geometry[l.geoID];c!==void 0&&o.genMorphGeometry(e,n,c,s,l.name)})})}genMorphGeometry(e,n,r,s,o){const a=n.PolygonVertexIndex!==void 0?n.PolygonVertexIndex.a:[],l=r.Vertices!==void 0?r.Vertices.a:[],c=r.Indexes!==void 0?r.Indexes.a:[],u=e.attributes.position.count*3,d=new Float32Array(u);for(let m=0;m<c.length;m++){const y=c[m]*3;d[y]=l[m*3],d[y+1]=l[m*3+1],d[y+2]=l[m*3+2]}const h={vertexIndices:a,vertexPositions:d},f=this.genBuffers(h),p=new Or(f.vertex,3);p.name=o||r.attrName,p.applyMatrix4(s),e.morphAttributes.position.push(p)}parseNormals(e){const n=e.MappingInformationType,r=e.ReferenceInformationType,s=e.Normals.a;let o=[];return r==="IndexToDirect"&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:s,indices:o,mappingType:n,referenceType:r}}parseUVs(e){const n=e.MappingInformationType,r=e.ReferenceInformationType,s=e.UV.a;let o=[];return r==="IndexToDirect"&&(o=e.UVIndex.a),{dataSize:2,buffer:s,indices:o,mappingType:n,referenceType:r}}parseVertexColors(e){const n=e.MappingInformationType,r=e.ReferenceInformationType,s=e.Colors.a;let o=[];r==="IndexToDirect"&&(o=e.ColorIndex.a);for(let a=0,l=new gi;a<s.length;a+=4)l.fromArray(s,a).convertSRGBToLinear().toArray(s,a);return{dataSize:4,buffer:s,indices:o,mappingType:n,referenceType:r}}parseMaterialIndices(e){const n=e.MappingInformationType,r=e.ReferenceInformationType;if(n==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};const s=e.Materials.a,o=[];for(let a=0;a<s.length;++a)o.push(a);return{dataSize:1,buffer:s,indices:o,mappingType:n,referenceType:r}}parseNurbsGeometry(e){const n=parseInt(e.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new zf;const r=n-1,s=e.KnotVector.a,o=[],a=e.Points.a;for(let h=0,f=a.length;h<f;h+=4)o.push(new gs().fromArray(a,h));let l,c;if(e.Form==="Closed")o.push(o[0]);else if(e.Form==="Periodic"){l=r,c=s.length-1-l;for(let h=0;h<r;++h)o.push(o[h])}const d=new Nce(r,s,o,l,c).getPoints(o.length*12);return new zf().setFromPoints(d)}}class Dce{parse(){const e=[],n=this.parseClips();if(n!==void 0)for(const r in n){const s=n[r],o=this.addClip(s);e.push(o)}return e}parseClips(){if(on.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const n=this.parseAnimationLayers(e);return this.parseAnimStacks(n)}parseAnimationCurveNodes(){const e=on.Objects.AnimationCurveNode,n=new Map;for(const r in e){const s=e[r];if(s.attrName.match(/S|R|T|DeformPercent/)!==null){const o={id:s.id,attr:s.attrName,curves:{}};n.set(o.id,o)}}return n}parseAnimationCurves(e){const n=on.Objects.AnimationCurve;for(const r in n){const s={id:n[r].id,times:n[r].KeyTime.a.map(zce),values:n[r].KeyValueFloat.a},o=_i.get(s.id);if(o!==void 0){const a=o.parents[0].ID,l=o.parents[0].relationship;l.match(/X/)?e.get(a).curves.x=s:l.match(/Y/)?e.get(a).curves.y=s:l.match(/Z/)?e.get(a).curves.z=s:l.match(/DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=s)}}}parseAnimationLayers(e){const n=on.Objects.AnimationLayer,r=new Map;for(const s in n){const o=[],a=_i.get(parseInt(s));a!==void 0&&(a.children.forEach(function(c,u){if(e.has(c.ID)){const d=e.get(c.ID);if(d.curves.x!==void 0||d.curves.y!==void 0||d.curves.z!==void 0){if(o[u]===void 0){const h=_i.get(c.ID).parents.filter(function(f){return f.relationship!==void 0})[0].ID;if(h!==void 0){const f=on.Objects.Model[h.toString()];if(f===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",c);return}const p={modelName:f.attrName?vn.sanitizeNodeName(f.attrName):"",ID:f.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};jr.traverse(function(m){m.ID===f.id&&(p.transform=m.matrix,m.userData.transformData&&(p.eulerOrder=m.userData.transformData.eulerOrder))}),p.transform||(p.transform=new Ct),"PreRotation"in f&&(p.preRotation=f.PreRotation.value),"PostRotation"in f&&(p.postRotation=f.PostRotation.value),o[u]=p}}o[u]&&(o[u][d.attr]=d)}else if(d.curves.morph!==void 0){if(o[u]===void 0){const h=_i.get(c.ID).parents.filter(function(g){return g.relationship!==void 0})[0].ID,f=_i.get(h).parents[0].ID,p=_i.get(f).parents[0].ID,m=_i.get(p).parents[0].ID,y=on.Objects.Model[m],v={modelName:y.attrName?vn.sanitizeNodeName(y.attrName):"",morphName:on.Objects.Deformer[h].attrName};o[u]=v}o[u][d.attr]=d}}}),r.set(parseInt(s),o))}return r}parseAnimStacks(e){const n=on.Objects.AnimationStack,r={};for(const s in n){const o=_i.get(parseInt(s)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(o[0].ID);r[s]={name:n[s].attrName,layer:a}}return r}addClip(e){let n=[];const r=this;return e.layer.forEach(function(s){n=n.concat(r.generateTracks(s))}),new kC(e.name,-1,n)}generateTracks(e){const n=[];let r=new ue,s=new ue;if(e.transform&&e.transform.decompose(r,new Yr,s),r=r.toArray(),s=s.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");o!==void 0&&n.push(o)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);o!==void 0&&n.push(o)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");o!==void 0&&n.push(o)}if(e.DeformPercent!==void 0){const o=this.generateMorphTrack(e);o!==void 0&&n.push(o)}return n}generateVectorTrack(e,n,r,s){const o=this.getTimesForAllAxes(n),a=this.getKeyframeTrackValues(o,n,r);return new Od(e+"."+s,o,a)}generateRotationTrack(e,n,r,s,o){let a,l;if(n.x!==void 0&&n.y!==void 0&&n.z!==void 0){const h=this.interpolateRotations(n.x,n.y,n.z,o);a=h[0],l=h[1]}r!==void 0&&(r=r.map(ki.degToRad),r.push(o),r=new xr().fromArray(r),r=new Yr().setFromEuler(r)),s!==void 0&&(s=s.map(ki.degToRad),s.push(o),s=new xr().fromArray(s),s=new Yr().setFromEuler(s).invert());const c=new Yr,u=new xr,d=[];if(!l||!a)return new fu(e+".quaternion",[0],[0]);for(let h=0;h<l.length;h+=3)u.set(l[h],l[h+1],l[h+2],o),c.setFromEuler(u),r!==void 0&&c.premultiply(r),s!==void 0&&c.multiply(s),h>2&&new Yr().fromArray(d,(h-3)/3*4).dot(c)<0&&c.set(-c.x,-c.y,-c.z,-c.w),c.toArray(d,h/3*4);return new fu(e+".quaternion",a,d)}generateMorphTrack(e){const n=e.DeformPercent.curves.morph,r=n.values.map(function(o){return o/100}),s=jr.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Uy(e.modelName+".morphTargetInfluences["+s+"]",n.times,r)}getTimesForAllAxes(e){let n=[];if(e.x!==void 0&&(n=n.concat(e.x.times)),e.y!==void 0&&(n=n.concat(e.y.times)),e.z!==void 0&&(n=n.concat(e.z.times)),n=n.sort(function(r,s){return r-s}),n.length>1){let r=1,s=n[0];for(let o=1;o<n.length;o++){const a=n[o];a!==s&&(n[r]=a,s=a,r++)}n=n.slice(0,r)}return n}getKeyframeTrackValues(e,n,r){const s=r,o=[];let a=-1,l=-1,c=-1;return e.forEach(function(u){if(n.x&&(a=n.x.times.indexOf(u)),n.y&&(l=n.y.times.indexOf(u)),n.z&&(c=n.z.times.indexOf(u)),a!==-1){const d=n.x.values[a];o.push(d),s[0]=d}else o.push(s[0]);if(l!==-1){const d=n.y.values[l];o.push(d),s[1]=d}else o.push(s[1]);if(c!==-1){const d=n.z.values[c];o.push(d),s[2]=d}else o.push(s[2])}),o}interpolateRotations(e,n,r,s){const o=[],a=[];o.push(e.times[0]),a.push(ki.degToRad(e.values[0])),a.push(ki.degToRad(n.values[0])),a.push(ki.degToRad(r.values[0]));for(let l=1;l<e.values.length;l++){const c=[e.values[l-1],n.values[l-1],r.values[l-1]];if(isNaN(c[0])||isNaN(c[1])||isNaN(c[2]))continue;const u=c.map(ki.degToRad),d=[e.values[l],n.values[l],r.values[l]];if(isNaN(d[0])||isNaN(d[1])||isNaN(d[2]))continue;const h=d.map(ki.degToRad),f=[d[0]-c[0],d[1]-c[1],d[2]-c[2]],p=[Math.abs(f[0]),Math.abs(f[1]),Math.abs(f[2])];if(p[0]>=180||p[1]>=180||p[2]>=180){const y=Math.max(...p)/180,v=new xr(...u,s),g=new xr(...h,s),_=new Yr().setFromEuler(v),x=new Yr().setFromEuler(g);_.dot(x)&&x.set(-x.x,-x.y,-x.z,-x.w);const b=e.times[l-1],S=e.times[l]-b,T=new Yr,w=new xr;for(let E=0;E<1;E+=1/y)T.copy(_.clone().slerp(x.clone(),E)),o.push(b+E*S),w.setFromQuaternion(T,s),a.push(w.x),a.push(w.y),a.push(w.z)}else o.push(e.times[l]),a.push(ki.degToRad(e.values[l])),a.push(ki.degToRad(n.values[l])),a.push(ki.degToRad(r.values[l]))}return[o,a]}}class Oce{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,n){this.currentProp=e,this.currentPropName=n}parse(e){this.currentIndent=0,this.allNodes=new I$,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const n=this,r=e.split(/[\r\n]+/);return r.forEach(function(s,o){const a=s.match(/^[\s\t]*;/),l=s.match(/^[\s\t]*$/);if(a||l)return;const c=s.match("^\\t{"+n.currentIndent+"}(\\w+):(.*){",""),u=s.match("^\\t{"+n.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),d=s.match("^\\t{"+(n.currentIndent-1)+"}}");c?n.parseNodeBegin(s,c):u?n.parseNodeProperty(s,u,r[++o]):d?n.popStack():s.match(/^[^\s\t}]/)&&n.parseNodePropertyContinued(s)}),this.allNodes}parseNodeBegin(e,n){const r=n[1].trim().replace(/^"/,"").replace(/"$/,""),s=n[2].split(",").map(function(c){return c.trim().replace(/^"/,"").replace(/"$/,"")}),o={name:r},a=this.parseNodeAttr(s),l=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(r,o):r in l?(r==="PoseNode"?l.PoseNode.push(o):l[r].id!==void 0&&(l[r]={},l[r][l[r].id]=l[r]),a.id!==""&&(l[r][a.id]=o)):typeof a.id=="number"?(l[r]={},l[r][a.id]=o):r!=="Properties70"&&(r==="PoseNode"?l[r]=[o]:l[r]=o),typeof a.id=="number"&&(o.id=a.id),a.name!==""&&(o.attrName=a.name),a.type!==""&&(o.attrType=a.type),this.pushStack(o)}parseNodeAttr(e){let n=e[0];e[0]!==""&&(n=parseInt(e[0]),isNaN(n)&&(n=e[0]));let r="",s="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),s=e[2]),{id:n,name:r,type:s}}parseNodeProperty(e,n,r){let s=n[1].replace(/^"/,"").replace(/"$/,"").trim(),o=n[2].replace(/^"/,"").replace(/"$/,"").trim();s==="Content"&&o===","&&(o=r.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if(a.name==="Properties70"){this.parseNodeSpecialProperty(e,s,o);return}if(s==="C"){const c=o.split(",").slice(1),u=parseInt(c[0]),d=parseInt(c[1]);let h=o.split(",").slice(3);h=h.map(function(f){return f.trim().replace(/^"/,"")}),s="connections",o=[u,d],$ce(o,h),a[s]===void 0&&(a[s]=[])}s==="Node"&&(a.id=o),s in a&&Array.isArray(a[s])?a[s].push(o):s!=="a"?a[s]=o:a.a=o,this.setCurrentProp(a,s),s==="a"&&o.slice(-1)!==","&&(a.a=dE(o))}parseNodePropertyContinued(e){const n=this.getCurrentNode();n.a+=e,e.slice(-1)!==","&&(n.a=dE(n.a))}parseNodeSpecialProperty(e,n,r){const s=r.split('",').map(function(d){return d.trim().replace(/^\"/,"").replace(/\s/,"_")}),o=s[0],a=s[1],l=s[2],c=s[3];let u=s[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=dE(u);break}this.getPrevNode()[o]={type:a,type2:l,flag:c,value:u},this.setCurrentProp(this.getPrevNode(),o)}}class Fce{parse(e){const n=new SO(e);n.skip(23);const r=n.getUint32();if(r<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+r);const s=new I$;for(;!this.endOfContent(n);){const o=this.parseNode(n,r);o!==null&&s.add(o.name,o)}return s}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,n){const r={},s=n>=7500?e.getUint64():e.getUint32(),o=n>=7500?e.getUint64():e.getUint32();n>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),l=e.getString(a);if(s===0)return null;const c=[];for(let f=0;f<o;f++)c.push(this.parseProperty(e));const u=c.length>0?c[0]:"",d=c.length>1?c[1]:"",h=c.length>2?c[2]:"";for(r.singleProperty=o===1&&e.getOffset()===s;s>e.getOffset();){const f=this.parseNode(e,n);f!==null&&this.parseSubNode(l,r,f)}return r.propertyList=c,typeof u=="number"&&(r.id=u),d!==""&&(r.attrName=d),h!==""&&(r.attrType=h),l!==""&&(r.name=l),r}parseSubNode(e,n,r){if(r.singleProperty===!0){const s=r.propertyList[0];Array.isArray(s)?(n[r.name]=r,r.a=s):n[r.name]=s}else if(e==="Connections"&&r.name==="C"){const s=[];r.propertyList.forEach(function(o,a){a!==0&&s.push(o)}),n.connections===void 0&&(n.connections=[]),n.connections.push(s)}else if(r.name==="Properties70")Object.keys(r).forEach(function(o){n[o]=r[o]});else if(e==="Properties70"&&r.name==="P"){let s=r.propertyList[0],o=r.propertyList[1];const a=r.propertyList[2],l=r.propertyList[3];let c;s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),o.indexOf("Lcl ")===0&&(o=o.replace("Lcl ","Lcl_")),o==="Color"||o==="ColorRGB"||o==="Vector"||o==="Vector3D"||o.indexOf("Lcl_")===0?c=[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:c=r.propertyList[4],n[s]={type:o,type2:a,flag:l,value:c}}else n[r.name]===void 0?typeof r.id=="number"?(n[r.name]={},n[r.name][r.id]=r):n[r.name]=r:r.name==="PoseNode"?(Array.isArray(n[r.name])||(n[r.name]=[n[r.name]]),n[r.name].push(r)):n[r.name][r.id]===void 0&&(n[r.name][r.id]=r)}parseProperty(e){const n=e.getString(1);let r;switch(n){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return r=e.getUint32(),e.getArrayBuffer(r);case"S":return r=e.getUint32(),e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const s=e.getUint32(),o=e.getUint32(),a=e.getUint32();if(o===0)switch(n){case"b":case"c":return e.getBooleanArray(s);case"d":return e.getFloat64Array(s);case"f":return e.getFloat32Array(s);case"i":return e.getInt32Array(s);case"l":return e.getInt64Array(s)}const l=bce(new Uint8Array(e.getArrayBuffer(a))),c=new SO(l.buffer);switch(n){case"b":case"c":return c.getBooleanArray(s);case"d":return c.getFloat64Array(s);case"f":return c.getFloat32Array(s);case"i":return c.getInt32Array(s);case"l":return c.getInt64Array(s)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+n)}}}class SO{constructor(e,n){this.dv=new DataView(e),this.offset=0,this.littleEndian=n!==void 0?n:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const n=[];for(let r=0;r<e;r++)n.push(this.getBoolean());return n}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const n=[];for(let r=0;r<e;r++)n.push(this.getInt32());return n}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n&2147483648?(n=~n&4294967295,e=~e&4294967295,e===4294967295&&(n=n+1&4294967295),e=e+1&4294967295,-(n*4294967296+e)):n*4294967296+e}getInt64Array(e){const n=[];for(let r=0;r<e;r++)n.push(this.getInt64());return n}getUint64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const n=[];for(let r=0;r<e;r++)n.push(this.getFloat32());return n}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const n=[];for(let r=0;r<e;r++)n.push(this.getFloat64());return n}getArrayBuffer(e){const n=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,n}getString(e){const n=this.offset;let r=new Uint8Array(this.dv.buffer,n,e);this.skip(e);const s=r.indexOf(0);return s>=0&&(r=new Uint8Array(this.dv.buffer,n,s)),this._textDecoder.decode(r)}}class I${add(e,n){this[e]=n}}function Bce(i){const e="Kaydara FBX Binary  \0";return i.byteLength>=e.length&&e===F$(i,0,e.length)}function Uce(i){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function r(s){const o=i[s-1];return i=i.slice(n+s),n++,o}for(let s=0;s<e.length;++s)if(r(1)===e[s])return!1;return!0}function wO(i){const e=/FBXVersion: (\d+)/,n=i.match(e);if(n)return parseInt(n[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function zce(i){return i/46186158e3}const Vce=[];function ax(i,e,n,r){let s;switch(r.mappingType){case"ByPolygonVertex":s=i;break;case"ByPolygon":s=e;break;case"ByVertice":s=n;break;case"AllSame":s=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}r.referenceType==="IndexToDirect"&&(s=r.indices[s]);const o=s*r.dataSize,a=o+r.dataSize;return Gce(Vce,r.buffer,o,a)}const uE=new xr,Mh=new ue;function D$(i){const e=new Ct,n=new Ct,r=new Ct,s=new Ct,o=new Ct,a=new Ct,l=new Ct,c=new Ct,u=new Ct,d=new Ct,h=new Ct,f=new Ct,p=i.inheritType?i.inheritType:0;if(i.translation&&e.setPosition(Mh.fromArray(i.translation)),i.preRotation){const M=i.preRotation.map(ki.degToRad);M.push(i.eulerOrder||xr.DEFAULT_ORDER),n.makeRotationFromEuler(uE.fromArray(M))}if(i.rotation){const M=i.rotation.map(ki.degToRad);M.push(i.eulerOrder||xr.DEFAULT_ORDER),r.makeRotationFromEuler(uE.fromArray(M))}if(i.postRotation){const M=i.postRotation.map(ki.degToRad);M.push(i.eulerOrder||xr.DEFAULT_ORDER),s.makeRotationFromEuler(uE.fromArray(M)),s.invert()}i.scale&&o.scale(Mh.fromArray(i.scale)),i.scalingOffset&&l.setPosition(Mh.fromArray(i.scalingOffset)),i.scalingPivot&&a.setPosition(Mh.fromArray(i.scalingPivot)),i.rotationOffset&&c.setPosition(Mh.fromArray(i.rotationOffset)),i.rotationPivot&&u.setPosition(Mh.fromArray(i.rotationPivot)),i.parentMatrixWorld&&(h.copy(i.parentMatrix),d.copy(i.parentMatrixWorld));const m=n.clone().multiply(r).multiply(s),y=new Ct;y.extractRotation(d);const v=new Ct;v.copyPosition(d);const g=v.clone().invert().multiply(d),_=y.clone().invert().multiply(g),x=o,b=new Ct;if(p===0)b.copy(y).multiply(m).multiply(_).multiply(x);else if(p===1)b.copy(y).multiply(_).multiply(m).multiply(x);else{const R=new Ct().scale(new ue().setFromMatrixScale(h)).clone().invert(),F=_.clone().multiply(R);b.copy(y).multiply(m).multiply(F).multiply(x)}const S=u.clone().invert(),T=a.clone().invert();let w=e.clone().multiply(c).multiply(u).multiply(n).multiply(r).multiply(s).multiply(S).multiply(l).multiply(a).multiply(o).multiply(T);const E=new Ct().copyPosition(w),A=d.clone().multiply(E);return f.copyPosition(A),w=f.clone().multiply(b),w.premultiply(d.invert()),w}function O$(i){i=i||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return i===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[i]}function dE(i){return i.split(",").map(function(n){return parseFloat(n)})}function F$(i,e,n){return e===void 0&&(e=0),n===void 0&&(n=i.byteLength),new TextDecoder().decode(new Uint8Array(i,e,n))}function $ce(i,e){for(let n=0,r=i.length,s=e.length;n<s;n++,r++)i[r]=e[n]}function Gce(i,e,n,r){for(let s=n,o=0;s<r;s++,o++)i[o]=e[s];return i}THREE.FBXLoader=kce;AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){const i=this.data;if(!i.src)return;this.remove();const e=new THREE.FBXLoader;i.crossorigin&&e.setCrossOrigin(i.crossorigin),e.load(i.src,this.load.bind(this))},load:function(i){this.model=i,this.el.setObject3D("mesh",i),this.el.emit("model-loaded",{format:"fbx",model:i})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});function Hce(){return"script_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function Wce(i,e){var n=document.createElement("script");return n.type="text/javascript",n.async=!0,n.id=e,n.src=i,n}function hE(i){const e=document.getElementById(i),n=e.parentNode;try{n&&n.removeChild(e)}catch{}}function jce(i){const e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(i,e)}function qce(i,e,n){return new n(function(r,s){const o=e.timeout||5e3,a=Hce(),l=Wce(i,a),c=setTimeout(function(){s(new Error("Script request to "+i+" timed out")),hE(a)},o),u=function(d){clearTimeout(d)};l.addEventListener("load",function(d){r({ok:!0}),u(c),hE(a)}),l.addEventListener("error",function(d){s(new Error("Script request to "+i+" failed "+d)),u(c),hE(a)}),jce(l)})}function Xce(i){return i=i||{},function(e,n){return n=n||{},qce(e,n,i.Promise||Promise)}}var Kce=Xce;const Yce=Kce(),Zce="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js",Qce=function(){let i;return function(){return i=i||Yce(Zce),i}}();AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=Qce().then(()=>{this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")})},update:function(){const i=this,e=this.el,n=this.data;n&&(this.remove(),this.loaderPromise.then(()=>{this.loader.load(n,function(s){i.model=s.scene,i.model.animations=s.animations,e.setObject3D("mesh",i.model),e.emit("model-loaded",{format:"gltf",model:i.model})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let i;const e=this.data;e.src&&(this.remove(),i=new THREE.ObjectLoader,e.crossorigin&&i.setCrossOrigin(e.crossorigin),i.load(e.src,n=>{n.traverse(r=>{r instanceof THREE.SkinnedMesh&&r.material&&(r.material.skinning=!!(r.geometry&&r.geometry.bones||[]).length)}),this.load(n)}))},load:function(i){this.model=i,this.el.setObject3D("mesh",i),this.el.emit("model-loaded",{format:"json",model:i})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){const i=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!i)throw new Error("No `checkpoint-controls` component found.");i.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}});function Jce(i){return i?Array.isArray(i)?i:i.materials?i.materials:[i]:[]}function Om(i,e,n,r){i&&(e=e||[],i.traverse(s=>{if(!s.isMesh)return;Jce(s.material).forEach(a=>{a&&!("envMap"in a)||e.length&&e.indexOf(a.name)===-1||(a.envMap=n,a.reflectivity=r,a.needsUpdate=!0)})}))}AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){const i=this.data;this.texture=new THREE.CubeTextureLoader().load([i.path+"posx."+i.extension,i.path+"negx."+i.extension,i.path+"posy."+i.extension,i.path+"negy."+i.extension,i.path+"posz."+i.extension,i.path+"negz."+i.extension]),this.texture.format=THREE.RGBAFormat,this.object3dsetHandler=()=>{const e=this.el.getObject3D("mesh"),n=this.data;Om(e,n.materials,this.texture,n.reflectivity)},this.object3dsetHandler(),this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(i){const e=this.data,n=this.el.getObject3D("mesh");let r=[],s=[];if(e.materials.length&&(i.materials?(r=e.materials.filter(o=>!i.materials.includes(o)),s=i.materials.filter(o=>!e.materials.includes(o))):r=e.materials),r.length&&Om(n,r,this.texture,e.reflectivity),s.length&&Om(n,s,null,1),i.materials&&e.reflectivity!==i.reflectivity){const o=e.materials.filter(a=>i.materials.includes(a));o.length&&Om(n,o,this.texture,e.reflectivity)}this.data.enableBackground&&!i.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&i.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);const i=this.el.getObject3D("mesh"),e=this.data;Om(i,e.materials,null,1),e.enableBackground&&this.setBackground(null)},setBackground:function(i){this.el.sceneEl.object3D.background=i}});AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){const i=this.el;i.addEventListener("hit",this.onHit),i.addEventListener("gripdown",this.onGripClose),i.addEventListener("gripup",this.onGripOpen),i.addEventListener("trackpaddown",this.onGripClose),i.addEventListener("trackpadup",this.onGripOpen),i.addEventListener("triggerdown",this.onGripClose),i.addEventListener("triggerup",this.onGripOpen)},pause:function(){const i=this.el;i.removeEventListener("hit",this.onHit),i.removeEventListener("gripdown",this.onGripClose),i.removeEventListener("gripup",this.onGripOpen),i.removeEventListener("trackpaddown",this.onGripClose),i.removeEventListener("trackpadup",this.onGripOpen),i.removeEventListener("triggerdown",this.onGripClose),i.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){const i=this.hitEl;this.grabbing=!1,i&&(i.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(i){const e=i.detail.el;e.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(e.addState(this.GRABBED_STATE),this.hitEl=e,this.constraint=new CANNON.LockConstraint(this.el.body,e.body),this.system.addConstraint(this.constraint))}});AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial),this.applyMaterial()},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse(i=>{i.isMesh&&(i.material=this.material)})}});AFRAME.registerComponent("sphere-collider",{schema:{enabled:{default:!0},interval:{default:80},objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.prevCheckTime=void 0,this.eventDetail={},this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},play:function(){const i=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(i,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){const i=this.data;let e;i.objects?e=this.el.sceneEl.querySelectorAll(i.objects):e=this.el.sceneEl.children,this.els=Array.prototype.slice.call(e)},tick:function(){const i=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3,s=new THREE.Box3,o=[],a=new Map;return function(l){if(!this.data.enabled)return;const c=this.prevCheckTime;if(c&&l-c<this.data.interval)return;this.prevCheckTime=l;const u=this.el,d=this.data,h=u.getObject3D("mesh");let f;if(!h)return;o.length=0,a.clear(),u.object3D.getWorldPosition(i),u.object3D.getWorldScale(n),f=d.radius*m(n),this.els.forEach(p),o.sort((y,v)=>a.get(y)>a.get(v)?1:-1).forEach(this.handleHit),this.collisions.filter(y=>!a.has(y)).forEach(this.handleHitEnd),eue(this.collisions,o);function p(y){let v,g,_,x;y.isEntity&&(g=y.getObject3D("mesh"),g&&(s.setFromObject(g).getSize(r),x=Math.max(r.x,r.y,r.z)/2,v=Math.sqrt(2*x*x),s.getCenter(e),v&&(_=i.distanceTo(e),_<v+f&&(o.push(y),a.set(y,_)))))}function m(y){return Math.max(y.x,y.y,y.z)}}}(),handleHit:function(i){i.emit("hit"),i.addState(this.data.state),this.eventDetail.el=i,this.el.emit("hit",this.eventDetail)},handleHitEnd:function(i){i.emit("hitend"),i.removeState(this.data.state),this.eventDetail.el=i,this.el.emit("hitend",this.eventDetail)}});function eue(i,e){i.length=0;for(let n=0;n<e.length;n++)i[n]=e[n]}AFRAME.registerComponent("nav-mesh",{schema:{nodeName:{type:"string"}},init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.nodeName=this.data.nodeName,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var i=this;const e=this.el.getObject3D("mesh");if(this.el.sceneEl.object3D,!e)return;let n;if(e.traverse(s=>{s.isMesh&&(!i.nodeName||s.name===i.nodeName)&&(n=s)}),!n)return;const r=n.geometry.clone();n.updateWorldMatrix(!0,!1),r.applyMatrix4(n.matrixWorld),this.system.setNavMeshGeometry(r),this.hasLoadedNavMesh=!0}});AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){const i=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3;return function(r,s){const o=this.el,a=this.data,l=this.raycaster,c=a.speed*s/1e3;if(!a.active)return;if(!this.path.length){const m=this.el.object3D.position;this.group=this.group||this.system.getGroup(m),this.path=this.system.getPath(m,i.copy(a.destination),this.group)||[],o.emit("navigation-start")}if(!this.path.length){console.warn("[nav] Unable to find path to %o.",a.destination),this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}const u=o.object3D.position,d=this.path[0];e.subVectors(d,u);const h=e.length();let f;if(h<c){if(this.path.shift(),!this.path.length){this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}n.copy(u),f=this.path[0]}else n.copy(e.setLength(c)).add(u),f=d;f.y=u.y,o.object3D.lookAt(f),l.ray.origin.copy(n),l.ray.origin.y+=1.5,l.ray.direction={x:0,y:-1,z:0};const p=l.intersectObject(this.system.getNavMesh());p.length?(e.subVectors(p[0].point,u),u.add(e.setLength(c))):u.copy(n)}}()});/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const tm="176",_r={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Il={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},B$=0,DC=1,U$=2,tue=0,PN=1,nue=2,Hs=3,Cs=0,On=1,Qr=2,Rs=0,eo=1,cp=2,up=3,dp=4,Vf=5,Ur=100,NN=101,kN=102,z$=103,V$=104,Tl=200,LN=201,IN=202,DN=203,zy=204,Vy=205,ON=206,FN=207,BN=208,UN=209,zN=210,iue=211,rue=212,sue=213,oue=214,$y=0,Gy=1,Hy=2,pu=3,Wy=4,jy=5,qy=6,Xy=7,B0=0,$$=1,G$=2,Ps=0,H$=1,W$=2,j$=3,q$=4,aue=5,X$=6,K$=7,VN=300,pa=301,ma=302,Fd=303,Bd=304,Ud=306,zd=1e3,Ua=1001,Vd=1002,Vn=1003,$N=1004,Dl=1005,Xi=1006,$f=1007,_s=1008,ci=1009,bd=1010,Sd=1011,oa=1012,or=1013,Dn=1014,wi=1015,lr=1016,KS=1017,YS=1018,to=1020,ZS=35902,GN=1021,U0=1022,yi=1023,no=1026,io=1027,z0=1028,nm=1029,Ol=1030,im=1031,lue=1032,rm=1033,wd=33776,ou=33777,au=33778,lu=33779,Ky=35840,Yy=35841,Zy=35842,Qy=35843,Jy=36196,hp=37492,fp=37496,pp=37808,mp=37809,gp=37810,yp=37811,vp=37812,xp=37813,_p=37814,bp=37815,Sp=37816,wp=37817,Tp=37818,Ep=37819,Mp=37820,Ap=37821,Td=36492,OC=36494,FC=36495,HN=36283,e0=36284,t0=36285,n0=36286,cue=3200,uue=3201,tc=0,Y$=1,qs="",Et="srgb",Wa="srgb-linear",Qb="linear",Tn="srgb",due=0,td=7680,hue=7681,fue=7682,pue=7683,mue=34055,gue=34056,yue=5386,vue=512,xue=513,_ue=514,bue=515,Sue=516,wue=517,Tue=518,BC=519,WN=512,QS=513,jN=514,JS=515,qN=516,XN=517,KN=518,YN=519,Jb=35044,vf=35048,TO="300 es",is=2e3,mu=2001;class dc{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){const r=this._listeners;if(r===void 0)return;const s=r[e];if(s!==void 0){const o=s.indexOf(n);o!==-1&&s.splice(o,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const r=n[e.type];if(r!==void 0){e.target=this;const s=r.slice(0);for(let o=0,a=s.length;o<a;o++)s[o].call(this,e);e.target=null}}}const Nr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let EO=1234567;const qg=Math.PI/180,$d=180/Math.PI;function Gl(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Nr[i&255]+Nr[i>>8&255]+Nr[i>>16&255]+Nr[i>>24&255]+"-"+Nr[e&255]+Nr[e>>8&255]+"-"+Nr[e>>16&15|64]+Nr[e>>24&255]+"-"+Nr[n&63|128]+Nr[n>>8&255]+"-"+Nr[n>>16&255]+Nr[n>>24&255]+Nr[r&255]+Nr[r>>8&255]+Nr[r>>16&255]+Nr[r>>24&255]).toLowerCase()}function Yt(i,e,n){return Math.max(e,Math.min(n,i))}function ZN(i,e){return(i%e+e)%e}function Eue(i,e,n,r,s){return r+(i-e)*(s-r)/(n-e)}function Mue(i,e,n){return i!==e?(n-i)/(e-i):0}function Xg(i,e,n){return(1-n)*i+n*e}function Aue(i,e,n,r){return Xg(i,e,1-Math.exp(-n*r))}function Cue(i,e=1){return e-Math.abs(ZN(i,e*2)-e)}function Rue(i,e,n){return i<=e?0:i>=n?1:(i=(i-e)/(n-e),i*i*(3-2*i))}function Pue(i,e,n){return i<=e?0:i>=n?1:(i=(i-e)/(n-e),i*i*i*(i*(i*6-15)+10))}function Nue(i,e){return i+Math.floor(Math.random()*(e-i+1))}function kue(i,e){return i+Math.random()*(e-i)}function Lue(i){return i*(.5-Math.random())}function Iue(i){i!==void 0&&(EO=i);let e=EO+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Due(i){return i*qg}function Oue(i){return i*$d}function Fue(i){return(i&i-1)===0&&i!==0}function Bue(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Uue(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function zue(i,e,n,r,s){const o=Math.cos,a=Math.sin,l=o(n/2),c=a(n/2),u=o((e+r)/2),d=a((e+r)/2),h=o((e-r)/2),f=a((e-r)/2),p=o((r-e)/2),m=a((r-e)/2);switch(s){case"XYX":i.set(l*d,c*h,c*f,l*u);break;case"YZY":i.set(c*f,l*d,c*h,l*u);break;case"ZXZ":i.set(c*h,c*f,l*d,l*u);break;case"XZX":i.set(l*d,c*m,c*p,l*u);break;case"YXY":i.set(c*p,l*d,c*m,l*u);break;case"ZYZ":i.set(c*m,c*p,l*d,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Jr(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Xt(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const e1={DEG2RAD:qg,RAD2DEG:$d,generateUUID:Gl,clamp:Yt,euclideanModulo:ZN,mapLinear:Eue,inverseLerp:Mue,lerp:Xg,damp:Aue,pingpong:Cue,smoothstep:Rue,smootherstep:Pue,randInt:Nue,randFloat:kue,randFloatSpread:Lue,seededRandom:Iue,degToRad:Due,radToDeg:Oue,isPowerOfTwo:Fue,ceilPowerOfTwo:Bue,floorPowerOfTwo:Uue,setQuaternionFromProperEuler:zue,normalize:Xt,denormalize:Jr};class Oe{constructor(e=0,n=0){Oe.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,s=e.elements;return this.x=s[0]*n+s[3]*r+s[6],this.y=s[1]*n+s[4]*r+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Yt(this.x,e.x,n.x),this.y=Yt(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Yt(this.x,e,n),this.y=Yt(this.y,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Yt(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Yt(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),s=Math.sin(n),o=this.x-e.x,a=this.y-e.y;return this.x=o*r-a*s+e.x,this.y=o*s+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Vt{constructor(e,n,r,s,o,a,l,c,u){Vt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,s,o,a,l,c,u)}set(e,n,r,s,o,a,l,c,u){const d=this.elements;return d[0]=e,d[1]=s,d[2]=l,d[3]=n,d[4]=o,d[5]=c,d[6]=r,d[7]=a,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,s=n.elements,o=this.elements,a=r[0],l=r[3],c=r[6],u=r[1],d=r[4],h=r[7],f=r[2],p=r[5],m=r[8],y=s[0],v=s[3],g=s[6],_=s[1],x=s[4],b=s[7],S=s[2],T=s[5],w=s[8];return o[0]=a*y+l*_+c*S,o[3]=a*v+l*x+c*T,o[6]=a*g+l*b+c*w,o[1]=u*y+d*_+h*S,o[4]=u*v+d*x+h*T,o[7]=u*g+d*b+h*w,o[2]=f*y+p*_+m*S,o[5]=f*v+p*x+m*T,o[8]=f*g+p*b+m*w,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8];return n*a*d-n*l*u-r*o*d+r*l*c+s*o*u-s*a*c}invert(){const e=this.elements,n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=d*a-l*u,f=l*c-d*o,p=u*o-a*c,m=n*h+r*f+s*p;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/m;return e[0]=h*y,e[1]=(s*u-d*r)*y,e[2]=(l*r-s*a)*y,e[3]=f*y,e[4]=(d*n-s*c)*y,e[5]=(s*o-l*n)*y,e[6]=p*y,e[7]=(r*c-u*n)*y,e[8]=(a*n-r*o)*y,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,s,o,a,l){const c=Math.cos(o),u=Math.sin(o);return this.set(r*c,r*u,-r*(c*a+u*l)+a+e,-s*u,s*c,-s*(-u*a+c*l)+l+n,0,0,1),this}scale(e,n){return this.premultiply(fE.makeScale(e,n)),this}rotate(e){return this.premultiply(fE.makeRotation(-e)),this}translate(e,n){return this.premultiply(fE.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let s=0;s<9;s++)if(n[s]!==r[s])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const fE=new Vt;function QN(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function i0(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function Z$(){const i=i0("canvas");return i.style.display="block",i}const MO={};function da(i){i in MO||(MO[i]=!0,console.warn(i))}function Vue(i,e,n){return new Promise(function(r,s){function o(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:s();break;case i.TIMEOUT_EXPIRED:setTimeout(o,n);break;default:r()}}setTimeout(o,n)})}function $ue(i){const e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function Gue(i){const e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const AO=new Vt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),CO=new Vt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Hue(){const i={enabled:!0,workingColorSpace:Wa,spaces:{},convert:function(s,o,a){return this.enabled===!1||o===a||!o||!a||(this.spaces[o].transfer===Tn&&(s.r=Hl(s.r),s.g=Hl(s.g),s.b=Hl(s.b)),this.spaces[o].primaries!==this.spaces[a].primaries&&(s.applyMatrix3(this.spaces[o].toXYZ),s.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Tn&&(s.r=Gf(s.r),s.g=Gf(s.g),s.b=Gf(s.b))),s},fromWorkingColorSpace:function(s,o){return this.convert(s,this.workingColorSpace,o)},toWorkingColorSpace:function(s,o){return this.convert(s,o,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===qs?Qb:this.spaces[s].transfer},getLuminanceCoefficients:function(s,o=this.workingColorSpace){return s.fromArray(this.spaces[o].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,o,a){return s.copy(this.spaces[o].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return i.define({[Wa]:{primaries:e,whitePoint:r,transfer:Qb,toXYZ:AO,fromXYZ:CO,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Et},outputColorSpaceConfig:{drawingBufferColorSpace:Et}},[Et]:{primaries:e,whitePoint:r,transfer:Tn,toXYZ:AO,fromXYZ:CO,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Et}}}),i}const rn=Hue();function Hl(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Gf(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let Ah;class Wue{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{Ah===void 0&&(Ah=i0("canvas")),Ah.width=e.width,Ah.height=e.height;const s=Ah.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),r=Ah}return r.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=i0("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const s=r.getImageData(0,0,e.width,e.height),o=s.data;for(let a=0;a<o.length;a++)o[a]=Hl(o[a]/255)*255;return r.putImageData(s,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(Hl(n[r]/255)*255):n[r]=Hl(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let jue=0;class JN{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:jue++}),this.uuid=Gl(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let a=0,l=s.length;a<l;a++)s[a].isDataTexture?o.push(pE(s[a].image)):o.push(pE(s[a]))}else o=pE(s);r.url=o}return n||(e.images[this.uuid]=r),r}}function pE(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?Wue.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let que=0;class Ki extends dc{constructor(e=Ki.DEFAULT_IMAGE,n=Ki.DEFAULT_MAPPING,r=Ua,s=Ua,o=Xi,a=_s,l=yi,c=ci,u=Ki.DEFAULT_ANISOTROPY,d=qs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:que++}),this.uuid=Gl(),this.name="",this.source=new JN(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new Oe(0,0),this.repeat=new Oe(1,1),this.center=new Oe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==VN)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case zd:e.x=e.x-Math.floor(e.x);break;case Ua:e.x=e.x<0?0:1;break;case Vd:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case zd:e.y=e.y-Math.floor(e.y);break;case Ua:e.y=e.y<0?0:1;break;case Vd:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Ki.DEFAULT_IMAGE=null;Ki.DEFAULT_MAPPING=VN;Ki.DEFAULT_ANISOTROPY=1;class Dt{constructor(e=0,n=0,r=0,s=1){Dt.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,s){return this.x=e,this.y=n,this.z=r,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,s=this.z,o=this.w,a=e.elements;return this.x=a[0]*n+a[4]*r+a[8]*s+a[12]*o,this.y=a[1]*n+a[5]*r+a[9]*s+a[13]*o,this.z=a[2]*n+a[6]*r+a[10]*s+a[14]*o,this.w=a[3]*n+a[7]*r+a[11]*s+a[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,s,o;const c=e.elements,u=c[0],d=c[4],h=c[8],f=c[1],p=c[5],m=c[9],y=c[2],v=c[6],g=c[10];if(Math.abs(d-f)<.01&&Math.abs(h-y)<.01&&Math.abs(m-v)<.01){if(Math.abs(d+f)<.1&&Math.abs(h+y)<.1&&Math.abs(m+v)<.1&&Math.abs(u+p+g-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const x=(u+1)/2,b=(p+1)/2,S=(g+1)/2,T=(d+f)/4,w=(h+y)/4,E=(m+v)/4;return x>b&&x>S?x<.01?(r=0,s=.707106781,o=.707106781):(r=Math.sqrt(x),s=T/r,o=w/r):b>S?b<.01?(r=.707106781,s=0,o=.707106781):(s=Math.sqrt(b),r=T/s,o=E/s):S<.01?(r=.707106781,s=.707106781,o=0):(o=Math.sqrt(S),r=w/o,s=E/o),this.set(r,s,o,n),this}let _=Math.sqrt((v-m)*(v-m)+(h-y)*(h-y)+(f-d)*(f-d));return Math.abs(_)<.001&&(_=1),this.x=(v-m)/_,this.y=(h-y)/_,this.z=(f-d)/_,this.w=Math.acos((u+p+g-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Yt(this.x,e.x,n.x),this.y=Yt(this.y,e.y,n.y),this.z=Yt(this.z,e.z,n.z),this.w=Yt(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Yt(this.x,e,n),this.y=Yt(this.y,e,n),this.z=Yt(this.z,e,n),this.w=Yt(this.w,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Yt(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Eu extends dc{constructor(e=1,n=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=r.depth?r.depth:1,this.scissor=new Dt(0,0,e,n),this.scissorTest=!1,this.viewport=new Dt(0,0,e,n);const s={width:e,height:n,depth:this.depth};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Xi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},r);const o=new Ki(s,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);o.flipY=!1,o.generateMipmaps=r.generateMipmaps,o.internalFormat=r.internalFormat,this.textures=[];const a=r.count;for(let l=0;l<a;l++)this.textures[l]=o.clone(),this.textures[l].isRenderTargetTexture=!0,this.textures[l].renderTarget=this;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=r.depthTexture,this.samples=r.samples,this.multiview=r.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,r=1){if(this.width!==e||this.height!==n||this.depth!==r){this.width=e,this.height=n,this.depth=r;for(let s=0,o=this.textures.length;s<o;s++)this.textures[s].image.width=e,this.textures[s].image.height=n,this.textures[s].image.depth=r;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const s=Object.assign({},e.textures[n].image);this.textures[n].source=new JN(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class gu extends Eu{constructor(e=1,n=1,r={}){super(e,n,r),this.isWebGLRenderTarget=!0}}class ew extends Ki{constructor(e=null,n=1,r=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:s},this.magFilter=Vn,this.minFilter=Vn,this.wrapR=Ua,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Xue extends Ki{constructor(e=null,n=1,r=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:s},this.magFilter=Vn,this.minFilter=Vn,this.wrapR=Ua,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ga{constructor(e=0,n=0,r=0,s=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=s}static slerpFlat(e,n,r,s,o,a,l){let c=r[s+0],u=r[s+1],d=r[s+2],h=r[s+3];const f=o[a+0],p=o[a+1],m=o[a+2],y=o[a+3];if(l===0){e[n+0]=c,e[n+1]=u,e[n+2]=d,e[n+3]=h;return}if(l===1){e[n+0]=f,e[n+1]=p,e[n+2]=m,e[n+3]=y;return}if(h!==y||c!==f||u!==p||d!==m){let v=1-l;const g=c*f+u*p+d*m+h*y,_=g>=0?1:-1,x=1-g*g;if(x>Number.EPSILON){const S=Math.sqrt(x),T=Math.atan2(S,g*_);v=Math.sin(v*T)/S,l=Math.sin(l*T)/S}const b=l*_;if(c=c*v+f*b,u=u*v+p*b,d=d*v+m*b,h=h*v+y*b,v===1-l){const S=1/Math.sqrt(c*c+u*u+d*d+h*h);c*=S,u*=S,d*=S,h*=S}}e[n]=c,e[n+1]=u,e[n+2]=d,e[n+3]=h}static multiplyQuaternionsFlat(e,n,r,s,o,a){const l=r[s],c=r[s+1],u=r[s+2],d=r[s+3],h=o[a],f=o[a+1],p=o[a+2],m=o[a+3];return e[n]=l*m+d*h+c*p-u*f,e[n+1]=c*m+d*f+u*h-l*p,e[n+2]=u*m+d*p+l*f-c*h,e[n+3]=d*m-l*h-c*f-u*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,s){return this._x=e,this._y=n,this._z=r,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const r=e._x,s=e._y,o=e._z,a=e._order,l=Math.cos,c=Math.sin,u=l(r/2),d=l(s/2),h=l(o/2),f=c(r/2),p=c(s/2),m=c(o/2);switch(a){case"XYZ":this._x=f*d*h+u*p*m,this._y=u*p*h-f*d*m,this._z=u*d*m+f*p*h,this._w=u*d*h-f*p*m;break;case"YXZ":this._x=f*d*h+u*p*m,this._y=u*p*h-f*d*m,this._z=u*d*m-f*p*h,this._w=u*d*h+f*p*m;break;case"ZXY":this._x=f*d*h-u*p*m,this._y=u*p*h+f*d*m,this._z=u*d*m+f*p*h,this._w=u*d*h-f*p*m;break;case"ZYX":this._x=f*d*h-u*p*m,this._y=u*p*h+f*d*m,this._z=u*d*m-f*p*h,this._w=u*d*h+f*p*m;break;case"YZX":this._x=f*d*h+u*p*m,this._y=u*p*h+f*d*m,this._z=u*d*m-f*p*h,this._w=u*d*h-f*p*m;break;case"XZY":this._x=f*d*h-u*p*m,this._y=u*p*h-f*d*m,this._z=u*d*m+f*p*h,this._w=u*d*h+f*p*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,s=Math.sin(r);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],s=n[4],o=n[8],a=n[1],l=n[5],c=n[9],u=n[2],d=n[6],h=n[10],f=r+l+h;if(f>0){const p=.5/Math.sqrt(f+1);this._w=.25/p,this._x=(d-c)*p,this._y=(o-u)*p,this._z=(a-s)*p}else if(r>l&&r>h){const p=2*Math.sqrt(1+r-l-h);this._w=(d-c)/p,this._x=.25*p,this._y=(s+a)/p,this._z=(o+u)/p}else if(l>h){const p=2*Math.sqrt(1+l-r-h);this._w=(o-u)/p,this._x=(s+a)/p,this._y=.25*p,this._z=(c+d)/p}else{const p=2*Math.sqrt(1+h-r-l);this._w=(a-s)/p,this._x=(o+u)/p,this._y=(c+d)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Yt(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const s=Math.min(1,n/r);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,s=e._y,o=e._z,a=e._w,l=n._x,c=n._y,u=n._z,d=n._w;return this._x=r*d+a*l+s*u-o*c,this._y=s*d+a*c+o*l-r*u,this._z=o*d+a*u+r*c-s*l,this._w=a*d-r*l-s*c-o*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,s=this._y,o=this._z,a=this._w;let l=a*e._w+r*e._x+s*e._y+o*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=a,this._x=r,this._y=s,this._z=o,this;const c=1-l*l;if(c<=Number.EPSILON){const p=1-n;return this._w=p*a+n*this._w,this._x=p*r+n*this._x,this._y=p*s+n*this._y,this._z=p*o+n*this._z,this.normalize(),this}const u=Math.sqrt(c),d=Math.atan2(u,l),h=Math.sin((1-n)*d)/u,f=Math.sin(n*d)/u;return this._w=a*h+this._w*f,this._x=r*h+this._x*f,this._y=s*h+this._y*f,this._z=o*h+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),r=Math.random(),s=Math.sqrt(1-r),o=Math.sqrt(r);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(n),o*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class K{constructor(e=0,n=0,r=0){K.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(RO.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(RO.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[3]*r+o[6]*s,this.y=o[1]*n+o[4]*r+o[7]*s,this.z=o[2]*n+o[5]*r+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,s=this.z,o=e.elements,a=1/(o[3]*n+o[7]*r+o[11]*s+o[15]);return this.x=(o[0]*n+o[4]*r+o[8]*s+o[12])*a,this.y=(o[1]*n+o[5]*r+o[9]*s+o[13])*a,this.z=(o[2]*n+o[6]*r+o[10]*s+o[14])*a,this}applyQuaternion(e){const n=this.x,r=this.y,s=this.z,o=e.x,a=e.y,l=e.z,c=e.w,u=2*(a*s-l*r),d=2*(l*n-o*s),h=2*(o*r-a*n);return this.x=n+c*u+a*h-l*d,this.y=r+c*d+l*u-o*h,this.z=s+c*h+o*d-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[4]*r+o[8]*s,this.y=o[1]*n+o[5]*r+o[9]*s,this.z=o[2]*n+o[6]*r+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Yt(this.x,e.x,n.x),this.y=Yt(this.y,e.y,n.y),this.z=Yt(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Yt(this.x,e,n),this.y=Yt(this.y,e,n),this.z=Yt(this.z,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Yt(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,s=e.y,o=e.z,a=n.x,l=n.y,c=n.z;return this.x=s*c-o*l,this.y=o*a-r*c,this.z=r*l-s*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return mE.copy(this).projectOnVector(e),this.sub(mE)}reflect(e){return this.sub(mE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Yt(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,s=this.z-e.z;return n*n+r*r+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const s=Math.sin(n)*e;return this.x=s*Math.sin(r),this.y=Math.cos(n)*e,this.z=s*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=s,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,r=Math.sqrt(1-n*n);return this.x=r*Math.cos(e),this.y=n,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const mE=new K,RO=new ga;class Kd{constructor(e=new K(1/0,1/0,1/0),n=new K(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(Wo.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(Wo.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=Wo.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const o=r.getAttribute("position");if(n===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let a=0,l=o.count;a<l;a++)e.isMesh===!0?e.getVertexPosition(a,Wo):Wo.fromBufferAttribute(o,a),Wo.applyMatrix4(e.matrixWorld),this.expandByPoint(Wo);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),lx.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),lx.copy(r.boundingBox)),lx.applyMatrix4(e.matrixWorld),this.union(lx)}const s=e.children;for(let o=0,a=s.length;o<a;o++)this.expandByObject(s[o],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Wo),Wo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Fm),cx.subVectors(this.max,Fm),Ch.subVectors(e.a,Fm),Rh.subVectors(e.b,Fm),Ph.subVectors(e.c,Fm),Ac.subVectors(Rh,Ch),Cc.subVectors(Ph,Rh),Uu.subVectors(Ch,Ph);let n=[0,-Ac.z,Ac.y,0,-Cc.z,Cc.y,0,-Uu.z,Uu.y,Ac.z,0,-Ac.x,Cc.z,0,-Cc.x,Uu.z,0,-Uu.x,-Ac.y,Ac.x,0,-Cc.y,Cc.x,0,-Uu.y,Uu.x,0];return!gE(n,Ch,Rh,Ph,cx)||(n=[1,0,0,0,1,0,0,0,1],!gE(n,Ch,Rh,Ph,cx))?!1:(ux.crossVectors(Ac,Cc),n=[ux.x,ux.y,ux.z],gE(n,Ch,Rh,Ph,cx))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Wo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Wo).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(hl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hl=[new K,new K,new K,new K,new K,new K,new K,new K],Wo=new K,lx=new Kd,Ch=new K,Rh=new K,Ph=new K,Ac=new K,Cc=new K,Uu=new K,Fm=new K,cx=new K,ux=new K,zu=new K;function gE(i,e,n,r,s){for(let o=0,a=i.length-3;o<=a;o+=3){zu.fromArray(i,o);const l=s.x*Math.abs(zu.x)+s.y*Math.abs(zu.y)+s.z*Math.abs(zu.z),c=e.dot(zu),u=n.dot(zu),d=r.dot(zu);if(Math.max(-Math.max(c,u,d),Math.min(c,u,d))>l)return!1}return!0}const Kue=new Kd,Bm=new K,yE=new K;class V0{constructor(e=new K,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):Kue.setFromPoints(e).getCenter(r);let s=0;for(let o=0,a=e.length;o<a;o++)s=Math.max(s,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Bm.subVectors(e,this.center);const n=Bm.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),s=(r-this.radius)*.5;this.center.addScaledVector(Bm,s/r),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(yE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Bm.copy(e.center).add(yE)),this.expandByPoint(Bm.copy(e.center).sub(yE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const fl=new K,vE=new K,dx=new K,Rc=new K,xE=new K,hx=new K,_E=new K;class tw{constructor(e=new K,n=new K(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,fl)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=fl.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(fl.copy(this.origin).addScaledVector(this.direction,n),fl.distanceToSquared(e))}distanceSqToSegment(e,n,r,s){vE.copy(e).add(n).multiplyScalar(.5),dx.copy(n).sub(e).normalize(),Rc.copy(this.origin).sub(vE);const o=e.distanceTo(n)*.5,a=-this.direction.dot(dx),l=Rc.dot(this.direction),c=-Rc.dot(dx),u=Rc.lengthSq(),d=Math.abs(1-a*a);let h,f,p,m;if(d>0)if(h=a*c-l,f=a*l-c,m=o*d,h>=0)if(f>=-m)if(f<=m){const y=1/d;h*=y,f*=y,p=h*(h+a*f+2*l)+f*(a*h+f+2*c)+u}else f=o,h=Math.max(0,-(a*f+l)),p=-h*h+f*(f+2*c)+u;else f=-o,h=Math.max(0,-(a*f+l)),p=-h*h+f*(f+2*c)+u;else f<=-m?(h=Math.max(0,-(-a*o+l)),f=h>0?-o:Math.min(Math.max(-o,-c),o),p=-h*h+f*(f+2*c)+u):f<=m?(h=0,f=Math.min(Math.max(-o,-c),o),p=f*(f+2*c)+u):(h=Math.max(0,-(a*o+l)),f=h>0?o:Math.min(Math.max(-o,-c),o),p=-h*h+f*(f+2*c)+u);else f=a>0?-o:o,h=Math.max(0,-(a*f+l)),p=-h*h+f*(f+2*c)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,h),s&&s.copy(vE).addScaledVector(dx,f),p}intersectSphere(e,n){fl.subVectors(e.center,this.origin);const r=fl.dot(this.direction),s=fl.dot(fl)-r*r,o=e.radius*e.radius;if(s>o)return null;const a=Math.sqrt(o-s),l=r-a,c=r+a;return c<0?null:l<0?this.at(c,n):this.at(l,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,s,o,a,l,c;const u=1/this.direction.x,d=1/this.direction.y,h=1/this.direction.z,f=this.origin;return u>=0?(r=(e.min.x-f.x)*u,s=(e.max.x-f.x)*u):(r=(e.max.x-f.x)*u,s=(e.min.x-f.x)*u),d>=0?(o=(e.min.y-f.y)*d,a=(e.max.y-f.y)*d):(o=(e.max.y-f.y)*d,a=(e.min.y-f.y)*d),r>a||o>s||((o>r||isNaN(r))&&(r=o),(a<s||isNaN(s))&&(s=a),h>=0?(l=(e.min.z-f.z)*h,c=(e.max.z-f.z)*h):(l=(e.max.z-f.z)*h,c=(e.min.z-f.z)*h),r>c||l>s)||((l>r||r!==r)&&(r=l),(c<s||s!==s)&&(s=c),s<0)?null:this.at(r>=0?r:s,n)}intersectsBox(e){return this.intersectBox(e,fl)!==null}intersectTriangle(e,n,r,s,o){xE.subVectors(n,e),hx.subVectors(r,e),_E.crossVectors(xE,hx);let a=this.direction.dot(_E),l;if(a>0){if(s)return null;l=1}else if(a<0)l=-1,a=-a;else return null;Rc.subVectors(this.origin,e);const c=l*this.direction.dot(hx.crossVectors(Rc,hx));if(c<0)return null;const u=l*this.direction.dot(xE.cross(Rc));if(u<0||c+u>a)return null;const d=-l*Rc.dot(_E);return d<0?null:this.at(d/a,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ln{constructor(e,n,r,s,o,a,l,c,u,d,h,f,p,m,y,v){ln.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,s,o,a,l,c,u,d,h,f,p,m,y,v)}set(e,n,r,s,o,a,l,c,u,d,h,f,p,m,y,v){const g=this.elements;return g[0]=e,g[4]=n,g[8]=r,g[12]=s,g[1]=o,g[5]=a,g[9]=l,g[13]=c,g[2]=u,g[6]=d,g[10]=h,g[14]=f,g[3]=p,g[7]=m,g[11]=y,g[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ln().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,s=1/Nh.setFromMatrixColumn(e,0).length(),o=1/Nh.setFromMatrixColumn(e,1).length(),a=1/Nh.setFromMatrixColumn(e,2).length();return n[0]=r[0]*s,n[1]=r[1]*s,n[2]=r[2]*s,n[3]=0,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[7]=0,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,s=e.y,o=e.z,a=Math.cos(r),l=Math.sin(r),c=Math.cos(s),u=Math.sin(s),d=Math.cos(o),h=Math.sin(o);if(e.order==="XYZ"){const f=a*d,p=a*h,m=l*d,y=l*h;n[0]=c*d,n[4]=-c*h,n[8]=u,n[1]=p+m*u,n[5]=f-y*u,n[9]=-l*c,n[2]=y-f*u,n[6]=m+p*u,n[10]=a*c}else if(e.order==="YXZ"){const f=c*d,p=c*h,m=u*d,y=u*h;n[0]=f+y*l,n[4]=m*l-p,n[8]=a*u,n[1]=a*h,n[5]=a*d,n[9]=-l,n[2]=p*l-m,n[6]=y+f*l,n[10]=a*c}else if(e.order==="ZXY"){const f=c*d,p=c*h,m=u*d,y=u*h;n[0]=f-y*l,n[4]=-a*h,n[8]=m+p*l,n[1]=p+m*l,n[5]=a*d,n[9]=y-f*l,n[2]=-a*u,n[6]=l,n[10]=a*c}else if(e.order==="ZYX"){const f=a*d,p=a*h,m=l*d,y=l*h;n[0]=c*d,n[4]=m*u-p,n[8]=f*u+y,n[1]=c*h,n[5]=y*u+f,n[9]=p*u-m,n[2]=-u,n[6]=l*c,n[10]=a*c}else if(e.order==="YZX"){const f=a*c,p=a*u,m=l*c,y=l*u;n[0]=c*d,n[4]=y-f*h,n[8]=m*h+p,n[1]=h,n[5]=a*d,n[9]=-l*d,n[2]=-u*d,n[6]=p*h+m,n[10]=f-y*h}else if(e.order==="XZY"){const f=a*c,p=a*u,m=l*c,y=l*u;n[0]=c*d,n[4]=-h,n[8]=u*d,n[1]=f*h+y,n[5]=a*d,n[9]=p*h-m,n[2]=m*h-p,n[6]=l*d,n[10]=y*h+f}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Yue,e,Zue)}lookAt(e,n,r){const s=this.elements;return Fs.subVectors(e,n),Fs.lengthSq()===0&&(Fs.z=1),Fs.normalize(),Pc.crossVectors(r,Fs),Pc.lengthSq()===0&&(Math.abs(r.z)===1?Fs.x+=1e-4:Fs.z+=1e-4,Fs.normalize(),Pc.crossVectors(r,Fs)),Pc.normalize(),fx.crossVectors(Fs,Pc),s[0]=Pc.x,s[4]=fx.x,s[8]=Fs.x,s[1]=Pc.y,s[5]=fx.y,s[9]=Fs.y,s[2]=Pc.z,s[6]=fx.z,s[10]=Fs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,s=n.elements,o=this.elements,a=r[0],l=r[4],c=r[8],u=r[12],d=r[1],h=r[5],f=r[9],p=r[13],m=r[2],y=r[6],v=r[10],g=r[14],_=r[3],x=r[7],b=r[11],S=r[15],T=s[0],w=s[4],E=s[8],A=s[12],M=s[1],R=s[5],F=s[9],B=s[13],C=s[2],L=s[6],P=s[10],W=s[14],D=s[3],X=s[7],q=s[11],J=s[15];return o[0]=a*T+l*M+c*C+u*D,o[4]=a*w+l*R+c*L+u*X,o[8]=a*E+l*F+c*P+u*q,o[12]=a*A+l*B+c*W+u*J,o[1]=d*T+h*M+f*C+p*D,o[5]=d*w+h*R+f*L+p*X,o[9]=d*E+h*F+f*P+p*q,o[13]=d*A+h*B+f*W+p*J,o[2]=m*T+y*M+v*C+g*D,o[6]=m*w+y*R+v*L+g*X,o[10]=m*E+y*F+v*P+g*q,o[14]=m*A+y*B+v*W+g*J,o[3]=_*T+x*M+b*C+S*D,o[7]=_*w+x*R+b*L+S*X,o[11]=_*E+x*F+b*P+S*q,o[15]=_*A+x*B+b*W+S*J,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],s=e[8],o=e[12],a=e[1],l=e[5],c=e[9],u=e[13],d=e[2],h=e[6],f=e[10],p=e[14],m=e[3],y=e[7],v=e[11],g=e[15];return m*(+o*c*h-s*u*h-o*l*f+r*u*f+s*l*p-r*c*p)+y*(+n*c*p-n*u*f+o*a*f-s*a*p+s*u*d-o*c*d)+v*(+n*u*h-n*l*p-o*a*h+r*a*p+o*l*d-r*u*d)+g*(-s*l*d-n*c*h+n*l*f+s*a*h-r*a*f+r*c*d)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=n,s[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],m=e[12],y=e[13],v=e[14],g=e[15],_=h*v*u-y*f*u+y*c*p-l*v*p-h*c*g+l*f*g,x=m*f*u-d*v*u-m*c*p+a*v*p+d*c*g-a*f*g,b=d*y*u-m*h*u+m*l*p-a*y*p-d*l*g+a*h*g,S=m*h*c-d*y*c-m*l*f+a*y*f+d*l*v-a*h*v,T=n*_+r*x+s*b+o*S;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/T;return e[0]=_*w,e[1]=(y*f*o-h*v*o-y*s*p+r*v*p+h*s*g-r*f*g)*w,e[2]=(l*v*o-y*c*o+y*s*u-r*v*u-l*s*g+r*c*g)*w,e[3]=(h*c*o-l*f*o-h*s*u+r*f*u+l*s*p-r*c*p)*w,e[4]=x*w,e[5]=(d*v*o-m*f*o+m*s*p-n*v*p-d*s*g+n*f*g)*w,e[6]=(m*c*o-a*v*o-m*s*u+n*v*u+a*s*g-n*c*g)*w,e[7]=(a*f*o-d*c*o+d*s*u-n*f*u-a*s*p+n*c*p)*w,e[8]=b*w,e[9]=(m*h*o-d*y*o-m*r*p+n*y*p+d*r*g-n*h*g)*w,e[10]=(a*y*o-m*l*o+m*r*u-n*y*u-a*r*g+n*l*g)*w,e[11]=(d*l*o-a*h*o-d*r*u+n*h*u+a*r*p-n*l*p)*w,e[12]=S*w,e[13]=(d*y*s-m*h*s+m*r*f-n*y*f-d*r*v+n*h*v)*w,e[14]=(m*l*s-a*y*s-m*r*c+n*y*c+a*r*v-n*l*v)*w,e[15]=(a*h*s-d*l*s+d*r*c-n*h*c-a*r*f+n*l*f)*w,this}scale(e){const n=this.elements,r=e.x,s=e.y,o=e.z;return n[0]*=r,n[4]*=s,n[8]*=o,n[1]*=r,n[5]*=s,n[9]*=o,n[2]*=r,n[6]*=s,n[10]*=o,n[3]*=r,n[7]*=s,n[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,s))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),s=Math.sin(n),o=1-r,a=e.x,l=e.y,c=e.z,u=o*a,d=o*l;return this.set(u*a+r,u*l-s*c,u*c+s*l,0,u*l+s*c,d*l+r,d*c-s*a,0,u*c-s*l,d*c+s*a,o*c*c+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,s,o,a){return this.set(1,r,o,0,e,1,a,0,n,s,1,0,0,0,0,1),this}compose(e,n,r){const s=this.elements,o=n._x,a=n._y,l=n._z,c=n._w,u=o+o,d=a+a,h=l+l,f=o*u,p=o*d,m=o*h,y=a*d,v=a*h,g=l*h,_=c*u,x=c*d,b=c*h,S=r.x,T=r.y,w=r.z;return s[0]=(1-(y+g))*S,s[1]=(p+b)*S,s[2]=(m-x)*S,s[3]=0,s[4]=(p-b)*T,s[5]=(1-(f+g))*T,s[6]=(v+_)*T,s[7]=0,s[8]=(m+x)*w,s[9]=(v-_)*w,s[10]=(1-(f+y))*w,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,n,r){const s=this.elements;let o=Nh.set(s[0],s[1],s[2]).length();const a=Nh.set(s[4],s[5],s[6]).length(),l=Nh.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],jo.copy(this);const u=1/o,d=1/a,h=1/l;return jo.elements[0]*=u,jo.elements[1]*=u,jo.elements[2]*=u,jo.elements[4]*=d,jo.elements[5]*=d,jo.elements[6]*=d,jo.elements[8]*=h,jo.elements[9]*=h,jo.elements[10]*=h,n.setFromRotationMatrix(jo),r.x=o,r.y=a,r.z=l,this}makePerspective(e,n,r,s,o,a,l=is){const c=this.elements,u=2*o/(n-e),d=2*o/(r-s),h=(n+e)/(n-e),f=(r+s)/(r-s);let p,m;if(l===is)p=-(a+o)/(a-o),m=-2*a*o/(a-o);else if(l===mu)p=-a/(a-o),m=-a*o/(a-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return c[0]=u,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=d,c[9]=f,c[13]=0,c[2]=0,c[6]=0,c[10]=p,c[14]=m,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,r,s,o,a,l=is){const c=this.elements,u=1/(n-e),d=1/(r-s),h=1/(a-o),f=(n+e)*u,p=(r+s)*d;let m,y;if(l===is)m=(a+o)*h,y=-2*h;else if(l===mu)m=o*h,y=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return c[0]=2*u,c[4]=0,c[8]=0,c[12]=-f,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-p,c[2]=0,c[6]=0,c[10]=y,c[14]=-m,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let s=0;s<16;s++)if(n[s]!==r[s])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const Nh=new K,jo=new ln,Yue=new K(0,0,0),Zue=new K(1,1,1),Pc=new K,fx=new K,Fs=new K,PO=new ln,NO=new ga;class ks{constructor(e=0,n=0,r=0,s=ks.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,s=this._order){return this._x=e,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const s=e.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],d=s[9],h=s[2],f=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(Yt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Yt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Yt(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Yt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Yt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-Yt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return PO.makeRotationFromQuaternion(e),this.setFromRotationMatrix(PO,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return NO.setFromEuler(this),this.setFromQuaternion(NO,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ks.DEFAULT_ORDER="XYZ";class e2{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Que=0;const kO=new K,kh=new ga,pl=new ln,px=new K,Um=new K,Jue=new K,ede=new ga,LO=new K(1,0,0),IO=new K(0,1,0),DO=new K(0,0,1),OO={type:"added"},tde={type:"removed"},Lh={type:"childadded",child:null},bE={type:"childremoved",child:null};class xi extends dc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Que++}),this.uuid=Gl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=xi.DEFAULT_UP.clone();const e=new K,n=new ks,r=new ga,s=new K(1,1,1);function o(){r.setFromEuler(n,!1)}function a(){n.setFromQuaternion(r,void 0,!1)}n._onChange(o),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new ln},normalMatrix:{value:new Vt}}),this.matrix=new ln,this.matrixWorld=new ln,this.matrixAutoUpdate=xi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=xi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new e2,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return kh.setFromAxisAngle(e,n),this.quaternion.multiply(kh),this}rotateOnWorldAxis(e,n){return kh.setFromAxisAngle(e,n),this.quaternion.premultiply(kh),this}rotateX(e){return this.rotateOnAxis(LO,e)}rotateY(e){return this.rotateOnAxis(IO,e)}rotateZ(e){return this.rotateOnAxis(DO,e)}translateOnAxis(e,n){return kO.copy(e).applyQuaternion(this.quaternion),this.position.add(kO.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(LO,e)}translateY(e){return this.translateOnAxis(IO,e)}translateZ(e){return this.translateOnAxis(DO,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(pl.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?px.copy(e):px.set(e,n,r);const s=this.parent;this.updateWorldMatrix(!0,!1),Um.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?pl.lookAt(Um,px,this.up):pl.lookAt(px,Um,this.up),this.quaternion.setFromRotationMatrix(pl),s&&(pl.extractRotation(s.matrixWorld),kh.setFromRotationMatrix(pl),this.quaternion.premultiply(kh.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(OO),Lh.child=e,this.dispatchEvent(Lh),Lh.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(tde),bE.child=e,this.dispatchEvent(bE),bE.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),pl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),pl.multiply(e.parent.matrixWorld)),e.applyMatrix4(pl),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(OO),Lh.child=e,this.dispatchEvent(Lh),Lh.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,r=[]){this[e]===n&&r.push(this);const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(e,n,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Um,e,Jue),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Um,ede,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].updateMatrixWorld(e)}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(l=>({...l,boundingBox:l.boundingBox?{min:l.boundingBox.min.toArray(),max:l.boundingBox.max.toArray()}:void 0,boundingSphere:l.boundingSphere?{radius:l.boundingSphere.radius,center:l.boundingSphere.center.toArray()}:void 0})),s.instanceInfo=this._instanceInfo.map(l=>({...l})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function o(l,c){return l[c.uuid]===void 0&&(l[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const c=l.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++){const h=c[u];o(e.shapes,h)}else o(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(e.materials,this.material[c]));s.material=l}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++){const c=this.animations[l];s.animations.push(o(e.animations,c))}}if(n){const l=a(e.geometries),c=a(e.materials),u=a(e.textures),d=a(e.images),h=a(e.shapes),f=a(e.skeletons),p=a(e.animations),m=a(e.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),m.length>0&&(r.nodes=m)}return r.object=s,r;function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const s=e.children[r];this.add(s.clone())}return this}}xi.DEFAULT_UP=new K(0,1,0);xi.DEFAULT_MATRIX_AUTO_UPDATE=!0;xi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const qo=new K,ml=new K,SE=new K,gl=new K,Ih=new K,Dh=new K,FO=new K,wE=new K,TE=new K,EE=new K,ME=new Dt,AE=new Dt,CE=new Dt;class To{constructor(e=new K,n=new K,r=new K){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,s){s.subVectors(r,n),qo.subVectors(e,n),s.cross(qo);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,n,r,s,o){qo.subVectors(s,n),ml.subVectors(r,n),SE.subVectors(e,n);const a=qo.dot(qo),l=qo.dot(ml),c=qo.dot(SE),u=ml.dot(ml),d=ml.dot(SE),h=a*u-l*l;if(h===0)return o.set(0,0,0),null;const f=1/h,p=(u*c-l*d)*f,m=(a*d-l*c)*f;return o.set(1-p-m,m,p)}static containsPoint(e,n,r,s){return this.getBarycoord(e,n,r,s,gl)===null?!1:gl.x>=0&&gl.y>=0&&gl.x+gl.y<=1}static getInterpolation(e,n,r,s,o,a,l,c){return this.getBarycoord(e,n,r,s,gl)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,gl.x),c.addScaledVector(a,gl.y),c.addScaledVector(l,gl.z),c)}static getInterpolatedAttribute(e,n,r,s,o,a){return ME.setScalar(0),AE.setScalar(0),CE.setScalar(0),ME.fromBufferAttribute(e,n),AE.fromBufferAttribute(e,r),CE.fromBufferAttribute(e,s),a.setScalar(0),a.addScaledVector(ME,o.x),a.addScaledVector(AE,o.y),a.addScaledVector(CE,o.z),a}static isFrontFacing(e,n,r,s){return qo.subVectors(r,n),ml.subVectors(e,n),qo.cross(ml).dot(s)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,s){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,n,r,s){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return qo.subVectors(this.c,this.b),ml.subVectors(this.a,this.b),qo.cross(ml).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return To.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return To.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,r,s,o){return To.getInterpolation(e,this.a,this.b,this.c,n,r,s,o)}containsPoint(e){return To.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return To.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,s=this.b,o=this.c;let a,l;Ih.subVectors(s,r),Dh.subVectors(o,r),wE.subVectors(e,r);const c=Ih.dot(wE),u=Dh.dot(wE);if(c<=0&&u<=0)return n.copy(r);TE.subVectors(e,s);const d=Ih.dot(TE),h=Dh.dot(TE);if(d>=0&&h<=d)return n.copy(s);const f=c*h-d*u;if(f<=0&&c>=0&&d<=0)return a=c/(c-d),n.copy(r).addScaledVector(Ih,a);EE.subVectors(e,o);const p=Ih.dot(EE),m=Dh.dot(EE);if(m>=0&&p<=m)return n.copy(o);const y=p*u-c*m;if(y<=0&&u>=0&&m<=0)return l=u/(u-m),n.copy(r).addScaledVector(Dh,l);const v=d*m-p*h;if(v<=0&&h-d>=0&&p-m>=0)return FO.subVectors(o,s),l=(h-d)/(h-d+(p-m)),n.copy(s).addScaledVector(FO,l);const g=1/(v+y+f);return a=y*g,l=f*g,n.copy(r).addScaledVector(Ih,a).addScaledVector(Dh,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Q$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Nc={h:0,s:0,l:0},mx={h:0,s:0,l:0};function RE(i,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?i+(e-i)*6*n:n<1/2?e:n<2/3?i+(e-i)*6*(2/3-n):i}let St=class{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Et){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,rn.toWorkingColorSpace(this,n),this}setRGB(e,n,r,s=rn.workingColorSpace){return this.r=e,this.g=n,this.b=r,rn.toWorkingColorSpace(this,s),this}setHSL(e,n,r,s=rn.workingColorSpace){if(e=ZN(e,1),n=Yt(n,0,1),r=Yt(r,0,1),n===0)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;this.r=RE(a,o,e+1/3),this.g=RE(a,o,e),this.b=RE(a,o,e-1/3)}return rn.toWorkingColorSpace(this,s),this}setStyle(e,n=Et){function r(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=s[1],l=s[2];switch(a){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,n);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,n);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=s[1],a=o.length;if(a===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(o,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Et){const r=Q$[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Hl(e.r),this.g=Hl(e.g),this.b=Hl(e.b),this}copyLinearToSRGB(e){return this.r=Gf(e.r),this.g=Gf(e.g),this.b=Gf(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Et){return rn.fromWorkingColorSpace(kr.copy(this),e),Math.round(Yt(kr.r*255,0,255))*65536+Math.round(Yt(kr.g*255,0,255))*256+Math.round(Yt(kr.b*255,0,255))}getHexString(e=Et){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=rn.workingColorSpace){rn.fromWorkingColorSpace(kr.copy(this),n);const r=kr.r,s=kr.g,o=kr.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,u;const d=(l+a)/2;if(l===a)c=0,u=0;else{const h=a-l;switch(u=d<=.5?h/(a+l):h/(2-a-l),a){case r:c=(s-o)/h+(s<o?6:0);break;case s:c=(o-r)/h+2;break;case o:c=(r-s)/h+4;break}c/=6}return e.h=c,e.s=u,e.l=d,e}getRGB(e,n=rn.workingColorSpace){return rn.fromWorkingColorSpace(kr.copy(this),n),e.r=kr.r,e.g=kr.g,e.b=kr.b,e}getStyle(e=Et){rn.fromWorkingColorSpace(kr.copy(this),e);const n=kr.r,r=kr.g,s=kr.b;return e!==Et?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(s*255)})`}offsetHSL(e,n,r){return this.getHSL(Nc),this.setHSL(Nc.h+e,Nc.s+n,Nc.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(Nc),e.getHSL(mx);const r=Xg(Nc.h,mx.h,n),s=Xg(Nc.s,mx.s,n),o=Xg(Nc.l,mx.l,n);return this.setHSL(r,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,s=this.b,o=e.elements;return this.r=o[0]*n+o[3]*r+o[6]*s,this.g=o[1]*n+o[4]*r+o[7]*s,this.b=o[2]*n+o[5]*r+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const kr=new St;St.NAMES=Q$;let nde=0;class $r extends dc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:nde++}),this.uuid=Gl(),this.name="",this.type="Material",this.blending=eo,this.side=Cs,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=zy,this.blendDst=Vy,this.blendEquation=Ur,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new St(0,0,0),this.blendAlpha=0,this.depthFunc=pu,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=BC,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=td,this.stencilZFail=td,this.stencilZPass=td,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const s=this[n];if(s===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==eo&&(r.blending=this.blending),this.side!==Cs&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==zy&&(r.blendSrc=this.blendSrc),this.blendDst!==Vy&&(r.blendDst=this.blendDst),this.blendEquation!==Ur&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==pu&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==BC&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==td&&(r.stencilFail=this.stencilFail),this.stencilZFail!==td&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==td&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function s(o){const a=[];for(const l in o){const c=o[l];delete c.metadata,a.push(c)}return a}if(n){const o=s(e.textures),a=s(e.images);o.length>0&&(r.textures=o),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const s=n.length;r=new Array(s);for(let o=0;o!==s;++o)r[o]=n[o].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class es extends $r{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ks,this.combine=B0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Cl=ide();function ide(){const i=new ArrayBuffer(4),e=new Float32Array(i),n=new Uint32Array(i),r=new Uint32Array(512),s=new Uint32Array(512);for(let c=0;c<256;++c){const u=c-127;u<-27?(r[c]=0,r[c|256]=32768,s[c]=24,s[c|256]=24):u<-14?(r[c]=1024>>-u-14,r[c|256]=1024>>-u-14|32768,s[c]=-u-1,s[c|256]=-u-1):u<=15?(r[c]=u+15<<10,r[c|256]=u+15<<10|32768,s[c]=13,s[c|256]=13):u<128?(r[c]=31744,r[c|256]=64512,s[c]=24,s[c|256]=24):(r[c]=31744,r[c|256]=64512,s[c]=13,s[c|256]=13)}const o=new Uint32Array(2048),a=new Uint32Array(64),l=new Uint32Array(64);for(let c=1;c<1024;++c){let u=c<<13,d=0;for(;!(u&8388608);)u<<=1,d-=8388608;u&=-8388609,d+=947912704,o[c]=u|d}for(let c=1024;c<2048;++c)o[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)a[c]=c<<23;a[31]=1199570944,a[32]=2147483648;for(let c=33;c<63;++c)a[c]=2147483648+(c-32<<23);a[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(l[c]=1024);return{floatView:e,uint32View:n,baseTable:r,shiftTable:s,mantissaTable:o,exponentTable:a,offsetTable:l}}function Bs(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=Yt(i,-65504,65504),Cl.floatView[0]=i;const e=Cl.uint32View[0],n=e>>23&511;return Cl.baseTable[n]+((e&8388607)>>Cl.shiftTable[n])}function gx(i){const e=i>>10;return Cl.uint32View[0]=Cl.mantissaTable[Cl.offsetTable[e]+(i&1023)]+Cl.exponentTable[e],Cl.floatView[0]}const Ni=new K,yx=new Oe;let rde=0;class Yi{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:rde++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=Jb,this.updateRanges=[],this.gpuType=wi,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=n.array[r+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)yx.fromBufferAttribute(this,n),yx.applyMatrix3(e),this.setXY(n,yx.x,yx.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)Ni.fromBufferAttribute(this,n),Ni.applyMatrix3(e),this.setXYZ(n,Ni.x,Ni.y,Ni.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)Ni.fromBufferAttribute(this,n),Ni.applyMatrix4(e),this.setXYZ(n,Ni.x,Ni.y,Ni.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)Ni.fromBufferAttribute(this,n),Ni.applyNormalMatrix(e),this.setXYZ(n,Ni.x,Ni.y,Ni.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)Ni.fromBufferAttribute(this,n),Ni.transformDirection(e),this.setXYZ(n,Ni.x,Ni.y,Ni.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let r=this.array[e*this.itemSize+n];return this.normalized&&(r=Jr(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=Xt(r,this.array)),this.array[e*this.itemSize+n]=r,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Jr(n,this.array)),n}setX(e,n){return this.normalized&&(n=Xt(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Jr(n,this.array)),n}setY(e,n){return this.normalized&&(n=Xt(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Jr(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Xt(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Jr(n,this.array)),n}setW(e,n){return this.normalized&&(n=Xt(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Xt(n,this.array),r=Xt(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,s){return e*=this.itemSize,this.normalized&&(n=Xt(n,this.array),r=Xt(r,this.array),s=Xt(s,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=s,this}setXYZW(e,n,r,s,o){return e*=this.itemSize,this.normalized&&(n=Xt(n,this.array),r=Xt(r,this.array),s=Xt(s,this.array),o=Xt(o,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Jb&&(e.usage=this.usage),e}}class t2 extends Yi{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class n2 extends Yi{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class J$ extends Yi{constructor(e,n,r){super(new Uint16Array(e),n,r),this.isFloat16BufferAttribute=!0}getX(e){let n=gx(this.array[e*this.itemSize]);return this.normalized&&(n=Jr(n,this.array)),n}setX(e,n){return this.normalized&&(n=Xt(n,this.array)),this.array[e*this.itemSize]=Bs(n),this}getY(e){let n=gx(this.array[e*this.itemSize+1]);return this.normalized&&(n=Jr(n,this.array)),n}setY(e,n){return this.normalized&&(n=Xt(n,this.array)),this.array[e*this.itemSize+1]=Bs(n),this}getZ(e){let n=gx(this.array[e*this.itemSize+2]);return this.normalized&&(n=Jr(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Xt(n,this.array)),this.array[e*this.itemSize+2]=Bs(n),this}getW(e){let n=gx(this.array[e*this.itemSize+3]);return this.normalized&&(n=Jr(n,this.array)),n}setW(e,n){return this.normalized&&(n=Xt(n,this.array)),this.array[e*this.itemSize+3]=Bs(n),this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Xt(n,this.array),r=Xt(r,this.array)),this.array[e+0]=Bs(n),this.array[e+1]=Bs(r),this}setXYZ(e,n,r,s){return e*=this.itemSize,this.normalized&&(n=Xt(n,this.array),r=Xt(r,this.array),s=Xt(s,this.array)),this.array[e+0]=Bs(n),this.array[e+1]=Bs(r),this.array[e+2]=Bs(s),this}setXYZW(e,n,r,s,o){return e*=this.itemSize,this.normalized&&(n=Xt(n,this.array),r=Xt(r,this.array),s=Xt(s,this.array),o=Xt(o,this.array)),this.array[e+0]=Bs(n),this.array[e+1]=Bs(r),this.array[e+2]=Bs(s),this.array[e+3]=Bs(o),this}}class Ti extends Yi{constructor(e,n,r){super(new Float32Array(e),n,r)}}let sde=0;const fo=new ln,PE=new xi,Oh=new K,Us=new Kd,zm=new Kd,ir=new K;class Tr extends dc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:sde++}),this.uuid=Gl(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(QN(e)?n2:t2)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const o=new Vt().getNormalMatrix(e);r.applyNormalMatrix(o),r.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return fo.makeRotationFromQuaternion(e),this.applyMatrix4(fo),this}rotateX(e){return fo.makeRotationX(e),this.applyMatrix4(fo),this}rotateY(e){return fo.makeRotationY(e),this.applyMatrix4(fo),this}rotateZ(e){return fo.makeRotationZ(e),this.applyMatrix4(fo),this}translate(e,n,r){return fo.makeTranslation(e,n,r),this.applyMatrix4(fo),this}scale(e,n,r){return fo.makeScale(e,n,r),this.applyMatrix4(fo),this}lookAt(e){return PE.lookAt(e),PE.updateMatrix(),this.applyMatrix4(PE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Oh).negate(),this.translate(Oh.x,Oh.y,Oh.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s];r.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Ti(r,3))}else{const r=Math.min(e.length,n.count);for(let s=0;s<r;s++){const o=e[s];n.setXYZ(s,o.x,o.y,o.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Kd);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new K(-1/0,-1/0,-1/0),new K(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,s=n.length;r<s;r++){const o=n[r];Us.setFromBufferAttribute(o),this.morphTargetsRelative?(ir.addVectors(this.boundingBox.min,Us.min),this.boundingBox.expandByPoint(ir),ir.addVectors(this.boundingBox.max,Us.max),this.boundingBox.expandByPoint(ir)):(this.boundingBox.expandByPoint(Us.min),this.boundingBox.expandByPoint(Us.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new V0);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new K,1/0);return}if(e){const r=this.boundingSphere.center;if(Us.setFromBufferAttribute(e),n)for(let o=0,a=n.length;o<a;o++){const l=n[o];zm.setFromBufferAttribute(l),this.morphTargetsRelative?(ir.addVectors(Us.min,zm.min),Us.expandByPoint(ir),ir.addVectors(Us.max,zm.max),Us.expandByPoint(ir)):(Us.expandByPoint(zm.min),Us.expandByPoint(zm.max))}Us.getCenter(r);let s=0;for(let o=0,a=e.count;o<a;o++)ir.fromBufferAttribute(e,o),s=Math.max(s,r.distanceToSquared(ir));if(n)for(let o=0,a=n.length;o<a;o++){const l=n[o],c=this.morphTargetsRelative;for(let u=0,d=l.count;u<d;u++)ir.fromBufferAttribute(l,u),c&&(Oh.fromBufferAttribute(e,u),ir.add(Oh)),s=Math.max(s,r.distanceToSquared(ir))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=n.position,s=n.normal,o=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Yi(new Float32Array(4*r.count),4));const a=this.getAttribute("tangent"),l=[],c=[];for(let E=0;E<r.count;E++)l[E]=new K,c[E]=new K;const u=new K,d=new K,h=new K,f=new Oe,p=new Oe,m=new Oe,y=new K,v=new K;function g(E,A,M){u.fromBufferAttribute(r,E),d.fromBufferAttribute(r,A),h.fromBufferAttribute(r,M),f.fromBufferAttribute(o,E),p.fromBufferAttribute(o,A),m.fromBufferAttribute(o,M),d.sub(u),h.sub(u),p.sub(f),m.sub(f);const R=1/(p.x*m.y-m.x*p.y);isFinite(R)&&(y.copy(d).multiplyScalar(m.y).addScaledVector(h,-p.y).multiplyScalar(R),v.copy(h).multiplyScalar(p.x).addScaledVector(d,-m.x).multiplyScalar(R),l[E].add(y),l[A].add(y),l[M].add(y),c[E].add(v),c[A].add(v),c[M].add(v))}let _=this.groups;_.length===0&&(_=[{start:0,count:e.count}]);for(let E=0,A=_.length;E<A;++E){const M=_[E],R=M.start,F=M.count;for(let B=R,C=R+F;B<C;B+=3)g(e.getX(B+0),e.getX(B+1),e.getX(B+2))}const x=new K,b=new K,S=new K,T=new K;function w(E){S.fromBufferAttribute(s,E),T.copy(S);const A=l[E];x.copy(A),x.sub(S.multiplyScalar(S.dot(A))).normalize(),b.crossVectors(T,A);const R=b.dot(c[E])<0?-1:1;a.setXYZW(E,x.x,x.y,x.z,R)}for(let E=0,A=_.length;E<A;++E){const M=_[E],R=M.start,F=M.count;for(let B=R,C=R+F;B<C;B+=3)w(e.getX(B+0)),w(e.getX(B+1)),w(e.getX(B+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Yi(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let f=0,p=r.count;f<p;f++)r.setXYZ(f,0,0,0);const s=new K,o=new K,a=new K,l=new K,c=new K,u=new K,d=new K,h=new K;if(e)for(let f=0,p=e.count;f<p;f+=3){const m=e.getX(f+0),y=e.getX(f+1),v=e.getX(f+2);s.fromBufferAttribute(n,m),o.fromBufferAttribute(n,y),a.fromBufferAttribute(n,v),d.subVectors(a,o),h.subVectors(s,o),d.cross(h),l.fromBufferAttribute(r,m),c.fromBufferAttribute(r,y),u.fromBufferAttribute(r,v),l.add(d),c.add(d),u.add(d),r.setXYZ(m,l.x,l.y,l.z),r.setXYZ(y,c.x,c.y,c.z),r.setXYZ(v,u.x,u.y,u.z)}else for(let f=0,p=n.count;f<p;f+=3)s.fromBufferAttribute(n,f+0),o.fromBufferAttribute(n,f+1),a.fromBufferAttribute(n,f+2),d.subVectors(a,o),h.subVectors(s,o),d.cross(h),r.setXYZ(f+0,d.x,d.y,d.z),r.setXYZ(f+1,d.x,d.y,d.z),r.setXYZ(f+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)ir.fromBufferAttribute(e,n),ir.normalize(),e.setXYZ(n,ir.x,ir.y,ir.z)}toNonIndexed(){function e(l,c){const u=l.array,d=l.itemSize,h=l.normalized,f=new u.constructor(c.length*d);let p=0,m=0;for(let y=0,v=c.length;y<v;y++){l.isInterleavedBufferAttribute?p=c[y]*l.data.stride+l.offset:p=c[y]*d;for(let g=0;g<d;g++)f[m++]=u[p++]}return new Yi(f,d,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Tr,r=this.index.array,s=this.attributes;for(const l in s){const c=s[l],u=e(c,r);n.setAttribute(l,u)}const o=this.morphAttributes;for(const l in o){const c=[],u=o[l];for(let d=0,h=u.length;d<h;d++){const f=u[d],p=e(f,r);c.push(p)}n.morphAttributes[l]=c}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,c=a.length;l<c;l++){const u=a[l];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const u in c)c[u]!==void 0&&(e[u]=c[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const c in r){const u=r[c];e.data.attributes[c]=u.toJSON(e.data)}const s={};let o=!1;for(const c in this.morphAttributes){const u=this.morphAttributes[c],d=[];for(let h=0,f=u.length;h<f;h++){const p=u[h];d.push(p.toJSON(e.data))}d.length>0&&(s[c]=d,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const s=e.attributes;for(const u in s){const d=s[u];this.setAttribute(u,d.clone(n))}const o=e.morphAttributes;for(const u in o){const d=[],h=o[u];for(let f=0,p=h.length;f<p;f++)d.push(h[f].clone(n));this.morphAttributes[u]=d}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,d=a.length;u<d;u++){const h=a[u];this.addGroup(h.start,h.count,h.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const BO=new ln,Vu=new tw,vx=new V0,UO=new K,xx=new K,_x=new K,bx=new K,NE=new K,Sx=new K,zO=new K,wx=new K;class Xn extends xi{constructor(e=new Tr,n=new es){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const s=n[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}getVertexPosition(e,n){const r=this.geometry,s=r.attributes.position,o=r.morphAttributes.position,a=r.morphTargetsRelative;n.fromBufferAttribute(s,e);const l=this.morphTargetInfluences;if(o&&l){Sx.set(0,0,0);for(let c=0,u=o.length;c<u;c++){const d=l[c],h=o[c];d!==0&&(NE.fromBufferAttribute(h,e),a?Sx.addScaledVector(NE,d):Sx.addScaledVector(NE.sub(n),d))}n.add(Sx)}return n}raycast(e,n){const r=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),vx.copy(r.boundingSphere),vx.applyMatrix4(o),Vu.copy(e.ray).recast(e.near),!(vx.containsPoint(Vu.origin)===!1&&(Vu.intersectSphere(vx,UO)===null||Vu.origin.distanceToSquared(UO)>(e.far-e.near)**2))&&(BO.copy(o).invert(),Vu.copy(e.ray).applyMatrix4(BO),!(r.boundingBox!==null&&Vu.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,Vu)))}_computeIntersections(e,n,r){let s;const o=this.geometry,a=this.material,l=o.index,c=o.attributes.position,u=o.attributes.uv,d=o.attributes.uv1,h=o.attributes.normal,f=o.groups,p=o.drawRange;if(l!==null)if(Array.isArray(a))for(let m=0,y=f.length;m<y;m++){const v=f[m],g=a[v.materialIndex],_=Math.max(v.start,p.start),x=Math.min(l.count,Math.min(v.start+v.count,p.start+p.count));for(let b=_,S=x;b<S;b+=3){const T=l.getX(b),w=l.getX(b+1),E=l.getX(b+2);s=Tx(this,g,e,r,u,d,h,T,w,E),s&&(s.faceIndex=Math.floor(b/3),s.face.materialIndex=v.materialIndex,n.push(s))}}else{const m=Math.max(0,p.start),y=Math.min(l.count,p.start+p.count);for(let v=m,g=y;v<g;v+=3){const _=l.getX(v),x=l.getX(v+1),b=l.getX(v+2);s=Tx(this,a,e,r,u,d,h,_,x,b),s&&(s.faceIndex=Math.floor(v/3),n.push(s))}}else if(c!==void 0)if(Array.isArray(a))for(let m=0,y=f.length;m<y;m++){const v=f[m],g=a[v.materialIndex],_=Math.max(v.start,p.start),x=Math.min(c.count,Math.min(v.start+v.count,p.start+p.count));for(let b=_,S=x;b<S;b+=3){const T=b,w=b+1,E=b+2;s=Tx(this,g,e,r,u,d,h,T,w,E),s&&(s.faceIndex=Math.floor(b/3),s.face.materialIndex=v.materialIndex,n.push(s))}}else{const m=Math.max(0,p.start),y=Math.min(c.count,p.start+p.count);for(let v=m,g=y;v<g;v+=3){const _=v,x=v+1,b=v+2;s=Tx(this,a,e,r,u,d,h,_,x,b),s&&(s.faceIndex=Math.floor(v/3),n.push(s))}}}}function ode(i,e,n,r,s,o,a,l){let c;if(e.side===On?c=r.intersectTriangle(a,o,s,!0,l):c=r.intersectTriangle(s,o,a,e.side===Cs,l),c===null)return null;wx.copy(l),wx.applyMatrix4(i.matrixWorld);const u=n.ray.origin.distanceTo(wx);return u<n.near||u>n.far?null:{distance:u,point:wx.clone(),object:i}}function Tx(i,e,n,r,s,o,a,l,c,u){i.getVertexPosition(l,xx),i.getVertexPosition(c,_x),i.getVertexPosition(u,bx);const d=ode(i,e,n,r,xx,_x,bx,zO);if(d){const h=new K;To.getBarycoord(zO,xx,_x,bx,h),s&&(d.uv=To.getInterpolatedAttribute(s,l,c,u,h,new Oe)),o&&(d.uv1=To.getInterpolatedAttribute(o,l,c,u,h,new Oe)),a&&(d.normal=To.getInterpolatedAttribute(a,l,c,u,h,new K),d.normal.dot(r.direction)>0&&d.normal.multiplyScalar(-1));const f={a:l,b:c,c:u,normal:new K,materialIndex:0};To.getNormal(xx,_x,bx,f.normal),d.face=f,d.barycoord=h}return d}class ja extends Tr{constructor(e=1,n=1,r=1,s=1,o=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:s,heightSegments:o,depthSegments:a};const l=this;s=Math.floor(s),o=Math.floor(o),a=Math.floor(a);const c=[],u=[],d=[],h=[];let f=0,p=0;m("z","y","x",-1,-1,r,n,e,a,o,0),m("z","y","x",1,-1,r,n,-e,a,o,1),m("x","z","y",1,1,e,r,n,s,a,2),m("x","z","y",1,-1,e,r,-n,s,a,3),m("x","y","z",1,-1,e,n,r,s,o,4),m("x","y","z",-1,-1,e,n,-r,s,o,5),this.setIndex(c),this.setAttribute("position",new Ti(u,3)),this.setAttribute("normal",new Ti(d,3)),this.setAttribute("uv",new Ti(h,2));function m(y,v,g,_,x,b,S,T,w,E,A){const M=b/w,R=S/E,F=b/2,B=S/2,C=T/2,L=w+1,P=E+1;let W=0,D=0;const X=new K;for(let q=0;q<P;q++){const J=q*R-B;for(let se=0;se<L;se++){const de=se*M-F;X[y]=de*_,X[v]=J*x,X[g]=C,u.push(X.x,X.y,X.z),X[y]=0,X[v]=0,X[g]=T>0?1:-1,d.push(X.x,X.y,X.z),h.push(se/w),h.push(1-q/E),W+=1}}for(let q=0;q<E;q++)for(let J=0;J<w;J++){const se=f+J+L*q,de=f+J+L*(q+1),G=f+(J+1)+L*(q+1),Q=f+(J+1)+L*q;c.push(se,de,Q),c.push(de,G,Q),D+=6}l.addGroup(p,D,A),p+=D,f+=W}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ja(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Cp(i){const e={};for(const n in i){e[n]={};for(const r in i[n]){const s=i[n][r];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=s.clone():Array.isArray(s)?e[n][r]=s.slice():e[n][r]=s}}return e}function qr(i){const e={};for(let n=0;n<i.length;n++){const r=Cp(i[n]);for(const s in r)e[s]=r[s]}return e}function ade(i){const e=[];for(let n=0;n<i.length;n++)e.push(i[n].clone());return e}function eG(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:rn.workingColorSpace}const tG={clone:Cp,merge:qr};var lde=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,cde=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ka extends $r{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=lde,this.fragmentShader=cde,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Cp(e.uniforms),this.uniformsGroups=ade(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const s in this.uniforms){const a=this.uniforms[s].value;a&&a.isTexture?n.uniforms[s]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[s]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[s]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[s]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[s]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[s]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[s]={type:"m4",value:a.toArray()}:n.uniforms[s]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const s in this.extensions)this.extensions[s]===!0&&(r[s]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class i2 extends xi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ln,this.projectionMatrix=new ln,this.projectionMatrixInverse=new ln,this.coordinateSystem=is}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const kc=new K,VO=new Oe,$O=new Oe;class ar extends i2{constructor(e=50,n=1,r=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=s,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=$d*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(qg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return $d*2*Math.atan(Math.tan(qg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,r){kc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(kc.x,kc.y).multiplyScalar(-e/kc.z),kc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(kc.x,kc.y).multiplyScalar(-e/kc.z)}getViewSize(e,n){return this.getViewBounds(e,VO,$O),n.subVectors($O,VO)}setViewOffset(e,n,r,s,o,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(qg*.5*this.fov)/this.zoom,r=2*n,s=this.aspect*r,o=-.5*s;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,u=a.fullHeight;o+=a.offsetX*s/c,n-=a.offsetY*r/u,s*=a.width/c,r*=a.height/u}const l=this.filmOffset;l!==0&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,n,n-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Fh=-90,Bh=1;class nG extends xi{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new ar(Fh,Bh,e,n);s.layers=this.layers,this.add(s);const o=new ar(Fh,Bh,e,n);o.layers=this.layers,this.add(o);const a=new ar(Fh,Bh,e,n);a.layers=this.layers,this.add(a);const l=new ar(Fh,Bh,e,n);l.layers=this.layers,this.add(l);const c=new ar(Fh,Bh,e,n);c.layers=this.layers,this.add(c);const u=new ar(Fh,Bh,e,n);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[r,s,o,a,l,c]=n;for(const u of n)this.remove(u);if(e===is)r.up.set(0,1,0),r.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===mu)r.up.set(0,-1,0),r.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of n)this.add(u),u.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,a,l,c,u,d]=this.children,h=e.getRenderTarget(),f=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),m=e.xr.enabled;e.xr.enabled=!1;const y=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,s),e.render(n,o),e.setRenderTarget(r,1,s),e.render(n,a),e.setRenderTarget(r,2,s),e.render(n,l),e.setRenderTarget(r,3,s),e.render(n,c),e.setRenderTarget(r,4,s),e.render(n,u),r.texture.generateMipmaps=y,e.setRenderTarget(r,5,s),e.render(n,d),e.setRenderTarget(h,f,p),e.xr.enabled=m,r.texture.needsPMREMUpdate=!0}}class nw extends Ki{constructor(e=[],n=pa,r,s,o,a,l,c,u,d){super(e,n,r,s,o,a,l,c,u,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class iG extends gu{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},s=[r,r,r,r,r,r];this.texture=new nw(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Xi}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new ja(5,5,5),o=new Ka({name:"CubemapFromEquirect",uniforms:Cp(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:On,blending:Rs});o.uniforms.tEquirect.value=n;const a=new Xn(s,o),l=n.minFilter;return n.minFilter===_s&&(n.minFilter=Xi),new nG(1,10,this).update(e,a),n.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,n=!0,r=!0,s=!0){const o=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,r,s);e.setRenderTarget(o)}}let xf=class extends xi{constructor(){super(),this.isGroup=!0,this.type="Group"}};const ude={type:"move"};class V_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new xf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new xf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new K,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new K),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new xf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new K,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new K),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let s=null,o=null,a=null;const l=this._targetRay,c=this._grip,u=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(u&&e.hand){a=!0;for(const y of e.hand.values()){const v=n.getJointPose(y,r),g=this._getHandJoint(u,y);v!==null&&(g.matrix.fromArray(v.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=v.radius),g.visible=v!==null}const d=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],f=d.position.distanceTo(h.position),p=.02,m=.005;u.inputState.pinching&&f>p+m?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&f<=p-m&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(o=n.getPose(e.gripSpace,r),o!==null&&(c.matrix.fromArray(o.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,o.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(o.linearVelocity)):c.hasLinearVelocity=!1,o.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(o.angularVelocity)):c.hasAngularVelocity=!1));l!==null&&(s=n.getPose(e.targetRaySpace,r),s===null&&o!==null&&(s=o),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(ude)))}return l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),u!==null&&(u.visible=a!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new xf;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}class iw extends xi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ks,this.environmentIntensity=1,this.environmentRotation=new ks,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class rG{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=Jb,this.updateRanges=[],this.version=0,this.uuid=Gl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,r){e*=this.stride,r*=n.stride;for(let s=0,o=this.stride;s<o;s++)this.array[e+s]=n.array[r+s];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(n,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Hr=new K;class r2{constructor(e,n,r,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=r,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,r=this.data.count;n<r;n++)Hr.fromBufferAttribute(this,n),Hr.applyMatrix4(e),this.setXYZ(n,Hr.x,Hr.y,Hr.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)Hr.fromBufferAttribute(this,n),Hr.applyNormalMatrix(e),this.setXYZ(n,Hr.x,Hr.y,Hr.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)Hr.fromBufferAttribute(this,n),Hr.transformDirection(e),this.setXYZ(n,Hr.x,Hr.y,Hr.z);return this}getComponent(e,n){let r=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(r=Jr(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=Xt(r,this.array)),this.data.array[e*this.data.stride+this.offset+n]=r,this}setX(e,n){return this.normalized&&(n=Xt(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=Xt(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=Xt(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=Xt(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=Jr(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=Jr(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=Jr(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=Jr(n,this.array)),n}setXY(e,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=Xt(n,this.array),r=Xt(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this}setXYZ(e,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=Xt(n,this.array),r=Xt(r,this.array),s=Xt(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=s,this}setXYZW(e,n,r,s,o){return e=e*this.data.stride+this.offset,this.normalized&&(n=Xt(n,this.array),r=Xt(r,this.array),s=Xt(s,this.array),o=Xt(o,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=s,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let r=0;r<this.count;r++){const s=r*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[s+o])}return new Yi(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new r2(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let r=0;r<this.count;r++){const s=r*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class dde extends $r{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class hde extends Ki{constructor(e=null,n=1,r=1,s,o,a,l,c,u=Vn,d=Vn,h,f){super(null,a,l,c,u,d,s,o,h,f),this.isDataTexture=!0,this.image={data:e,width:n,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class fde extends Yi{constructor(e,n,r,s=1){super(e,n,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const kE=new K,pde=new K,mde=new Vt;class Ws{constructor(e=new K(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,s){return this.normal.set(e,n,r),this.constant=s,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const s=kE.subVectors(r,n).cross(pde.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(kE),s=this.normal.dot(r);if(s===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:n.copy(e.start).addScaledVector(r,o)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||mde.getNormalMatrix(e),s=this.coplanarPoint(kE).applyMatrix4(e),o=this.normal.applyMatrix3(r).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const $u=new V0,Ex=new K;class $0{constructor(e=new Ws,n=new Ws,r=new Ws,s=new Ws,o=new Ws,a=new Ws){this.planes=[e,n,r,s,o,a]}set(e,n,r,s,o,a){const l=this.planes;return l[0].copy(e),l[1].copy(n),l[2].copy(r),l[3].copy(s),l[4].copy(o),l[5].copy(a),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=is){const r=this.planes,s=e.elements,o=s[0],a=s[1],l=s[2],c=s[3],u=s[4],d=s[5],h=s[6],f=s[7],p=s[8],m=s[9],y=s[10],v=s[11],g=s[12],_=s[13],x=s[14],b=s[15];if(r[0].setComponents(c-o,f-u,v-p,b-g).normalize(),r[1].setComponents(c+o,f+u,v+p,b+g).normalize(),r[2].setComponents(c+a,f+d,v+m,b+_).normalize(),r[3].setComponents(c-a,f-d,v-m,b-_).normalize(),r[4].setComponents(c-l,f-h,v-y,b-x).normalize(),n===is)r[5].setComponents(c+l,f+h,v+y,b+x).normalize();else if(n===mu)r[5].setComponents(l,h,y,x).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),$u.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),$u.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere($u)}intersectsSprite(e){return $u.center.set(0,0,0),$u.radius=.7071067811865476,$u.applyMatrix4(e.matrixWorld),this.intersectsSphere($u)}intersectsSphere(e){const n=this.planes,r=e.center,s=-e.radius;for(let o=0;o<6;o++)if(n[o].distanceToPoint(r)<s)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const s=n[r];if(Ex.x=s.normal.x>0?e.max.x:e.min.x,Ex.y=s.normal.y>0?e.max.y:e.min.y,Ex.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Ex)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Ea=new ln,Ma=new $0;class s2{constructor(){this.coordinateSystem=is}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let r=0;r<n.cameras.length;r++){const s=n.cameras[r];if(Ea.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ma.setFromProjectionMatrix(Ea,this.coordinateSystem),Ma.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let r=0;r<n.cameras.length;r++){const s=n.cameras[r];if(Ea.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ma.setFromProjectionMatrix(Ea,this.coordinateSystem),Ma.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let r=0;r<n.cameras.length;r++){const s=n.cameras[r];if(Ea.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ma.setFromProjectionMatrix(Ea,this.coordinateSystem),Ma.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let r=0;r<n.cameras.length;r++){const s=n.cameras[r];if(Ea.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ma.setFromProjectionMatrix(Ea,this.coordinateSystem),Ma.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let r=0;r<n.cameras.length;r++){const s=n.cameras[r];if(Ea.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ma.setFromProjectionMatrix(Ea,this.coordinateSystem),Ma.containsPoint(e))return!0}return!1}clone(){return new s2}}class G0 extends $r{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new St(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const t1=new K,n1=new K,GO=new ln,Vm=new tw,Mx=new V0,LE=new K,HO=new K;class sG extends xi{constructor(e=new Tr,n=new G0){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[0];for(let s=1,o=n.count;s<o;s++)t1.fromBufferAttribute(n,s-1),n1.fromBufferAttribute(n,s),r[s]=r[s-1],r[s]+=t1.distanceTo(n1);e.setAttribute("lineDistance",new Ti(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const r=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Mx.copy(r.boundingSphere),Mx.applyMatrix4(s),Mx.radius+=o,e.ray.intersectsSphere(Mx)===!1)return;GO.copy(s).invert(),Vm.copy(e.ray).applyMatrix4(GO);const l=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,u=this.isLineSegments?2:1,d=r.index,f=r.attributes.position;if(d!==null){const p=Math.max(0,a.start),m=Math.min(d.count,a.start+a.count);for(let y=p,v=m-1;y<v;y+=u){const g=d.getX(y),_=d.getX(y+1),x=Ax(this,e,Vm,c,g,_,y);x&&n.push(x)}if(this.isLineLoop){const y=d.getX(m-1),v=d.getX(p),g=Ax(this,e,Vm,c,y,v,m-1);g&&n.push(g)}}else{const p=Math.max(0,a.start),m=Math.min(f.count,a.start+a.count);for(let y=p,v=m-1;y<v;y+=u){const g=Ax(this,e,Vm,c,y,y+1,y);g&&n.push(g)}if(this.isLineLoop){const y=Ax(this,e,Vm,c,m-1,p,m-1);y&&n.push(y)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const s=n[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}}function Ax(i,e,n,r,s,o,a){const l=i.geometry.attributes.position;if(t1.fromBufferAttribute(l,s),n1.fromBufferAttribute(l,o),n.distanceSqToSegment(t1,n1,LE,HO)>r)return;LE.applyMatrix4(i.matrixWorld);const u=e.ray.origin.distanceTo(LE);if(!(u<e.near||u>e.far))return{distance:u,point:HO.clone().applyMatrix4(i.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:i}}class gde extends $r{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class yde extends Ki{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=Vn,this.minFilter=Vn,this.generateMipmaps=!1,this.needsUpdate=!0}}class ro extends Ki{constructor(e,n,r=Dn,s,o,a,l=Vn,c=Vn,u,d=no){if(d!==no&&d!==io)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,s,o,a,l,c,d,r,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new JN(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class oG extends ro{constructor(e=1,n=1,r=1){super(e,n),this.isDepthArrayTexture=!0,this.image={width:e,height:n,depth:r},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class H0 extends Tr{constructor(e=1,n=1,r=1,s=32,o=1,a=!1,l=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:r,radialSegments:s,heightSegments:o,openEnded:a,thetaStart:l,thetaLength:c};const u=this;s=Math.floor(s),o=Math.floor(o);const d=[],h=[],f=[],p=[];let m=0;const y=[],v=r/2;let g=0;_(),a===!1&&(e>0&&x(!0),n>0&&x(!1)),this.setIndex(d),this.setAttribute("position",new Ti(h,3)),this.setAttribute("normal",new Ti(f,3)),this.setAttribute("uv",new Ti(p,2));function _(){const b=new K,S=new K;let T=0;const w=(n-e)/r;for(let E=0;E<=o;E++){const A=[],M=E/o,R=M*(n-e)+e;for(let F=0;F<=s;F++){const B=F/s,C=B*c+l,L=Math.sin(C),P=Math.cos(C);S.x=R*L,S.y=-M*r+v,S.z=R*P,h.push(S.x,S.y,S.z),b.set(L,w,P).normalize(),f.push(b.x,b.y,b.z),p.push(B,1-M),A.push(m++)}y.push(A)}for(let E=0;E<s;E++)for(let A=0;A<o;A++){const M=y[A][E],R=y[A+1][E],F=y[A+1][E+1],B=y[A][E+1];(e>0||A!==0)&&(d.push(M,R,B),T+=3),(n>0||A!==o-1)&&(d.push(R,F,B),T+=3)}u.addGroup(g,T,0),g+=T}function x(b){const S=m,T=new Oe,w=new K;let E=0;const A=b===!0?e:n,M=b===!0?1:-1;for(let F=1;F<=s;F++)h.push(0,v*M,0),f.push(0,M,0),p.push(.5,.5),m++;const R=m;for(let F=0;F<=s;F++){const C=F/s*c+l,L=Math.cos(C),P=Math.sin(C);w.x=A*P,w.y=v*M,w.z=A*L,h.push(w.x,w.y,w.z),f.push(0,M,0),T.x=L*.5+.5,T.y=P*.5*M+.5,p.push(T.x,T.y),m++}for(let F=0;F<s;F++){const B=S+F,C=R+F;b===!0?d.push(C,C+1,B):d.push(C+1,C,B),E+=3}u.addGroup(g,E,b===!0?1:2),g+=E}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new H0(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class o2 extends H0{constructor(e=1,n=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(0,e,n,r,s,o,a,l),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l}}static fromJSON(e){return new o2(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class hc{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,n){const r=this.getUtoTmapping(e);return this.getPoint(r,n)}getPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return n}getSpacedPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPointAt(r/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let r,s=this.getPoint(0),o=0;n.push(0);for(let a=1;a<=e;a++)r=this.getPoint(a/e),o+=r.distanceTo(s),n.push(o),s=r;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){const r=this.getLengths();let s=0;const o=r.length;let a;n?a=n:a=e*r[o-1];let l=0,c=o-1,u;for(;l<=c;)if(s=Math.floor(l+(c-l)/2),u=r[s]-a,u<0)l=s+1;else if(u>0)c=s-1;else{c=s;break}if(s=c,r[s]===a)return s/(o-1);const d=r[s],f=r[s+1]-d,p=(a-d)/f;return(s+p)/(o-1)}getTangent(e,n){let s=e-1e-4,o=e+1e-4;s<0&&(s=0),o>1&&(o=1);const a=this.getPoint(s),l=this.getPoint(o),c=n||(a.isVector2?new Oe:new K);return c.copy(l).sub(a).normalize(),c}getTangentAt(e,n){const r=this.getUtoTmapping(e);return this.getTangent(r,n)}computeFrenetFrames(e,n=!1){const r=new K,s=[],o=[],a=[],l=new K,c=new ln;for(let p=0;p<=e;p++){const m=p/e;s[p]=this.getTangentAt(m,new K)}o[0]=new K,a[0]=new K;let u=Number.MAX_VALUE;const d=Math.abs(s[0].x),h=Math.abs(s[0].y),f=Math.abs(s[0].z);d<=u&&(u=d,r.set(1,0,0)),h<=u&&(u=h,r.set(0,1,0)),f<=u&&r.set(0,0,1),l.crossVectors(s[0],r).normalize(),o[0].crossVectors(s[0],l),a[0].crossVectors(s[0],o[0]);for(let p=1;p<=e;p++){if(o[p]=o[p-1].clone(),a[p]=a[p-1].clone(),l.crossVectors(s[p-1],s[p]),l.length()>Number.EPSILON){l.normalize();const m=Math.acos(Yt(s[p-1].dot(s[p]),-1,1));o[p].applyMatrix4(c.makeRotationAxis(l,m))}a[p].crossVectors(s[p],o[p])}if(n===!0){let p=Math.acos(Yt(o[0].dot(o[e]),-1,1));p/=e,s[0].dot(l.crossVectors(o[0],o[e]))>0&&(p=-p);for(let m=1;m<=e;m++)o[m].applyMatrix4(c.makeRotationAxis(s[m],p*m)),a[m].crossVectors(s[m],o[m])}return{tangents:s,normals:o,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class aG extends hc{constructor(e=0,n=0,r=1,s=1,o=0,a=Math.PI*2,l=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=r,this.yRadius=s,this.aStartAngle=o,this.aEndAngle=a,this.aClockwise=l,this.aRotation=c}getPoint(e,n=new Oe){const r=n,s=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const a=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=s;for(;o>s;)o-=s;o<Number.EPSILON&&(a?o=0:o=s),this.aClockwise===!0&&!a&&(o===s?o=-s:o=o-s);const l=this.aStartAngle+e*o;let c=this.aX+this.xRadius*Math.cos(l),u=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const d=Math.cos(this.aRotation),h=Math.sin(this.aRotation),f=c-this.aX,p=u-this.aY;c=f*d-p*h+this.aX,u=f*h+p*d+this.aY}return r.set(c,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class vde extends aG{constructor(e,n,r,s,o,a){super(e,n,r,r,s,o,a),this.isArcCurve=!0,this.type="ArcCurve"}}function a2(){let i=0,e=0,n=0,r=0;function s(o,a,l,c){i=o,e=l,n=-3*o+3*a-2*l-c,r=2*o-2*a+l+c}return{initCatmullRom:function(o,a,l,c,u){s(a,l,u*(l-o),u*(c-a))},initNonuniformCatmullRom:function(o,a,l,c,u,d,h){let f=(a-o)/u-(l-o)/(u+d)+(l-a)/d,p=(l-a)/d-(c-a)/(d+h)+(c-l)/h;f*=d,p*=d,s(a,l,f,p)},calc:function(o){const a=o*o,l=a*o;return i+e*o+n*a+r*l}}}const Cx=new K,IE=new a2,DE=new a2,OE=new a2;class xde extends hc{constructor(e=[],n=!1,r="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=r,this.tension=s}getPoint(e,n=new K){const r=n,s=this.points,o=s.length,a=(o-(this.closed?0:1))*e;let l=Math.floor(a),c=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o)+1)*o:c===0&&l===o-1&&(l=o-2,c=1);let u,d;this.closed||l>0?u=s[(l-1)%o]:(Cx.subVectors(s[0],s[1]).add(s[0]),u=Cx);const h=s[l%o],f=s[(l+1)%o];if(this.closed||l+2<o?d=s[(l+2)%o]:(Cx.subVectors(s[o-1],s[o-2]).add(s[o-1]),d=Cx),this.curveType==="centripetal"||this.curveType==="chordal"){const p=this.curveType==="chordal"?.5:.25;let m=Math.pow(u.distanceToSquared(h),p),y=Math.pow(h.distanceToSquared(f),p),v=Math.pow(f.distanceToSquared(d),p);y<1e-4&&(y=1),m<1e-4&&(m=y),v<1e-4&&(v=y),IE.initNonuniformCatmullRom(u.x,h.x,f.x,d.x,m,y,v),DE.initNonuniformCatmullRom(u.y,h.y,f.y,d.y,m,y,v),OE.initNonuniformCatmullRom(u.z,h.z,f.z,d.z,m,y,v)}else this.curveType==="catmullrom"&&(IE.initCatmullRom(u.x,h.x,f.x,d.x,this.tension),DE.initCatmullRom(u.y,h.y,f.y,d.y,this.tension),OE.initCatmullRom(u.z,h.z,f.z,d.z,this.tension));return r.set(IE.calc(c),DE.calc(c),OE.calc(c)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const s=e.points[n];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const s=this.points[n];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const s=e.points[n];this.points.push(new K().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function WO(i,e,n,r,s){const o=(r-e)*.5,a=(s-n)*.5,l=i*i,c=i*l;return(2*n-2*r+o+a)*c+(-3*n+3*r-2*o-a)*l+o*i+n}function _de(i,e){const n=1-i;return n*n*e}function bde(i,e){return 2*(1-i)*i*e}function Sde(i,e){return i*i*e}function Kg(i,e,n,r){return _de(i,e)+bde(i,n)+Sde(i,r)}function wde(i,e){const n=1-i;return n*n*n*e}function Tde(i,e){const n=1-i;return 3*n*n*i*e}function Ede(i,e){return 3*(1-i)*i*i*e}function Mde(i,e){return i*i*i*e}function Yg(i,e,n,r,s){return wde(i,e)+Tde(i,n)+Ede(i,r)+Mde(i,s)}class Ade extends hc{constructor(e=new Oe,n=new Oe,r=new Oe,s=new Oe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=r,this.v3=s}getPoint(e,n=new Oe){const r=n,s=this.v0,o=this.v1,a=this.v2,l=this.v3;return r.set(Yg(e,s.x,o.x,a.x,l.x),Yg(e,s.y,o.y,a.y,l.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class lG extends hc{constructor(e=new K,n=new K,r=new K,s=new K){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=r,this.v3=s}getPoint(e,n=new K){const r=n,s=this.v0,o=this.v1,a=this.v2,l=this.v3;return r.set(Yg(e,s.x,o.x,a.x,l.x),Yg(e,s.y,o.y,a.y,l.y),Yg(e,s.z,o.z,a.z,l.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Cde extends hc{constructor(e=new Oe,n=new Oe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Oe){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Oe){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Rde extends hc{constructor(e=new K,n=new K){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new K){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new K){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Pde extends hc{constructor(e=new Oe,n=new Oe,r=new Oe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new Oe){const r=n,s=this.v0,o=this.v1,a=this.v2;return r.set(Kg(e,s.x,o.x,a.x),Kg(e,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class l2 extends hc{constructor(e=new K,n=new K,r=new K){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new K){const r=n,s=this.v0,o=this.v1,a=this.v2;return r.set(Kg(e,s.x,o.x,a.x),Kg(e,s.y,o.y,a.y),Kg(e,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Nde extends hc{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Oe){const r=n,s=this.points,o=(s.length-1)*e,a=Math.floor(o),l=o-a,c=s[a===0?a:a-1],u=s[a],d=s[a>s.length-2?s.length-1:a+1],h=s[a>s.length-3?s.length-1:a+2];return r.set(WO(l,c.x,u.x,d.x,h.x),WO(l,c.y,u.y,d.y,h.y)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const s=e.points[n];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const s=this.points[n];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const s=e.points[n];this.points.push(new Oe().fromArray(s))}return this}}var kde=Object.freeze({__proto__:null,ArcCurve:vde,CatmullRomCurve3:xde,CubicBezierCurve:Ade,CubicBezierCurve3:lG,EllipseCurve:aG,LineCurve:Cde,LineCurve3:Rde,QuadraticBezierCurve:Pde,QuadraticBezierCurve3:l2,SplineCurve:Nde});class W0 extends Tr{constructor(e=1,n=1,r=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:s};const o=e/2,a=n/2,l=Math.floor(r),c=Math.floor(s),u=l+1,d=c+1,h=e/l,f=n/c,p=[],m=[],y=[],v=[];for(let g=0;g<d;g++){const _=g*f-a;for(let x=0;x<u;x++){const b=x*h-o;m.push(b,-_,0),y.push(0,0,1),v.push(x/l),v.push(1-g/c)}}for(let g=0;g<c;g++)for(let _=0;_<l;_++){const x=_+u*g,b=_+u*(g+1),S=_+1+u*(g+1),T=_+1+u*g;p.push(x,b,T),p.push(b,S,T)}this.setIndex(p),this.setAttribute("position",new Ti(m,3)),this.setAttribute("normal",new Ti(y,3)),this.setAttribute("uv",new Ti(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new W0(e.width,e.height,e.widthSegments,e.heightSegments)}}class Gd extends Tr{constructor(e=1,n=32,r=16,s=0,o=Math.PI*2,a=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:s,phiLength:o,thetaStart:a,thetaLength:l},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const c=Math.min(a+l,Math.PI);let u=0;const d=[],h=new K,f=new K,p=[],m=[],y=[],v=[];for(let g=0;g<=r;g++){const _=[],x=g/r;let b=0;g===0&&a===0?b=.5/n:g===r&&c===Math.PI&&(b=-.5/n);for(let S=0;S<=n;S++){const T=S/n;h.x=-e*Math.cos(s+T*o)*Math.sin(a+x*l),h.y=e*Math.cos(a+x*l),h.z=e*Math.sin(s+T*o)*Math.sin(a+x*l),m.push(h.x,h.y,h.z),f.copy(h).normalize(),y.push(f.x,f.y,f.z),v.push(T+b,1-x),_.push(u++)}d.push(_)}for(let g=0;g<r;g++)for(let _=0;_<n;_++){const x=d[g][_+1],b=d[g][_],S=d[g+1][_],T=d[g+1][_+1];(g!==0||a>0)&&p.push(x,b,T),(g!==r-1||c<Math.PI)&&p.push(b,S,T)}this.setIndex(p),this.setAttribute("position",new Ti(m,3)),this.setAttribute("normal",new Ti(y,3)),this.setAttribute("uv",new Ti(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gd(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class c2 extends Tr{constructor(e=new l2(new K(-1,-1,0),new K(-1,1,0),new K(1,1,0)),n=64,r=1,s=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:r,radialSegments:s,closed:o};const a=e.computeFrenetFrames(n,o);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const l=new K,c=new K,u=new Oe;let d=new K;const h=[],f=[],p=[],m=[];y(),this.setIndex(m),this.setAttribute("position",new Ti(h,3)),this.setAttribute("normal",new Ti(f,3)),this.setAttribute("uv",new Ti(p,2));function y(){for(let x=0;x<n;x++)v(x);v(o===!1?n:0),_(),g()}function v(x){d=e.getPointAt(x/n,d);const b=a.normals[x],S=a.binormals[x];for(let T=0;T<=s;T++){const w=T/s*Math.PI*2,E=Math.sin(w),A=-Math.cos(w);c.x=A*b.x+E*S.x,c.y=A*b.y+E*S.y,c.z=A*b.z+E*S.z,c.normalize(),f.push(c.x,c.y,c.z),l.x=d.x+r*c.x,l.y=d.y+r*c.y,l.z=d.z+r*c.z,h.push(l.x,l.y,l.z)}}function g(){for(let x=1;x<=n;x++)for(let b=1;b<=s;b++){const S=(s+1)*(x-1)+(b-1),T=(s+1)*x+(b-1),w=(s+1)*x+b,E=(s+1)*(x-1)+b;m.push(S,T,E),m.push(T,w,E)}}function _(){for(let x=0;x<=n;x++)for(let b=0;b<=s;b++)u.x=x/n,u.y=b/s,p.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new c2(new kde[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Lde extends $r{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new St(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class cG extends $r{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new St(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tc,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ks,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ide extends cG{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Oe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Yt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new St(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new St(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new St(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Dde extends $r{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new St(16777215),this.specular=new St(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tc,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ks,this.combine=B0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ode extends $r{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new St(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tc,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Fde extends $r{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tc,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class uG extends $r{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tc,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ks,this.combine=B0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Bde extends $r{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=cue,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Ude extends $r{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class zde extends $r{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new St(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tc,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Vde extends G0{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const jO={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class $de{constructor(e,n,r){const s=this;let o=!1,a=0,l=0,c;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=r,this.itemStart=function(d){l++,o===!1&&s.onStart!==void 0&&s.onStart(d,a,l),o=!0},this.itemEnd=function(d){a++,s.onProgress!==void 0&&s.onProgress(d,a,l),a===l&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(d){s.onError!==void 0&&s.onError(d)},this.resolveURL=function(d){return c?c(d):d},this.setURLModifier=function(d){return c=d,this},this.addHandler=function(d,h){return u.push(d,h),this},this.removeHandler=function(d){const h=u.indexOf(d);return h!==-1&&u.splice(h,2),this},this.getHandler=function(d){for(let h=0,f=u.length;h<f;h+=2){const p=u[h],m=u[h+1];if(p.global&&(p.lastIndex=0),p.test(d))return m}return null}}}const Gde=new $de;class u2{constructor(e){this.manager=e!==void 0?e:Gde,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const r=this;return new Promise(function(s,o){r.load(e,s,n,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}u2.DEFAULT_MATERIAL_NAME="__DEFAULT";class Hde extends u2{constructor(e){super(e)}load(e,n,r,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=jO.get(e);if(a!==void 0)return o.manager.itemStart(e),setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a;const l=i0("img");function c(){d(),jO.add(e,this),n&&n(this),o.manager.itemEnd(e)}function u(h){d(),s&&s(h),o.manager.itemError(e),o.manager.itemEnd(e)}function d(){l.removeEventListener("load",c,!1),l.removeEventListener("error",u,!1)}return l.addEventListener("load",c,!1),l.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}}class Wde extends u2{constructor(e){super(e)}load(e,n,r,s){const o=new Ki,a=new Hde(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(l){o.image=l,o.needsUpdate=!0,n!==void 0&&n(o)},r,s),o}}class Yd extends xi{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new St(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(n.object.target=this.target.uuid),n}}class jde extends Yd{constructor(e,n,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(xi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new St(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const FE=new ln,qO=new K,XO=new K;class d2{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Oe(512,512),this.mapType=ci,this.map=null,this.mapPass=null,this.matrix=new ln,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new $0,this._frameExtents=new Oe(1,1),this._viewportCount=1,this._viewports=[new Dt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,r=this.matrix;qO.setFromMatrixPosition(e.matrixWorld),n.position.copy(qO),XO.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(XO),n.updateMatrixWorld(),FE.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(FE),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(FE)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class qde extends d2{constructor(){super(new ar(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,r=$d*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=e.distance||n.far;(r!==n.fov||s!==n.aspect||o!==n.far)&&(n.fov=r,n.aspect=s,n.far=o,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class dG extends Yd{constructor(e,n,r=0,s=Math.PI/3,o=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(xi.DEFAULT_UP),this.updateMatrix(),this.target=new xi,this.distance=r,this.angle=s,this.penumbra=o,this.decay=a,this.map=null,this.shadow=new qde}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const KO=new ln,$m=new K,BE=new K;class Xde extends d2{constructor(){super(new ar(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Oe(4,2),this._viewportCount=6,this._viewports=[new Dt(2,1,1,1),new Dt(0,1,1,1),new Dt(3,1,1,1),new Dt(1,1,1,1),new Dt(3,0,1,1),new Dt(1,0,1,1)],this._cubeDirections=[new K(1,0,0),new K(-1,0,0),new K(0,0,1),new K(0,0,-1),new K(0,1,0),new K(0,-1,0)],this._cubeUps=[new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,0,1),new K(0,0,-1)]}updateMatrices(e,n=0){const r=this.camera,s=this.matrix,o=e.distance||r.far;o!==r.far&&(r.far=o,r.updateProjectionMatrix()),$m.setFromMatrixPosition(e.matrixWorld),r.position.copy($m),BE.copy(r.position),BE.add(this._cubeDirections[n]),r.up.copy(this._cubeUps[n]),r.lookAt(BE),r.updateMatrixWorld(),s.makeTranslation(-$m.x,-$m.y,-$m.z),KO.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(KO)}}class Kde extends Yd{constructor(e,n,r=0,s=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=s,this.shadow=new Xde}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class j0 extends i2{constructor(e=-1,n=1,r=1,s=-1,o=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=s,this.near=o,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,s,o,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=r-e,a=r+e,l=s+n,c=s-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=u*this.view.offsetX,a=o+u*this.view.width,l-=d*this.view.offsetY,c=l-d*this.view.height}this.projectionMatrix.makeOrthographic(o,a,l,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class Yde extends d2{constructor(){super(new j0(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class hG extends Yd{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(xi.DEFAULT_UP),this.updateMatrix(),this.target=new xi,this.shadow=new Yde}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class fG extends Yd{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class Zde extends Yd{constructor(e,n,r=10,s=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class Qde{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new K)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const r=e.x,s=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*s),n.addScaledVector(a[2],.488603*o),n.addScaledVector(a[3],.488603*r),n.addScaledVector(a[4],1.092548*(r*s)),n.addScaledVector(a[5],1.092548*(s*o)),n.addScaledVector(a[6],.315392*(3*o*o-1)),n.addScaledVector(a[7],1.092548*(r*o)),n.addScaledVector(a[8],.546274*(r*r-s*s)),n}getIrradianceAt(e,n){const r=e.x,s=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*s),n.addScaledVector(a[2],2*.511664*o),n.addScaledVector(a[3],2*.511664*r),n.addScaledVector(a[4],2*.429043*r*s),n.addScaledVector(a[5],2*.429043*s*o),n.addScaledVector(a[6],.743125*o*o-.247708),n.addScaledVector(a[7],2*.429043*r*o),n.addScaledVector(a[8],.429043*(r*r-s*s)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const r=this.coefficients;for(let s=0;s<9;s++)r[s].fromArray(e,n+s*3);return this}toArray(e=[],n=0){const r=this.coefficients;for(let s=0;s<9;s++)r[s].toArray(e,n+s*3);return e}static getBasisAt(e,n){const r=e.x,s=e.y,o=e.z;n[0]=.282095,n[1]=.488603*s,n[2]=.488603*o,n[3]=.488603*r,n[4]=1.092548*r*s,n[5]=1.092548*s*o,n[6]=.315392*(3*o*o-1),n[7]=1.092548*r*o,n[8]=.546274*(r*r-s*s)}}class Jde extends Yd{constructor(e=new Qde,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class pG extends ar{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class mG{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=YO(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=YO();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function YO(){return performance.now()}class ehe extends Eu{constructor(e=1,n=1,r=1,s={}){super(e,n,s),this.isRenderTargetArray=!0,this.depth=r,this.texture=new ew(null,e,n,r),this.texture.isRenderTargetTexture=!0}}class the extends rG{constructor(e,n,r=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}const ZO=new ln;class gG{constructor(e,n,r=0,s=1/0){this.ray=new tw(e,n),this.near=r,this.far=s,this.camera=null,this.layers=new e2,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return ZO.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(ZO),this}intersectObject(e,n=!0,r=[]){return UC(e,this,r,n),r.sort(QO),r}intersectObjects(e,n=!0,r=[]){for(let s=0,o=e.length;s<o;s++)UC(e[s],this,r,n);return r.sort(QO),r}}function QO(i,e){return i.distance-e.distance}function UC(i,e,n,r){let s=!0;if(i.layers.test(e.layers)&&i.raycast(e,n)===!1&&(s=!1),s===!0&&r===!0){const o=i.children;for(let a=0,l=o.length;a<l;a++)UC(o[a],e,n,!0)}}class JO{constructor(e=1,n=0,r=0){this.radius=e,this.phi=n,this.theta=r}set(e,n,r){return this.radius=e,this.phi=n,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Yt(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,r){return this.radius=Math.sqrt(e*e+n*n+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Yt(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class rw{constructor(e,n,r,s){rw.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,r,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let r=0;r<4;r++)this.elements[r]=e[r+n];return this}set(e,n,r,s){const o=this.elements;return o[0]=e,o[2]=n,o[1]=r,o[3]=s,this}}class sw extends dc{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function eF(i,e,n,r){const s=nhe(r);switch(n){case GN:return i*e;case z0:return i*e/s.components*s.byteLength;case nm:return i*e/s.components*s.byteLength;case Ol:return i*e*2/s.components*s.byteLength;case im:return i*e*2/s.components*s.byteLength;case U0:return i*e*3/s.components*s.byteLength;case yi:return i*e*4/s.components*s.byteLength;case rm:return i*e*4/s.components*s.byteLength;case wd:case ou:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case au:case lu:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Yy:case Qy:return Math.max(i,16)*Math.max(e,8)/4;case Ky:case Zy:return Math.max(i,8)*Math.max(e,8)/2;case Jy:case hp:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case fp:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case pp:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case mp:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case gp:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case yp:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case vp:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case xp:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case _p:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case bp:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case Sp:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case wp:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case Tp:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case Ep:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Mp:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case Ap:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Td:case OC:case FC:return Math.ceil(i/4)*Math.ceil(e/4)*16;case HN:case e0:return Math.ceil(i/4)*Math.ceil(e/4)*8;case t0:case n0:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function nhe(i){switch(i){case ci:case bd:return{byteLength:1,components:1};case oa:case Sd:case lr:return{byteLength:2,components:1};case KS:case YS:return{byteLength:2,components:4};case Dn:case or:case wi:return{byteLength:4,components:1};case ZS:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:tm}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=tm);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function yG(){let i=null,e=!1,n=null,r=null;function s(o,a){n(o,a),r=i.requestAnimationFrame(s)}return{start:function(){e!==!0&&n!==null&&(r=i.requestAnimationFrame(s),e=!0)},stop:function(){i.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(o){n=o},setContext:function(o){i=o}}}function ihe(i){const e=new WeakMap;function n(l,c){const u=l.array,d=l.usage,h=u.byteLength,f=i.createBuffer();i.bindBuffer(c,f),i.bufferData(c,u,d),l.onUploadCallback();let p;if(u instanceof Float32Array)p=i.FLOAT;else if(u instanceof Uint16Array)l.isFloat16BufferAttribute?p=i.HALF_FLOAT:p=i.UNSIGNED_SHORT;else if(u instanceof Int16Array)p=i.SHORT;else if(u instanceof Uint32Array)p=i.UNSIGNED_INT;else if(u instanceof Int32Array)p=i.INT;else if(u instanceof Int8Array)p=i.BYTE;else if(u instanceof Uint8Array)p=i.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)p=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:l.version,size:h}}function r(l,c,u){const d=c.array,h=c.updateRanges;if(i.bindBuffer(u,l),h.length===0)i.bufferSubData(u,0,d);else{h.sort((p,m)=>p.start-m.start);let f=0;for(let p=1;p<h.length;p++){const m=h[f],y=h[p];y.start<=m.start+m.count+1?m.count=Math.max(m.count,y.start+y.count-m.start):(++f,h[f]=y)}h.length=f+1;for(let p=0,m=h.length;p<m;p++){const y=h[p];i.bufferSubData(u,y.start*d.BYTES_PER_ELEMENT,d,y.start,y.count)}c.clearUpdateRanges()}c.onUploadCallback()}function s(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function o(l){l.isInterleavedBufferAttribute&&(l=l.data);const c=e.get(l);c&&(i.deleteBuffer(c.buffer),e.delete(l))}function a(l,c){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){const d=e.get(l);(!d||d.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}const u=e.get(l);if(u===void 0)e.set(l,n(l,c));else if(u.version<l.version){if(u.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(u.buffer,l,c),u.version=l.version}}return{get:s,remove:o,update:a}}var rhe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,she=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,ohe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,ahe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lhe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,che=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,uhe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,dhe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,hhe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,fhe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,phe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,mhe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,ghe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,yhe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,vhe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,xhe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,_he=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,bhe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,She=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,whe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,The=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Ehe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Mhe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Ahe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Che=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Rhe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Phe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Nhe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,khe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Lhe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Ihe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Dhe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Ohe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Fhe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Bhe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Uhe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,zhe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Vhe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,$he=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Ghe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Hhe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Whe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,jhe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,qhe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Xhe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Khe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Yhe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Zhe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Qhe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Jhe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,efe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,tfe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,nfe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,ife=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,rfe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,sfe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,ofe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,afe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,lfe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,cfe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,ufe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,dfe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,hfe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,ffe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,pfe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,mfe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,gfe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,yfe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,vfe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,xfe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,_fe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,bfe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Sfe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,wfe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Tfe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Efe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Mfe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Afe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Cfe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Rfe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Pfe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Nfe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,kfe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Lfe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Ife=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Dfe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Ofe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Ffe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Bfe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Ufe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,zfe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Vfe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,$fe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Gfe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Hfe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Wfe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,jfe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,qfe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Xfe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Kfe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Yfe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Zfe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Qfe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Jfe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,epe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,tpe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,npe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const ipe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,rpe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,spe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,ope=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ape=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,lpe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cpe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,upe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,dpe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,hpe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,fpe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,ppe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,mpe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,gpe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ype=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,vpe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xpe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_pe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bpe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Spe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wpe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Tpe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Epe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Mpe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ape=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Cpe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Rpe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ppe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Npe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,kpe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Lpe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ipe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Dpe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Ope=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,nn={alphahash_fragment:rhe,alphahash_pars_fragment:she,alphamap_fragment:ohe,alphamap_pars_fragment:ahe,alphatest_fragment:lhe,alphatest_pars_fragment:che,aomap_fragment:uhe,aomap_pars_fragment:dhe,batching_pars_vertex:hhe,batching_vertex:fhe,begin_vertex:phe,beginnormal_vertex:mhe,bsdfs:ghe,iridescence_fragment:yhe,bumpmap_pars_fragment:vhe,clipping_planes_fragment:xhe,clipping_planes_pars_fragment:_he,clipping_planes_pars_vertex:bhe,clipping_planes_vertex:She,color_fragment:whe,color_pars_fragment:The,color_pars_vertex:Ehe,color_vertex:Mhe,common:Ahe,cube_uv_reflection_fragment:Che,defaultnormal_vertex:Rhe,displacementmap_pars_vertex:Phe,displacementmap_vertex:Nhe,emissivemap_fragment:khe,emissivemap_pars_fragment:Lhe,colorspace_fragment:Ihe,colorspace_pars_fragment:Dhe,envmap_fragment:Ohe,envmap_common_pars_fragment:Fhe,envmap_pars_fragment:Bhe,envmap_pars_vertex:Uhe,envmap_physical_pars_fragment:Yhe,envmap_vertex:zhe,fog_vertex:Vhe,fog_pars_vertex:$he,fog_fragment:Ghe,fog_pars_fragment:Hhe,gradientmap_pars_fragment:Whe,lightmap_pars_fragment:jhe,lights_lambert_fragment:qhe,lights_lambert_pars_fragment:Xhe,lights_pars_begin:Khe,lights_toon_fragment:Zhe,lights_toon_pars_fragment:Qhe,lights_phong_fragment:Jhe,lights_phong_pars_fragment:efe,lights_physical_fragment:tfe,lights_physical_pars_fragment:nfe,lights_fragment_begin:ife,lights_fragment_maps:rfe,lights_fragment_end:sfe,logdepthbuf_fragment:ofe,logdepthbuf_pars_fragment:afe,logdepthbuf_pars_vertex:lfe,logdepthbuf_vertex:cfe,map_fragment:ufe,map_pars_fragment:dfe,map_particle_fragment:hfe,map_particle_pars_fragment:ffe,metalnessmap_fragment:pfe,metalnessmap_pars_fragment:mfe,morphinstance_vertex:gfe,morphcolor_vertex:yfe,morphnormal_vertex:vfe,morphtarget_pars_vertex:xfe,morphtarget_vertex:_fe,normal_fragment_begin:bfe,normal_fragment_maps:Sfe,normal_pars_fragment:wfe,normal_pars_vertex:Tfe,normal_vertex:Efe,normalmap_pars_fragment:Mfe,clearcoat_normal_fragment_begin:Afe,clearcoat_normal_fragment_maps:Cfe,clearcoat_pars_fragment:Rfe,iridescence_pars_fragment:Pfe,opaque_fragment:Nfe,packing:kfe,premultiplied_alpha_fragment:Lfe,project_vertex:Ife,dithering_fragment:Dfe,dithering_pars_fragment:Ofe,roughnessmap_fragment:Ffe,roughnessmap_pars_fragment:Bfe,shadowmap_pars_fragment:Ufe,shadowmap_pars_vertex:zfe,shadowmap_vertex:Vfe,shadowmask_pars_fragment:$fe,skinbase_vertex:Gfe,skinning_pars_vertex:Hfe,skinning_vertex:Wfe,skinnormal_vertex:jfe,specularmap_fragment:qfe,specularmap_pars_fragment:Xfe,tonemapping_fragment:Kfe,tonemapping_pars_fragment:Yfe,transmission_fragment:Zfe,transmission_pars_fragment:Qfe,uv_pars_fragment:Jfe,uv_pars_vertex:epe,uv_vertex:tpe,worldpos_vertex:npe,background_vert:ipe,background_frag:rpe,backgroundCube_vert:spe,backgroundCube_frag:ope,cube_vert:ape,cube_frag:lpe,depth_vert:cpe,depth_frag:upe,distanceRGBA_vert:dpe,distanceRGBA_frag:hpe,equirect_vert:fpe,equirect_frag:ppe,linedashed_vert:mpe,linedashed_frag:gpe,meshbasic_vert:ype,meshbasic_frag:vpe,meshlambert_vert:xpe,meshlambert_frag:_pe,meshmatcap_vert:bpe,meshmatcap_frag:Spe,meshnormal_vert:wpe,meshnormal_frag:Tpe,meshphong_vert:Epe,meshphong_frag:Mpe,meshphysical_vert:Ape,meshphysical_frag:Cpe,meshtoon_vert:Rpe,meshtoon_frag:Ppe,points_vert:Npe,points_frag:kpe,shadow_vert:Lpe,shadow_frag:Ipe,sprite_vert:Dpe,sprite_frag:Ope},it={common:{diffuse:{value:new St(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Vt},alphaMap:{value:null},alphaMapTransform:{value:new Vt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Vt}},envmap:{envMap:{value:null},envMapRotation:{value:new Vt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Vt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Vt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Vt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Vt},normalScale:{value:new Oe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Vt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Vt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Vt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Vt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new St(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new St(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Vt},alphaTest:{value:0},uvTransform:{value:new Vt}},sprite:{diffuse:{value:new St(16777215)},opacity:{value:1},center:{value:new Oe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Vt},alphaMap:{value:null},alphaMapTransform:{value:new Vt},alphaTest:{value:0}}},Da={basic:{uniforms:qr([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.fog]),vertexShader:nn.meshbasic_vert,fragmentShader:nn.meshbasic_frag},lambert:{uniforms:qr([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.fog,it.lights,{emissive:{value:new St(0)}}]),vertexShader:nn.meshlambert_vert,fragmentShader:nn.meshlambert_frag},phong:{uniforms:qr([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.fog,it.lights,{emissive:{value:new St(0)},specular:{value:new St(1118481)},shininess:{value:30}}]),vertexShader:nn.meshphong_vert,fragmentShader:nn.meshphong_frag},standard:{uniforms:qr([it.common,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.roughnessmap,it.metalnessmap,it.fog,it.lights,{emissive:{value:new St(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:nn.meshphysical_vert,fragmentShader:nn.meshphysical_frag},toon:{uniforms:qr([it.common,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.gradientmap,it.fog,it.lights,{emissive:{value:new St(0)}}]),vertexShader:nn.meshtoon_vert,fragmentShader:nn.meshtoon_frag},matcap:{uniforms:qr([it.common,it.bumpmap,it.normalmap,it.displacementmap,it.fog,{matcap:{value:null}}]),vertexShader:nn.meshmatcap_vert,fragmentShader:nn.meshmatcap_frag},points:{uniforms:qr([it.points,it.fog]),vertexShader:nn.points_vert,fragmentShader:nn.points_frag},dashed:{uniforms:qr([it.common,it.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:nn.linedashed_vert,fragmentShader:nn.linedashed_frag},depth:{uniforms:qr([it.common,it.displacementmap]),vertexShader:nn.depth_vert,fragmentShader:nn.depth_frag},normal:{uniforms:qr([it.common,it.bumpmap,it.normalmap,it.displacementmap,{opacity:{value:1}}]),vertexShader:nn.meshnormal_vert,fragmentShader:nn.meshnormal_frag},sprite:{uniforms:qr([it.sprite,it.fog]),vertexShader:nn.sprite_vert,fragmentShader:nn.sprite_frag},background:{uniforms:{uvTransform:{value:new Vt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:nn.background_vert,fragmentShader:nn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Vt}},vertexShader:nn.backgroundCube_vert,fragmentShader:nn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:nn.cube_vert,fragmentShader:nn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:nn.equirect_vert,fragmentShader:nn.equirect_frag},distanceRGBA:{uniforms:qr([it.common,it.displacementmap,{referencePosition:{value:new K},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:nn.distanceRGBA_vert,fragmentShader:nn.distanceRGBA_frag},shadow:{uniforms:qr([it.lights,it.fog,{color:{value:new St(0)},opacity:{value:1}}]),vertexShader:nn.shadow_vert,fragmentShader:nn.shadow_frag}};Da.physical={uniforms:qr([Da.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Vt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Vt},clearcoatNormalScale:{value:new Oe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Vt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Vt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Vt},sheen:{value:0},sheenColor:{value:new St(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Vt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Vt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Vt},transmissionSamplerSize:{value:new Oe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Vt},attenuationDistance:{value:0},attenuationColor:{value:new St(0)},specularColor:{value:new St(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Vt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Vt},anisotropyVector:{value:new Oe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Vt}}]),vertexShader:nn.meshphysical_vert,fragmentShader:nn.meshphysical_frag};const Rx={r:0,b:0,g:0},Gu=new ks,Fpe=new ln;function Bpe(i,e,n,r,s,o,a){const l=new St(0);let c=o===!0?0:1,u,d,h=null,f=0,p=null;function m(x){let b=x.isScene===!0?x.background:null;return b&&b.isTexture&&(b=(x.backgroundBlurriness>0?n:e).get(b)),b}function y(x){let b=!1;const S=m(x);S===null?g(l,c):S&&S.isColor&&(g(S,1),b=!0);const T=i.xr.getEnvironmentBlendMode();T==="additive"?r.buffers.color.setClear(0,0,0,1,a):T==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(i.autoClear||b)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function v(x,b){const S=m(b);S&&(S.isCubeTexture||S.mapping===Ud)?(d===void 0&&(d=new Xn(new ja(1,1,1),new Ka({name:"BackgroundCubeMaterial",uniforms:Cp(Da.backgroundCube.uniforms),vertexShader:Da.backgroundCube.vertexShader,fragmentShader:Da.backgroundCube.fragmentShader,side:On,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(T,w,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(d)),Gu.copy(b.backgroundRotation),Gu.x*=-1,Gu.y*=-1,Gu.z*=-1,S.isCubeTexture&&S.isRenderTargetTexture===!1&&(Gu.y*=-1,Gu.z*=-1),d.material.uniforms.envMap.value=S,d.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=b.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,d.material.uniforms.backgroundRotation.value.setFromMatrix4(Fpe.makeRotationFromEuler(Gu)),d.material.toneMapped=rn.getTransfer(S.colorSpace)!==Tn,(h!==S||f!==S.version||p!==i.toneMapping)&&(d.material.needsUpdate=!0,h=S,f=S.version,p=i.toneMapping),d.layers.enableAll(),x.unshift(d,d.geometry,d.material,0,0,null)):S&&S.isTexture&&(u===void 0&&(u=new Xn(new W0(2,2),new Ka({name:"BackgroundMaterial",uniforms:Cp(Da.background.uniforms),vertexShader:Da.background.vertexShader,fragmentShader:Da.background.fragmentShader,side:Cs,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(u)),u.material.uniforms.t2D.value=S,u.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,u.material.toneMapped=rn.getTransfer(S.colorSpace)!==Tn,S.matrixAutoUpdate===!0&&S.updateMatrix(),u.material.uniforms.uvTransform.value.copy(S.matrix),(h!==S||f!==S.version||p!==i.toneMapping)&&(u.material.needsUpdate=!0,h=S,f=S.version,p=i.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null))}function g(x,b){x.getRGB(Rx,eG(i)),r.buffers.color.setClear(Rx.r,Rx.g,Rx.b,b,a)}function _(){d!==void 0&&(d.geometry.dispose(),d.material.dispose(),d=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return l},setClearColor:function(x,b=1){l.set(x),c=b,g(l,c)},getClearAlpha:function(){return c},setClearAlpha:function(x){c=x,g(l,c)},render:y,addToRenderList:v,dispose:_}}function Upe(i,e){const n=i.getParameter(i.MAX_VERTEX_ATTRIBS),r={},s=f(null);let o=s,a=!1;function l(M,R,F,B,C){let L=!1;const P=h(B,F,R);o!==P&&(o=P,u(o.object)),L=p(M,B,F,C),L&&m(M,B,F,C),C!==null&&e.update(C,i.ELEMENT_ARRAY_BUFFER),(L||a)&&(a=!1,b(M,R,F,B),C!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(C).buffer))}function c(){return i.createVertexArray()}function u(M){return i.bindVertexArray(M)}function d(M){return i.deleteVertexArray(M)}function h(M,R,F){const B=F.wireframe===!0;let C=r[M.id];C===void 0&&(C={},r[M.id]=C);let L=C[R.id];L===void 0&&(L={},C[R.id]=L);let P=L[B];return P===void 0&&(P=f(c()),L[B]=P),P}function f(M){const R=[],F=[],B=[];for(let C=0;C<n;C++)R[C]=0,F[C]=0,B[C]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:R,enabledAttributes:F,attributeDivisors:B,object:M,attributes:{},index:null}}function p(M,R,F,B){const C=o.attributes,L=R.attributes;let P=0;const W=F.getAttributes();for(const D in W)if(W[D].location>=0){const q=C[D];let J=L[D];if(J===void 0&&(D==="instanceMatrix"&&M.instanceMatrix&&(J=M.instanceMatrix),D==="instanceColor"&&M.instanceColor&&(J=M.instanceColor)),q===void 0||q.attribute!==J||J&&q.data!==J.data)return!0;P++}return o.attributesNum!==P||o.index!==B}function m(M,R,F,B){const C={},L=R.attributes;let P=0;const W=F.getAttributes();for(const D in W)if(W[D].location>=0){let q=L[D];q===void 0&&(D==="instanceMatrix"&&M.instanceMatrix&&(q=M.instanceMatrix),D==="instanceColor"&&M.instanceColor&&(q=M.instanceColor));const J={};J.attribute=q,q&&q.data&&(J.data=q.data),C[D]=J,P++}o.attributes=C,o.attributesNum=P,o.index=B}function y(){const M=o.newAttributes;for(let R=0,F=M.length;R<F;R++)M[R]=0}function v(M){g(M,0)}function g(M,R){const F=o.newAttributes,B=o.enabledAttributes,C=o.attributeDivisors;F[M]=1,B[M]===0&&(i.enableVertexAttribArray(M),B[M]=1),C[M]!==R&&(i.vertexAttribDivisor(M,R),C[M]=R)}function _(){const M=o.newAttributes,R=o.enabledAttributes;for(let F=0,B=R.length;F<B;F++)R[F]!==M[F]&&(i.disableVertexAttribArray(F),R[F]=0)}function x(M,R,F,B,C,L,P){P===!0?i.vertexAttribIPointer(M,R,F,C,L):i.vertexAttribPointer(M,R,F,B,C,L)}function b(M,R,F,B){y();const C=B.attributes,L=F.getAttributes(),P=R.defaultAttributeValues;for(const W in L){const D=L[W];if(D.location>=0){let X=C[W];if(X===void 0&&(W==="instanceMatrix"&&M.instanceMatrix&&(X=M.instanceMatrix),W==="instanceColor"&&M.instanceColor&&(X=M.instanceColor)),X!==void 0){const q=X.normalized,J=X.itemSize,se=e.get(X);if(se===void 0)continue;const de=se.buffer,G=se.type,Q=se.bytesPerElement,ee=G===i.INT||G===i.UNSIGNED_INT||X.gpuType===or;if(X.isInterleavedBufferAttribute){const ie=X.data,Se=ie.stride,Fe=X.offset;if(ie.isInstancedInterleavedBuffer){for(let Be=0;Be<D.locationSize;Be++)g(D.location+Be,ie.meshPerAttribute);M.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=ie.meshPerAttribute*ie.count)}else for(let Be=0;Be<D.locationSize;Be++)v(D.location+Be);i.bindBuffer(i.ARRAY_BUFFER,de);for(let Be=0;Be<D.locationSize;Be++)x(D.location+Be,J/D.locationSize,G,q,Se*Q,(Fe+J/D.locationSize*Be)*Q,ee)}else{if(X.isInstancedBufferAttribute){for(let ie=0;ie<D.locationSize;ie++)g(D.location+ie,X.meshPerAttribute);M.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let ie=0;ie<D.locationSize;ie++)v(D.location+ie);i.bindBuffer(i.ARRAY_BUFFER,de);for(let ie=0;ie<D.locationSize;ie++)x(D.location+ie,J/D.locationSize,G,q,J*Q,J/D.locationSize*ie*Q,ee)}}else if(P!==void 0){const q=P[W];if(q!==void 0)switch(q.length){case 2:i.vertexAttrib2fv(D.location,q);break;case 3:i.vertexAttrib3fv(D.location,q);break;case 4:i.vertexAttrib4fv(D.location,q);break;default:i.vertexAttrib1fv(D.location,q)}}}}_()}function S(){E();for(const M in r){const R=r[M];for(const F in R){const B=R[F];for(const C in B)d(B[C].object),delete B[C];delete R[F]}delete r[M]}}function T(M){if(r[M.id]===void 0)return;const R=r[M.id];for(const F in R){const B=R[F];for(const C in B)d(B[C].object),delete B[C];delete R[F]}delete r[M.id]}function w(M){for(const R in r){const F=r[R];if(F[M.id]===void 0)continue;const B=F[M.id];for(const C in B)d(B[C].object),delete B[C];delete F[M.id]}}function E(){A(),a=!0,o!==s&&(o=s,u(o.object))}function A(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:l,reset:E,resetDefaultState:A,dispose:S,releaseStatesOfGeometry:T,releaseStatesOfProgram:w,initAttributes:y,enableAttribute:v,disableUnusedAttributes:_}}function zpe(i,e,n){let r;function s(u){r=u}function o(u,d){i.drawArrays(r,u,d),n.update(d,r,1)}function a(u,d,h){h!==0&&(i.drawArraysInstanced(r,u,d,h),n.update(d,r,h))}function l(u,d,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,u,0,d,0,h);let p=0;for(let m=0;m<h;m++)p+=d[m];n.update(p,r,1)}function c(u,d,h,f){if(h===0)return;const p=e.get("WEBGL_multi_draw");if(p===null)for(let m=0;m<u.length;m++)a(u[m],d[m],f[m]);else{p.multiDrawArraysInstancedWEBGL(r,u,0,d,0,f,0,h);let m=0;for(let y=0;y<h;y++)m+=d[y]*f[y];n.update(m,r,1)}}this.setMode=s,this.render=o,this.renderInstances=a,this.renderMultiDraw=l,this.renderMultiDrawInstances=c}function Vpe(i,e,n,r){let s;function o(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const w=e.get("EXT_texture_filter_anisotropic");s=i.getParameter(w.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function a(w){return!(w!==yi&&r.convert(w)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(w){const E=w===lr&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(w!==ci&&r.convert(w)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&w!==wi&&!E)}function c(w){if(w==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";w="mediump"}return w==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=n.precision!==void 0?n.precision:"highp";const d=c(u);d!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",d,"instead."),u=d);const h=n.logarithmicDepthBuffer===!0,f=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),p=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),m=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=i.getParameter(i.MAX_TEXTURE_SIZE),v=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),g=i.getParameter(i.MAX_VERTEX_ATTRIBS),_=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),x=i.getParameter(i.MAX_VARYING_VECTORS),b=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),S=m>0,T=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:c,textureFormatReadable:a,textureTypeReadable:l,precision:u,logarithmicDepthBuffer:h,reverseDepthBuffer:f,maxTextures:p,maxVertexTextures:m,maxTextureSize:y,maxCubemapSize:v,maxAttributes:g,maxVertexUniforms:_,maxVaryings:x,maxFragmentUniforms:b,vertexTextures:S,maxSamples:T}}function $pe(i){const e=this;let n=null,r=0,s=!1,o=!1;const a=new Ws,l=new Vt,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(h,f){const p=h.length!==0||f||r!==0||s;return s=f,r=h.length,p},this.beginShadows=function(){o=!0,d(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(h,f){n=d(h,f,0)},this.setState=function(h,f,p){const m=h.clippingPlanes,y=h.clipIntersection,v=h.clipShadows,g=i.get(h);if(!s||m===null||m.length===0||o&&!v)o?d(null):u();else{const _=o?0:r,x=_*4;let b=g.clippingState||null;c.value=b,b=d(m,f,x,p);for(let S=0;S!==x;++S)b[S]=n[S];g.clippingState=b,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=_}};function u(){c.value!==n&&(c.value=n,c.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function d(h,f,p,m){const y=h!==null?h.length:0;let v=null;if(y!==0){if(v=c.value,m!==!0||v===null){const g=p+y*4,_=f.matrixWorldInverse;l.getNormalMatrix(_),(v===null||v.length<g)&&(v=new Float32Array(g));for(let x=0,b=p;x!==y;++x,b+=4)a.copy(h[x]).applyMatrix4(_,l),a.normal.toArray(v,b),v[b+3]=a.constant}c.value=v,c.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,v}}function Gpe(i){let e=new WeakMap;function n(a,l){return l===Fd?a.mapping=pa:l===Bd&&(a.mapping=ma),a}function r(a){if(a&&a.isTexture){const l=a.mapping;if(l===Fd||l===Bd)if(e.has(a)){const c=e.get(a).texture;return n(c,a.mapping)}else{const c=a.image;if(c&&c.height>0){const u=new iG(c.height);return u.fromEquirectangularTexture(i,a),e.set(a,u),a.addEventListener("dispose",s),n(u.texture,a.mapping)}else return null}}return a}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap}return{get:r,dispose:o}}const _f=4,tF=[.125,.215,.35,.446,.526,.582],od=20,UE=new j0,nF=new St;let zE=null,VE=0,$E=0,GE=!1;const nd=(1+Math.sqrt(5))/2,Uh=1/nd,iF=[new K(-nd,Uh,0),new K(nd,Uh,0),new K(-Uh,0,nd),new K(Uh,0,nd),new K(0,nd,-Uh),new K(0,nd,Uh),new K(-1,1,-1),new K(1,1,-1),new K(-1,1,1),new K(1,1,1)],Hpe=new K;let rF=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,s=100,o={}){const{size:a=256,position:l=Hpe}=o;zE=this._renderer.getRenderTarget(),VE=this._renderer.getActiveCubeFace(),$E=this._renderer.getActiveMipmapLevel(),GE=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,r,s,c,l),n>0&&this._blur(c,0,0,n),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=aF(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=oF(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(zE,VE,$E),this._renderer.xr.enabled=GE,e.scissorTest=!1,Px(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===pa||e.mapping===ma?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),zE=this._renderer.getRenderTarget(),VE=this._renderer.getActiveCubeFace(),$E=this._renderer.getActiveMipmapLevel(),GE=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:Xi,minFilter:Xi,generateMipmaps:!1,type:lr,format:yi,colorSpace:Wa,depthBuffer:!1},s=sF(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=sF(e,n,r);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Wpe(o)),this._blurMaterial=jpe(o,e,n)}return s}_compileMaterial(e){const n=new Xn(this._lodPlanes[0],e);this._renderer.compile(n,UE)}_sceneToCubeUV(e,n,r,s,o){const c=new ar(90,1,n,r),u=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],h=this._renderer,f=h.autoClear,p=h.toneMapping;h.getClearColor(nF),h.toneMapping=Ps,h.autoClear=!1;const m=new es({name:"PMREM.Background",side:On,depthWrite:!1,depthTest:!1}),y=new Xn(new ja,m);let v=!1;const g=e.background;g?g.isColor&&(m.color.copy(g),e.background=null,v=!0):(m.color.copy(nF),v=!0);for(let _=0;_<6;_++){const x=_%3;x===0?(c.up.set(0,u[_],0),c.position.set(o.x,o.y,o.z),c.lookAt(o.x+d[_],o.y,o.z)):x===1?(c.up.set(0,0,u[_]),c.position.set(o.x,o.y,o.z),c.lookAt(o.x,o.y+d[_],o.z)):(c.up.set(0,u[_],0),c.position.set(o.x,o.y,o.z),c.lookAt(o.x,o.y,o.z+d[_]));const b=this._cubeSize;Px(s,x*b,_>2?b:0,b,b),h.setRenderTarget(s),v&&h.render(y,c),h.render(e,c)}y.geometry.dispose(),y.material.dispose(),h.toneMapping=p,h.autoClear=f,e.background=g}_textureToCubeUV(e,n){const r=this._renderer,s=e.mapping===pa||e.mapping===ma;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=aF()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=oF());const o=s?this._cubemapMaterial:this._equirectMaterial,a=new Xn(this._lodPlanes[0],o),l=o.uniforms;l.envMap.value=e;const c=this._cubeSize;Px(n,0,0,3*c,2*c),r.setRenderTarget(n),r.render(a,UE)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;const s=this._lodPlanes.length;for(let o=1;o<s;o++){const a=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),l=iF[(s-o-1)%iF.length];this._blur(e,o-1,o,a,l)}n.autoClear=r}_blur(e,n,r,s,o){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,r,s,"latitudinal",o),this._halfBlur(a,e,r,r,s,"longitudinal",o)}_halfBlur(e,n,r,s,o,a,l){const c=this._renderer,u=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,h=new Xn(this._lodPlanes[s],u),f=u.uniforms,p=this._sizeLods[r]-1,m=isFinite(o)?Math.PI/(2*p):2*Math.PI/(2*od-1),y=o/m,v=isFinite(o)?1+Math.floor(d*y):od;v>od&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${od}`);const g=[];let _=0;for(let w=0;w<od;++w){const E=w/y,A=Math.exp(-E*E/2);g.push(A),w===0?_+=A:w<v&&(_+=2*A)}for(let w=0;w<g.length;w++)g[w]=g[w]/_;f.envMap.value=e.texture,f.samples.value=v,f.weights.value=g,f.latitudinal.value=a==="latitudinal",l&&(f.poleAxis.value=l);const{_lodMax:x}=this;f.dTheta.value=m,f.mipInt.value=x-r;const b=this._sizeLods[s],S=3*b*(s>x-_f?s-x+_f:0),T=4*(this._cubeSize-b);Px(n,S,T,3*b,2*b),c.setRenderTarget(n),c.render(h,UE)}};function Wpe(i){const e=[],n=[],r=[];let s=i;const o=i-_f+1+tF.length;for(let a=0;a<o;a++){const l=Math.pow(2,s);n.push(l);let c=1/l;a>i-_f?c=tF[a-i+_f-1]:a===0&&(c=0),r.push(c);const u=1/(l-2),d=-u,h=1+u,f=[d,d,h,d,h,h,d,d,h,h,d,h],p=6,m=6,y=3,v=2,g=1,_=new Float32Array(y*m*p),x=new Float32Array(v*m*p),b=new Float32Array(g*m*p);for(let T=0;T<p;T++){const w=T%3*2/3-1,E=T>2?0:-1,A=[w,E,0,w+2/3,E,0,w+2/3,E+1,0,w,E,0,w+2/3,E+1,0,w,E+1,0];_.set(A,y*m*T),x.set(f,v*m*T);const M=[T,T,T,T,T,T];b.set(M,g*m*T)}const S=new Tr;S.setAttribute("position",new Yi(_,y)),S.setAttribute("uv",new Yi(x,v)),S.setAttribute("faceIndex",new Yi(b,g)),e.push(S),s>_f&&s--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function sF(i,e,n){const r=new gu(i,e,n);return r.texture.mapping=Ud,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Px(i,e,n,r,s){i.viewport.set(e,n,r,s),i.scissor.set(e,n,r,s)}function jpe(i,e,n){const r=new Float32Array(od),s=new K(0,1,0);return new Ka({name:"SphericalGaussianBlur",defines:{n:od,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:h2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function oF(){return new Ka({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:h2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function aF(){return new Ka({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:h2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function h2(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function qpe(i){let e=new WeakMap,n=null;function r(l){if(l&&l.isTexture){const c=l.mapping,u=c===Fd||c===Bd,d=c===pa||c===ma;if(u||d){let h=e.get(l);const f=h!==void 0?h.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==f)return n===null&&(n=new rF(i)),h=u?n.fromEquirectangular(l,h):n.fromCubemap(l,h),h.texture.pmremVersion=l.pmremVersion,e.set(l,h),h.texture;if(h!==void 0)return h.texture;{const p=l.image;return u&&p&&p.height>0||d&&p&&s(p)?(n===null&&(n=new rF(i)),h=u?n.fromEquirectangular(l):n.fromCubemap(l),h.texture.pmremVersion=l.pmremVersion,e.set(l,h),l.addEventListener("dispose",o),h.texture):null}}}return l}function s(l){let c=0;const u=6;for(let d=0;d<u;d++)l[d]!==void 0&&c++;return c===u}function o(l){const c=l.target;c.removeEventListener("dispose",o);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function a(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:a}}function Xpe(i){const e={};function n(r){if(e[r]!==void 0)return e[r];let s;switch(r){case"WEBGL_depth_texture":s=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=i.getExtension(r)}return e[r]=s,s}return{has:function(r){return n(r)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(r){const s=n(r);return s===null&&da("THREE.WebGLRenderer: "+r+" extension not supported."),s}}}function Kpe(i,e,n,r){const s={},o=new WeakMap;function a(h){const f=h.target;f.index!==null&&e.remove(f.index);for(const m in f.attributes)e.remove(f.attributes[m]);f.removeEventListener("dispose",a),delete s[f.id];const p=o.get(f);p&&(e.remove(p),o.delete(f)),r.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,n.memory.geometries--}function l(h,f){return s[f.id]===!0||(f.addEventListener("dispose",a),s[f.id]=!0,n.memory.geometries++),f}function c(h){const f=h.attributes;for(const p in f)e.update(f[p],i.ARRAY_BUFFER)}function u(h){const f=[],p=h.index,m=h.attributes.position;let y=0;if(p!==null){const _=p.array;y=p.version;for(let x=0,b=_.length;x<b;x+=3){const S=_[x+0],T=_[x+1],w=_[x+2];f.push(S,T,T,w,w,S)}}else if(m!==void 0){const _=m.array;y=m.version;for(let x=0,b=_.length/3-1;x<b;x+=3){const S=x+0,T=x+1,w=x+2;f.push(S,T,T,w,w,S)}}else return;const v=new(QN(f)?n2:t2)(f,1);v.version=y;const g=o.get(h);g&&e.remove(g),o.set(h,v)}function d(h){const f=o.get(h);if(f){const p=h.index;p!==null&&f.version<p.version&&u(h)}else u(h);return o.get(h)}return{get:l,update:c,getWireframeAttribute:d}}function Ype(i,e,n){let r;function s(f){r=f}let o,a;function l(f){o=f.type,a=f.bytesPerElement}function c(f,p){i.drawElements(r,p,o,f*a),n.update(p,r,1)}function u(f,p,m){m!==0&&(i.drawElementsInstanced(r,p,o,f*a,m),n.update(p,r,m))}function d(f,p,m){if(m===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,p,0,o,f,0,m);let v=0;for(let g=0;g<m;g++)v+=p[g];n.update(v,r,1)}function h(f,p,m,y){if(m===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let g=0;g<f.length;g++)u(f[g]/a,p[g],y[g]);else{v.multiDrawElementsInstancedWEBGL(r,p,0,o,f,0,y,0,m);let g=0;for(let _=0;_<m;_++)g+=p[_]*y[_];n.update(g,r,1)}}this.setMode=s,this.setIndex=l,this.render=c,this.renderInstances=u,this.renderMultiDraw=d,this.renderMultiDrawInstances=h}function Zpe(i){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(o,a,l){switch(n.calls++,a){case i.TRIANGLES:n.triangles+=l*(o/3);break;case i.LINES:n.lines+=l*(o/2);break;case i.LINE_STRIP:n.lines+=l*(o-1);break;case i.LINE_LOOP:n.lines+=l*o;break;case i.POINTS:n.points+=l*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function s(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:s,update:r}}function Qpe(i,e,n){const r=new WeakMap,s=new Dt;function o(a,l,c){const u=a.morphTargetInfluences,d=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,h=d!==void 0?d.length:0;let f=r.get(l);if(f===void 0||f.count!==h){let M=function(){E.dispose(),r.delete(l),l.removeEventListener("dispose",M)};var p=M;f!==void 0&&f.texture.dispose();const m=l.morphAttributes.position!==void 0,y=l.morphAttributes.normal!==void 0,v=l.morphAttributes.color!==void 0,g=l.morphAttributes.position||[],_=l.morphAttributes.normal||[],x=l.morphAttributes.color||[];let b=0;m===!0&&(b=1),y===!0&&(b=2),v===!0&&(b=3);let S=l.attributes.position.count*b,T=1;S>e.maxTextureSize&&(T=Math.ceil(S/e.maxTextureSize),S=e.maxTextureSize);const w=new Float32Array(S*T*4*h),E=new ew(w,S,T,h);E.type=wi,E.needsUpdate=!0;const A=b*4;for(let R=0;R<h;R++){const F=g[R],B=_[R],C=x[R],L=S*T*4*R;for(let P=0;P<F.count;P++){const W=P*A;m===!0&&(s.fromBufferAttribute(F,P),w[L+W+0]=s.x,w[L+W+1]=s.y,w[L+W+2]=s.z,w[L+W+3]=0),y===!0&&(s.fromBufferAttribute(B,P),w[L+W+4]=s.x,w[L+W+5]=s.y,w[L+W+6]=s.z,w[L+W+7]=0),v===!0&&(s.fromBufferAttribute(C,P),w[L+W+8]=s.x,w[L+W+9]=s.y,w[L+W+10]=s.z,w[L+W+11]=C.itemSize===4?s.w:1)}}f={count:h,texture:E,size:new Oe(S,T)},r.set(l,f),l.addEventListener("dispose",M)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)c.getUniforms().setValue(i,"morphTexture",a.morphTexture,n);else{let m=0;for(let v=0;v<u.length;v++)m+=u[v];const y=l.morphTargetsRelative?1:1-m;c.getUniforms().setValue(i,"morphTargetBaseInfluence",y),c.getUniforms().setValue(i,"morphTargetInfluences",u)}c.getUniforms().setValue(i,"morphTargetsTexture",f.texture,n),c.getUniforms().setValue(i,"morphTargetsTextureSize",f.size)}return{update:o}}function Jpe(i,e,n,r){let s=new WeakMap;function o(c){const u=r.render.frame,d=c.geometry,h=e.get(c,d);if(s.get(h)!==u&&(e.update(h),s.set(h,u)),c.isInstancedMesh&&(c.hasEventListener("dispose",l)===!1&&c.addEventListener("dispose",l),s.get(c)!==u&&(n.update(c.instanceMatrix,i.ARRAY_BUFFER),c.instanceColor!==null&&n.update(c.instanceColor,i.ARRAY_BUFFER),s.set(c,u))),c.isSkinnedMesh){const f=c.skeleton;s.get(f)!==u&&(f.update(),s.set(f,u))}return h}function a(){s=new WeakMap}function l(c){const u=c.target;u.removeEventListener("dispose",l),n.remove(u.instanceMatrix),u.instanceColor!==null&&n.remove(u.instanceColor)}return{update:o,dispose:a}}const vG=new Ki,lF=new ro(1,1),xG=new ew,_G=new Xue,bG=new nw,cF=[],uF=[],dF=new Float32Array(16),hF=new Float32Array(9),fF=new Float32Array(4);function sm(i,e,n){const r=i[0];if(r<=0||r>0)return i;const s=e*n;let o=cF[s];if(o===void 0&&(o=new Float32Array(s),cF[s]=o),e!==0){r.toArray(o,0);for(let a=1,l=0;a!==e;++a)l+=n,i[a].toArray(o,l)}return o}function Qi(i,e){if(i.length!==e.length)return!1;for(let n=0,r=i.length;n<r;n++)if(i[n]!==e[n])return!1;return!0}function Ji(i,e){for(let n=0,r=e.length;n<r;n++)i[n]=e[n]}function ow(i,e){let n=uF[e];n===void 0&&(n=new Int32Array(e),uF[e]=n);for(let r=0;r!==e;++r)n[r]=i.allocateTextureUnit();return n}function eme(i,e){const n=this.cache;n[0]!==e&&(i.uniform1f(this.addr,e),n[0]=e)}function tme(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Qi(n,e))return;i.uniform2fv(this.addr,e),Ji(n,e)}}function nme(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Qi(n,e))return;i.uniform3fv(this.addr,e),Ji(n,e)}}function ime(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Qi(n,e))return;i.uniform4fv(this.addr,e),Ji(n,e)}}function rme(i,e){const n=this.cache,r=e.elements;if(r===void 0){if(Qi(n,e))return;i.uniformMatrix2fv(this.addr,!1,e),Ji(n,e)}else{if(Qi(n,r))return;fF.set(r),i.uniformMatrix2fv(this.addr,!1,fF),Ji(n,r)}}function sme(i,e){const n=this.cache,r=e.elements;if(r===void 0){if(Qi(n,e))return;i.uniformMatrix3fv(this.addr,!1,e),Ji(n,e)}else{if(Qi(n,r))return;hF.set(r),i.uniformMatrix3fv(this.addr,!1,hF),Ji(n,r)}}function ome(i,e){const n=this.cache,r=e.elements;if(r===void 0){if(Qi(n,e))return;i.uniformMatrix4fv(this.addr,!1,e),Ji(n,e)}else{if(Qi(n,r))return;dF.set(r),i.uniformMatrix4fv(this.addr,!1,dF),Ji(n,r)}}function ame(i,e){const n=this.cache;n[0]!==e&&(i.uniform1i(this.addr,e),n[0]=e)}function lme(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Qi(n,e))return;i.uniform2iv(this.addr,e),Ji(n,e)}}function cme(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Qi(n,e))return;i.uniform3iv(this.addr,e),Ji(n,e)}}function ume(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Qi(n,e))return;i.uniform4iv(this.addr,e),Ji(n,e)}}function dme(i,e){const n=this.cache;n[0]!==e&&(i.uniform1ui(this.addr,e),n[0]=e)}function hme(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Qi(n,e))return;i.uniform2uiv(this.addr,e),Ji(n,e)}}function fme(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Qi(n,e))return;i.uniform3uiv(this.addr,e),Ji(n,e)}}function pme(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Qi(n,e))return;i.uniform4uiv(this.addr,e),Ji(n,e)}}function mme(i,e,n){const r=this.cache,s=n.allocateTextureUnit();r[0]!==s&&(i.uniform1i(this.addr,s),r[0]=s);let o;this.type===i.SAMPLER_2D_SHADOW?(lF.compareFunction=JS,o=lF):o=vG,n.setTexture2D(e||o,s)}function gme(i,e,n){const r=this.cache,s=n.allocateTextureUnit();r[0]!==s&&(i.uniform1i(this.addr,s),r[0]=s),n.setTexture3D(e||_G,s)}function yme(i,e,n){const r=this.cache,s=n.allocateTextureUnit();r[0]!==s&&(i.uniform1i(this.addr,s),r[0]=s),n.setTextureCube(e||bG,s)}function vme(i,e,n){const r=this.cache,s=n.allocateTextureUnit();r[0]!==s&&(i.uniform1i(this.addr,s),r[0]=s),n.setTexture2DArray(e||xG,s)}function xme(i){switch(i){case 5126:return eme;case 35664:return tme;case 35665:return nme;case 35666:return ime;case 35674:return rme;case 35675:return sme;case 35676:return ome;case 5124:case 35670:return ame;case 35667:case 35671:return lme;case 35668:case 35672:return cme;case 35669:case 35673:return ume;case 5125:return dme;case 36294:return hme;case 36295:return fme;case 36296:return pme;case 35678:case 36198:case 36298:case 36306:case 35682:return mme;case 35679:case 36299:case 36307:return gme;case 35680:case 36300:case 36308:case 36293:return yme;case 36289:case 36303:case 36311:case 36292:return vme}}function _me(i,e){i.uniform1fv(this.addr,e)}function bme(i,e){const n=sm(e,this.size,2);i.uniform2fv(this.addr,n)}function Sme(i,e){const n=sm(e,this.size,3);i.uniform3fv(this.addr,n)}function wme(i,e){const n=sm(e,this.size,4);i.uniform4fv(this.addr,n)}function Tme(i,e){const n=sm(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,n)}function Eme(i,e){const n=sm(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,n)}function Mme(i,e){const n=sm(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,n)}function Ame(i,e){i.uniform1iv(this.addr,e)}function Cme(i,e){i.uniform2iv(this.addr,e)}function Rme(i,e){i.uniform3iv(this.addr,e)}function Pme(i,e){i.uniform4iv(this.addr,e)}function Nme(i,e){i.uniform1uiv(this.addr,e)}function kme(i,e){i.uniform2uiv(this.addr,e)}function Lme(i,e){i.uniform3uiv(this.addr,e)}function Ime(i,e){i.uniform4uiv(this.addr,e)}function Dme(i,e,n){const r=this.cache,s=e.length,o=ow(n,s);Qi(r,o)||(i.uniform1iv(this.addr,o),Ji(r,o));for(let a=0;a!==s;++a)n.setTexture2D(e[a]||vG,o[a])}function Ome(i,e,n){const r=this.cache,s=e.length,o=ow(n,s);Qi(r,o)||(i.uniform1iv(this.addr,o),Ji(r,o));for(let a=0;a!==s;++a)n.setTexture3D(e[a]||_G,o[a])}function Fme(i,e,n){const r=this.cache,s=e.length,o=ow(n,s);Qi(r,o)||(i.uniform1iv(this.addr,o),Ji(r,o));for(let a=0;a!==s;++a)n.setTextureCube(e[a]||bG,o[a])}function Bme(i,e,n){const r=this.cache,s=e.length,o=ow(n,s);Qi(r,o)||(i.uniform1iv(this.addr,o),Ji(r,o));for(let a=0;a!==s;++a)n.setTexture2DArray(e[a]||xG,o[a])}function Ume(i){switch(i){case 5126:return _me;case 35664:return bme;case 35665:return Sme;case 35666:return wme;case 35674:return Tme;case 35675:return Eme;case 35676:return Mme;case 5124:case 35670:return Ame;case 35667:case 35671:return Cme;case 35668:case 35672:return Rme;case 35669:case 35673:return Pme;case 5125:return Nme;case 36294:return kme;case 36295:return Lme;case 36296:return Ime;case 35678:case 36198:case 36298:case 36306:case 35682:return Dme;case 35679:case 36299:case 36307:return Ome;case 35680:case 36300:case 36308:case 36293:return Fme;case 36289:case 36303:case 36311:case 36292:return Bme}}class zme{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.setValue=xme(n.type)}}class Vme{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=Ume(n.type)}}class $me{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const s=this.seq;for(let o=0,a=s.length;o!==a;++o){const l=s[o];l.setValue(e,n[l.id],r)}}}const HE=/(\w+)(\])?(\[|\.)?/g;function pF(i,e){i.seq.push(e),i.map[e.id]=e}function Gme(i,e,n){const r=i.name,s=r.length;for(HE.lastIndex=0;;){const o=HE.exec(r),a=HE.lastIndex;let l=o[1];const c=o[2]==="]",u=o[3];if(c&&(l=l|0),u===void 0||u==="["&&a+2===s){pF(n,u===void 0?new zme(l,i,e):new Vme(l,i,e));break}else{let h=n.map[l];h===void 0&&(h=new $me(l),pF(n,h)),n=h}}}class $_{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let s=0;s<r;++s){const o=e.getActiveUniform(n,s),a=e.getUniformLocation(n,o.name);Gme(o,a,this)}}setValue(e,n,r,s){const o=this.map[n];o!==void 0&&o.setValue(e,r,s)}setOptional(e,n,r){const s=n[r];s!==void 0&&this.setValue(e,r,s)}static upload(e,n,r,s){for(let o=0,a=n.length;o!==a;++o){const l=n[o],c=r[l.id];c.needsUpdate!==!1&&l.setValue(e,c.value,s)}}static seqWithValue(e,n){const r=[];for(let s=0,o=e.length;s!==o;++s){const a=e[s];a.id in n&&r.push(a)}return r}}function mF(i,e,n){const r=i.createShader(e);return i.shaderSource(r,n),i.compileShader(r),r}const Hme=37297;let Wme=0;function jme(i,e){const n=i.split(`
`),r=[],s=Math.max(e-6,0),o=Math.min(e+6,n.length);for(let a=s;a<o;a++){const l=a+1;r.push(`${l===e?">":" "} ${l}: ${n[a]}`)}return r.join(`
`)}const gF=new Vt;function qme(i){rn._getMatrix(gF,rn.workingColorSpace,i);const e=`mat3( ${gF.elements.map(n=>n.toFixed(4))} )`;switch(rn.getTransfer(i)){case Qb:return[e,"LinearTransferOETF"];case Tn:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function yF(i,e,n){const r=i.getShaderParameter(e,i.COMPILE_STATUS),s=i.getShaderInfoLog(e).trim();if(r&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const a=parseInt(o[1]);return n.toUpperCase()+`

`+s+`

`+jme(i.getShaderSource(e),a)}else return s}function Xme(i,e){const n=qme(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function Kme(i,e){let n;switch(e){case H$:n="Linear";break;case W$:n="Reinhard";break;case j$:n="Cineon";break;case q$:n="ACESFilmic";break;case X$:n="AgX";break;case K$:n="Neutral";break;case aue:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+i+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Nx=new K;function Yme(){rn.getLuminanceCoefficients(Nx);const i=Nx.x.toFixed(4),e=Nx.y.toFixed(4),n=Nx.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Zme(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(_g).join(`
`)}function Qme(i){const e=[];for(const n in i){const r=i[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function Jme(i,e){const n={},r=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s++){const o=i.getActiveAttrib(e,s),a=o.name;let l=1;o.type===i.FLOAT_MAT2&&(l=2),o.type===i.FLOAT_MAT3&&(l=3),o.type===i.FLOAT_MAT4&&(l=4),n[a]={type:o.type,location:i.getAttribLocation(e,a),locationSize:l}}return n}function _g(i){return i!==""}function vF(i,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function xF(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ege=/^[ \t]*#include +<([\w\d./]+)>/gm;function zC(i){return i.replace(ege,nge)}const tge=new Map;function nge(i,e){let n=nn[e];if(n===void 0){const r=tge.get(e);if(r!==void 0)n=nn[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return zC(n)}const ige=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _F(i){return i.replace(ige,rge)}function rge(i,e,n,r){let s="";for(let o=parseInt(e);o<parseInt(n);o++)s+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function bF(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function sge(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===PN?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===nue?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Hs&&(e="SHADOWMAP_TYPE_VSM"),e}function oge(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case pa:case ma:e="ENVMAP_TYPE_CUBE";break;case Ud:e="ENVMAP_TYPE_CUBE_UV";break}return e}function age(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case ma:e="ENVMAP_MODE_REFRACTION";break}return e}function lge(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case B0:e="ENVMAP_BLENDING_MULTIPLY";break;case $$:e="ENVMAP_BLENDING_MIX";break;case G$:e="ENVMAP_BLENDING_ADD";break}return e}function cge(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function uge(i,e,n,r){const s=i.getContext(),o=n.defines;let a=n.vertexShader,l=n.fragmentShader;const c=sge(n),u=oge(n),d=age(n),h=lge(n),f=cge(n),p=Zme(n),m=Qme(o),y=s.createProgram();let v,g,_=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(_g).join(`
`),v.length>0&&(v+=`
`),g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(_g).join(`
`),g.length>0&&(g+=`
`)):(v=[bF(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(_g).join(`
`),g=[bF(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",n.envMap?"#define "+h:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ps?"#define TONE_MAPPING":"",n.toneMapping!==Ps?nn.tonemapping_pars_fragment:"",n.toneMapping!==Ps?Kme("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",nn.colorspace_pars_fragment,Xme("linearToOutputTexel",n.outputColorSpace),Yme(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(_g).join(`
`)),a=zC(a),a=vF(a,n),a=xF(a,n),l=zC(l),l=vF(l,n),l=xF(l,n),a=_F(a),l=_F(l),n.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,v=[p,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,g=["#define varying in",n.glslVersion===TO?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===TO?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);const x=_+v+a,b=_+g+l,S=mF(s,s.VERTEX_SHADER,x),T=mF(s,s.FRAGMENT_SHADER,b);s.attachShader(y,S),s.attachShader(y,T),n.index0AttributeName!==void 0?s.bindAttribLocation(y,0,n.index0AttributeName):n.morphTargets===!0&&s.bindAttribLocation(y,0,"position"),s.linkProgram(y);function w(R){if(i.debug.checkShaderErrors){const F=s.getProgramInfoLog(y).trim(),B=s.getShaderInfoLog(S).trim(),C=s.getShaderInfoLog(T).trim();let L=!0,P=!0;if(s.getProgramParameter(y,s.LINK_STATUS)===!1)if(L=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(s,y,S,T);else{const W=yF(s,S,"vertex"),D=yF(s,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(y,s.VALIDATE_STATUS)+`

Material Name: `+R.name+`
Material Type: `+R.type+`

Program Info Log: `+F+`
`+W+`
`+D)}else F!==""?console.warn("THREE.WebGLProgram: Program Info Log:",F):(B===""||C==="")&&(P=!1);P&&(R.diagnostics={runnable:L,programLog:F,vertexShader:{log:B,prefix:v},fragmentShader:{log:C,prefix:g}})}s.deleteShader(S),s.deleteShader(T),E=new $_(s,y),A=Jme(s,y)}let E;this.getUniforms=function(){return E===void 0&&w(this),E};let A;this.getAttributes=function(){return A===void 0&&w(this),A};let M=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return M===!1&&(M=s.getProgramParameter(y,Hme)),M},this.destroy=function(){r.releaseStatesOfProgram(this),s.deleteProgram(y),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Wme++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=S,this.fragmentShader=T,this}let dge=0;class hge{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,s=this._getShaderStage(n),o=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(s)===!1&&(a.add(s),s.usedTimes++),a.has(o)===!1&&(a.add(o),o.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new fge(e),n.set(e,r)),r}}class fge{constructor(e){this.id=dge++,this.code=e,this.usedTimes=0}}function pge(i,e,n,r,s,o,a){const l=new e2,c=new hge,u=new Set,d=[],h=s.logarithmicDepthBuffer,f=s.vertexTextures;let p=s.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(A){return u.add(A),A===0?"uv":`uv${A}`}function v(A,M,R,F,B){const C=F.fog,L=B.geometry,P=A.isMeshStandardMaterial?F.environment:null,W=(A.isMeshStandardMaterial?n:e).get(A.envMap||P),D=W&&W.mapping===Ud?W.image.height:null,X=m[A.type];A.precision!==null&&(p=s.getMaxPrecision(A.precision),p!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",p,"instead."));const q=L.morphAttributes.position||L.morphAttributes.normal||L.morphAttributes.color,J=q!==void 0?q.length:0;let se=0;L.morphAttributes.position!==void 0&&(se=1),L.morphAttributes.normal!==void 0&&(se=2),L.morphAttributes.color!==void 0&&(se=3);let de,G,Q,ee;if(X){const Jt=Da[X];de=Jt.vertexShader,G=Jt.fragmentShader}else de=A.vertexShader,G=A.fragmentShader,c.update(A),Q=c.getVertexShaderID(A),ee=c.getFragmentShaderID(A);const ie=i.getRenderTarget(),Se=i.state.buffers.depth.getReversed(),Fe=B.isInstancedMesh===!0,Be=B.isBatchedMesh===!0,ct=!!A.map,xt=!!A.matcap,He=!!W,Z=!!A.aoMap,Nt=!!A.lightMap,Rt=!!A.bumpMap,mt=!!A.normalMap,Je=!!A.displacementMap,qt=!!A.emissiveMap,et=!!A.metalnessMap,j=!!A.roughnessMap,O=A.anisotropy>0,ce=A.clearcoat>0,ye=A.dispersion>0,Ae=A.iridescence>0,we=A.sheen>0,ot=A.transmission>0,Pe=O&&!!A.anisotropyMap,Ce=ce&&!!A.clearcoatMap,vt=ce&&!!A.clearcoatNormalMap,Ne=ce&&!!A.clearcoatRoughnessMap,st=Ae&&!!A.iridescenceMap,ke=Ae&&!!A.iridescenceThicknessMap,Ye=we&&!!A.sheenColorMap,pe=we&&!!A.sheenRoughnessMap,Ue=!!A.specularMap,tt=!!A.specularColorMap,_t=!!A.specularIntensityMap,ne=ot&&!!A.transmissionMap,$e=ot&&!!A.thicknessMap,me=!!A.gradientMap,Me=!!A.alphaMap,Xe=A.alphaTest>0,Ze=!!A.alphaHash,Wt=!!A.extensions;let $n=Ps;A.toneMapped&&(ie===null||ie.isXRRenderTarget===!0)&&($n=i.toneMapping);const tr={shaderID:X,shaderType:A.type,shaderName:A.name,vertexShader:de,fragmentShader:G,defines:A.defines,customVertexShaderID:Q,customFragmentShaderID:ee,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:p,batching:Be,batchingColor:Be&&B._colorsTexture!==null,instancing:Fe,instancingColor:Fe&&B.instanceColor!==null,instancingMorph:Fe&&B.morphTexture!==null,supportsVertexTextures:f,outputColorSpace:ie===null?i.outputColorSpace:ie.isXRRenderTarget===!0?ie.texture.colorSpace:Wa,alphaToCoverage:!!A.alphaToCoverage,map:ct,matcap:xt,envMap:He,envMapMode:He&&W.mapping,envMapCubeUVHeight:D,aoMap:Z,lightMap:Nt,bumpMap:Rt,normalMap:mt,displacementMap:f&&Je,emissiveMap:qt,normalMapObjectSpace:mt&&A.normalMapType===Y$,normalMapTangentSpace:mt&&A.normalMapType===tc,metalnessMap:et,roughnessMap:j,anisotropy:O,anisotropyMap:Pe,clearcoat:ce,clearcoatMap:Ce,clearcoatNormalMap:vt,clearcoatRoughnessMap:Ne,dispersion:ye,iridescence:Ae,iridescenceMap:st,iridescenceThicknessMap:ke,sheen:we,sheenColorMap:Ye,sheenRoughnessMap:pe,specularMap:Ue,specularColorMap:tt,specularIntensityMap:_t,transmission:ot,transmissionMap:ne,thicknessMap:$e,gradientMap:me,opaque:A.transparent===!1&&A.blending===eo&&A.alphaToCoverage===!1,alphaMap:Me,alphaTest:Xe,alphaHash:Ze,combine:A.combine,mapUv:ct&&y(A.map.channel),aoMapUv:Z&&y(A.aoMap.channel),lightMapUv:Nt&&y(A.lightMap.channel),bumpMapUv:Rt&&y(A.bumpMap.channel),normalMapUv:mt&&y(A.normalMap.channel),displacementMapUv:Je&&y(A.displacementMap.channel),emissiveMapUv:qt&&y(A.emissiveMap.channel),metalnessMapUv:et&&y(A.metalnessMap.channel),roughnessMapUv:j&&y(A.roughnessMap.channel),anisotropyMapUv:Pe&&y(A.anisotropyMap.channel),clearcoatMapUv:Ce&&y(A.clearcoatMap.channel),clearcoatNormalMapUv:vt&&y(A.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ne&&y(A.clearcoatRoughnessMap.channel),iridescenceMapUv:st&&y(A.iridescenceMap.channel),iridescenceThicknessMapUv:ke&&y(A.iridescenceThicknessMap.channel),sheenColorMapUv:Ye&&y(A.sheenColorMap.channel),sheenRoughnessMapUv:pe&&y(A.sheenRoughnessMap.channel),specularMapUv:Ue&&y(A.specularMap.channel),specularColorMapUv:tt&&y(A.specularColorMap.channel),specularIntensityMapUv:_t&&y(A.specularIntensityMap.channel),transmissionMapUv:ne&&y(A.transmissionMap.channel),thicknessMapUv:$e&&y(A.thicknessMap.channel),alphaMapUv:Me&&y(A.alphaMap.channel),vertexTangents:!!L.attributes.tangent&&(mt||O),vertexColors:A.vertexColors,vertexAlphas:A.vertexColors===!0&&!!L.attributes.color&&L.attributes.color.itemSize===4,pointsUvs:B.isPoints===!0&&!!L.attributes.uv&&(ct||Me),fog:!!C,useFog:A.fog===!0,fogExp2:!!C&&C.isFogExp2,flatShading:A.flatShading===!0,sizeAttenuation:A.sizeAttenuation===!0,logarithmicDepthBuffer:h,reverseDepthBuffer:Se,skinning:B.isSkinnedMesh===!0,morphTargets:L.morphAttributes.position!==void 0,morphNormals:L.morphAttributes.normal!==void 0,morphColors:L.morphAttributes.color!==void 0,morphTargetsCount:J,morphTextureStride:se,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numLightProbes:M.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:A.dithering,shadowMapEnabled:i.shadowMap.enabled&&R.length>0,shadowMapType:i.shadowMap.type,toneMapping:$n,decodeVideoTexture:ct&&A.map.isVideoTexture===!0&&rn.getTransfer(A.map.colorSpace)===Tn,decodeVideoTextureEmissive:qt&&A.emissiveMap.isVideoTexture===!0&&rn.getTransfer(A.emissiveMap.colorSpace)===Tn,premultipliedAlpha:A.premultipliedAlpha,doubleSided:A.side===Qr,flipSided:A.side===On,useDepthPacking:A.depthPacking>=0,depthPacking:A.depthPacking||0,index0AttributeName:A.index0AttributeName,extensionClipCullDistance:Wt&&A.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Wt&&A.extensions.multiDraw===!0||Be)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:A.customProgramCacheKey()};return tr.vertexUv1s=u.has(1),tr.vertexUv2s=u.has(2),tr.vertexUv3s=u.has(3),u.clear(),tr}function g(A){const M=[];if(A.shaderID?M.push(A.shaderID):(M.push(A.customVertexShaderID),M.push(A.customFragmentShaderID)),A.defines!==void 0)for(const R in A.defines)M.push(R),M.push(A.defines[R]);return A.isRawShaderMaterial===!1&&(_(M,A),x(M,A),M.push(i.outputColorSpace)),M.push(A.customProgramCacheKey),M.join()}function _(A,M){A.push(M.precision),A.push(M.outputColorSpace),A.push(M.envMapMode),A.push(M.envMapCubeUVHeight),A.push(M.mapUv),A.push(M.alphaMapUv),A.push(M.lightMapUv),A.push(M.aoMapUv),A.push(M.bumpMapUv),A.push(M.normalMapUv),A.push(M.displacementMapUv),A.push(M.emissiveMapUv),A.push(M.metalnessMapUv),A.push(M.roughnessMapUv),A.push(M.anisotropyMapUv),A.push(M.clearcoatMapUv),A.push(M.clearcoatNormalMapUv),A.push(M.clearcoatRoughnessMapUv),A.push(M.iridescenceMapUv),A.push(M.iridescenceThicknessMapUv),A.push(M.sheenColorMapUv),A.push(M.sheenRoughnessMapUv),A.push(M.specularMapUv),A.push(M.specularColorMapUv),A.push(M.specularIntensityMapUv),A.push(M.transmissionMapUv),A.push(M.thicknessMapUv),A.push(M.combine),A.push(M.fogExp2),A.push(M.sizeAttenuation),A.push(M.morphTargetsCount),A.push(M.morphAttributeCount),A.push(M.numDirLights),A.push(M.numPointLights),A.push(M.numSpotLights),A.push(M.numSpotLightMaps),A.push(M.numHemiLights),A.push(M.numRectAreaLights),A.push(M.numDirLightShadows),A.push(M.numPointLightShadows),A.push(M.numSpotLightShadows),A.push(M.numSpotLightShadowsWithMaps),A.push(M.numLightProbes),A.push(M.shadowMapType),A.push(M.toneMapping),A.push(M.numClippingPlanes),A.push(M.numClipIntersection),A.push(M.depthPacking)}function x(A,M){l.disableAll(),M.supportsVertexTextures&&l.enable(0),M.instancing&&l.enable(1),M.instancingColor&&l.enable(2),M.instancingMorph&&l.enable(3),M.matcap&&l.enable(4),M.envMap&&l.enable(5),M.normalMapObjectSpace&&l.enable(6),M.normalMapTangentSpace&&l.enable(7),M.clearcoat&&l.enable(8),M.iridescence&&l.enable(9),M.alphaTest&&l.enable(10),M.vertexColors&&l.enable(11),M.vertexAlphas&&l.enable(12),M.vertexUv1s&&l.enable(13),M.vertexUv2s&&l.enable(14),M.vertexUv3s&&l.enable(15),M.vertexTangents&&l.enable(16),M.anisotropy&&l.enable(17),M.alphaHash&&l.enable(18),M.batching&&l.enable(19),M.dispersion&&l.enable(20),M.batchingColor&&l.enable(21),A.push(l.mask),l.disableAll(),M.fog&&l.enable(0),M.useFog&&l.enable(1),M.flatShading&&l.enable(2),M.logarithmicDepthBuffer&&l.enable(3),M.reverseDepthBuffer&&l.enable(4),M.skinning&&l.enable(5),M.morphTargets&&l.enable(6),M.morphNormals&&l.enable(7),M.morphColors&&l.enable(8),M.premultipliedAlpha&&l.enable(9),M.shadowMapEnabled&&l.enable(10),M.doubleSided&&l.enable(11),M.flipSided&&l.enable(12),M.useDepthPacking&&l.enable(13),M.dithering&&l.enable(14),M.transmission&&l.enable(15),M.sheen&&l.enable(16),M.opaque&&l.enable(17),M.pointsUvs&&l.enable(18),M.decodeVideoTexture&&l.enable(19),M.decodeVideoTextureEmissive&&l.enable(20),M.alphaToCoverage&&l.enable(21),A.push(l.mask)}function b(A){const M=m[A.type];let R;if(M){const F=Da[M];R=tG.clone(F.uniforms)}else R=A.uniforms;return R}function S(A,M){let R;for(let F=0,B=d.length;F<B;F++){const C=d[F];if(C.cacheKey===M){R=C,++R.usedTimes;break}}return R===void 0&&(R=new uge(i,M,A,o),d.push(R)),R}function T(A){if(--A.usedTimes===0){const M=d.indexOf(A);d[M]=d[d.length-1],d.pop(),A.destroy()}}function w(A){c.remove(A)}function E(){c.dispose()}return{getParameters:v,getProgramCacheKey:g,getUniforms:b,acquireProgram:S,releaseProgram:T,releaseShaderCache:w,programs:d,dispose:E}}function mge(){let i=new WeakMap;function e(a){return i.has(a)}function n(a){let l=i.get(a);return l===void 0&&(l={},i.set(a,l)),l}function r(a){i.delete(a)}function s(a,l,c){i.get(a)[l]=c}function o(){i=new WeakMap}return{has:e,get:n,remove:r,update:s,dispose:o}}function gge(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function SF(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function wF(){const i=[];let e=0;const n=[],r=[],s=[];function o(){e=0,n.length=0,r.length=0,s.length=0}function a(h,f,p,m,y,v){let g=i[e];return g===void 0?(g={id:h.id,object:h,geometry:f,material:p,groupOrder:m,renderOrder:h.renderOrder,z:y,group:v},i[e]=g):(g.id=h.id,g.object=h,g.geometry=f,g.material=p,g.groupOrder=m,g.renderOrder=h.renderOrder,g.z=y,g.group=v),e++,g}function l(h,f,p,m,y,v){const g=a(h,f,p,m,y,v);p.transmission>0?r.push(g):p.transparent===!0?s.push(g):n.push(g)}function c(h,f,p,m,y,v){const g=a(h,f,p,m,y,v);p.transmission>0?r.unshift(g):p.transparent===!0?s.unshift(g):n.unshift(g)}function u(h,f){n.length>1&&n.sort(h||gge),r.length>1&&r.sort(f||SF),s.length>1&&s.sort(f||SF)}function d(){for(let h=e,f=i.length;h<f;h++){const p=i[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:n,transmissive:r,transparent:s,init:o,push:l,unshift:c,finish:d,sort:u}}function yge(){let i=new WeakMap;function e(r,s){const o=i.get(r);let a;return o===void 0?(a=new wF,i.set(r,[a])):s>=o.length?(a=new wF,o.push(a)):a=o[s],a}function n(){i=new WeakMap}return{get:e,dispose:n}}function vge(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new K,color:new St};break;case"SpotLight":n={position:new K,direction:new K,color:new St,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new K,color:new St,distance:0,decay:0};break;case"HemisphereLight":n={direction:new K,skyColor:new St,groundColor:new St};break;case"RectAreaLight":n={color:new St,position:new K,halfWidth:new K,halfHeight:new K};break}return i[e.id]=n,n}}}function xge(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=n,n}}}let _ge=0;function bge(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function Sge(i){const e=new vge,n=xge(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new K);const s=new K,o=new ln,a=new ln;function l(u){let d=0,h=0,f=0;for(let A=0;A<9;A++)r.probe[A].set(0,0,0);let p=0,m=0,y=0,v=0,g=0,_=0,x=0,b=0,S=0,T=0,w=0;u.sort(bge);for(let A=0,M=u.length;A<M;A++){const R=u[A],F=R.color,B=R.intensity,C=R.distance,L=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)d+=F.r*B,h+=F.g*B,f+=F.b*B;else if(R.isLightProbe){for(let P=0;P<9;P++)r.probe[P].addScaledVector(R.sh.coefficients[P],B);w++}else if(R.isDirectionalLight){const P=e.get(R);if(P.color.copy(R.color).multiplyScalar(R.intensity),R.castShadow){const W=R.shadow,D=n.get(R);D.shadowIntensity=W.intensity,D.shadowBias=W.bias,D.shadowNormalBias=W.normalBias,D.shadowRadius=W.radius,D.shadowMapSize=W.mapSize,r.directionalShadow[p]=D,r.directionalShadowMap[p]=L,r.directionalShadowMatrix[p]=R.shadow.matrix,_++}r.directional[p]=P,p++}else if(R.isSpotLight){const P=e.get(R);P.position.setFromMatrixPosition(R.matrixWorld),P.color.copy(F).multiplyScalar(B),P.distance=C,P.coneCos=Math.cos(R.angle),P.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),P.decay=R.decay,r.spot[y]=P;const W=R.shadow;if(R.map&&(r.spotLightMap[S]=R.map,S++,W.updateMatrices(R),R.castShadow&&T++),r.spotLightMatrix[y]=W.matrix,R.castShadow){const D=n.get(R);D.shadowIntensity=W.intensity,D.shadowBias=W.bias,D.shadowNormalBias=W.normalBias,D.shadowRadius=W.radius,D.shadowMapSize=W.mapSize,r.spotShadow[y]=D,r.spotShadowMap[y]=L,b++}y++}else if(R.isRectAreaLight){const P=e.get(R);P.color.copy(F).multiplyScalar(B),P.halfWidth.set(R.width*.5,0,0),P.halfHeight.set(0,R.height*.5,0),r.rectArea[v]=P,v++}else if(R.isPointLight){const P=e.get(R);if(P.color.copy(R.color).multiplyScalar(R.intensity),P.distance=R.distance,P.decay=R.decay,R.castShadow){const W=R.shadow,D=n.get(R);D.shadowIntensity=W.intensity,D.shadowBias=W.bias,D.shadowNormalBias=W.normalBias,D.shadowRadius=W.radius,D.shadowMapSize=W.mapSize,D.shadowCameraNear=W.camera.near,D.shadowCameraFar=W.camera.far,r.pointShadow[m]=D,r.pointShadowMap[m]=L,r.pointShadowMatrix[m]=R.shadow.matrix,x++}r.point[m]=P,m++}else if(R.isHemisphereLight){const P=e.get(R);P.skyColor.copy(R.color).multiplyScalar(B),P.groundColor.copy(R.groundColor).multiplyScalar(B),r.hemi[g]=P,g++}}v>0&&(i.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=it.LTC_FLOAT_1,r.rectAreaLTC2=it.LTC_FLOAT_2):(r.rectAreaLTC1=it.LTC_HALF_1,r.rectAreaLTC2=it.LTC_HALF_2)),r.ambient[0]=d,r.ambient[1]=h,r.ambient[2]=f;const E=r.hash;(E.directionalLength!==p||E.pointLength!==m||E.spotLength!==y||E.rectAreaLength!==v||E.hemiLength!==g||E.numDirectionalShadows!==_||E.numPointShadows!==x||E.numSpotShadows!==b||E.numSpotMaps!==S||E.numLightProbes!==w)&&(r.directional.length=p,r.spot.length=y,r.rectArea.length=v,r.point.length=m,r.hemi.length=g,r.directionalShadow.length=_,r.directionalShadowMap.length=_,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=b,r.spotShadowMap.length=b,r.directionalShadowMatrix.length=_,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=b+S-T,r.spotLightMap.length=S,r.numSpotLightShadowsWithMaps=T,r.numLightProbes=w,E.directionalLength=p,E.pointLength=m,E.spotLength=y,E.rectAreaLength=v,E.hemiLength=g,E.numDirectionalShadows=_,E.numPointShadows=x,E.numSpotShadows=b,E.numSpotMaps=S,E.numLightProbes=w,r.version=_ge++)}function c(u,d){let h=0,f=0,p=0,m=0,y=0;const v=d.matrixWorldInverse;for(let g=0,_=u.length;g<_;g++){const x=u[g];if(x.isDirectionalLight){const b=r.directional[h];b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),h++}else if(x.isSpotLight){const b=r.spot[p];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(v),b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),p++}else if(x.isRectAreaLight){const b=r.rectArea[m];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(v),a.identity(),o.copy(x.matrixWorld),o.premultiply(v),a.extractRotation(o),b.halfWidth.set(x.width*.5,0,0),b.halfHeight.set(0,x.height*.5,0),b.halfWidth.applyMatrix4(a),b.halfHeight.applyMatrix4(a),m++}else if(x.isPointLight){const b=r.point[f];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(v),f++}else if(x.isHemisphereLight){const b=r.hemi[y];b.direction.setFromMatrixPosition(x.matrixWorld),b.direction.transformDirection(v),y++}}}return{setup:l,setupView:c,state:r}}function TF(i){const e=new Sge(i),n=[],r=[];function s(d){u.camera=d,n.length=0,r.length=0}function o(d){n.push(d)}function a(d){r.push(d)}function l(){e.setup(n)}function c(d){e.setupView(n,d)}const u={lightsArray:n,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:u,setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function wge(i){let e=new WeakMap;function n(s,o=0){const a=e.get(s);let l;return a===void 0?(l=new TF(i),e.set(s,[l])):o>=a.length?(l=new TF(i),a.push(l)):l=a[o],l}function r(){e=new WeakMap}return{get:n,dispose:r}}const Tge=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Ege=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Mge(i,e,n){let r=new $0;const s=new Oe,o=new Oe,a=new Dt,l=new Bde({depthPacking:uue}),c=new Ude,u={},d=n.maxTextureSize,h={[Cs]:On,[On]:Cs,[Qr]:Qr},f=new Ka({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Oe},radius:{value:4}},vertexShader:Tge,fragmentShader:Ege}),p=f.clone();p.defines.HORIZONTAL_PASS=1;const m=new Tr;m.setAttribute("position",new Yi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new Xn(m,f),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PN;let g=this.type;this.render=function(T,w,E){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||T.length===0)return;const A=i.getRenderTarget(),M=i.getActiveCubeFace(),R=i.getActiveMipmapLevel(),F=i.state;F.setBlending(Rs),F.buffers.color.setClear(1,1,1,1),F.buffers.depth.setTest(!0),F.setScissorTest(!1);const B=g!==Hs&&this.type===Hs,C=g===Hs&&this.type!==Hs;for(let L=0,P=T.length;L<P;L++){const W=T[L],D=W.shadow;if(D===void 0){console.warn("THREE.WebGLShadowMap:",W,"has no shadow.");continue}if(D.autoUpdate===!1&&D.needsUpdate===!1)continue;s.copy(D.mapSize);const X=D.getFrameExtents();if(s.multiply(X),o.copy(D.mapSize),(s.x>d||s.y>d)&&(s.x>d&&(o.x=Math.floor(d/X.x),s.x=o.x*X.x,D.mapSize.x=o.x),s.y>d&&(o.y=Math.floor(d/X.y),s.y=o.y*X.y,D.mapSize.y=o.y)),D.map===null||B===!0||C===!0){const J=this.type!==Hs?{minFilter:Vn,magFilter:Vn}:{};D.map!==null&&D.map.dispose(),D.map=new gu(s.x,s.y,J),D.map.texture.name=W.name+".shadowMap",D.camera.updateProjectionMatrix()}i.setRenderTarget(D.map),i.clear();const q=D.getViewportCount();for(let J=0;J<q;J++){const se=D.getViewport(J);a.set(o.x*se.x,o.y*se.y,o.x*se.z,o.y*se.w),F.viewport(a),D.updateMatrices(W,J),r=D.getFrustum(),b(w,E,D.camera,W,this.type)}D.isPointLightShadow!==!0&&this.type===Hs&&_(D,E),D.needsUpdate=!1}g=this.type,v.needsUpdate=!1,i.setRenderTarget(A,M,R)};function _(T,w){const E=e.update(y);f.defines.VSM_SAMPLES!==T.blurSamples&&(f.defines.VSM_SAMPLES=T.blurSamples,p.defines.VSM_SAMPLES=T.blurSamples,f.needsUpdate=!0,p.needsUpdate=!0),T.mapPass===null&&(T.mapPass=new gu(s.x,s.y)),f.uniforms.shadow_pass.value=T.map.texture,f.uniforms.resolution.value=T.mapSize,f.uniforms.radius.value=T.radius,i.setRenderTarget(T.mapPass),i.clear(),i.renderBufferDirect(w,null,E,f,y,null),p.uniforms.shadow_pass.value=T.mapPass.texture,p.uniforms.resolution.value=T.mapSize,p.uniforms.radius.value=T.radius,i.setRenderTarget(T.map),i.clear(),i.renderBufferDirect(w,null,E,p,y,null)}function x(T,w,E,A){let M=null;const R=E.isPointLight===!0?T.customDistanceMaterial:T.customDepthMaterial;if(R!==void 0)M=R;else if(M=E.isPointLight===!0?c:l,i.localClippingEnabled&&w.clipShadows===!0&&Array.isArray(w.clippingPlanes)&&w.clippingPlanes.length!==0||w.displacementMap&&w.displacementScale!==0||w.alphaMap&&w.alphaTest>0||w.map&&w.alphaTest>0||w.alphaToCoverage===!0){const F=M.uuid,B=w.uuid;let C=u[F];C===void 0&&(C={},u[F]=C);let L=C[B];L===void 0&&(L=M.clone(),C[B]=L,w.addEventListener("dispose",S)),M=L}if(M.visible=w.visible,M.wireframe=w.wireframe,A===Hs?M.side=w.shadowSide!==null?w.shadowSide:w.side:M.side=w.shadowSide!==null?w.shadowSide:h[w.side],M.alphaMap=w.alphaMap,M.alphaTest=w.alphaToCoverage===!0?.5:w.alphaTest,M.map=w.map,M.clipShadows=w.clipShadows,M.clippingPlanes=w.clippingPlanes,M.clipIntersection=w.clipIntersection,M.displacementMap=w.displacementMap,M.displacementScale=w.displacementScale,M.displacementBias=w.displacementBias,M.wireframeLinewidth=w.wireframeLinewidth,M.linewidth=w.linewidth,E.isPointLight===!0&&M.isMeshDistanceMaterial===!0){const F=i.properties.get(M);F.light=E}return M}function b(T,w,E,A,M){if(T.visible===!1)return;if(T.layers.test(w.layers)&&(T.isMesh||T.isLine||T.isPoints)&&(T.castShadow||T.receiveShadow&&M===Hs)&&(!T.frustumCulled||r.intersectsObject(T))){T.modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,T.matrixWorld);const B=e.update(T),C=T.material;if(Array.isArray(C)){const L=B.groups;for(let P=0,W=L.length;P<W;P++){const D=L[P],X=C[D.materialIndex];if(X&&X.visible){const q=x(T,X,A,M);T.onBeforeShadow(i,T,w,E,B,q,D),i.renderBufferDirect(E,null,B,q,T,D),T.onAfterShadow(i,T,w,E,B,q,D)}}}else if(C.visible){const L=x(T,C,A,M);T.onBeforeShadow(i,T,w,E,B,L,null),i.renderBufferDirect(E,null,B,L,T,null),T.onAfterShadow(i,T,w,E,B,L,null)}}const F=T.children;for(let B=0,C=F.length;B<C;B++)b(F[B],w,E,A,M)}function S(T){T.target.removeEventListener("dispose",S);for(const E in u){const A=u[E],M=T.target.uuid;M in A&&(A[M].dispose(),delete A[M])}}}const Age={[$y]:Gy,[Hy]:qy,[Wy]:Xy,[pu]:jy,[Gy]:$y,[qy]:Hy,[Xy]:Wy,[jy]:pu};function Cge(i,e){function n(){let ne=!1;const $e=new Dt;let me=null;const Me=new Dt(0,0,0,0);return{setMask:function(Xe){me!==Xe&&!ne&&(i.colorMask(Xe,Xe,Xe,Xe),me=Xe)},setLocked:function(Xe){ne=Xe},setClear:function(Xe,Ze,Wt,$n,tr){tr===!0&&(Xe*=$n,Ze*=$n,Wt*=$n),$e.set(Xe,Ze,Wt,$n),Me.equals($e)===!1&&(i.clearColor(Xe,Ze,Wt,$n),Me.copy($e))},reset:function(){ne=!1,me=null,Me.set(-1,0,0,0)}}}function r(){let ne=!1,$e=!1,me=null,Me=null,Xe=null;return{setReversed:function(Ze){if($e!==Ze){const Wt=e.get("EXT_clip_control");Ze?Wt.clipControlEXT(Wt.LOWER_LEFT_EXT,Wt.ZERO_TO_ONE_EXT):Wt.clipControlEXT(Wt.LOWER_LEFT_EXT,Wt.NEGATIVE_ONE_TO_ONE_EXT),$e=Ze;const $n=Xe;Xe=null,this.setClear($n)}},getReversed:function(){return $e},setTest:function(Ze){Ze?ie(i.DEPTH_TEST):Se(i.DEPTH_TEST)},setMask:function(Ze){me!==Ze&&!ne&&(i.depthMask(Ze),me=Ze)},setFunc:function(Ze){if($e&&(Ze=Age[Ze]),Me!==Ze){switch(Ze){case $y:i.depthFunc(i.NEVER);break;case Gy:i.depthFunc(i.ALWAYS);break;case Hy:i.depthFunc(i.LESS);break;case pu:i.depthFunc(i.LEQUAL);break;case Wy:i.depthFunc(i.EQUAL);break;case jy:i.depthFunc(i.GEQUAL);break;case qy:i.depthFunc(i.GREATER);break;case Xy:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Me=Ze}},setLocked:function(Ze){ne=Ze},setClear:function(Ze){Xe!==Ze&&($e&&(Ze=1-Ze),i.clearDepth(Ze),Xe=Ze)},reset:function(){ne=!1,me=null,Me=null,Xe=null,$e=!1}}}function s(){let ne=!1,$e=null,me=null,Me=null,Xe=null,Ze=null,Wt=null,$n=null,tr=null;return{setTest:function(Jt){ne||(Jt?ie(i.STENCIL_TEST):Se(i.STENCIL_TEST))},setMask:function(Jt){$e!==Jt&&!ne&&(i.stencilMask(Jt),$e=Jt)},setFunc:function(Jt,ds,Bo){(me!==Jt||Me!==ds||Xe!==Bo)&&(i.stencilFunc(Jt,ds,Bo),me=Jt,Me=ds,Xe=Bo)},setOp:function(Jt,ds,Bo){(Ze!==Jt||Wt!==ds||$n!==Bo)&&(i.stencilOp(Jt,ds,Bo),Ze=Jt,Wt=ds,$n=Bo)},setLocked:function(Jt){ne=Jt},setClear:function(Jt){tr!==Jt&&(i.clearStencil(Jt),tr=Jt)},reset:function(){ne=!1,$e=null,me=null,Me=null,Xe=null,Ze=null,Wt=null,$n=null,tr=null}}}const o=new n,a=new r,l=new s,c=new WeakMap,u=new WeakMap;let d={},h={},f=new WeakMap,p=[],m=null,y=!1,v=null,g=null,_=null,x=null,b=null,S=null,T=null,w=new St(0,0,0),E=0,A=!1,M=null,R=null,F=null,B=null,C=null;const L=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let P=!1,W=0;const D=i.getParameter(i.VERSION);D.indexOf("WebGL")!==-1?(W=parseFloat(/^WebGL (\d)/.exec(D)[1]),P=W>=1):D.indexOf("OpenGL ES")!==-1&&(W=parseFloat(/^OpenGL ES (\d)/.exec(D)[1]),P=W>=2);let X=null,q={};const J=i.getParameter(i.SCISSOR_BOX),se=i.getParameter(i.VIEWPORT),de=new Dt().fromArray(J),G=new Dt().fromArray(se);function Q(ne,$e,me,Me){const Xe=new Uint8Array(4),Ze=i.createTexture();i.bindTexture(ne,Ze),i.texParameteri(ne,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(ne,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Wt=0;Wt<me;Wt++)ne===i.TEXTURE_3D||ne===i.TEXTURE_2D_ARRAY?i.texImage3D($e,0,i.RGBA,1,1,Me,0,i.RGBA,i.UNSIGNED_BYTE,Xe):i.texImage2D($e+Wt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Xe);return Ze}const ee={};ee[i.TEXTURE_2D]=Q(i.TEXTURE_2D,i.TEXTURE_2D,1),ee[i.TEXTURE_CUBE_MAP]=Q(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),ee[i.TEXTURE_2D_ARRAY]=Q(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),ee[i.TEXTURE_3D]=Q(i.TEXTURE_3D,i.TEXTURE_3D,1,1),o.setClear(0,0,0,1),a.setClear(1),l.setClear(0),ie(i.DEPTH_TEST),a.setFunc(pu),Rt(!1),mt(DC),ie(i.CULL_FACE),Z(Rs);function ie(ne){d[ne]!==!0&&(i.enable(ne),d[ne]=!0)}function Se(ne){d[ne]!==!1&&(i.disable(ne),d[ne]=!1)}function Fe(ne,$e){return h[ne]!==$e?(i.bindFramebuffer(ne,$e),h[ne]=$e,ne===i.DRAW_FRAMEBUFFER&&(h[i.FRAMEBUFFER]=$e),ne===i.FRAMEBUFFER&&(h[i.DRAW_FRAMEBUFFER]=$e),!0):!1}function Be(ne,$e){let me=p,Me=!1;if(ne){me=f.get($e),me===void 0&&(me=[],f.set($e,me));const Xe=ne.textures;if(me.length!==Xe.length||me[0]!==i.COLOR_ATTACHMENT0){for(let Ze=0,Wt=Xe.length;Ze<Wt;Ze++)me[Ze]=i.COLOR_ATTACHMENT0+Ze;me.length=Xe.length,Me=!0}}else me[0]!==i.BACK&&(me[0]=i.BACK,Me=!0);Me&&i.drawBuffers(me)}function ct(ne){return m!==ne?(i.useProgram(ne),m=ne,!0):!1}const xt={[Ur]:i.FUNC_ADD,[NN]:i.FUNC_SUBTRACT,[kN]:i.FUNC_REVERSE_SUBTRACT};xt[z$]=i.MIN,xt[V$]=i.MAX;const He={[Tl]:i.ZERO,[LN]:i.ONE,[IN]:i.SRC_COLOR,[zy]:i.SRC_ALPHA,[zN]:i.SRC_ALPHA_SATURATE,[BN]:i.DST_COLOR,[ON]:i.DST_ALPHA,[DN]:i.ONE_MINUS_SRC_COLOR,[Vy]:i.ONE_MINUS_SRC_ALPHA,[UN]:i.ONE_MINUS_DST_COLOR,[FN]:i.ONE_MINUS_DST_ALPHA,[iue]:i.CONSTANT_COLOR,[rue]:i.ONE_MINUS_CONSTANT_COLOR,[sue]:i.CONSTANT_ALPHA,[oue]:i.ONE_MINUS_CONSTANT_ALPHA};function Z(ne,$e,me,Me,Xe,Ze,Wt,$n,tr,Jt){if(ne===Rs){y===!0&&(Se(i.BLEND),y=!1);return}if(y===!1&&(ie(i.BLEND),y=!0),ne!==Vf){if(ne!==v||Jt!==A){if((g!==Ur||b!==Ur)&&(i.blendEquation(i.FUNC_ADD),g=Ur,b=Ur),Jt)switch(ne){case eo:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case cp:i.blendFunc(i.ONE,i.ONE);break;case up:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case dp:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ne);break}else switch(ne){case eo:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case cp:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case up:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case dp:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ne);break}_=null,x=null,S=null,T=null,w.set(0,0,0),E=0,v=ne,A=Jt}return}Xe=Xe||$e,Ze=Ze||me,Wt=Wt||Me,($e!==g||Xe!==b)&&(i.blendEquationSeparate(xt[$e],xt[Xe]),g=$e,b=Xe),(me!==_||Me!==x||Ze!==S||Wt!==T)&&(i.blendFuncSeparate(He[me],He[Me],He[Ze],He[Wt]),_=me,x=Me,S=Ze,T=Wt),($n.equals(w)===!1||tr!==E)&&(i.blendColor($n.r,$n.g,$n.b,tr),w.copy($n),E=tr),v=ne,A=!1}function Nt(ne,$e){ne.side===Qr?Se(i.CULL_FACE):ie(i.CULL_FACE);let me=ne.side===On;$e&&(me=!me),Rt(me),ne.blending===eo&&ne.transparent===!1?Z(Rs):Z(ne.blending,ne.blendEquation,ne.blendSrc,ne.blendDst,ne.blendEquationAlpha,ne.blendSrcAlpha,ne.blendDstAlpha,ne.blendColor,ne.blendAlpha,ne.premultipliedAlpha),a.setFunc(ne.depthFunc),a.setTest(ne.depthTest),a.setMask(ne.depthWrite),o.setMask(ne.colorWrite);const Me=ne.stencilWrite;l.setTest(Me),Me&&(l.setMask(ne.stencilWriteMask),l.setFunc(ne.stencilFunc,ne.stencilRef,ne.stencilFuncMask),l.setOp(ne.stencilFail,ne.stencilZFail,ne.stencilZPass)),qt(ne.polygonOffset,ne.polygonOffsetFactor,ne.polygonOffsetUnits),ne.alphaToCoverage===!0?ie(i.SAMPLE_ALPHA_TO_COVERAGE):Se(i.SAMPLE_ALPHA_TO_COVERAGE)}function Rt(ne){M!==ne&&(ne?i.frontFace(i.CW):i.frontFace(i.CCW),M=ne)}function mt(ne){ne!==B$?(ie(i.CULL_FACE),ne!==R&&(ne===DC?i.cullFace(i.BACK):ne===U$?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Se(i.CULL_FACE),R=ne}function Je(ne){ne!==F&&(P&&i.lineWidth(ne),F=ne)}function qt(ne,$e,me){ne?(ie(i.POLYGON_OFFSET_FILL),(B!==$e||C!==me)&&(i.polygonOffset($e,me),B=$e,C=me)):Se(i.POLYGON_OFFSET_FILL)}function et(ne){ne?ie(i.SCISSOR_TEST):Se(i.SCISSOR_TEST)}function j(ne){ne===void 0&&(ne=i.TEXTURE0+L-1),X!==ne&&(i.activeTexture(ne),X=ne)}function O(ne,$e,me){me===void 0&&(X===null?me=i.TEXTURE0+L-1:me=X);let Me=q[me];Me===void 0&&(Me={type:void 0,texture:void 0},q[me]=Me),(Me.type!==ne||Me.texture!==$e)&&(X!==me&&(i.activeTexture(me),X=me),i.bindTexture(ne,$e||ee[ne]),Me.type=ne,Me.texture=$e)}function ce(){const ne=q[X];ne!==void 0&&ne.type!==void 0&&(i.bindTexture(ne.type,null),ne.type=void 0,ne.texture=void 0)}function ye(){try{i.compressedTexImage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Ae(){try{i.compressedTexImage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function we(){try{i.texSubImage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function ot(){try{i.texSubImage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Pe(){try{i.compressedTexSubImage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Ce(){try{i.compressedTexSubImage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function vt(){try{i.texStorage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Ne(){try{i.texStorage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function st(){try{i.texImage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function ke(){try{i.texImage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Ye(ne){de.equals(ne)===!1&&(i.scissor(ne.x,ne.y,ne.z,ne.w),de.copy(ne))}function pe(ne){G.equals(ne)===!1&&(i.viewport(ne.x,ne.y,ne.z,ne.w),G.copy(ne))}function Ue(ne,$e){let me=u.get($e);me===void 0&&(me=new WeakMap,u.set($e,me));let Me=me.get(ne);Me===void 0&&(Me=i.getUniformBlockIndex($e,ne.name),me.set(ne,Me))}function tt(ne,$e){const Me=u.get($e).get(ne);c.get($e)!==Me&&(i.uniformBlockBinding($e,Me,ne.__bindingPointIndex),c.set($e,Me))}function _t(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),a.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),d={},X=null,q={},h={},f=new WeakMap,p=[],m=null,y=!1,v=null,g=null,_=null,x=null,b=null,S=null,T=null,w=new St(0,0,0),E=0,A=!1,M=null,R=null,F=null,B=null,C=null,de.set(0,0,i.canvas.width,i.canvas.height),G.set(0,0,i.canvas.width,i.canvas.height),o.reset(),a.reset(),l.reset()}return{buffers:{color:o,depth:a,stencil:l},enable:ie,disable:Se,bindFramebuffer:Fe,drawBuffers:Be,useProgram:ct,setBlending:Z,setMaterial:Nt,setFlipSided:Rt,setCullFace:mt,setLineWidth:Je,setPolygonOffset:qt,setScissorTest:et,activeTexture:j,bindTexture:O,unbindTexture:ce,compressedTexImage2D:ye,compressedTexImage3D:Ae,texImage2D:st,texImage3D:ke,updateUBOMapping:Ue,uniformBlockBinding:tt,texStorage2D:vt,texStorage3D:Ne,texSubImage2D:we,texSubImage3D:ot,compressedTexSubImage2D:Pe,compressedTexSubImage3D:Ce,scissor:Ye,viewport:pe,reset:_t}}function Rge(i,e,n,r,s,o,a){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Oe,d=new WeakMap;let h;const f=new WeakMap;let p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function m(j,O){return p?new OffscreenCanvas(j,O):i0("canvas")}function y(j,O,ce){let ye=1;const Ae=et(j);if((Ae.width>ce||Ae.height>ce)&&(ye=ce/Math.max(Ae.width,Ae.height)),ye<1)if(typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&j instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&j instanceof ImageBitmap||typeof VideoFrame<"u"&&j instanceof VideoFrame){const we=Math.floor(ye*Ae.width),ot=Math.floor(ye*Ae.height);h===void 0&&(h=m(we,ot));const Pe=O?m(we,ot):h;return Pe.width=we,Pe.height=ot,Pe.getContext("2d").drawImage(j,0,0,we,ot),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ae.width+"x"+Ae.height+") to ("+we+"x"+ot+")."),Pe}else return"data"in j&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ae.width+"x"+Ae.height+")."),j;return j}function v(j){return j.generateMipmaps}function g(j){i.generateMipmap(j)}function _(j){return j.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:j.isWebGL3DRenderTarget?i.TEXTURE_3D:j.isWebGLArrayRenderTarget||j.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function x(j,O,ce,ye,Ae=!1){if(j!==null){if(i[j]!==void 0)return i[j];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+j+"'")}let we=O;if(O===i.RED&&(ce===i.FLOAT&&(we=i.R32F),ce===i.HALF_FLOAT&&(we=i.R16F),ce===i.UNSIGNED_BYTE&&(we=i.R8)),O===i.RED_INTEGER&&(ce===i.UNSIGNED_BYTE&&(we=i.R8UI),ce===i.UNSIGNED_SHORT&&(we=i.R16UI),ce===i.UNSIGNED_INT&&(we=i.R32UI),ce===i.BYTE&&(we=i.R8I),ce===i.SHORT&&(we=i.R16I),ce===i.INT&&(we=i.R32I)),O===i.RG&&(ce===i.FLOAT&&(we=i.RG32F),ce===i.HALF_FLOAT&&(we=i.RG16F),ce===i.UNSIGNED_BYTE&&(we=i.RG8)),O===i.RG_INTEGER&&(ce===i.UNSIGNED_BYTE&&(we=i.RG8UI),ce===i.UNSIGNED_SHORT&&(we=i.RG16UI),ce===i.UNSIGNED_INT&&(we=i.RG32UI),ce===i.BYTE&&(we=i.RG8I),ce===i.SHORT&&(we=i.RG16I),ce===i.INT&&(we=i.RG32I)),O===i.RGB_INTEGER&&(ce===i.UNSIGNED_BYTE&&(we=i.RGB8UI),ce===i.UNSIGNED_SHORT&&(we=i.RGB16UI),ce===i.UNSIGNED_INT&&(we=i.RGB32UI),ce===i.BYTE&&(we=i.RGB8I),ce===i.SHORT&&(we=i.RGB16I),ce===i.INT&&(we=i.RGB32I)),O===i.RGBA_INTEGER&&(ce===i.UNSIGNED_BYTE&&(we=i.RGBA8UI),ce===i.UNSIGNED_SHORT&&(we=i.RGBA16UI),ce===i.UNSIGNED_INT&&(we=i.RGBA32UI),ce===i.BYTE&&(we=i.RGBA8I),ce===i.SHORT&&(we=i.RGBA16I),ce===i.INT&&(we=i.RGBA32I)),O===i.RGB&&ce===i.UNSIGNED_INT_5_9_9_9_REV&&(we=i.RGB9_E5),O===i.RGBA){const ot=Ae?Qb:rn.getTransfer(ye);ce===i.FLOAT&&(we=i.RGBA32F),ce===i.HALF_FLOAT&&(we=i.RGBA16F),ce===i.UNSIGNED_BYTE&&(we=ot===Tn?i.SRGB8_ALPHA8:i.RGBA8),ce===i.UNSIGNED_SHORT_4_4_4_4&&(we=i.RGBA4),ce===i.UNSIGNED_SHORT_5_5_5_1&&(we=i.RGB5_A1)}return(we===i.R16F||we===i.R32F||we===i.RG16F||we===i.RG32F||we===i.RGBA16F||we===i.RGBA32F)&&e.get("EXT_color_buffer_float"),we}function b(j,O){let ce;return j?O===null||O===Dn||O===to?ce=i.DEPTH24_STENCIL8:O===wi?ce=i.DEPTH32F_STENCIL8:O===oa&&(ce=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):O===null||O===Dn||O===to?ce=i.DEPTH_COMPONENT24:O===wi?ce=i.DEPTH_COMPONENT32F:O===oa&&(ce=i.DEPTH_COMPONENT16),ce}function S(j,O){return v(j)===!0||j.isFramebufferTexture&&j.minFilter!==Vn&&j.minFilter!==Xi?Math.log2(Math.max(O.width,O.height))+1:j.mipmaps!==void 0&&j.mipmaps.length>0?j.mipmaps.length:j.isCompressedTexture&&Array.isArray(j.image)?O.mipmaps.length:1}function T(j){const O=j.target;O.removeEventListener("dispose",T),E(O),O.isVideoTexture&&d.delete(O)}function w(j){const O=j.target;O.removeEventListener("dispose",w),M(O)}function E(j){const O=r.get(j);if(O.__webglInit===void 0)return;const ce=j.source,ye=f.get(ce);if(ye){const Ae=ye[O.__cacheKey];Ae.usedTimes--,Ae.usedTimes===0&&A(j),Object.keys(ye).length===0&&f.delete(ce)}r.remove(j)}function A(j){const O=r.get(j);i.deleteTexture(O.__webglTexture);const ce=j.source,ye=f.get(ce);delete ye[O.__cacheKey],a.memory.textures--}function M(j){const O=r.get(j);if(j.depthTexture&&(j.depthTexture.dispose(),r.remove(j.depthTexture)),j.isWebGLCubeRenderTarget)for(let ye=0;ye<6;ye++){if(Array.isArray(O.__webglFramebuffer[ye]))for(let Ae=0;Ae<O.__webglFramebuffer[ye].length;Ae++)i.deleteFramebuffer(O.__webglFramebuffer[ye][Ae]);else i.deleteFramebuffer(O.__webglFramebuffer[ye]);O.__webglDepthbuffer&&i.deleteRenderbuffer(O.__webglDepthbuffer[ye])}else{if(Array.isArray(O.__webglFramebuffer))for(let ye=0;ye<O.__webglFramebuffer.length;ye++)i.deleteFramebuffer(O.__webglFramebuffer[ye]);else i.deleteFramebuffer(O.__webglFramebuffer);if(O.__webglDepthbuffer&&i.deleteRenderbuffer(O.__webglDepthbuffer),O.__webglMultisampledFramebuffer&&i.deleteFramebuffer(O.__webglMultisampledFramebuffer),O.__webglColorRenderbuffer)for(let ye=0;ye<O.__webglColorRenderbuffer.length;ye++)O.__webglColorRenderbuffer[ye]&&i.deleteRenderbuffer(O.__webglColorRenderbuffer[ye]);O.__webglDepthRenderbuffer&&i.deleteRenderbuffer(O.__webglDepthRenderbuffer)}const ce=j.textures;for(let ye=0,Ae=ce.length;ye<Ae;ye++){const we=r.get(ce[ye]);we.__webglTexture&&(i.deleteTexture(we.__webglTexture),a.memory.textures--),r.remove(ce[ye])}r.remove(j)}let R=0;function F(){R=0}function B(){const j=R;return j>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+j+" texture units while this GPU supports only "+s.maxTextures),R+=1,j}function C(j){const O=[];return O.push(j.wrapS),O.push(j.wrapT),O.push(j.wrapR||0),O.push(j.magFilter),O.push(j.minFilter),O.push(j.anisotropy),O.push(j.internalFormat),O.push(j.format),O.push(j.type),O.push(j.generateMipmaps),O.push(j.premultiplyAlpha),O.push(j.flipY),O.push(j.unpackAlignment),O.push(j.colorSpace),O.join()}function L(j,O){const ce=r.get(j);if(j.isVideoTexture&&Je(j),j.isRenderTargetTexture===!1&&j.version>0&&ce.__version!==j.version){const ye=j.image;if(ye===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ye.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{G(ce,j,O);return}}n.bindTexture(i.TEXTURE_2D,ce.__webglTexture,i.TEXTURE0+O)}function P(j,O){const ce=r.get(j);if(j.version>0&&ce.__version!==j.version){G(ce,j,O);return}n.bindTexture(i.TEXTURE_2D_ARRAY,ce.__webglTexture,i.TEXTURE0+O)}function W(j,O){const ce=r.get(j);if(j.version>0&&ce.__version!==j.version){G(ce,j,O);return}n.bindTexture(i.TEXTURE_3D,ce.__webglTexture,i.TEXTURE0+O)}function D(j,O){const ce=r.get(j);if(j.version>0&&ce.__version!==j.version){Q(ce,j,O);return}n.bindTexture(i.TEXTURE_CUBE_MAP,ce.__webglTexture,i.TEXTURE0+O)}const X={[zd]:i.REPEAT,[Ua]:i.CLAMP_TO_EDGE,[Vd]:i.MIRRORED_REPEAT},q={[Vn]:i.NEAREST,[$N]:i.NEAREST_MIPMAP_NEAREST,[Dl]:i.NEAREST_MIPMAP_LINEAR,[Xi]:i.LINEAR,[$f]:i.LINEAR_MIPMAP_NEAREST,[_s]:i.LINEAR_MIPMAP_LINEAR},J={[WN]:i.NEVER,[YN]:i.ALWAYS,[QS]:i.LESS,[JS]:i.LEQUAL,[jN]:i.EQUAL,[KN]:i.GEQUAL,[qN]:i.GREATER,[XN]:i.NOTEQUAL};function se(j,O){if(O.type===wi&&e.has("OES_texture_float_linear")===!1&&(O.magFilter===Xi||O.magFilter===$f||O.magFilter===Dl||O.magFilter===_s||O.minFilter===Xi||O.minFilter===$f||O.minFilter===Dl||O.minFilter===_s)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(j,i.TEXTURE_WRAP_S,X[O.wrapS]),i.texParameteri(j,i.TEXTURE_WRAP_T,X[O.wrapT]),(j===i.TEXTURE_3D||j===i.TEXTURE_2D_ARRAY)&&i.texParameteri(j,i.TEXTURE_WRAP_R,X[O.wrapR]),i.texParameteri(j,i.TEXTURE_MAG_FILTER,q[O.magFilter]),i.texParameteri(j,i.TEXTURE_MIN_FILTER,q[O.minFilter]),O.compareFunction&&(i.texParameteri(j,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(j,i.TEXTURE_COMPARE_FUNC,J[O.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(O.magFilter===Vn||O.minFilter!==Dl&&O.minFilter!==_s||O.type===wi&&e.has("OES_texture_float_linear")===!1)return;if(O.anisotropy>1||r.get(O).__currentAnisotropy){const ce=e.get("EXT_texture_filter_anisotropic");i.texParameterf(j,ce.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(O.anisotropy,s.getMaxAnisotropy())),r.get(O).__currentAnisotropy=O.anisotropy}}}function de(j,O){let ce=!1;j.__webglInit===void 0&&(j.__webglInit=!0,O.addEventListener("dispose",T));const ye=O.source;let Ae=f.get(ye);Ae===void 0&&(Ae={},f.set(ye,Ae));const we=C(O);if(we!==j.__cacheKey){Ae[we]===void 0&&(Ae[we]={texture:i.createTexture(),usedTimes:0},a.memory.textures++,ce=!0),Ae[we].usedTimes++;const ot=Ae[j.__cacheKey];ot!==void 0&&(Ae[j.__cacheKey].usedTimes--,ot.usedTimes===0&&A(O)),j.__cacheKey=we,j.__webglTexture=Ae[we].texture}return ce}function G(j,O,ce){let ye=i.TEXTURE_2D;(O.isDataArrayTexture||O.isCompressedArrayTexture)&&(ye=i.TEXTURE_2D_ARRAY),O.isData3DTexture&&(ye=i.TEXTURE_3D);const Ae=de(j,O),we=O.source;n.bindTexture(ye,j.__webglTexture,i.TEXTURE0+ce);const ot=r.get(we);if(we.version!==ot.__version||Ae===!0){n.activeTexture(i.TEXTURE0+ce);const Pe=rn.getPrimaries(rn.workingColorSpace),Ce=O.colorSpace===qs?null:rn.getPrimaries(O.colorSpace),vt=O.colorSpace===qs||Pe===Ce?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,O.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,O.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,O.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,vt);let Ne=y(O.image,!1,s.maxTextureSize);Ne=qt(O,Ne);const st=o.convert(O.format,O.colorSpace),ke=o.convert(O.type);let Ye=x(O.internalFormat,st,ke,O.colorSpace,O.isVideoTexture);se(ye,O);let pe;const Ue=O.mipmaps,tt=O.isVideoTexture!==!0,_t=ot.__version===void 0||Ae===!0,ne=we.dataReady,$e=S(O,Ne);if(O.isDepthTexture)Ye=b(O.format===io,O.type),_t&&(tt?n.texStorage2D(i.TEXTURE_2D,1,Ye,Ne.width,Ne.height):n.texImage2D(i.TEXTURE_2D,0,Ye,Ne.width,Ne.height,0,st,ke,null));else if(O.isDataTexture)if(Ue.length>0){tt&&_t&&n.texStorage2D(i.TEXTURE_2D,$e,Ye,Ue[0].width,Ue[0].height);for(let me=0,Me=Ue.length;me<Me;me++)pe=Ue[me],tt?ne&&n.texSubImage2D(i.TEXTURE_2D,me,0,0,pe.width,pe.height,st,ke,pe.data):n.texImage2D(i.TEXTURE_2D,me,Ye,pe.width,pe.height,0,st,ke,pe.data);O.generateMipmaps=!1}else tt?(_t&&n.texStorage2D(i.TEXTURE_2D,$e,Ye,Ne.width,Ne.height),ne&&n.texSubImage2D(i.TEXTURE_2D,0,0,0,Ne.width,Ne.height,st,ke,Ne.data)):n.texImage2D(i.TEXTURE_2D,0,Ye,Ne.width,Ne.height,0,st,ke,Ne.data);else if(O.isCompressedTexture)if(O.isCompressedArrayTexture){tt&&_t&&n.texStorage3D(i.TEXTURE_2D_ARRAY,$e,Ye,Ue[0].width,Ue[0].height,Ne.depth);for(let me=0,Me=Ue.length;me<Me;me++)if(pe=Ue[me],O.format!==yi)if(st!==null)if(tt){if(ne)if(O.layerUpdates.size>0){const Xe=eF(pe.width,pe.height,O.format,O.type);for(const Ze of O.layerUpdates){const Wt=pe.data.subarray(Ze*Xe/pe.data.BYTES_PER_ELEMENT,(Ze+1)*Xe/pe.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,me,0,0,Ze,pe.width,pe.height,1,st,Wt)}O.clearLayerUpdates()}else n.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,me,0,0,0,pe.width,pe.height,Ne.depth,st,pe.data)}else n.compressedTexImage3D(i.TEXTURE_2D_ARRAY,me,Ye,pe.width,pe.height,Ne.depth,0,pe.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else tt?ne&&n.texSubImage3D(i.TEXTURE_2D_ARRAY,me,0,0,0,pe.width,pe.height,Ne.depth,st,ke,pe.data):n.texImage3D(i.TEXTURE_2D_ARRAY,me,Ye,pe.width,pe.height,Ne.depth,0,st,ke,pe.data)}else{tt&&_t&&n.texStorage2D(i.TEXTURE_2D,$e,Ye,Ue[0].width,Ue[0].height);for(let me=0,Me=Ue.length;me<Me;me++)pe=Ue[me],O.format!==yi?st!==null?tt?ne&&n.compressedTexSubImage2D(i.TEXTURE_2D,me,0,0,pe.width,pe.height,st,pe.data):n.compressedTexImage2D(i.TEXTURE_2D,me,Ye,pe.width,pe.height,0,pe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):tt?ne&&n.texSubImage2D(i.TEXTURE_2D,me,0,0,pe.width,pe.height,st,ke,pe.data):n.texImage2D(i.TEXTURE_2D,me,Ye,pe.width,pe.height,0,st,ke,pe.data)}else if(O.isDataArrayTexture)if(tt){if(_t&&n.texStorage3D(i.TEXTURE_2D_ARRAY,$e,Ye,Ne.width,Ne.height,Ne.depth),ne)if(O.layerUpdates.size>0){const me=eF(Ne.width,Ne.height,O.format,O.type);for(const Me of O.layerUpdates){const Xe=Ne.data.subarray(Me*me/Ne.data.BYTES_PER_ELEMENT,(Me+1)*me/Ne.data.BYTES_PER_ELEMENT);n.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Me,Ne.width,Ne.height,1,st,ke,Xe)}O.clearLayerUpdates()}else n.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Ne.width,Ne.height,Ne.depth,st,ke,Ne.data)}else n.texImage3D(i.TEXTURE_2D_ARRAY,0,Ye,Ne.width,Ne.height,Ne.depth,0,st,ke,Ne.data);else if(O.isData3DTexture)tt?(_t&&n.texStorage3D(i.TEXTURE_3D,$e,Ye,Ne.width,Ne.height,Ne.depth),ne&&n.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Ne.width,Ne.height,Ne.depth,st,ke,Ne.data)):n.texImage3D(i.TEXTURE_3D,0,Ye,Ne.width,Ne.height,Ne.depth,0,st,ke,Ne.data);else if(O.isFramebufferTexture){if(_t)if(tt)n.texStorage2D(i.TEXTURE_2D,$e,Ye,Ne.width,Ne.height);else{let me=Ne.width,Me=Ne.height;for(let Xe=0;Xe<$e;Xe++)n.texImage2D(i.TEXTURE_2D,Xe,Ye,me,Me,0,st,ke,null),me>>=1,Me>>=1}}else if(Ue.length>0){if(tt&&_t){const me=et(Ue[0]);n.texStorage2D(i.TEXTURE_2D,$e,Ye,me.width,me.height)}for(let me=0,Me=Ue.length;me<Me;me++)pe=Ue[me],tt?ne&&n.texSubImage2D(i.TEXTURE_2D,me,0,0,st,ke,pe):n.texImage2D(i.TEXTURE_2D,me,Ye,st,ke,pe);O.generateMipmaps=!1}else if(tt){if(_t){const me=et(Ne);n.texStorage2D(i.TEXTURE_2D,$e,Ye,me.width,me.height)}ne&&n.texSubImage2D(i.TEXTURE_2D,0,0,0,st,ke,Ne)}else n.texImage2D(i.TEXTURE_2D,0,Ye,st,ke,Ne);v(O)&&g(ye),ot.__version=we.version,O.onUpdate&&O.onUpdate(O)}j.__version=O.version}function Q(j,O,ce){if(O.image.length!==6)return;const ye=de(j,O),Ae=O.source;n.bindTexture(i.TEXTURE_CUBE_MAP,j.__webglTexture,i.TEXTURE0+ce);const we=r.get(Ae);if(Ae.version!==we.__version||ye===!0){n.activeTexture(i.TEXTURE0+ce);const ot=rn.getPrimaries(rn.workingColorSpace),Pe=O.colorSpace===qs?null:rn.getPrimaries(O.colorSpace),Ce=O.colorSpace===qs||ot===Pe?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,O.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,O.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,O.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ce);const vt=O.isCompressedTexture||O.image[0].isCompressedTexture,Ne=O.image[0]&&O.image[0].isDataTexture,st=[];for(let Me=0;Me<6;Me++)!vt&&!Ne?st[Me]=y(O.image[Me],!0,s.maxCubemapSize):st[Me]=Ne?O.image[Me].image:O.image[Me],st[Me]=qt(O,st[Me]);const ke=st[0],Ye=o.convert(O.format,O.colorSpace),pe=o.convert(O.type),Ue=x(O.internalFormat,Ye,pe,O.colorSpace),tt=O.isVideoTexture!==!0,_t=we.__version===void 0||ye===!0,ne=Ae.dataReady;let $e=S(O,ke);se(i.TEXTURE_CUBE_MAP,O);let me;if(vt){tt&&_t&&n.texStorage2D(i.TEXTURE_CUBE_MAP,$e,Ue,ke.width,ke.height);for(let Me=0;Me<6;Me++){me=st[Me].mipmaps;for(let Xe=0;Xe<me.length;Xe++){const Ze=me[Xe];O.format!==yi?Ye!==null?tt?ne&&n.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Xe,0,0,Ze.width,Ze.height,Ye,Ze.data):n.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Xe,Ue,Ze.width,Ze.height,0,Ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):tt?ne&&n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Xe,0,0,Ze.width,Ze.height,Ye,pe,Ze.data):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Xe,Ue,Ze.width,Ze.height,0,Ye,pe,Ze.data)}}}else{if(me=O.mipmaps,tt&&_t){me.length>0&&$e++;const Me=et(st[0]);n.texStorage2D(i.TEXTURE_CUBE_MAP,$e,Ue,Me.width,Me.height)}for(let Me=0;Me<6;Me++)if(Ne){tt?ne&&n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,st[Me].width,st[Me].height,Ye,pe,st[Me].data):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,Ue,st[Me].width,st[Me].height,0,Ye,pe,st[Me].data);for(let Xe=0;Xe<me.length;Xe++){const Wt=me[Xe].image[Me].image;tt?ne&&n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Xe+1,0,0,Wt.width,Wt.height,Ye,pe,Wt.data):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Xe+1,Ue,Wt.width,Wt.height,0,Ye,pe,Wt.data)}}else{tt?ne&&n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,Ye,pe,st[Me]):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,Ue,Ye,pe,st[Me]);for(let Xe=0;Xe<me.length;Xe++){const Ze=me[Xe];tt?ne&&n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Xe+1,0,0,Ye,pe,Ze.image[Me]):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Xe+1,Ue,Ye,pe,Ze.image[Me])}}}v(O)&&g(i.TEXTURE_CUBE_MAP),we.__version=Ae.version,O.onUpdate&&O.onUpdate(O)}j.__version=O.version}function ee(j,O,ce,ye,Ae,we){const ot=o.convert(ce.format,ce.colorSpace),Pe=o.convert(ce.type),Ce=x(ce.internalFormat,ot,Pe,ce.colorSpace),vt=r.get(O),Ne=r.get(ce);if(Ne.__renderTarget=O,!vt.__hasExternalTextures){const st=Math.max(1,O.width>>we),ke=Math.max(1,O.height>>we);Ae===i.TEXTURE_3D||Ae===i.TEXTURE_2D_ARRAY?n.texImage3D(Ae,we,Ce,st,ke,O.depth,0,ot,Pe,null):n.texImage2D(Ae,we,Ce,st,ke,0,ot,Pe,null)}n.bindFramebuffer(i.FRAMEBUFFER,j),mt(O)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,ye,Ae,Ne.__webglTexture,0,Rt(O)):(Ae===i.TEXTURE_2D||Ae>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Ae<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,ye,Ae,Ne.__webglTexture,we),n.bindFramebuffer(i.FRAMEBUFFER,null)}function ie(j,O,ce){if(i.bindRenderbuffer(i.RENDERBUFFER,j),O.depthBuffer){const ye=O.depthTexture,Ae=ye&&ye.isDepthTexture?ye.type:null,we=b(O.stencilBuffer,Ae),ot=O.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Pe=Rt(O);mt(O)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Pe,we,O.width,O.height):ce?i.renderbufferStorageMultisample(i.RENDERBUFFER,Pe,we,O.width,O.height):i.renderbufferStorage(i.RENDERBUFFER,we,O.width,O.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,ot,i.RENDERBUFFER,j)}else{const ye=O.textures;for(let Ae=0;Ae<ye.length;Ae++){const we=ye[Ae],ot=o.convert(we.format,we.colorSpace),Pe=o.convert(we.type),Ce=x(we.internalFormat,ot,Pe,we.colorSpace),vt=Rt(O);ce&&mt(O)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,vt,Ce,O.width,O.height):mt(O)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,vt,Ce,O.width,O.height):i.renderbufferStorage(i.RENDERBUFFER,Ce,O.width,O.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Se(j,O){if(O&&O.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(i.FRAMEBUFFER,j),!(O.depthTexture&&O.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const ye=r.get(O.depthTexture);ye.__renderTarget=O,(!ye.__webglTexture||O.depthTexture.image.width!==O.width||O.depthTexture.image.height!==O.height)&&(O.depthTexture.image.width=O.width,O.depthTexture.image.height=O.height,O.depthTexture.needsUpdate=!0),L(O.depthTexture,0);const Ae=ye.__webglTexture,we=Rt(O);if(O.depthTexture.format===no)mt(O)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Ae,0,we):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Ae,0);else if(O.depthTexture.format===io)mt(O)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Ae,0,we):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Ae,0);else throw new Error("Unknown depthTexture format")}function Fe(j){const O=r.get(j),ce=j.isWebGLCubeRenderTarget===!0;if(O.__boundDepthTexture!==j.depthTexture){const ye=j.depthTexture;if(O.__depthDisposeCallback&&O.__depthDisposeCallback(),ye){const Ae=()=>{delete O.__boundDepthTexture,delete O.__depthDisposeCallback,ye.removeEventListener("dispose",Ae)};ye.addEventListener("dispose",Ae),O.__depthDisposeCallback=Ae}O.__boundDepthTexture=ye}if(j.depthTexture&&!O.__autoAllocateDepthBuffer){if(ce)throw new Error("target.depthTexture not supported in Cube render targets");const ye=j.texture.mipmaps;ye&&ye.length>0?Se(O.__webglFramebuffer[0],j):Se(O.__webglFramebuffer,j)}else if(ce){O.__webglDepthbuffer=[];for(let ye=0;ye<6;ye++)if(n.bindFramebuffer(i.FRAMEBUFFER,O.__webglFramebuffer[ye]),O.__webglDepthbuffer[ye]===void 0)O.__webglDepthbuffer[ye]=i.createRenderbuffer(),ie(O.__webglDepthbuffer[ye],j,!1);else{const Ae=j.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,we=O.__webglDepthbuffer[ye];i.bindRenderbuffer(i.RENDERBUFFER,we),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ae,i.RENDERBUFFER,we)}}else{const ye=j.texture.mipmaps;if(ye&&ye.length>0?n.bindFramebuffer(i.FRAMEBUFFER,O.__webglFramebuffer[0]):n.bindFramebuffer(i.FRAMEBUFFER,O.__webglFramebuffer),O.__webglDepthbuffer===void 0)O.__webglDepthbuffer=i.createRenderbuffer(),ie(O.__webglDepthbuffer,j,!1);else{const Ae=j.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,we=O.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,we),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ae,i.RENDERBUFFER,we)}}n.bindFramebuffer(i.FRAMEBUFFER,null)}function Be(j,O,ce){const ye=r.get(j);O!==void 0&&ee(ye.__webglFramebuffer,j,j.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),ce!==void 0&&Fe(j)}function ct(j){const O=j.texture,ce=r.get(j),ye=r.get(O);j.addEventListener("dispose",w);const Ae=j.textures,we=j.isWebGLCubeRenderTarget===!0,ot=Ae.length>1;if(ot||(ye.__webglTexture===void 0&&(ye.__webglTexture=i.createTexture()),ye.__version=O.version,a.memory.textures++),we){ce.__webglFramebuffer=[];for(let Pe=0;Pe<6;Pe++)if(O.mipmaps&&O.mipmaps.length>0){ce.__webglFramebuffer[Pe]=[];for(let Ce=0;Ce<O.mipmaps.length;Ce++)ce.__webglFramebuffer[Pe][Ce]=i.createFramebuffer()}else ce.__webglFramebuffer[Pe]=i.createFramebuffer()}else{if(O.mipmaps&&O.mipmaps.length>0){ce.__webglFramebuffer=[];for(let Pe=0;Pe<O.mipmaps.length;Pe++)ce.__webglFramebuffer[Pe]=i.createFramebuffer()}else ce.__webglFramebuffer=i.createFramebuffer();if(ot)for(let Pe=0,Ce=Ae.length;Pe<Ce;Pe++){const vt=r.get(Ae[Pe]);vt.__webglTexture===void 0&&(vt.__webglTexture=i.createTexture(),a.memory.textures++)}if(j.samples>0&&mt(j)===!1){ce.__webglMultisampledFramebuffer=i.createFramebuffer(),ce.__webglColorRenderbuffer=[],n.bindFramebuffer(i.FRAMEBUFFER,ce.__webglMultisampledFramebuffer);for(let Pe=0;Pe<Ae.length;Pe++){const Ce=Ae[Pe];ce.__webglColorRenderbuffer[Pe]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,ce.__webglColorRenderbuffer[Pe]);const vt=o.convert(Ce.format,Ce.colorSpace),Ne=o.convert(Ce.type),st=x(Ce.internalFormat,vt,Ne,Ce.colorSpace,j.isXRRenderTarget===!0),ke=Rt(j);i.renderbufferStorageMultisample(i.RENDERBUFFER,ke,st,j.width,j.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Pe,i.RENDERBUFFER,ce.__webglColorRenderbuffer[Pe])}i.bindRenderbuffer(i.RENDERBUFFER,null),j.depthBuffer&&(ce.__webglDepthRenderbuffer=i.createRenderbuffer(),ie(ce.__webglDepthRenderbuffer,j,!0)),n.bindFramebuffer(i.FRAMEBUFFER,null)}}if(we){n.bindTexture(i.TEXTURE_CUBE_MAP,ye.__webglTexture),se(i.TEXTURE_CUBE_MAP,O);for(let Pe=0;Pe<6;Pe++)if(O.mipmaps&&O.mipmaps.length>0)for(let Ce=0;Ce<O.mipmaps.length;Ce++)ee(ce.__webglFramebuffer[Pe][Ce],j,O,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,Ce);else ee(ce.__webglFramebuffer[Pe],j,O,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,0);v(O)&&g(i.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(ot){for(let Pe=0,Ce=Ae.length;Pe<Ce;Pe++){const vt=Ae[Pe],Ne=r.get(vt);n.bindTexture(i.TEXTURE_2D,Ne.__webglTexture),se(i.TEXTURE_2D,vt),ee(ce.__webglFramebuffer,j,vt,i.COLOR_ATTACHMENT0+Pe,i.TEXTURE_2D,0),v(vt)&&g(i.TEXTURE_2D)}n.unbindTexture()}else{let Pe=i.TEXTURE_2D;if((j.isWebGL3DRenderTarget||j.isWebGLArrayRenderTarget)&&(Pe=j.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),n.bindTexture(Pe,ye.__webglTexture),se(Pe,O),O.mipmaps&&O.mipmaps.length>0)for(let Ce=0;Ce<O.mipmaps.length;Ce++)ee(ce.__webglFramebuffer[Ce],j,O,i.COLOR_ATTACHMENT0,Pe,Ce);else ee(ce.__webglFramebuffer,j,O,i.COLOR_ATTACHMENT0,Pe,0);v(O)&&g(Pe),n.unbindTexture()}j.depthBuffer&&Fe(j)}function xt(j){const O=j.textures;for(let ce=0,ye=O.length;ce<ye;ce++){const Ae=O[ce];if(v(Ae)){const we=_(j),ot=r.get(Ae).__webglTexture;n.bindTexture(we,ot),g(we),n.unbindTexture()}}}const He=[],Z=[];function Nt(j){if(j.samples>0){if(mt(j)===!1){const O=j.textures,ce=j.width,ye=j.height;let Ae=i.COLOR_BUFFER_BIT;const we=j.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ot=r.get(j),Pe=O.length>1;if(Pe)for(let vt=0;vt<O.length;vt++)n.bindFramebuffer(i.FRAMEBUFFER,ot.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+vt,i.RENDERBUFFER,null),n.bindFramebuffer(i.FRAMEBUFFER,ot.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+vt,i.TEXTURE_2D,null,0);n.bindFramebuffer(i.READ_FRAMEBUFFER,ot.__webglMultisampledFramebuffer);const Ce=j.texture.mipmaps;Ce&&Ce.length>0?n.bindFramebuffer(i.DRAW_FRAMEBUFFER,ot.__webglFramebuffer[0]):n.bindFramebuffer(i.DRAW_FRAMEBUFFER,ot.__webglFramebuffer);for(let vt=0;vt<O.length;vt++){if(j.resolveDepthBuffer&&(j.depthBuffer&&(Ae|=i.DEPTH_BUFFER_BIT),j.stencilBuffer&&j.resolveStencilBuffer&&(Ae|=i.STENCIL_BUFFER_BIT)),Pe){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,ot.__webglColorRenderbuffer[vt]);const Ne=r.get(O[vt]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Ne,0)}i.blitFramebuffer(0,0,ce,ye,0,0,ce,ye,Ae,i.NEAREST),c===!0&&(He.length=0,Z.length=0,He.push(i.COLOR_ATTACHMENT0+vt),j.depthBuffer&&j.resolveDepthBuffer===!1&&(He.push(we),Z.push(we),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,Z)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,He))}if(n.bindFramebuffer(i.READ_FRAMEBUFFER,null),n.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Pe)for(let vt=0;vt<O.length;vt++){n.bindFramebuffer(i.FRAMEBUFFER,ot.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+vt,i.RENDERBUFFER,ot.__webglColorRenderbuffer[vt]);const Ne=r.get(O[vt]).__webglTexture;n.bindFramebuffer(i.FRAMEBUFFER,ot.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+vt,i.TEXTURE_2D,Ne,0)}n.bindFramebuffer(i.DRAW_FRAMEBUFFER,ot.__webglMultisampledFramebuffer)}else if(j.depthBuffer&&j.resolveDepthBuffer===!1&&c){const O=j.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[O])}}}function Rt(j){return Math.min(s.maxSamples,j.samples)}function mt(j){const O=r.get(j);return j.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&O.__useRenderToTexture!==!1}function Je(j){const O=a.render.frame;d.get(j)!==O&&(d.set(j,O),j.update())}function qt(j,O){const ce=j.colorSpace,ye=j.format,Ae=j.type;return j.isCompressedTexture===!0||j.isVideoTexture===!0||ce!==Wa&&ce!==qs&&(rn.getTransfer(ce)===Tn?(ye!==yi||Ae!==ci)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ce)),O}function et(j){return typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement?(u.width=j.naturalWidth||j.width,u.height=j.naturalHeight||j.height):typeof VideoFrame<"u"&&j instanceof VideoFrame?(u.width=j.displayWidth,u.height=j.displayHeight):(u.width=j.width,u.height=j.height),u}this.allocateTextureUnit=B,this.resetTextureUnits=F,this.setTexture2D=L,this.setTexture2DArray=P,this.setTexture3D=W,this.setTextureCube=D,this.rebindTextures=Be,this.setupRenderTarget=ct,this.updateRenderTargetMipmap=xt,this.updateMultisampleRenderTarget=Nt,this.setupDepthRenderbuffer=Fe,this.setupFrameBufferTexture=ee,this.useMultisampledRTT=mt}function Pge(i,e){function n(r,s=qs){let o;const a=rn.getTransfer(s);if(r===ci)return i.UNSIGNED_BYTE;if(r===KS)return i.UNSIGNED_SHORT_4_4_4_4;if(r===YS)return i.UNSIGNED_SHORT_5_5_5_1;if(r===ZS)return i.UNSIGNED_INT_5_9_9_9_REV;if(r===bd)return i.BYTE;if(r===Sd)return i.SHORT;if(r===oa)return i.UNSIGNED_SHORT;if(r===or)return i.INT;if(r===Dn)return i.UNSIGNED_INT;if(r===wi)return i.FLOAT;if(r===lr)return i.HALF_FLOAT;if(r===GN)return i.ALPHA;if(r===U0)return i.RGB;if(r===yi)return i.RGBA;if(r===no)return i.DEPTH_COMPONENT;if(r===io)return i.DEPTH_STENCIL;if(r===z0)return i.RED;if(r===nm)return i.RED_INTEGER;if(r===Ol)return i.RG;if(r===im)return i.RG_INTEGER;if(r===rm)return i.RGBA_INTEGER;if(r===wd||r===ou||r===au||r===lu)if(a===Tn)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(r===wd)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===ou)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===au)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===lu)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(r===wd)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===ou)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===au)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===lu)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===Ky||r===Yy||r===Zy||r===Qy)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(r===Ky)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Yy)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===Zy)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Qy)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===Jy||r===hp||r===fp)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(r===Jy||r===hp)return a===Tn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(r===fp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===pp||r===mp||r===gp||r===yp||r===vp||r===xp||r===_p||r===bp||r===Sp||r===wp||r===Tp||r===Ep||r===Mp||r===Ap)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(r===pp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===mp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===gp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===yp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===vp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===xp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===_p)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===bp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===Sp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===wp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===Tp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===Ep)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===Mp)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===Ap)return a===Tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===Td||r===OC||r===FC)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(r===Td)return a===Tn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===OC)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===FC)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===HN||r===e0||r===t0||r===n0)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(r===Td)return o.COMPRESSED_RED_RGTC1_EXT;if(r===e0)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===t0)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===n0)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===to?i.UNSIGNED_INT_24_8:i[r]!==void 0?i[r]:null}return{convert:n}}const Nge=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,kge=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Lge{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,r){if(this.texture===null){const s=new Ki,o=e.properties.get(s);o.__webglTexture=n.texture,(n.depthNear!==r.depthNear||n.depthFar!==r.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,r=new Ka({vertexShader:Nge,fragmentShader:kge,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Xn(new W0(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Ige extends dc{constructor(e,n){super();const r=this;let s=null,o=1,a=null,l="local-floor",c=1,u=null,d=null,h=null,f=null,p=null,m=null;const y=new Lge,v=n.getContextAttributes();let g=null,_=null;const x=[],b=[],S=new Oe;let T=null;const w=new ar;w.viewport=new Dt;const E=new ar;E.viewport=new Dt;const A=[w,E],M=new pG;let R=null,F=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(G){let Q=x[G];return Q===void 0&&(Q=new V_,x[G]=Q),Q.getTargetRaySpace()},this.getControllerGrip=function(G){let Q=x[G];return Q===void 0&&(Q=new V_,x[G]=Q),Q.getGripSpace()},this.getHand=function(G){let Q=x[G];return Q===void 0&&(Q=new V_,x[G]=Q),Q.getHandSpace()};function B(G){const Q=b.indexOf(G.inputSource);if(Q===-1)return;const ee=x[Q];ee!==void 0&&(ee.update(G.inputSource,G.frame,u||a),ee.dispatchEvent({type:G.type,data:G.inputSource}))}function C(){s.removeEventListener("select",B),s.removeEventListener("selectstart",B),s.removeEventListener("selectend",B),s.removeEventListener("squeeze",B),s.removeEventListener("squeezestart",B),s.removeEventListener("squeezeend",B),s.removeEventListener("end",C),s.removeEventListener("inputsourceschange",L);for(let G=0;G<x.length;G++){const Q=b[G];Q!==null&&(b[G]=null,x[G].disconnect(Q))}R=null,F=null,y.reset(),e.setRenderTarget(g),p=null,f=null,h=null,s=null,_=null,de.stop(),r.isPresenting=!1,e.setPixelRatio(T),e.setSize(S.width,S.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(G){o=G,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(G){l=G,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(G){u=G},this.getBaseLayer=function(){return f!==null?f:p},this.getBinding=function(){return h},this.getFrame=function(){return m},this.getSession=function(){return s},this.setSession=async function(G){if(s=G,s!==null){if(g=e.getRenderTarget(),s.addEventListener("select",B),s.addEventListener("selectstart",B),s.addEventListener("selectend",B),s.addEventListener("squeeze",B),s.addEventListener("squeezestart",B),s.addEventListener("squeezeend",B),s.addEventListener("end",C),s.addEventListener("inputsourceschange",L),v.xrCompatible!==!0&&await n.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(S),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let ee=null,ie=null,Se=null;v.depth&&(Se=v.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,ee=v.stencil?io:no,ie=v.stencil?to:Dn);const Fe={colorFormat:n.RGBA8,depthFormat:Se,scaleFactor:o};h=new XRWebGLBinding(s,n),f=h.createProjectionLayer(Fe),s.updateRenderState({layers:[f]}),e.setPixelRatio(1),e.setSize(f.textureWidth,f.textureHeight,!1),_=new gu(f.textureWidth,f.textureHeight,{format:yi,type:ci,depthTexture:new ro(f.textureWidth,f.textureHeight,ie,void 0,void 0,void 0,void 0,void 0,void 0,ee),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:f.ignoreDepthValues===!1,resolveStencilBuffer:f.ignoreDepthValues===!1})}else{const ee={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:o};p=new XRWebGLLayer(s,n,ee),s.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),_=new gu(p.framebufferWidth,p.framebufferHeight,{format:yi,type:ci,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:p.ignoreDepthValues===!1,resolveStencilBuffer:p.ignoreDepthValues===!1})}_.isXRRenderTarget=!0,this.setFoveation(c),u=null,a=await s.requestReferenceSpace(l),de.setContext(s),de.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return y.getDepthTexture()};function L(G){for(let Q=0;Q<G.removed.length;Q++){const ee=G.removed[Q],ie=b.indexOf(ee);ie>=0&&(b[ie]=null,x[ie].disconnect(ee))}for(let Q=0;Q<G.added.length;Q++){const ee=G.added[Q];let ie=b.indexOf(ee);if(ie===-1){for(let Fe=0;Fe<x.length;Fe++)if(Fe>=b.length){b.push(ee),ie=Fe;break}else if(b[Fe]===null){b[Fe]=ee,ie=Fe;break}if(ie===-1)break}const Se=x[ie];Se&&Se.connect(ee)}}const P=new K,W=new K;function D(G,Q,ee){P.setFromMatrixPosition(Q.matrixWorld),W.setFromMatrixPosition(ee.matrixWorld);const ie=P.distanceTo(W),Se=Q.projectionMatrix.elements,Fe=ee.projectionMatrix.elements,Be=Se[14]/(Se[10]-1),ct=Se[14]/(Se[10]+1),xt=(Se[9]+1)/Se[5],He=(Se[9]-1)/Se[5],Z=(Se[8]-1)/Se[0],Nt=(Fe[8]+1)/Fe[0],Rt=Be*Z,mt=Be*Nt,Je=ie/(-Z+Nt),qt=Je*-Z;if(Q.matrixWorld.decompose(G.position,G.quaternion,G.scale),G.translateX(qt),G.translateZ(Je),G.matrixWorld.compose(G.position,G.quaternion,G.scale),G.matrixWorldInverse.copy(G.matrixWorld).invert(),Se[10]===-1)G.projectionMatrix.copy(Q.projectionMatrix),G.projectionMatrixInverse.copy(Q.projectionMatrixInverse);else{const et=Be+Je,j=ct+Je,O=Rt-qt,ce=mt+(ie-qt),ye=xt*ct/j*et,Ae=He*ct/j*et;G.projectionMatrix.makePerspective(O,ce,ye,Ae,et,j),G.projectionMatrixInverse.copy(G.projectionMatrix).invert()}}function X(G,Q){Q===null?G.matrixWorld.copy(G.matrix):G.matrixWorld.multiplyMatrices(Q.matrixWorld,G.matrix),G.matrixWorldInverse.copy(G.matrixWorld).invert()}this.updateCamera=function(G){if(s===null)return;let Q=G.near,ee=G.far;y.texture!==null&&(y.depthNear>0&&(Q=y.depthNear),y.depthFar>0&&(ee=y.depthFar)),M.near=E.near=w.near=Q,M.far=E.far=w.far=ee,(R!==M.near||F!==M.far)&&(s.updateRenderState({depthNear:M.near,depthFar:M.far}),R=M.near,F=M.far),w.layers.mask=G.layers.mask|2,E.layers.mask=G.layers.mask|4,M.layers.mask=w.layers.mask|E.layers.mask;const ie=G.parent,Se=M.cameras;X(M,ie);for(let Fe=0;Fe<Se.length;Fe++)X(Se[Fe],ie);Se.length===2?D(M,w,E):M.projectionMatrix.copy(w.projectionMatrix),q(G,M,ie)};function q(G,Q,ee){ee===null?G.matrix.copy(Q.matrixWorld):(G.matrix.copy(ee.matrixWorld),G.matrix.invert(),G.matrix.multiply(Q.matrixWorld)),G.matrix.decompose(G.position,G.quaternion,G.scale),G.updateMatrixWorld(!0),G.projectionMatrix.copy(Q.projectionMatrix),G.projectionMatrixInverse.copy(Q.projectionMatrixInverse),G.isPerspectiveCamera&&(G.fov=$d*2*Math.atan(1/G.projectionMatrix.elements[5]),G.zoom=1)}this.getCamera=function(){return M},this.getFoveation=function(){if(!(f===null&&p===null))return c},this.setFoveation=function(G){c=G,f!==null&&(f.fixedFoveation=G),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=G)},this.hasDepthSensing=function(){return y.texture!==null},this.getDepthSensingMesh=function(){return y.getMesh(M)};let J=null;function se(G,Q){if(d=Q.getViewerPose(u||a),m=Q,d!==null){const ee=d.views;p!==null&&(e.setRenderTargetFramebuffer(_,p.framebuffer),e.setRenderTarget(_));let ie=!1;ee.length!==M.cameras.length&&(M.cameras.length=0,ie=!0);for(let Be=0;Be<ee.length;Be++){const ct=ee[Be];let xt=null;if(p!==null)xt=p.getViewport(ct);else{const Z=h.getViewSubImage(f,ct);xt=Z.viewport,Be===0&&(e.setRenderTargetTextures(_,Z.colorTexture,Z.depthStencilTexture),e.setRenderTarget(_))}let He=A[Be];He===void 0&&(He=new ar,He.layers.enable(Be),He.viewport=new Dt,A[Be]=He),He.matrix.fromArray(ct.transform.matrix),He.matrix.decompose(He.position,He.quaternion,He.scale),He.projectionMatrix.fromArray(ct.projectionMatrix),He.projectionMatrixInverse.copy(He.projectionMatrix).invert(),He.viewport.set(xt.x,xt.y,xt.width,xt.height),Be===0&&(M.matrix.copy(He.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),ie===!0&&M.cameras.push(He)}const Se=s.enabledFeatures;if(Se&&Se.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&h){const Be=h.getDepthInformation(ee[0]);Be&&Be.isValid&&Be.texture&&y.init(e,Be,s.renderState)}}for(let ee=0;ee<x.length;ee++){const ie=b[ee],Se=x[ee];ie!==null&&Se!==void 0&&Se.update(ie,Q,u||a)}J&&J(G,Q),Q.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:Q}),m=null}const de=new yG;de.setAnimationLoop(se),this.setAnimationLoop=function(G){J=G},this.dispose=function(){}}}const Hu=new ks,Dge=new ln;function Oge(i,e){function n(v,g){v.matrixAutoUpdate===!0&&v.updateMatrix(),g.value.copy(v.matrix)}function r(v,g){g.color.getRGB(v.fogColor.value,eG(i)),g.isFog?(v.fogNear.value=g.near,v.fogFar.value=g.far):g.isFogExp2&&(v.fogDensity.value=g.density)}function s(v,g,_,x,b){g.isMeshBasicMaterial||g.isMeshLambertMaterial?o(v,g):g.isMeshToonMaterial?(o(v,g),h(v,g)):g.isMeshPhongMaterial?(o(v,g),d(v,g)):g.isMeshStandardMaterial?(o(v,g),f(v,g),g.isMeshPhysicalMaterial&&p(v,g,b)):g.isMeshMatcapMaterial?(o(v,g),m(v,g)):g.isMeshDepthMaterial?o(v,g):g.isMeshDistanceMaterial?(o(v,g),y(v,g)):g.isMeshNormalMaterial?o(v,g):g.isLineBasicMaterial?(a(v,g),g.isLineDashedMaterial&&l(v,g)):g.isPointsMaterial?c(v,g,_,x):g.isSpriteMaterial?u(v,g):g.isShadowMaterial?(v.color.value.copy(g.color),v.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function o(v,g){v.opacity.value=g.opacity,g.color&&v.diffuse.value.copy(g.color),g.emissive&&v.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(v.map.value=g.map,n(g.map,v.mapTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,n(g.alphaMap,v.alphaMapTransform)),g.bumpMap&&(v.bumpMap.value=g.bumpMap,n(g.bumpMap,v.bumpMapTransform),v.bumpScale.value=g.bumpScale,g.side===On&&(v.bumpScale.value*=-1)),g.normalMap&&(v.normalMap.value=g.normalMap,n(g.normalMap,v.normalMapTransform),v.normalScale.value.copy(g.normalScale),g.side===On&&v.normalScale.value.negate()),g.displacementMap&&(v.displacementMap.value=g.displacementMap,n(g.displacementMap,v.displacementMapTransform),v.displacementScale.value=g.displacementScale,v.displacementBias.value=g.displacementBias),g.emissiveMap&&(v.emissiveMap.value=g.emissiveMap,n(g.emissiveMap,v.emissiveMapTransform)),g.specularMap&&(v.specularMap.value=g.specularMap,n(g.specularMap,v.specularMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);const _=e.get(g),x=_.envMap,b=_.envMapRotation;x&&(v.envMap.value=x,Hu.copy(b),Hu.x*=-1,Hu.y*=-1,Hu.z*=-1,x.isCubeTexture&&x.isRenderTargetTexture===!1&&(Hu.y*=-1,Hu.z*=-1),v.envMapRotation.value.setFromMatrix4(Dge.makeRotationFromEuler(Hu)),v.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=g.reflectivity,v.ior.value=g.ior,v.refractionRatio.value=g.refractionRatio),g.lightMap&&(v.lightMap.value=g.lightMap,v.lightMapIntensity.value=g.lightMapIntensity,n(g.lightMap,v.lightMapTransform)),g.aoMap&&(v.aoMap.value=g.aoMap,v.aoMapIntensity.value=g.aoMapIntensity,n(g.aoMap,v.aoMapTransform))}function a(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,g.map&&(v.map.value=g.map,n(g.map,v.mapTransform))}function l(v,g){v.dashSize.value=g.dashSize,v.totalSize.value=g.dashSize+g.gapSize,v.scale.value=g.scale}function c(v,g,_,x){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.size.value=g.size*_,v.scale.value=x*.5,g.map&&(v.map.value=g.map,n(g.map,v.uvTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,n(g.alphaMap,v.alphaMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest)}function u(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.rotation.value=g.rotation,g.map&&(v.map.value=g.map,n(g.map,v.mapTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,n(g.alphaMap,v.alphaMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest)}function d(v,g){v.specular.value.copy(g.specular),v.shininess.value=Math.max(g.shininess,1e-4)}function h(v,g){g.gradientMap&&(v.gradientMap.value=g.gradientMap)}function f(v,g){v.metalness.value=g.metalness,g.metalnessMap&&(v.metalnessMap.value=g.metalnessMap,n(g.metalnessMap,v.metalnessMapTransform)),v.roughness.value=g.roughness,g.roughnessMap&&(v.roughnessMap.value=g.roughnessMap,n(g.roughnessMap,v.roughnessMapTransform)),g.envMap&&(v.envMapIntensity.value=g.envMapIntensity)}function p(v,g,_){v.ior.value=g.ior,g.sheen>0&&(v.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),v.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(v.sheenColorMap.value=g.sheenColorMap,n(g.sheenColorMap,v.sheenColorMapTransform)),g.sheenRoughnessMap&&(v.sheenRoughnessMap.value=g.sheenRoughnessMap,n(g.sheenRoughnessMap,v.sheenRoughnessMapTransform))),g.clearcoat>0&&(v.clearcoat.value=g.clearcoat,v.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(v.clearcoatMap.value=g.clearcoatMap,n(g.clearcoatMap,v.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,n(g.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(v.clearcoatNormalMap.value=g.clearcoatNormalMap,n(g.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===On&&v.clearcoatNormalScale.value.negate())),g.dispersion>0&&(v.dispersion.value=g.dispersion),g.iridescence>0&&(v.iridescence.value=g.iridescence,v.iridescenceIOR.value=g.iridescenceIOR,v.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(v.iridescenceMap.value=g.iridescenceMap,n(g.iridescenceMap,v.iridescenceMapTransform)),g.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=g.iridescenceThicknessMap,n(g.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),g.transmission>0&&(v.transmission.value=g.transmission,v.transmissionSamplerMap.value=_.texture,v.transmissionSamplerSize.value.set(_.width,_.height),g.transmissionMap&&(v.transmissionMap.value=g.transmissionMap,n(g.transmissionMap,v.transmissionMapTransform)),v.thickness.value=g.thickness,g.thicknessMap&&(v.thicknessMap.value=g.thicknessMap,n(g.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=g.attenuationDistance,v.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(v.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(v.anisotropyMap.value=g.anisotropyMap,n(g.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=g.specularIntensity,v.specularColor.value.copy(g.specularColor),g.specularColorMap&&(v.specularColorMap.value=g.specularColorMap,n(g.specularColorMap,v.specularColorMapTransform)),g.specularIntensityMap&&(v.specularIntensityMap.value=g.specularIntensityMap,n(g.specularIntensityMap,v.specularIntensityMapTransform))}function m(v,g){g.matcap&&(v.matcap.value=g.matcap)}function y(v,g){const _=e.get(g).light;v.referencePosition.value.setFromMatrixPosition(_.matrixWorld),v.nearDistance.value=_.shadow.camera.near,v.farDistance.value=_.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:s}}function Fge(i,e,n,r){let s={},o={},a=[];const l=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function c(_,x){const b=x.program;r.uniformBlockBinding(_,b)}function u(_,x){let b=s[_.id];b===void 0&&(m(_),b=d(_),s[_.id]=b,_.addEventListener("dispose",v));const S=x.program;r.updateUBOMapping(_,S);const T=e.render.frame;o[_.id]!==T&&(f(_),o[_.id]=T)}function d(_){const x=h();_.__bindingPointIndex=x;const b=i.createBuffer(),S=_.__size,T=_.usage;return i.bindBuffer(i.UNIFORM_BUFFER,b),i.bufferData(i.UNIFORM_BUFFER,S,T),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,x,b),b}function h(){for(let _=0;_<l;_++)if(a.indexOf(_)===-1)return a.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function f(_){const x=s[_.id],b=_.uniforms,S=_.__cache;i.bindBuffer(i.UNIFORM_BUFFER,x);for(let T=0,w=b.length;T<w;T++){const E=Array.isArray(b[T])?b[T]:[b[T]];for(let A=0,M=E.length;A<M;A++){const R=E[A];if(p(R,T,A,S)===!0){const F=R.__offset,B=Array.isArray(R.value)?R.value:[R.value];let C=0;for(let L=0;L<B.length;L++){const P=B[L],W=y(P);typeof P=="number"||typeof P=="boolean"?(R.__data[0]=P,i.bufferSubData(i.UNIFORM_BUFFER,F+C,R.__data)):P.isMatrix3?(R.__data[0]=P.elements[0],R.__data[1]=P.elements[1],R.__data[2]=P.elements[2],R.__data[3]=0,R.__data[4]=P.elements[3],R.__data[5]=P.elements[4],R.__data[6]=P.elements[5],R.__data[7]=0,R.__data[8]=P.elements[6],R.__data[9]=P.elements[7],R.__data[10]=P.elements[8],R.__data[11]=0):(P.toArray(R.__data,C),C+=W.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,F,R.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function p(_,x,b,S){const T=_.value,w=x+"_"+b;if(S[w]===void 0)return typeof T=="number"||typeof T=="boolean"?S[w]=T:S[w]=T.clone(),!0;{const E=S[w];if(typeof T=="number"||typeof T=="boolean"){if(E!==T)return S[w]=T,!0}else if(E.equals(T)===!1)return E.copy(T),!0}return!1}function m(_){const x=_.uniforms;let b=0;const S=16;for(let w=0,E=x.length;w<E;w++){const A=Array.isArray(x[w])?x[w]:[x[w]];for(let M=0,R=A.length;M<R;M++){const F=A[M],B=Array.isArray(F.value)?F.value:[F.value];for(let C=0,L=B.length;C<L;C++){const P=B[C],W=y(P),D=b%S,X=D%W.boundary,q=D+X;b+=X,q!==0&&S-q<W.storage&&(b+=S-q),F.__data=new Float32Array(W.storage/Float32Array.BYTES_PER_ELEMENT),F.__offset=b,b+=W.storage}}}const T=b%S;return T>0&&(b+=S-T),_.__size=b,_.__cache={},this}function y(_){const x={boundary:0,storage:0};return typeof _=="number"||typeof _=="boolean"?(x.boundary=4,x.storage=4):_.isVector2?(x.boundary=8,x.storage=8):_.isVector3||_.isColor?(x.boundary=16,x.storage=12):_.isVector4?(x.boundary=16,x.storage=16):_.isMatrix3?(x.boundary=48,x.storage=48):_.isMatrix4?(x.boundary=64,x.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),x}function v(_){const x=_.target;x.removeEventListener("dispose",v);const b=a.indexOf(x.__bindingPointIndex);a.splice(b,1),i.deleteBuffer(s[x.id]),delete s[x.id],delete o[x.id]}function g(){for(const _ in s)i.deleteBuffer(s[_]);a=[],s={},o={}}return{bind:c,update:u,dispose:g}}class Bge{constructor(e={}){const{canvas:n=Z$(),context:r=null,depth:s=!0,stencil:o=!1,alpha:a=!1,antialias:l=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:u=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:h=!1,reverseDepthBuffer:f=!1}=e;this.isWebGLRenderer=!0;let p;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=r.getContextAttributes().alpha}else p=a;const m=new Uint32Array(4),y=new Int32Array(4);let v=null,g=null;const _=[],x=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Ps,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const b=this;let S=!1;this._outputColorSpace=Et;let T=0,w=0,E=null,A=-1,M=null;const R=new Dt,F=new Dt;let B=null;const C=new St(0);let L=0,P=n.width,W=n.height,D=1,X=null,q=null;const J=new Dt(0,0,P,W),se=new Dt(0,0,P,W);let de=!1;const G=new $0;let Q=!1,ee=!1;const ie=new ln,Se=new ln,Fe=new K,Be=new Dt,ct={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let xt=!1;function He(){return E===null?D:1}let Z=r;function Nt($,re){return n.getContext($,re)}try{const $={alpha:!0,depth:s,stencil:o,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:d,failIfMajorPerformanceCaveat:h};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${tm}`),n.addEventListener("webglcontextlost",Me,!1),n.addEventListener("webglcontextrestored",Xe,!1),n.addEventListener("webglcontextcreationerror",Ze,!1),Z===null){const re="webgl2";if(Z=Nt(re,$),Z===null)throw Nt(re)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch($){throw console.error("THREE.WebGLRenderer: "+$.message),$}let Rt,mt,Je,qt,et,j,O,ce,ye,Ae,we,ot,Pe,Ce,vt,Ne,st,ke,Ye,pe,Ue,tt,_t,ne;function $e(){Rt=new Xpe(Z),Rt.init(),tt=new Pge(Z,Rt),mt=new Vpe(Z,Rt,e,tt),Je=new Cge(Z,Rt),mt.reverseDepthBuffer&&f&&Je.buffers.depth.setReversed(!0),qt=new Zpe(Z),et=new mge,j=new Rge(Z,Rt,Je,et,mt,tt,qt),O=new Gpe(b),ce=new qpe(b),ye=new ihe(Z),_t=new Upe(Z,ye),Ae=new Kpe(Z,ye,qt,_t),we=new Jpe(Z,Ae,ye,qt),Ye=new Qpe(Z,mt,j),Ne=new $pe(et),ot=new pge(b,O,ce,Rt,mt,_t,Ne),Pe=new Oge(b,et),Ce=new yge,vt=new wge(Rt),ke=new Bpe(b,O,ce,Je,we,p,c),st=new Mge(b,we,mt),ne=new Fge(Z,qt,mt,Je),pe=new zpe(Z,Rt,qt),Ue=new Ype(Z,Rt,qt),qt.programs=ot.programs,b.capabilities=mt,b.extensions=Rt,b.properties=et,b.renderLists=Ce,b.shadowMap=st,b.state=Je,b.info=qt}$e();const me=new Ige(b,Z);this.xr=me,this.getContext=function(){return Z},this.getContextAttributes=function(){return Z.getContextAttributes()},this.forceContextLoss=function(){const $=Rt.get("WEBGL_lose_context");$&&$.loseContext()},this.forceContextRestore=function(){const $=Rt.get("WEBGL_lose_context");$&&$.restoreContext()},this.getPixelRatio=function(){return D},this.setPixelRatio=function($){$!==void 0&&(D=$,this.setSize(P,W,!1))},this.getSize=function($){return $.set(P,W)},this.setSize=function($,re,he=!0){if(me.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}P=$,W=re,n.width=Math.floor($*D),n.height=Math.floor(re*D),he===!0&&(n.style.width=$+"px",n.style.height=re+"px"),this.setViewport(0,0,$,re)},this.getDrawingBufferSize=function($){return $.set(P*D,W*D).floor()},this.setDrawingBufferSize=function($,re,he){P=$,W=re,D=he,n.width=Math.floor($*he),n.height=Math.floor(re*he),this.setViewport(0,0,$,re)},this.getCurrentViewport=function($){return $.copy(R)},this.getViewport=function($){return $.copy(J)},this.setViewport=function($,re,he,fe){$.isVector4?J.set($.x,$.y,$.z,$.w):J.set($,re,he,fe),Je.viewport(R.copy(J).multiplyScalar(D).round())},this.getScissor=function($){return $.copy(se)},this.setScissor=function($,re,he,fe){$.isVector4?se.set($.x,$.y,$.z,$.w):se.set($,re,he,fe),Je.scissor(F.copy(se).multiplyScalar(D).round())},this.getScissorTest=function(){return de},this.setScissorTest=function($){Je.setScissorTest(de=$)},this.setOpaqueSort=function($){X=$},this.setTransparentSort=function($){q=$},this.getClearColor=function($){return $.copy(ke.getClearColor())},this.setClearColor=function(){ke.setClearColor(...arguments)},this.getClearAlpha=function(){return ke.getClearAlpha()},this.setClearAlpha=function(){ke.setClearAlpha(...arguments)},this.clear=function($=!0,re=!0,he=!0){let fe=0;if($){let le=!1;if(E!==null){const Ve=E.texture.format;le=Ve===rm||Ve===im||Ve===nm}if(le){const Ve=E.texture.type,nt=Ve===ci||Ve===Dn||Ve===oa||Ve===to||Ve===KS||Ve===YS,ut=ke.getClearColor(),pt=ke.getClearAlpha(),Bt=ut.r,Ot=ut.g,Mt=ut.b;nt?(m[0]=Bt,m[1]=Ot,m[2]=Mt,m[3]=pt,Z.clearBufferuiv(Z.COLOR,0,m)):(y[0]=Bt,y[1]=Ot,y[2]=Mt,y[3]=pt,Z.clearBufferiv(Z.COLOR,0,y))}else fe|=Z.COLOR_BUFFER_BIT}re&&(fe|=Z.DEPTH_BUFFER_BIT),he&&(fe|=Z.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Z.clear(fe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Me,!1),n.removeEventListener("webglcontextrestored",Xe,!1),n.removeEventListener("webglcontextcreationerror",Ze,!1),ke.dispose(),Ce.dispose(),vt.dispose(),et.dispose(),O.dispose(),ce.dispose(),we.dispose(),_t.dispose(),ne.dispose(),ot.dispose(),me.dispose(),me.removeEventListener("sessionstart",rv),me.removeEventListener("sessionend",sv),tl.stop()};function Me($){$.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),S=!0}function Xe(){console.log("THREE.WebGLRenderer: Context Restored."),S=!1;const $=qt.autoReset,re=st.enabled,he=st.autoUpdate,fe=st.needsUpdate,le=st.type;$e(),qt.autoReset=$,st.enabled=re,st.autoUpdate=he,st.needsUpdate=fe,st.type=le}function Ze($){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",$.statusMessage)}function Wt($){const re=$.target;re.removeEventListener("dispose",Wt),$n(re)}function $n($){tr($),et.remove($)}function tr($){const re=et.get($).programs;re!==void 0&&(re.forEach(function(he){ot.releaseProgram(he)}),$.isShaderMaterial&&ot.releaseShaderCache($))}this.renderBufferDirect=function($,re,he,fe,le,Ve){re===null&&(re=ct);const nt=le.isMesh&&le.matrixWorld.determinant()<0,ut=Iw($,re,he,fe,le);Je.setMaterial(fe,nt);let pt=he.index,Bt=1;if(fe.wireframe===!0){if(pt=Ae.getWireframeAttribute(he),pt===void 0)return;Bt=2}const Ot=he.drawRange,Mt=he.attributes.position;let tn=Ot.start*Bt,fn=(Ot.start+Ot.count)*Bt;Ve!==null&&(tn=Math.max(tn,Ve.start*Bt),fn=Math.min(fn,(Ve.start+Ve.count)*Bt)),pt!==null?(tn=Math.max(tn,0),fn=Math.min(fn,pt.count)):Mt!=null&&(tn=Math.max(tn,0),fn=Math.min(fn,Mt.count));const ii=fn-tn;if(ii<0||ii===1/0)return;_t.setup(le,fe,ut,he,pt);let Yn,un=pe;if(pt!==null&&(Yn=ye.get(pt),un=Ue,un.setIndex(Yn)),le.isMesh)fe.wireframe===!0?(Je.setLineWidth(fe.wireframeLinewidth*He()),un.setMode(Z.LINES)):un.setMode(Z.TRIANGLES);else if(le.isLine){let Pt=fe.linewidth;Pt===void 0&&(Pt=1),Je.setLineWidth(Pt*He()),le.isLineSegments?un.setMode(Z.LINES):le.isLineLoop?un.setMode(Z.LINE_LOOP):un.setMode(Z.LINE_STRIP)}else le.isPoints?un.setMode(Z.POINTS):le.isSprite&&un.setMode(Z.TRIANGLES);if(le.isBatchedMesh)if(le._multiDrawInstances!==null)da("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),un.renderMultiDrawInstances(le._multiDrawStarts,le._multiDrawCounts,le._multiDrawCount,le._multiDrawInstances);else if(Rt.get("WEBGL_multi_draw"))un.renderMultiDraw(le._multiDrawStarts,le._multiDrawCounts,le._multiDrawCount);else{const Pt=le._multiDrawStarts,$i=le._multiDrawCounts,pn=le._multiDrawCount,hs=pt?ye.get(pt).bytesPerElement:1,Bn=et.get(fe).currentProgram.getUniforms();for(let pr=0;pr<pn;pr++)Bn.setValue(Z,"_gl_DrawID",pr),un.render(Pt[pr]/hs,$i[pr])}else if(le.isInstancedMesh)un.renderInstances(tn,ii,le.count);else if(he.isInstancedBufferGeometry){const Pt=he._maxInstanceCount!==void 0?he._maxInstanceCount:1/0,$i=Math.min(he.instanceCount,Pt);un.renderInstances(tn,ii,$i)}else un.render(tn,ii)};function Jt($,re,he){$.transparent===!0&&$.side===Qr&&$.forceSinglePass===!1?($.side=On,$.needsUpdate=!0,Jd($,re,he),$.side=Cs,$.needsUpdate=!0,Jd($,re,he),$.side=Qr):Jd($,re,he)}this.compile=function($,re,he=null){he===null&&(he=$),g=vt.get(he),g.init(re),x.push(g),he.traverseVisible(function(le){le.isLight&&le.layers.test(re.layers)&&(g.pushLight(le),le.castShadow&&g.pushShadow(le))}),$!==he&&$.traverseVisible(function(le){le.isLight&&le.layers.test(re.layers)&&(g.pushLight(le),le.castShadow&&g.pushShadow(le))}),g.setupLights();const fe=new Set;return $.traverse(function(le){if(!(le.isMesh||le.isPoints||le.isLine||le.isSprite))return;const Ve=le.material;if(Ve)if(Array.isArray(Ve))for(let nt=0;nt<Ve.length;nt++){const ut=Ve[nt];Jt(ut,he,le),fe.add(ut)}else Jt(Ve,he,le),fe.add(Ve)}),g=x.pop(),fe},this.compileAsync=function($,re,he=null){const fe=this.compile($,re,he);return new Promise(le=>{function Ve(){if(fe.forEach(function(nt){et.get(nt).currentProgram.isReady()&&fe.delete(nt)}),fe.size===0){le($);return}setTimeout(Ve,10)}Rt.get("KHR_parallel_shader_compile")!==null?Ve():setTimeout(Ve,10)})};let ds=null;function Bo($){ds&&ds($)}function rv(){tl.stop()}function sv(){tl.start()}const tl=new yG;tl.setAnimationLoop(Bo),typeof self<"u"&&tl.setContext(self),this.setAnimationLoop=function($){ds=$,me.setAnimationLoop($),$===null?tl.stop():tl.start()},me.addEventListener("sessionstart",rv),me.addEventListener("sessionend",sv),this.render=function($,re){if(re!==void 0&&re.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(S===!0)return;if($.matrixWorldAutoUpdate===!0&&$.updateMatrixWorld(),re.parent===null&&re.matrixWorldAutoUpdate===!0&&re.updateMatrixWorld(),me.enabled===!0&&me.isPresenting===!0&&(me.cameraAutoUpdate===!0&&me.updateCamera(re),re=me.getCamera()),$.isScene===!0&&$.onBeforeRender(b,$,re,E),g=vt.get($,x.length),g.init(re),x.push(g),Se.multiplyMatrices(re.projectionMatrix,re.matrixWorldInverse),G.setFromProjectionMatrix(Se),ee=this.localClippingEnabled,Q=Ne.init(this.clippingPlanes,ee),v=Ce.get($,_.length),v.init(),_.push(v),me.enabled===!0&&me.isPresenting===!0){const Ve=b.xr.getDepthSensingMesh();Ve!==null&&dm(Ve,re,-1/0,b.sortObjects)}dm($,re,0,b.sortObjects),v.finish(),b.sortObjects===!0&&v.sort(X,q),xt=me.enabled===!1||me.isPresenting===!1||me.hasDepthSensing()===!1,xt&&ke.addToRenderList(v,$),this.info.render.frame++,Q===!0&&Ne.beginShadows();const he=g.state.shadowsArray;st.render(he,$,re),Q===!0&&Ne.endShadows(),this.info.autoReset===!0&&this.info.reset();const fe=v.opaque,le=v.transmissive;if(g.setupLights(),re.isArrayCamera){const Ve=re.cameras;if(le.length>0)for(let nt=0,ut=Ve.length;nt<ut;nt++){const pt=Ve[nt];hm(fe,le,$,pt)}xt&&ke.render($);for(let nt=0,ut=Ve.length;nt<ut;nt++){const pt=Ve[nt];ov(v,$,pt,pt.viewport)}}else le.length>0&&hm(fe,le,$,re),xt&&ke.render($),ov(v,$,re);E!==null&&w===0&&(j.updateMultisampleRenderTarget(E),j.updateRenderTargetMipmap(E)),$.isScene===!0&&$.onAfterRender(b,$,re),_t.resetDefaultState(),A=-1,M=null,x.pop(),x.length>0?(g=x[x.length-1],Q===!0&&Ne.setGlobalState(b.clippingPlanes,g.state.camera)):g=null,_.pop(),_.length>0?v=_[_.length-1]:v=null};function dm($,re,he,fe){if($.visible===!1)return;if($.layers.test(re.layers)){if($.isGroup)he=$.renderOrder;else if($.isLOD)$.autoUpdate===!0&&$.update(re);else if($.isLight)g.pushLight($),$.castShadow&&g.pushShadow($);else if($.isSprite){if(!$.frustumCulled||G.intersectsSprite($)){fe&&Be.setFromMatrixPosition($.matrixWorld).applyMatrix4(Se);const nt=we.update($),ut=$.material;ut.visible&&v.push($,nt,ut,he,Be.z,null)}}else if(($.isMesh||$.isLine||$.isPoints)&&(!$.frustumCulled||G.intersectsObject($))){const nt=we.update($),ut=$.material;if(fe&&($.boundingSphere!==void 0?($.boundingSphere===null&&$.computeBoundingSphere(),Be.copy($.boundingSphere.center)):(nt.boundingSphere===null&&nt.computeBoundingSphere(),Be.copy(nt.boundingSphere.center)),Be.applyMatrix4($.matrixWorld).applyMatrix4(Se)),Array.isArray(ut)){const pt=nt.groups;for(let Bt=0,Ot=pt.length;Bt<Ot;Bt++){const Mt=pt[Bt],tn=ut[Mt.materialIndex];tn&&tn.visible&&v.push($,nt,tn,he,Be.z,Mt)}}else ut.visible&&v.push($,nt,ut,he,Be.z,null)}}const Ve=$.children;for(let nt=0,ut=Ve.length;nt<ut;nt++)dm(Ve[nt],re,he,fe)}function ov($,re,he,fe){const le=$.opaque,Ve=$.transmissive,nt=$.transparent;g.setupLightsView(he),Q===!0&&Ne.setGlobalState(b.clippingPlanes,he),fe&&Je.viewport(R.copy(fe)),le.length>0&&Qd(le,re,he),Ve.length>0&&Qd(Ve,re,he),nt.length>0&&Qd(nt,re,he),Je.buffers.depth.setTest(!0),Je.buffers.depth.setMask(!0),Je.buffers.color.setMask(!0),Je.setPolygonOffset(!1)}function hm($,re,he,fe){if((he.isScene===!0?he.overrideMaterial:null)!==null)return;g.state.transmissionRenderTarget[fe.id]===void 0&&(g.state.transmissionRenderTarget[fe.id]=new gu(1,1,{generateMipmaps:!0,type:Rt.has("EXT_color_buffer_half_float")||Rt.has("EXT_color_buffer_float")?lr:ci,minFilter:_s,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:rn.workingColorSpace}));const Ve=g.state.transmissionRenderTarget[fe.id],nt=fe.viewport||R;Ve.setSize(nt.z*b.transmissionResolutionScale,nt.w*b.transmissionResolutionScale);const ut=b.getRenderTarget();b.setRenderTarget(Ve),b.getClearColor(C),L=b.getClearAlpha(),L<1&&b.setClearColor(16777215,.5),b.clear(),xt&&ke.render(he);const pt=b.toneMapping;b.toneMapping=Ps;const Bt=fe.viewport;if(fe.viewport!==void 0&&(fe.viewport=void 0),g.setupLightsView(fe),Q===!0&&Ne.setGlobalState(b.clippingPlanes,fe),Qd($,he,fe),j.updateMultisampleRenderTarget(Ve),j.updateRenderTargetMipmap(Ve),Rt.has("WEBGL_multisampled_render_to_texture")===!1){let Ot=!1;for(let Mt=0,tn=re.length;Mt<tn;Mt++){const fn=re[Mt],ii=fn.object,Yn=fn.geometry,un=fn.material,Pt=fn.group;if(un.side===Qr&&ii.layers.test(fe.layers)){const $i=un.side;un.side=On,un.needsUpdate=!0,fm(ii,he,fe,Yn,un,Pt),un.side=$i,un.needsUpdate=!0,Ot=!0}}Ot===!0&&(j.updateMultisampleRenderTarget(Ve),j.updateRenderTargetMipmap(Ve))}b.setRenderTarget(ut),b.setClearColor(C,L),Bt!==void 0&&(fe.viewport=Bt),b.toneMapping=pt}function Qd($,re,he){const fe=re.isScene===!0?re.overrideMaterial:null;for(let le=0,Ve=$.length;le<Ve;le++){const nt=$[le],ut=nt.object,pt=nt.geometry,Bt=nt.group;let Ot=nt.material;Ot.allowOverride===!0&&fe!==null&&(Ot=fe),ut.layers.test(he.layers)&&fm(ut,re,he,pt,Ot,Bt)}}function fm($,re,he,fe,le,Ve){$.onBeforeRender(b,re,he,fe,le,Ve),$.modelViewMatrix.multiplyMatrices(he.matrixWorldInverse,$.matrixWorld),$.normalMatrix.getNormalMatrix($.modelViewMatrix),le.onBeforeRender(b,re,he,fe,$,Ve),le.transparent===!0&&le.side===Qr&&le.forceSinglePass===!1?(le.side=On,le.needsUpdate=!0,b.renderBufferDirect(he,re,fe,le,$,Ve),le.side=Cs,le.needsUpdate=!0,b.renderBufferDirect(he,re,fe,le,$,Ve),le.side=Qr):b.renderBufferDirect(he,re,fe,le,$,Ve),$.onAfterRender(b,re,he,fe,le,Ve)}function Jd($,re,he){re.isScene!==!0&&(re=ct);const fe=et.get($),le=g.state.lights,Ve=g.state.shadowsArray,nt=le.state.version,ut=ot.getParameters($,le.state,Ve,re,he),pt=ot.getProgramCacheKey(ut);let Bt=fe.programs;fe.environment=$.isMeshStandardMaterial?re.environment:null,fe.fog=re.fog,fe.envMap=($.isMeshStandardMaterial?ce:O).get($.envMap||fe.environment),fe.envMapRotation=fe.environment!==null&&$.envMap===null?re.environmentRotation:$.envMapRotation,Bt===void 0&&($.addEventListener("dispose",Wt),Bt=new Map,fe.programs=Bt);let Ot=Bt.get(pt);if(Ot!==void 0){if(fe.currentProgram===Ot&&fe.lightsStateVersion===nt)return lv($,ut),Ot}else ut.uniforms=ot.getUniforms($),$.onBeforeCompile(ut,b),Ot=ot.acquireProgram(ut,pt),Bt.set(pt,Ot),fe.uniforms=ut.uniforms;const Mt=fe.uniforms;return(!$.isShaderMaterial&&!$.isRawShaderMaterial||$.clipping===!0)&&(Mt.clippingPlanes=Ne.uniform),lv($,ut),fe.needsLights=Ow($),fe.lightsStateVersion=nt,fe.needsLights&&(Mt.ambientLightColor.value=le.state.ambient,Mt.lightProbe.value=le.state.probe,Mt.directionalLights.value=le.state.directional,Mt.directionalLightShadows.value=le.state.directionalShadow,Mt.spotLights.value=le.state.spot,Mt.spotLightShadows.value=le.state.spotShadow,Mt.rectAreaLights.value=le.state.rectArea,Mt.ltc_1.value=le.state.rectAreaLTC1,Mt.ltc_2.value=le.state.rectAreaLTC2,Mt.pointLights.value=le.state.point,Mt.pointLightShadows.value=le.state.pointShadow,Mt.hemisphereLights.value=le.state.hemi,Mt.directionalShadowMap.value=le.state.directionalShadowMap,Mt.directionalShadowMatrix.value=le.state.directionalShadowMatrix,Mt.spotShadowMap.value=le.state.spotShadowMap,Mt.spotLightMatrix.value=le.state.spotLightMatrix,Mt.spotLightMap.value=le.state.spotLightMap,Mt.pointShadowMap.value=le.state.pointShadowMap,Mt.pointShadowMatrix.value=le.state.pointShadowMatrix),fe.currentProgram=Ot,fe.uniformsList=null,Ot}function av($){if($.uniformsList===null){const re=$.currentProgram.getUniforms();$.uniformsList=$_.seqWithValue(re.seq,$.uniforms)}return $.uniformsList}function lv($,re){const he=et.get($);he.outputColorSpace=re.outputColorSpace,he.batching=re.batching,he.batchingColor=re.batchingColor,he.instancing=re.instancing,he.instancingColor=re.instancingColor,he.instancingMorph=re.instancingMorph,he.skinning=re.skinning,he.morphTargets=re.morphTargets,he.morphNormals=re.morphNormals,he.morphColors=re.morphColors,he.morphTargetsCount=re.morphTargetsCount,he.numClippingPlanes=re.numClippingPlanes,he.numIntersection=re.numClipIntersection,he.vertexAlphas=re.vertexAlphas,he.vertexTangents=re.vertexTangents,he.toneMapping=re.toneMapping}function Iw($,re,he,fe,le){re.isScene!==!0&&(re=ct),j.resetTextureUnits();const Ve=re.fog,nt=fe.isMeshStandardMaterial?re.environment:null,ut=E===null?b.outputColorSpace:E.isXRRenderTarget===!0?E.texture.colorSpace:Wa,pt=(fe.isMeshStandardMaterial?ce:O).get(fe.envMap||nt),Bt=fe.vertexColors===!0&&!!he.attributes.color&&he.attributes.color.itemSize===4,Ot=!!he.attributes.tangent&&(!!fe.normalMap||fe.anisotropy>0),Mt=!!he.morphAttributes.position,tn=!!he.morphAttributes.normal,fn=!!he.morphAttributes.color;let ii=Ps;fe.toneMapped&&(E===null||E.isXRRenderTarget===!0)&&(ii=b.toneMapping);const Yn=he.morphAttributes.position||he.morphAttributes.normal||he.morphAttributes.color,un=Yn!==void 0?Yn.length:0,Pt=et.get(fe),$i=g.state.lights;if(Q===!0&&(ee===!0||$!==M)){const Ri=$===M&&fe.id===A;Ne.setState(fe,$,Ri)}let pn=!1;fe.version===Pt.__version?(Pt.needsLights&&Pt.lightsStateVersion!==$i.state.version||Pt.outputColorSpace!==ut||le.isBatchedMesh&&Pt.batching===!1||!le.isBatchedMesh&&Pt.batching===!0||le.isBatchedMesh&&Pt.batchingColor===!0&&le.colorTexture===null||le.isBatchedMesh&&Pt.batchingColor===!1&&le.colorTexture!==null||le.isInstancedMesh&&Pt.instancing===!1||!le.isInstancedMesh&&Pt.instancing===!0||le.isSkinnedMesh&&Pt.skinning===!1||!le.isSkinnedMesh&&Pt.skinning===!0||le.isInstancedMesh&&Pt.instancingColor===!0&&le.instanceColor===null||le.isInstancedMesh&&Pt.instancingColor===!1&&le.instanceColor!==null||le.isInstancedMesh&&Pt.instancingMorph===!0&&le.morphTexture===null||le.isInstancedMesh&&Pt.instancingMorph===!1&&le.morphTexture!==null||Pt.envMap!==pt||fe.fog===!0&&Pt.fog!==Ve||Pt.numClippingPlanes!==void 0&&(Pt.numClippingPlanes!==Ne.numPlanes||Pt.numIntersection!==Ne.numIntersection)||Pt.vertexAlphas!==Bt||Pt.vertexTangents!==Ot||Pt.morphTargets!==Mt||Pt.morphNormals!==tn||Pt.morphColors!==fn||Pt.toneMapping!==ii||Pt.morphTargetsCount!==un)&&(pn=!0):(pn=!0,Pt.__version=fe.version);let hs=Pt.currentProgram;pn===!0&&(hs=Jd(fe,re,le));let Bn=!1,pr=!1,Lu=!1;const kn=hs.getUniforms(),Gr=Pt.uniforms;if(Je.useProgram(hs.program)&&(Bn=!0,pr=!0,Lu=!0),fe.id!==A&&(A=fe.id,pr=!0),Bn||M!==$){Je.buffers.depth.getReversed()?(ie.copy($.projectionMatrix),$ue(ie),Gue(ie),kn.setValue(Z,"projectionMatrix",ie)):kn.setValue(Z,"projectionMatrix",$.projectionMatrix),kn.setValue(Z,"viewMatrix",$.matrixWorldInverse);const Gi=kn.map.cameraPosition;Gi!==void 0&&Gi.setValue(Z,Fe.setFromMatrixPosition($.matrixWorld)),mt.logarithmicDepthBuffer&&kn.setValue(Z,"logDepthBufFC",2/(Math.log($.far+1)/Math.LN2)),(fe.isMeshPhongMaterial||fe.isMeshToonMaterial||fe.isMeshLambertMaterial||fe.isMeshBasicMaterial||fe.isMeshStandardMaterial||fe.isShaderMaterial)&&kn.setValue(Z,"isOrthographic",$.isOrthographicCamera===!0),M!==$&&(M=$,pr=!0,Lu=!0)}if(le.isSkinnedMesh){kn.setOptional(Z,le,"bindMatrix"),kn.setOptional(Z,le,"bindMatrixInverse");const Ri=le.skeleton;Ri&&(Ri.boneTexture===null&&Ri.computeBoneTexture(),kn.setValue(Z,"boneTexture",Ri.boneTexture,j))}le.isBatchedMesh&&(kn.setOptional(Z,le,"batchingTexture"),kn.setValue(Z,"batchingTexture",le._matricesTexture,j),kn.setOptional(Z,le,"batchingIdTexture"),kn.setValue(Z,"batchingIdTexture",le._indirectTexture,j),kn.setOptional(Z,le,"batchingColorTexture"),le._colorsTexture!==null&&kn.setValue(Z,"batchingColorTexture",le._colorsTexture,j));const Mr=he.morphAttributes;if((Mr.position!==void 0||Mr.normal!==void 0||Mr.color!==void 0)&&Ye.update(le,he,hs),(pr||Pt.receiveShadow!==le.receiveShadow)&&(Pt.receiveShadow=le.receiveShadow,kn.setValue(Z,"receiveShadow",le.receiveShadow)),fe.isMeshGouraudMaterial&&fe.envMap!==null&&(Gr.envMap.value=pt,Gr.flipEnvMap.value=pt.isCubeTexture&&pt.isRenderTargetTexture===!1?-1:1),fe.isMeshStandardMaterial&&fe.envMap===null&&re.environment!==null&&(Gr.envMapIntensity.value=re.environmentIntensity),pr&&(kn.setValue(Z,"toneMappingExposure",b.toneMappingExposure),Pt.needsLights&&Dw(Gr,Lu),Ve&&fe.fog===!0&&Pe.refreshFogUniforms(Gr,Ve),Pe.refreshMaterialUniforms(Gr,fe,D,W,g.state.transmissionRenderTarget[$.id]),$_.upload(Z,av(Pt),Gr,j)),fe.isShaderMaterial&&fe.uniformsNeedUpdate===!0&&($_.upload(Z,av(Pt),Gr,j),fe.uniformsNeedUpdate=!1),fe.isSpriteMaterial&&kn.setValue(Z,"center",le.center),kn.setValue(Z,"modelViewMatrix",le.modelViewMatrix),kn.setValue(Z,"normalMatrix",le.normalMatrix),kn.setValue(Z,"modelMatrix",le.matrixWorld),fe.isShaderMaterial||fe.isRawShaderMaterial){const Ri=fe.uniformsGroups;for(let Gi=0,eh=Ri.length;Gi<eh;Gi++){const nl=Ri[Gi];ne.update(nl,hs),ne.bind(nl,hs)}}return hs}function Dw($,re){$.ambientLightColor.needsUpdate=re,$.lightProbe.needsUpdate=re,$.directionalLights.needsUpdate=re,$.directionalLightShadows.needsUpdate=re,$.pointLights.needsUpdate=re,$.pointLightShadows.needsUpdate=re,$.spotLights.needsUpdate=re,$.spotLightShadows.needsUpdate=re,$.rectAreaLights.needsUpdate=re,$.hemisphereLights.needsUpdate=re}function Ow($){return $.isMeshLambertMaterial||$.isMeshToonMaterial||$.isMeshPhongMaterial||$.isMeshStandardMaterial||$.isShadowMaterial||$.isShaderMaterial&&$.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return E},this.setRenderTargetTextures=function($,re,he){const fe=et.get($);fe.__autoAllocateDepthBuffer=$.resolveDepthBuffer===!1,fe.__autoAllocateDepthBuffer===!1&&(fe.__useRenderToTexture=!1),et.get($.texture).__webglTexture=re,et.get($.depthTexture).__webglTexture=fe.__autoAllocateDepthBuffer?void 0:he,fe.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function($,re){const he=et.get($);he.__webglFramebuffer=re,he.__useDefaultFramebuffer=re===void 0};const Fw=Z.createFramebuffer();this.setRenderTarget=function($,re=0,he=0){E=$,T=re,w=he;let fe=!0,le=null,Ve=!1,nt=!1;if($){const pt=et.get($);if(pt.__useDefaultFramebuffer!==void 0)Je.bindFramebuffer(Z.FRAMEBUFFER,null),fe=!1;else if(pt.__webglFramebuffer===void 0)j.setupRenderTarget($);else if(pt.__hasExternalTextures)j.rebindTextures($,et.get($.texture).__webglTexture,et.get($.depthTexture).__webglTexture);else if($.depthBuffer){const Mt=$.depthTexture;if(pt.__boundDepthTexture!==Mt){if(Mt!==null&&et.has(Mt)&&($.width!==Mt.image.width||$.height!==Mt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");j.setupDepthRenderbuffer($)}}const Bt=$.texture;(Bt.isData3DTexture||Bt.isDataArrayTexture||Bt.isCompressedArrayTexture)&&(nt=!0);const Ot=et.get($).__webglFramebuffer;$.isWebGLCubeRenderTarget?(Array.isArray(Ot[re])?le=Ot[re][he]:le=Ot[re],Ve=!0):$.samples>0&&j.useMultisampledRTT($)===!1?le=et.get($).__webglMultisampledFramebuffer:Array.isArray(Ot)?le=Ot[he]:le=Ot,R.copy($.viewport),F.copy($.scissor),B=$.scissorTest}else R.copy(J).multiplyScalar(D).floor(),F.copy(se).multiplyScalar(D).floor(),B=de;if(he!==0&&(le=Fw),Je.bindFramebuffer(Z.FRAMEBUFFER,le)&&fe&&Je.drawBuffers($,le),Je.viewport(R),Je.scissor(F),Je.setScissorTest(B),Ve){const pt=et.get($.texture);Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_CUBE_MAP_POSITIVE_X+re,pt.__webglTexture,he)}else if(nt){const pt=et.get($.texture),Bt=re;Z.framebufferTextureLayer(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,pt.__webglTexture,he,Bt)}else if($!==null&&he!==0){const pt=et.get($.texture);Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,pt.__webglTexture,he)}A=-1},this.readRenderTargetPixels=function($,re,he,fe,le,Ve,nt){if(!($&&$.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ut=et.get($).__webglFramebuffer;if($.isWebGLCubeRenderTarget&&nt!==void 0&&(ut=ut[nt]),ut){Je.bindFramebuffer(Z.FRAMEBUFFER,ut);try{const pt=$.texture,Bt=pt.format,Ot=pt.type;if(!mt.textureFormatReadable(Bt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!mt.textureTypeReadable(Ot)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}re>=0&&re<=$.width-fe&&he>=0&&he<=$.height-le&&Z.readPixels(re,he,fe,le,tt.convert(Bt),tt.convert(Ot),Ve)}finally{const pt=E!==null?et.get(E).__webglFramebuffer:null;Je.bindFramebuffer(Z.FRAMEBUFFER,pt)}}},this.readRenderTargetPixelsAsync=async function($,re,he,fe,le,Ve,nt){if(!($&&$.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ut=et.get($).__webglFramebuffer;if($.isWebGLCubeRenderTarget&&nt!==void 0&&(ut=ut[nt]),ut)if(re>=0&&re<=$.width-fe&&he>=0&&he<=$.height-le){Je.bindFramebuffer(Z.FRAMEBUFFER,ut);const pt=$.texture,Bt=pt.format,Ot=pt.type;if(!mt.textureFormatReadable(Bt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!mt.textureTypeReadable(Ot))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Mt=Z.createBuffer();Z.bindBuffer(Z.PIXEL_PACK_BUFFER,Mt),Z.bufferData(Z.PIXEL_PACK_BUFFER,Ve.byteLength,Z.STREAM_READ),Z.readPixels(re,he,fe,le,tt.convert(Bt),tt.convert(Ot),0);const tn=E!==null?et.get(E).__webglFramebuffer:null;Je.bindFramebuffer(Z.FRAMEBUFFER,tn);const fn=Z.fenceSync(Z.SYNC_GPU_COMMANDS_COMPLETE,0);return Z.flush(),await Vue(Z,fn,4),Z.bindBuffer(Z.PIXEL_PACK_BUFFER,Mt),Z.getBufferSubData(Z.PIXEL_PACK_BUFFER,0,Ve),Z.deleteBuffer(Mt),Z.deleteSync(fn),Ve}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function($,re=null,he=0){const fe=Math.pow(2,-he),le=Math.floor($.image.width*fe),Ve=Math.floor($.image.height*fe),nt=re!==null?re.x:0,ut=re!==null?re.y:0;j.setTexture2D($,0),Z.copyTexSubImage2D(Z.TEXTURE_2D,he,0,0,nt,ut,le,Ve),Je.unbindTexture()};const Bw=Z.createFramebuffer(),Uw=Z.createFramebuffer();this.copyTextureToTexture=function($,re,he=null,fe=null,le=0,Ve=null){Ve===null&&(le!==0?(da("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ve=le,le=0):Ve=0);let nt,ut,pt,Bt,Ot,Mt,tn,fn,ii;const Yn=$.isCompressedTexture?$.mipmaps[Ve]:$.image;if(he!==null)nt=he.max.x-he.min.x,ut=he.max.y-he.min.y,pt=he.isBox3?he.max.z-he.min.z:1,Bt=he.min.x,Ot=he.min.y,Mt=he.isBox3?he.min.z:0;else{const Mr=Math.pow(2,-le);nt=Math.floor(Yn.width*Mr),ut=Math.floor(Yn.height*Mr),$.isDataArrayTexture?pt=Yn.depth:$.isData3DTexture?pt=Math.floor(Yn.depth*Mr):pt=1,Bt=0,Ot=0,Mt=0}fe!==null?(tn=fe.x,fn=fe.y,ii=fe.z):(tn=0,fn=0,ii=0);const un=tt.convert(re.format),Pt=tt.convert(re.type);let $i;re.isData3DTexture?(j.setTexture3D(re,0),$i=Z.TEXTURE_3D):re.isDataArrayTexture||re.isCompressedArrayTexture?(j.setTexture2DArray(re,0),$i=Z.TEXTURE_2D_ARRAY):(j.setTexture2D(re,0),$i=Z.TEXTURE_2D),Z.pixelStorei(Z.UNPACK_FLIP_Y_WEBGL,re.flipY),Z.pixelStorei(Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,re.premultiplyAlpha),Z.pixelStorei(Z.UNPACK_ALIGNMENT,re.unpackAlignment);const pn=Z.getParameter(Z.UNPACK_ROW_LENGTH),hs=Z.getParameter(Z.UNPACK_IMAGE_HEIGHT),Bn=Z.getParameter(Z.UNPACK_SKIP_PIXELS),pr=Z.getParameter(Z.UNPACK_SKIP_ROWS),Lu=Z.getParameter(Z.UNPACK_SKIP_IMAGES);Z.pixelStorei(Z.UNPACK_ROW_LENGTH,Yn.width),Z.pixelStorei(Z.UNPACK_IMAGE_HEIGHT,Yn.height),Z.pixelStorei(Z.UNPACK_SKIP_PIXELS,Bt),Z.pixelStorei(Z.UNPACK_SKIP_ROWS,Ot),Z.pixelStorei(Z.UNPACK_SKIP_IMAGES,Mt);const kn=$.isDataArrayTexture||$.isData3DTexture,Gr=re.isDataArrayTexture||re.isData3DTexture;if($.isDepthTexture){const Mr=et.get($),Ri=et.get(re),Gi=et.get(Mr.__renderTarget),eh=et.get(Ri.__renderTarget);Je.bindFramebuffer(Z.READ_FRAMEBUFFER,Gi.__webglFramebuffer),Je.bindFramebuffer(Z.DRAW_FRAMEBUFFER,eh.__webglFramebuffer);for(let nl=0;nl<pt;nl++)kn&&(Z.framebufferTextureLayer(Z.READ_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,et.get($).__webglTexture,le,Mt+nl),Z.framebufferTextureLayer(Z.DRAW_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,et.get(re).__webglTexture,Ve,ii+nl)),Z.blitFramebuffer(Bt,Ot,nt,ut,tn,fn,nt,ut,Z.DEPTH_BUFFER_BIT,Z.NEAREST);Je.bindFramebuffer(Z.READ_FRAMEBUFFER,null),Je.bindFramebuffer(Z.DRAW_FRAMEBUFFER,null)}else if(le!==0||$.isRenderTargetTexture||et.has($)){const Mr=et.get($),Ri=et.get(re);Je.bindFramebuffer(Z.READ_FRAMEBUFFER,Bw),Je.bindFramebuffer(Z.DRAW_FRAMEBUFFER,Uw);for(let Gi=0;Gi<pt;Gi++)kn?Z.framebufferTextureLayer(Z.READ_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Mr.__webglTexture,le,Mt+Gi):Z.framebufferTexture2D(Z.READ_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,Mr.__webglTexture,le),Gr?Z.framebufferTextureLayer(Z.DRAW_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Ri.__webglTexture,Ve,ii+Gi):Z.framebufferTexture2D(Z.DRAW_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,Ri.__webglTexture,Ve),le!==0?Z.blitFramebuffer(Bt,Ot,nt,ut,tn,fn,nt,ut,Z.COLOR_BUFFER_BIT,Z.NEAREST):Gr?Z.copyTexSubImage3D($i,Ve,tn,fn,ii+Gi,Bt,Ot,nt,ut):Z.copyTexSubImage2D($i,Ve,tn,fn,Bt,Ot,nt,ut);Je.bindFramebuffer(Z.READ_FRAMEBUFFER,null),Je.bindFramebuffer(Z.DRAW_FRAMEBUFFER,null)}else Gr?$.isDataTexture||$.isData3DTexture?Z.texSubImage3D($i,Ve,tn,fn,ii,nt,ut,pt,un,Pt,Yn.data):re.isCompressedArrayTexture?Z.compressedTexSubImage3D($i,Ve,tn,fn,ii,nt,ut,pt,un,Yn.data):Z.texSubImage3D($i,Ve,tn,fn,ii,nt,ut,pt,un,Pt,Yn):$.isDataTexture?Z.texSubImage2D(Z.TEXTURE_2D,Ve,tn,fn,nt,ut,un,Pt,Yn.data):$.isCompressedTexture?Z.compressedTexSubImage2D(Z.TEXTURE_2D,Ve,tn,fn,Yn.width,Yn.height,un,Yn.data):Z.texSubImage2D(Z.TEXTURE_2D,Ve,tn,fn,nt,ut,un,Pt,Yn);Z.pixelStorei(Z.UNPACK_ROW_LENGTH,pn),Z.pixelStorei(Z.UNPACK_IMAGE_HEIGHT,hs),Z.pixelStorei(Z.UNPACK_SKIP_PIXELS,Bn),Z.pixelStorei(Z.UNPACK_SKIP_ROWS,pr),Z.pixelStorei(Z.UNPACK_SKIP_IMAGES,Lu),Ve===0&&re.generateMipmaps&&Z.generateMipmap($i),Je.unbindTexture()},this.copyTextureToTexture3D=function($,re,he=null,fe=null,le=0){return da('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture($,re,he,fe,le)},this.initRenderTarget=function($){et.get($).__webglFramebuffer===void 0&&j.setupRenderTarget($)},this.initTexture=function($){$.isCubeTexture?j.setTextureCube($,0):$.isData3DTexture?j.setTexture3D($,0):$.isDataArrayTexture||$.isCompressedArrayTexture?j.setTexture2DArray($,0):j.setTexture2D($,0),Je.unbindTexture()},this.resetState=function(){T=0,w=0,E=null,Je.reset(),_t.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return is}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=rn._getDrawingBufferColorSpace(e),n.unpackColorSpace=rn._getUnpackColorSpace()}}let bi=class{static roundNumber(e,n){const r=Math.pow(10,n);return Math.round(e*r)/r}static sample(e){return e[Math.floor(Math.random()*e.length)]}static distanceToSquared(e,n){var r=e.x-n.x,s=e.y-n.y,o=e.z-n.z;return r*r+s*s+o*o}static isPointInPoly(e,n){for(var r=!1,s=-1,o=e.length,a=o-1;++s<o;a=s)(e[s].z<=n.z&&n.z<e[a].z||e[a].z<=n.z&&n.z<e[s].z)&&n.x<(e[a].x-e[s].x)*(n.z-e[s].z)/(e[a].z-e[s].z)+e[s].x&&(r=!r);return r}static isVectorInPolygon(e,n,r){var s=1e5,o=-1e5,a=[];return n.vertexIds.forEach(l=>{s=Math.min(r[l].y,s),o=Math.max(r[l].y,o),a.push(r[l])}),!!(e.y<o+.5&&e.y>s-.5&&this.isPointInPoly(a,e))}static triarea2(e,n,r){return(r.x-e.x)*(n.z-e.z)-(n.x-e.x)*(r.z-e.z)}static vequal(e,n){return this.distanceToSquared(e,n)<1e-5}static mergeVertices(e,n=1e-4){n=Math.max(n,Number.EPSILON);for(var r={},s=e.getIndex(),o=e.getAttribute("position"),a=s?s.count:o.count,l=0,c=[],u=[],d=Math.log10(1/n),h=Math.pow(10,d),f=0;f<a;f++){var p=s?s.getX(f):f,m="";m+=~~(o.getX(p)*h)+",",m+=~~(o.getY(p)*h)+",",(m+=~~(o.getZ(p)*h)+",")in r?c.push(r[m]):(u.push(o.getX(p)),u.push(o.getY(p)),u.push(o.getZ(p)),r[m]=l,c.push(l),l++)}const y=new Yi(new Float32Array(u),o.itemSize,o.normalized),v=new Tr;return v.setAttribute("position",y),v.setIndex(c),v}},Uge=class{constructor(e){this.content=[],this.scoreFunction=e}push(e){this.content.push(e),this.sinkDown(this.content.length-1)}pop(){const e=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),e}remove(e){const n=this.content.indexOf(e),r=this.content.pop();n!==this.content.length-1&&(this.content[n]=r,this.scoreFunction(r)<this.scoreFunction(e)?this.sinkDown(n):this.bubbleUp(n))}size(){return this.content.length}rescoreElement(e){this.sinkDown(this.content.indexOf(e))}sinkDown(e){const n=this.content[e];for(;e>0;){const r=(e+1>>1)-1,s=this.content[r];if(!(this.scoreFunction(n)<this.scoreFunction(s)))break;this.content[r]=n,this.content[e]=s,e=r}}bubbleUp(e){const n=this.content.length,r=this.content[e],s=this.scoreFunction(r);for(;;){const o=e+1<<1,a=o-1;let l,c=null;if(a<n&&(l=this.scoreFunction(this.content[a]),l<s&&(c=a)),o<n&&this.scoreFunction(this.content[o])<(c===null?s:l)&&(c=o),c===null)break;this.content[e]=this.content[c],this.content[c]=r,e=c}}},zge=class{constructor(){this.portals=[]}push(e,n){n===void 0&&(n=e),this.portals.push({left:e,right:n})}stringPull(){const e=this.portals,n=[];let r,s,o,a=0,l=0,c=0;r=e[0].left,s=e[0].left,o=e[0].right,n.push(r);for(let u=1;u<e.length;u++){const d=e[u].left,h=e[u].right;if(bi.triarea2(r,o,h)<=0){if(!(bi.vequal(r,o)||bi.triarea2(r,s,h)>0)){n.push(s),r=s,a=l,s=r,o=r,l=a,c=a,u=a;continue}o=h,c=u}if(bi.triarea2(r,s,d)>=0){if(!(bi.vequal(r,s)||bi.triarea2(r,o,d)<0)){n.push(o),r=o,a=c,s=r,o=r,l=a,c=a,u=a;continue}s=d,l=u}}return n.length!==0&&bi.vequal(n[n.length-1],e[e.length-1].left)||n.push(e[e.length-1].left),this.path=n,n}},VC=class{constructor(){this.zones={}}static createZone(e,n=1e-4){return(class{static buildZone(r,s){const o=this._buildNavigationMesh(r,s),a={};o.vertices.forEach(c=>{c.x=bi.roundNumber(c.x,2),c.y=bi.roundNumber(c.y,2),c.z=bi.roundNumber(c.z,2)}),a.vertices=o.vertices;const l=this._buildPolygonGroups(o);return a.groups=new Array(l.length),l.forEach((c,u)=>{const d=new Map;c.forEach((f,p)=>{d.set(f,p)});const h=new Array(c.length);c.forEach((f,p)=>{const m=[];f.neighbours.forEach(g=>m.push(d.get(g)));const y=[];f.neighbours.forEach(g=>y.push(this._getSharedVerticesInOrder(f,g)));const v=new K(0,0,0);v.add(a.vertices[f.vertexIds[0]]),v.add(a.vertices[f.vertexIds[1]]),v.add(a.vertices[f.vertexIds[2]]),v.divideScalar(3),v.x=bi.roundNumber(v.x,2),v.y=bi.roundNumber(v.y,2),v.z=bi.roundNumber(v.z,2),h[p]={id:p,neighbours:m,vertexIds:f.vertexIds,centroid:v,portals:y}}),a.groups[u]=h}),a}static _buildNavigationMesh(r,s){return r=bi.mergeVertices(r,s),this._buildPolygonsFromGeometry(r)}static _spreadGroupId(r){let s=new Set([r]);for(;s.size>0;){const o=s;s=new Set,o.forEach(a=>{a.group=r.group,a.neighbours.forEach(l=>{l.group===void 0&&s.add(l)})})}}static _buildPolygonGroups(r){const s=[];return r.polygons.forEach(o=>{o.group!==void 0?s[o.group].push(o):(o.group=s.length,this._spreadGroupId(o),s.push([o]))}),s}static _buildPolygonNeighbours(r,s){const o=new Set,a=s[r.vertexIds[1]],l=s[r.vertexIds[2]];return s[r.vertexIds[0]].forEach(c=>{c!==r&&(a.includes(c)||l.includes(c))&&o.add(c)}),a.forEach(c=>{c!==r&&l.includes(c)&&o.add(c)}),o}static _buildPolygonsFromGeometry(r){const s=[],o=[],a=r.attributes.position,l=r.index,c=[];for(let u=0;u<a.count;u++)o.push(new K().fromBufferAttribute(a,u)),c[u]=[];for(let u=0;u<r.index.count;u+=3){const d=l.getX(u),h=l.getX(u+1),f=l.getX(u+2),p={vertexIds:[d,h,f],neighbours:null};s.push(p),c[d].push(p),c[h].push(p),c[f].push(p)}return s.forEach(u=>{u.neighbours=this._buildPolygonNeighbours(u,c)}),{polygons:s,vertices:o}}static _getSharedVerticesInOrder(r,s){const o=r.vertexIds,a=o[0],l=o[1],c=o[2],u=s.vertexIds,d=u.includes(a),h=u.includes(l),f=u.includes(c);return d&&h&&f?Array.from(o):d&&h?[a,l]:h&&f?[l,c]:d&&f?[c,a]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}).buildZone(e,n)}setZoneData(e,n){this.zones[e]=n}getRandomNode(e,n,r,s){if(!this.zones[e])return new K;r=r||null,s=s||0;const o=[];return this.zones[e].groups[n].forEach(a=>{r&&s?bi.distanceToSquared(r,a.centroid)<s*s&&o.push(a.centroid):o.push(a.centroid)}),bi.sample(o)||new K}getClosestNode(e,n,r,s=!1){const o=this.zones[n].vertices;let a=null,l=1/0;return this.zones[n].groups[r].forEach(c=>{const u=bi.distanceToSquared(c.centroid,e);u<l&&(!s||bi.isVectorInPolygon(e,c,o))&&(a=c,l=u)}),a}findPath(e,n,r,s){const o=this.zones[r].groups[s],a=this.zones[r].vertices,l=this.getClosestNode(e,r,s,!0),c=this.getClosestNode(n,r,s,!0);if(!l||!c)return null;const u=(class{static init(p){for(let m=0;m<p.length;m++){const y=p[m];y.f=0,y.g=0,y.h=0,y.cost=1,y.visited=!1,y.closed=!1,y.parent=null}}static cleanUp(p){for(let m=0;m<p.length;m++){const y=p[m];delete y.f,delete y.g,delete y.h,delete y.cost,delete y.visited,delete y.closed,delete y.parent}}static heap(){return new Uge(function(p){return p.f})}static search(p,m,y){this.init(p);const v=this.heap();for(v.push(m);v.size()>0;){const g=v.pop();if(g===y){let x=g;const b=[];for(;x.parent;)b.push(x),x=x.parent;return this.cleanUp(b),b.reverse()}g.closed=!0;const _=this.neighbours(p,g);for(let x=0,b=_.length;x<b;x++){const S=_[x];if(S.closed)continue;const T=g.g+S.cost,w=S.visited;if(!w||T<S.g){if(S.visited=!0,S.parent=g,!S.centroid||!y.centroid)throw new Error("Unexpected state");S.h=S.h||this.heuristic(S.centroid,y.centroid),S.g=T,S.f=S.g+S.h,w?v.rescoreElement(S):v.push(S)}}}return[]}static heuristic(p,m){return bi.distanceToSquared(p,m)}static neighbours(p,m){const y=[];for(let v=0;v<m.neighbours.length;v++)y.push(p[m.neighbours[v]]);return y}}).search(o,l,c),d=function(p,m){for(var y=0;y<p.neighbours.length;y++)if(p.neighbours[y]===m.id)return p.portals[y]},h=new zge;h.push(e);for(let p=0;p<u.length;p++){const m=u[p],y=u[p+1];if(y){const v=d(m,y);h.push(a[v[0]],a[v[1]])}}h.push(n),h.stringPull();const f=h.path.map(p=>new K(p.x,p.y,p.z));return f.shift(),f}};VC.prototype.getGroup=function(){const i=new Ws;return function(e,n,r=!1){if(!this.zones[e])return null;let s=null,o=Math.pow(50,2);const a=this.zones[e];for(let l=0;l<a.groups.length;l++){const c=a.groups[l];for(const u of c){if(r&&(i.setFromCoplanarPoints(a.vertices[u.vertexIds[0]],a.vertices[u.vertexIds[1]],a.vertices[u.vertexIds[2]]),Math.abs(i.distanceToPoint(n))<.01)&&bi.isPointInPoly([a.vertices[u.vertexIds[0]],a.vertices[u.vertexIds[1]],a.vertices[u.vertexIds[2]]],n))return l;const d=bi.distanceToSquared(u.centroid,n);d<o&&(s=l,o=d)}}return s}}(),VC.prototype.clampStep=function(){const i=new K,e=new Ws,n=new To,r=new K;let s,o,a=new K;return function(l,c,u,d,h,f){const p=this.zones[d].vertices,m=this.zones[d].groups[h],y=[u],v={};v[u.id]=0,s=void 0,a.set(0,0,0),o=1/0,e.setFromCoplanarPoints(p[u.vertexIds[0]],p[u.vertexIds[1]],p[u.vertexIds[2]]),e.projectPoint(c,i),r.copy(i);for(let g=y.pop();g;g=y.pop()){n.set(p[g.vertexIds[0]],p[g.vertexIds[1]],p[g.vertexIds[2]]),n.closestPointToPoint(r,i),i.distanceToSquared(r)<o&&(s=g,a.copy(i),o=i.distanceToSquared(r));const _=v[g.id];if(!(_>2))for(let x=0;x<g.neighbours.length;x++){const b=m[g.neighbours[x]];b.id in v||(y.push(b),v[b.id]=_+1)}}return f.copy(a),s}}();let Vge=class extends xi{constructor(){super(),this._playerMarker=new Xn(new Gd(.25,32,32),new es({color:15631215})),this._targetMarker=new Xn(new ja(.3,.3,.3),new es({color:14469912})),this._nodeMarker=new Xn(new ja(.1,.8,.1),new es({color:4417387})),this._stepMarker=new Xn(new ja(.1,1,.1),new es({color:14472114})),this._pathMarker=new xi,this._pathLineMaterial=new G0({color:41903,linewidth:2}),this._pathPointMaterial=new es({color:41903}),this._pathPointGeometry=new Gd(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(e=>{e.visible=!1,this.add(e)})}setPath(e){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);e=[this._playerMarker.position].concat(e);const n=new Tr;n.setAttribute("position",new Yi(new Float32Array(3*e.length),3));for(let r=0;r<e.length;r++)n.attributes.position.setXYZ(r,e[r].x,e[r].y+.2,e[r].z);this._pathMarker.add(new sG(n,this._pathLineMaterial));for(let r=0;r<e.length-1;r++){const s=new Xn(this._pathPointGeometry,this._pathPointMaterial);s.position.copy(e[r]),s.position.y+=.2,this._pathMarker.add(s)}return this._pathMarker.visible=!0,this}setPlayerPosition(e){return this._playerMarker.position.copy(e),this._playerMarker.visible=!0,this}setTargetPosition(e){return this._targetMarker.position.copy(e),this._targetMarker.visible=!0,this}setNodePosition(e){return this._nodeMarker.position.copy(e),this._nodeMarker.visible=!0,this}setStepPosition(e){return this._stepMarker.position.copy(e),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(e=>{e.visible=!1}),this}};const $ge=Object.freeze(Object.defineProperty({__proto__:null,Pathfinding:VC,PathfindingHelper:Vge},Symbol.toStringTag,{value:"Module"})),Gge=sc($ge),{Pathfinding:SG}=Gge,Gm=new SG,Hm="level";AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(i){this.navMesh=new THREE.Mesh(i),Gm.setZoneData(Hm,SG.createZone(i)),Array.from(this.agents).forEach(e=>e.updateNavLocation())},getNavMesh:function(){return this.navMesh},addAgent:function(i){this.agents.add(i)},removeAgent:function(i){this.agents.delete(i)},getPath:function(i,e,n){return this.navMesh?Gm.findPath(i,e,Hm,n):null},getGroup:function(i){return this.navMesh?Gm.getGroup(Hm,i):null},getNode:function(i,e){return this.navMesh?Gm.getClosestNode(i,Hm,e,!0):null},clampStep:function(i,e,n,r,s){if(this.navMesh){if(!r)return s.copy(e),this.getNode(e,n)}else return s.copy(e),null;return Gm.clampStep(i,e,r,Hm,n,s)}});AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}});AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}});AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){const i=this.el,e=this.data;let n=i.components.material;const r=new THREE.PlaneGeometry(e.width,e.depth,e.density,e.density);this.waves=[];const s=r.getAttribute("position");for(let o=0;o<s.count;o++)this.waves.push({z:s.getZ(o),ang:Math.random()*Math.PI*2,amp:e.amplitude+Math.random()*e.amplitudeVariance,speed:(e.speed+Math.random()*e.speedVariance)/1e3});n||(n={},n.material=new THREE.MeshPhongMaterial({color:e.color,transparent:e.opacity<1,opacity:e.opacity,flatShading:!0})),this.mesh=new THREE.Mesh(r,n.material),i.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(i,e){if(!e)return;const n=this.mesh.geometry.getAttribute("position");for(let r=0;r<n.count;r++){const s=this.waves[r],o=s.z+Math.sin(s.ang)*s.amp;n.setZ(r,o),s.ang+=s.speed*e}n.needsUpdate=!0}});AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}});AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){const i=this.el,e=this.data;let n=i.components.material;if(!e.path.length){console.error("[a-tube] `path` property expected but not found.");return}const r=new THREE.CatmullRomCurve3(e.path.map(function(o){return o=o.split(" "),new THREE.Vector3(Number(o[0]),Number(o[1]),Number(o[2]))})),s=new THREE.TubeGeometry(r,e.segments,e.radius,e.radialSegments,e.closed);n||(n={},n.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(s,n.material),this.el.setObject3D("mesh",this.mesh)},update:function(i){Object.keys(i).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}});function wG(i,e,n){var r,s=1;i==null&&(i=0),e==null&&(e=0),n==null&&(n=0);function o(){var a,l=r.length,c,u=0,d=0,h=0;for(a=0;a<l;++a)c=r[a],u+=c.x||0,d+=c.y||0,h+=c.z||0;for(u=(u/l-i)*s,d=(d/l-e)*s,h=(h/l-n)*s,a=0;a<l;++a)c=r[a],u&&(c.x-=u),d&&(c.y-=d),h&&(c.z-=h)}return o.initialize=function(a){r=a},o.x=function(a){return arguments.length?(i=+a,o):i},o.y=function(a){return arguments.length?(e=+a,o):e},o.z=function(a){return arguments.length?(n=+a,o):n},o.strength=function(a){return arguments.length?(s=+a,o):s},o}function Hge(i){const e=+this._x.call(null,i);return TG(this.cover(e),e,i)}function TG(i,e,n){if(isNaN(e))return i;var r,s=i._root,o={data:n},a=i._x0,l=i._x1,c,u,d,h,f;if(!s)return i._root=o,i;for(;s.length;)if((d=e>=(c=(a+l)/2))?a=c:l=c,r=s,!(s=s[h=+d]))return r[h]=o,i;if(u=+i._x.call(null,s.data),e===u)return o.next=s,r?r[h]=o:i._root=o,i;do r=r?r[h]=new Array(2):i._root=new Array(2),(d=e>=(c=(a+l)/2))?a=c:l=c;while((h=+d)==(f=+(u>=c)));return r[f]=s,r[h]=o,i}function Wge(i){Array.isArray(i)||(i=Array.from(i));const e=i.length,n=new Float64Array(e);let r=1/0,s=-1/0;for(let o=0,a;o<e;++o)isNaN(a=+this._x.call(null,i[o]))||(n[o]=a,a<r&&(r=a),a>s&&(s=a));if(r>s)return this;this.cover(r).cover(s);for(let o=0;o<e;++o)TG(this,n[o],i[o]);return this}function jge(i){if(isNaN(i=+i))return this;var e=this._x0,n=this._x1;if(isNaN(e))n=(e=Math.floor(i))+1;else{for(var r=n-e||1,s=this._root,o,a;e>i||i>=n;)switch(a=+(i<e),o=new Array(2),o[a]=s,s=o,r*=2,a){case 0:n=e+r;break;case 1:e=n-r;break}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._x1=n,this}function qge(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}function Xge(i){return arguments.length?this.cover(+i[0][0]).cover(+i[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function Wl(i,e,n){this.node=i,this.x0=e,this.x1=n}function Kge(i,e){var n,r=this._x0,s,o,a=this._x1,l=[],c=this._root,u,d;for(c&&l.push(new Wl(c,r,a)),e==null?e=1/0:(r=i-e,a=i+e);u=l.pop();)if(!(!(c=u.node)||(s=u.x0)>a||(o=u.x1)<r))if(c.length){var h=(s+o)/2;l.push(new Wl(c[1],h,o),new Wl(c[0],s,h)),(d=+(i>=h))&&(u=l[l.length-1],l[l.length-1]=l[l.length-1-d],l[l.length-1-d]=u)}else{var f=Math.abs(i-+this._x.call(null,c.data));f<e&&(e=f,r=i-f,a=i+f,n=c.data)}return n}function Yge(i){if(isNaN(c=+this._x.call(null,i)))return this;var e,n=this._root,r,s,o,a=this._x0,l=this._x1,c,u,d,h,f;if(!n)return this;if(n.length)for(;;){if((d=c>=(u=(a+l)/2))?a=u:l=u,e=n,!(n=n[h=+d]))return this;if(!n.length)break;e[h+1&1]&&(r=e,f=h)}for(;n.data!==i;)if(s=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,s?(o?s.next=o:delete s.next,this):e?(o?e[h]=o:delete e[h],(n=e[0]||e[1])&&n===(e[1]||e[0])&&!n.length&&(r?r[f]=n:this._root=n),this):(this._root=o,this)}function Zge(i){for(var e=0,n=i.length;e<n;++e)this.remove(i[e]);return this}function Qge(){return this._root}function Jge(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}function eye(i){var e=[],n,r=this._root,s,o,a;for(r&&e.push(new Wl(r,this._x0,this._x1));n=e.pop();)if(!i(r=n.node,o=n.x0,a=n.x1)&&r.length){var l=(o+a)/2;(s=r[1])&&e.push(new Wl(s,l,a)),(s=r[0])&&e.push(new Wl(s,o,l))}return this}function tye(i){var e=[],n=[],r;for(this._root&&e.push(new Wl(this._root,this._x0,this._x1));r=e.pop();){var s=r.node;if(s.length){var o,a=r.x0,l=r.x1,c=(a+l)/2;(o=s[0])&&e.push(new Wl(o,a,c)),(o=s[1])&&e.push(new Wl(o,c,l))}n.push(r)}for(;r=n.pop();)i(r.node,r.x0,r.x1);return this}function nye(i){return i[0]}function iye(i){return arguments.length?(this._x=i,this):this._x}function EG(i,e){var n=new f2(e??nye,NaN,NaN);return i==null?n:n.addAll(i)}function f2(i,e,n){this._x=i,this._x0=e,this._x1=n,this._root=void 0}function EF(i){for(var e={data:i.data},n=e;i=i.next;)n=n.next={data:i.data};return e}var Is=EG.prototype=f2.prototype;Is.copy=function(){var i=new f2(this._x,this._x0,this._x1),e=this._root,n,r;if(!e)return i;if(!e.length)return i._root=EF(e),i;for(n=[{source:e,target:i._root=new Array(2)}];e=n.pop();)for(var s=0;s<2;++s)(r=e.source[s])&&(r.length?n.push({source:r,target:e.target[s]=new Array(2)}):e.target[s]=EF(r));return i};Is.add=Hge;Is.addAll=Wge;Is.cover=jge;Is.data=qge;Is.extent=Xge;Is.find=Kge;Is.remove=Yge;Is.removeAll=Zge;Is.root=Qge;Is.size=Jge;Is.visit=eye;Is.visitAfter=tye;Is.x=iye;function rye(i){const e=+this._x.call(null,i),n=+this._y.call(null,i);return MG(this.cover(e,n),e,n,i)}function MG(i,e,n,r){if(isNaN(e)||isNaN(n))return i;var s,o=i._root,a={data:r},l=i._x0,c=i._y0,u=i._x1,d=i._y1,h,f,p,m,y,v,g,_;if(!o)return i._root=a,i;for(;o.length;)if((y=e>=(h=(l+u)/2))?l=h:u=h,(v=n>=(f=(c+d)/2))?c=f:d=f,s=o,!(o=o[g=v<<1|y]))return s[g]=a,i;if(p=+i._x.call(null,o.data),m=+i._y.call(null,o.data),e===p&&n===m)return a.next=o,s?s[g]=a:i._root=a,i;do s=s?s[g]=new Array(4):i._root=new Array(4),(y=e>=(h=(l+u)/2))?l=h:u=h,(v=n>=(f=(c+d)/2))?c=f:d=f;while((g=v<<1|y)===(_=(m>=f)<<1|p>=h));return s[_]=o,s[g]=a,i}function sye(i){var e,n,r=i.length,s,o,a=new Array(r),l=new Array(r),c=1/0,u=1/0,d=-1/0,h=-1/0;for(n=0;n<r;++n)isNaN(s=+this._x.call(null,e=i[n]))||isNaN(o=+this._y.call(null,e))||(a[n]=s,l[n]=o,s<c&&(c=s),s>d&&(d=s),o<u&&(u=o),o>h&&(h=o));if(c>d||u>h)return this;for(this.cover(c,u).cover(d,h),n=0;n<r;++n)MG(this,a[n],l[n],i[n]);return this}function oye(i,e){if(isNaN(i=+i)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,s=this._x1,o=this._y1;if(isNaN(n))s=(n=Math.floor(i))+1,o=(r=Math.floor(e))+1;else{for(var a=s-n||1,l=this._root,c,u;n>i||i>=s||r>e||e>=o;)switch(u=(e<r)<<1|i<n,c=new Array(4),c[u]=l,l=c,a*=2,u){case 0:s=n+a,o=r+a;break;case 1:n=s-a,o=r+a;break;case 2:s=n+a,r=o-a;break;case 3:n=s-a,r=o-a;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=s,this._y1=o,this}function aye(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}function lye(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ts(i,e,n,r,s){this.node=i,this.x0=e,this.y0=n,this.x1=r,this.y1=s}function cye(i,e,n){var r,s=this._x0,o=this._y0,a,l,c,u,d=this._x1,h=this._y1,f=[],p=this._root,m,y;for(p&&f.push(new ts(p,s,o,d,h)),n==null?n=1/0:(s=i-n,o=e-n,d=i+n,h=e+n,n*=n);m=f.pop();)if(!(!(p=m.node)||(a=m.x0)>d||(l=m.y0)>h||(c=m.x1)<s||(u=m.y1)<o))if(p.length){var v=(a+c)/2,g=(l+u)/2;f.push(new ts(p[3],v,g,c,u),new ts(p[2],a,g,v,u),new ts(p[1],v,l,c,g),new ts(p[0],a,l,v,g)),(y=(e>=g)<<1|i>=v)&&(m=f[f.length-1],f[f.length-1]=f[f.length-1-y],f[f.length-1-y]=m)}else{var _=i-+this._x.call(null,p.data),x=e-+this._y.call(null,p.data),b=_*_+x*x;if(b<n){var S=Math.sqrt(n=b);s=i-S,o=e-S,d=i+S,h=e+S,r=p.data}}return r}function uye(i){if(isNaN(d=+this._x.call(null,i))||isNaN(h=+this._y.call(null,i)))return this;var e,n=this._root,r,s,o,a=this._x0,l=this._y0,c=this._x1,u=this._y1,d,h,f,p,m,y,v,g;if(!n)return this;if(n.length)for(;;){if((m=d>=(f=(a+c)/2))?a=f:c=f,(y=h>=(p=(l+u)/2))?l=p:u=p,e=n,!(n=n[v=y<<1|m]))return this;if(!n.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(r=e,g=v)}for(;n.data!==i;)if(s=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,s?(o?s.next=o:delete s.next,this):e?(o?e[v]=o:delete e[v],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[g]=n:this._root=n),this):(this._root=o,this)}function dye(i){for(var e=0,n=i.length;e<n;++e)this.remove(i[e]);return this}function hye(){return this._root}function fye(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}function pye(i){var e=[],n,r=this._root,s,o,a,l,c;for(r&&e.push(new ts(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!i(r=n.node,o=n.x0,a=n.y0,l=n.x1,c=n.y1)&&r.length){var u=(o+l)/2,d=(a+c)/2;(s=r[3])&&e.push(new ts(s,u,d,l,c)),(s=r[2])&&e.push(new ts(s,o,d,u,c)),(s=r[1])&&e.push(new ts(s,u,a,l,d)),(s=r[0])&&e.push(new ts(s,o,a,u,d))}return this}function mye(i){var e=[],n=[],r;for(this._root&&e.push(new ts(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var s=r.node;if(s.length){var o,a=r.x0,l=r.y0,c=r.x1,u=r.y1,d=(a+c)/2,h=(l+u)/2;(o=s[0])&&e.push(new ts(o,a,l,d,h)),(o=s[1])&&e.push(new ts(o,d,l,c,h)),(o=s[2])&&e.push(new ts(o,a,h,d,u)),(o=s[3])&&e.push(new ts(o,d,h,c,u))}n.push(r)}for(;r=n.pop();)i(r.node,r.x0,r.y0,r.x1,r.y1);return this}function gye(i){return i[0]}function yye(i){return arguments.length?(this._x=i,this):this._x}function vye(i){return i[1]}function xye(i){return arguments.length?(this._y=i,this):this._y}function AG(i,e,n){var r=new p2(e??gye,n??vye,NaN,NaN,NaN,NaN);return i==null?r:r.addAll(i)}function p2(i,e,n,r,s,o){this._x=i,this._y=e,this._x0=n,this._y0=r,this._x1=s,this._y1=o,this._root=void 0}function MF(i){for(var e={data:i.data},n=e;i=i.next;)n=n.next={data:i.data};return e}var us=AG.prototype=p2.prototype;us.copy=function(){var i=new p2(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return i;if(!e.length)return i._root=MF(e),i;for(n=[{source:e,target:i._root=new Array(4)}];e=n.pop();)for(var s=0;s<4;++s)(r=e.source[s])&&(r.length?n.push({source:r,target:e.target[s]=new Array(4)}):e.target[s]=MF(r));return i};us.add=rye;us.addAll=sye;us.cover=oye;us.data=aye;us.extent=lye;us.find=cye;us.remove=uye;us.removeAll=dye;us.root=hye;us.size=fye;us.visit=pye;us.visitAfter=mye;us.x=yye;us.y=xye;function _ye(i){const e=+this._x.call(null,i),n=+this._y.call(null,i),r=+this._z.call(null,i);return CG(this.cover(e,n,r),e,n,r,i)}function CG(i,e,n,r,s){if(isNaN(e)||isNaN(n)||isNaN(r))return i;var o,a=i._root,l={data:s},c=i._x0,u=i._y0,d=i._z0,h=i._x1,f=i._y1,p=i._z1,m,y,v,g,_,x,b,S,T,w,E;if(!a)return i._root=l,i;for(;a.length;)if((b=e>=(m=(c+h)/2))?c=m:h=m,(S=n>=(y=(u+f)/2))?u=y:f=y,(T=r>=(v=(d+p)/2))?d=v:p=v,o=a,!(a=a[w=T<<2|S<<1|b]))return o[w]=l,i;if(g=+i._x.call(null,a.data),_=+i._y.call(null,a.data),x=+i._z.call(null,a.data),e===g&&n===_&&r===x)return l.next=a,o?o[w]=l:i._root=l,i;do o=o?o[w]=new Array(8):i._root=new Array(8),(b=e>=(m=(c+h)/2))?c=m:h=m,(S=n>=(y=(u+f)/2))?u=y:f=y,(T=r>=(v=(d+p)/2))?d=v:p=v;while((w=T<<2|S<<1|b)===(E=(x>=v)<<2|(_>=y)<<1|g>=m));return o[E]=a,o[w]=l,i}function bye(i){Array.isArray(i)||(i=Array.from(i));const e=i.length,n=new Float64Array(e),r=new Float64Array(e),s=new Float64Array(e);let o=1/0,a=1/0,l=1/0,c=-1/0,u=-1/0,d=-1/0;for(let h=0,f,p,m,y;h<e;++h)isNaN(p=+this._x.call(null,f=i[h]))||isNaN(m=+this._y.call(null,f))||isNaN(y=+this._z.call(null,f))||(n[h]=p,r[h]=m,s[h]=y,p<o&&(o=p),p>c&&(c=p),m<a&&(a=m),m>u&&(u=m),y<l&&(l=y),y>d&&(d=y));if(o>c||a>u||l>d)return this;this.cover(o,a,l).cover(c,u,d);for(let h=0;h<e;++h)CG(this,n[h],r[h],s[h],i[h]);return this}function Sye(i,e,n){if(isNaN(i=+i)||isNaN(e=+e)||isNaN(n=+n))return this;var r=this._x0,s=this._y0,o=this._z0,a=this._x1,l=this._y1,c=this._z1;if(isNaN(r))a=(r=Math.floor(i))+1,l=(s=Math.floor(e))+1,c=(o=Math.floor(n))+1;else{for(var u=a-r||1,d=this._root,h,f;r>i||i>=a||s>e||e>=l||o>n||n>=c;)switch(f=(n<o)<<2|(e<s)<<1|i<r,h=new Array(8),h[f]=d,d=h,u*=2,f){case 0:a=r+u,l=s+u,c=o+u;break;case 1:r=a-u,l=s+u,c=o+u;break;case 2:a=r+u,s=l-u,c=o+u;break;case 3:r=a-u,s=l-u,c=o+u;break;case 4:a=r+u,l=s+u,o=c-u;break;case 5:r=a-u,l=s+u,o=c-u;break;case 6:a=r+u,s=l-u,o=c-u;break;case 7:r=a-u,s=l-u,o=c-u;break}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=s,this._z0=o,this._x1=a,this._y1=l,this._z1=c,this}function wye(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}function Tye(i){return arguments.length?this.cover(+i[0][0],+i[0][1],+i[0][2]).cover(+i[1][0],+i[1][1],+i[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Ln(i,e,n,r,s,o,a){this.node=i,this.x0=e,this.y0=n,this.z0=r,this.x1=s,this.y1=o,this.z1=a}function Eye(i,e,n,r){var s,o=this._x0,a=this._y0,l=this._z0,c,u,d,h,f,p,m=this._x1,y=this._y1,v=this._z1,g=[],_=this._root,x,b;for(_&&g.push(new Ln(_,o,a,l,m,y,v)),r==null?r=1/0:(o=i-r,a=e-r,l=n-r,m=i+r,y=e+r,v=n+r,r*=r);x=g.pop();)if(!(!(_=x.node)||(c=x.x0)>m||(u=x.y0)>y||(d=x.z0)>v||(h=x.x1)<o||(f=x.y1)<a||(p=x.z1)<l))if(_.length){var S=(c+h)/2,T=(u+f)/2,w=(d+p)/2;g.push(new Ln(_[7],S,T,w,h,f,p),new Ln(_[6],c,T,w,S,f,p),new Ln(_[5],S,u,w,h,T,p),new Ln(_[4],c,u,w,S,T,p),new Ln(_[3],S,T,d,h,f,w),new Ln(_[2],c,T,d,S,f,w),new Ln(_[1],S,u,d,h,T,w),new Ln(_[0],c,u,d,S,T,w)),(b=(n>=w)<<2|(e>=T)<<1|i>=S)&&(x=g[g.length-1],g[g.length-1]=g[g.length-1-b],g[g.length-1-b]=x)}else{var E=i-+this._x.call(null,_.data),A=e-+this._y.call(null,_.data),M=n-+this._z.call(null,_.data),R=E*E+A*A+M*M;if(R<r){var F=Math.sqrt(r=R);o=i-F,a=e-F,l=n-F,m=i+F,y=e+F,v=n+F,s=_.data}}return s}const Mye=(i,e,n,r,s,o)=>Math.sqrt((i-r)**2+(e-s)**2+(n-o)**2);function Aye(i,e,n,r){const s=[],o=i-r,a=e-r,l=n-r,c=i+r,u=e+r,d=n+r;return this.visit((h,f,p,m,y,v,g)=>{if(!h.length)do{const _=h.data;Mye(i,e,n,this._x(_),this._y(_),this._z(_))<=r&&s.push(_)}while(h=h.next);return f>c||p>u||m>d||y<o||v<a||g<l}),s}function Cye(i){if(isNaN(f=+this._x.call(null,i))||isNaN(p=+this._y.call(null,i))||isNaN(m=+this._z.call(null,i)))return this;var e,n=this._root,r,s,o,a=this._x0,l=this._y0,c=this._z0,u=this._x1,d=this._y1,h=this._z1,f,p,m,y,v,g,_,x,b,S,T;if(!n)return this;if(n.length)for(;;){if((_=f>=(y=(a+u)/2))?a=y:u=y,(x=p>=(v=(l+d)/2))?l=v:d=v,(b=m>=(g=(c+h)/2))?c=g:h=g,e=n,!(n=n[S=b<<2|x<<1|_]))return this;if(!n.length)break;(e[S+1&7]||e[S+2&7]||e[S+3&7]||e[S+4&7]||e[S+5&7]||e[S+6&7]||e[S+7&7])&&(r=e,T=S)}for(;n.data!==i;)if(s=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,s?(o?s.next=o:delete s.next,this):e?(o?e[S]=o:delete e[S],(n=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&n===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[T]=n:this._root=n),this):(this._root=o,this)}function Rye(i){for(var e=0,n=i.length;e<n;++e)this.remove(i[e]);return this}function Pye(){return this._root}function Nye(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}function kye(i){var e=[],n,r=this._root,s,o,a,l,c,u,d;for(r&&e.push(new Ln(r,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();)if(!i(r=n.node,o=n.x0,a=n.y0,l=n.z0,c=n.x1,u=n.y1,d=n.z1)&&r.length){var h=(o+c)/2,f=(a+u)/2,p=(l+d)/2;(s=r[7])&&e.push(new Ln(s,h,f,p,c,u,d)),(s=r[6])&&e.push(new Ln(s,o,f,p,h,u,d)),(s=r[5])&&e.push(new Ln(s,h,a,p,c,f,d)),(s=r[4])&&e.push(new Ln(s,o,a,p,h,f,d)),(s=r[3])&&e.push(new Ln(s,h,f,l,c,u,p)),(s=r[2])&&e.push(new Ln(s,o,f,l,h,u,p)),(s=r[1])&&e.push(new Ln(s,h,a,l,c,f,p)),(s=r[0])&&e.push(new Ln(s,o,a,l,h,f,p))}return this}function Lye(i){var e=[],n=[],r;for(this._root&&e.push(new Ln(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=e.pop();){var s=r.node;if(s.length){var o,a=r.x0,l=r.y0,c=r.z0,u=r.x1,d=r.y1,h=r.z1,f=(a+u)/2,p=(l+d)/2,m=(c+h)/2;(o=s[0])&&e.push(new Ln(o,a,l,c,f,p,m)),(o=s[1])&&e.push(new Ln(o,f,l,c,u,p,m)),(o=s[2])&&e.push(new Ln(o,a,p,c,f,d,m)),(o=s[3])&&e.push(new Ln(o,f,p,c,u,d,m)),(o=s[4])&&e.push(new Ln(o,a,l,m,f,p,h)),(o=s[5])&&e.push(new Ln(o,f,l,m,u,p,h)),(o=s[6])&&e.push(new Ln(o,a,p,m,f,d,h)),(o=s[7])&&e.push(new Ln(o,f,p,m,u,d,h))}n.push(r)}for(;r=n.pop();)i(r.node,r.x0,r.y0,r.z0,r.x1,r.y1,r.z1);return this}function Iye(i){return i[0]}function Dye(i){return arguments.length?(this._x=i,this):this._x}function Oye(i){return i[1]}function Fye(i){return arguments.length?(this._y=i,this):this._y}function Bye(i){return i[2]}function Uye(i){return arguments.length?(this._z=i,this):this._z}function RG(i,e,n,r){var s=new m2(e??Iye,n??Oye,r??Bye,NaN,NaN,NaN,NaN,NaN,NaN);return i==null?s:s.addAll(i)}function m2(i,e,n,r,s,o,a,l,c){this._x=i,this._y=e,this._z=n,this._x0=r,this._y0=s,this._z0=o,this._x1=a,this._y1=l,this._z1=c,this._root=void 0}function AF(i){for(var e={data:i.data},n=e;i=i.next;)n=n.next={data:i.data};return e}var Er=RG.prototype=m2.prototype;Er.copy=function(){var i=new m2(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,n,r;if(!e)return i;if(!e.length)return i._root=AF(e),i;for(n=[{source:e,target:i._root=new Array(8)}];e=n.pop();)for(var s=0;s<8;++s)(r=e.source[s])&&(r.length?n.push({source:r,target:e.target[s]=new Array(8)}):e.target[s]=AF(r));return i};Er.add=_ye;Er.addAll=bye;Er.cover=Sye;Er.data=wye;Er.extent=Tye;Er.find=Eye;Er.findAllWithinRadius=Aye;Er.remove=Cye;Er.removeAll=Rye;Er.root=Pye;Er.size=Nye;Er.visit=kye;Er.visitAfter=Lye;Er.x=Dye;Er.y=Fye;Er.z=Uye;function Fl(i){return function(){return i}}function El(i){return(i()-.5)*1e-6}function zye(i){return i.index}function CF(i,e){var n=i.get(e);if(!n)throw new Error("node not found: "+e);return n}function PG(i){var e=zye,n=f,r,s=Fl(30),o,a,l,c,u,d,h=1;i==null&&(i=[]);function f(g){return 1/Math.min(c[g.source.index],c[g.target.index])}function p(g){for(var _=0,x=i.length;_<h;++_)for(var b=0,S,T,w,E=0,A=0,M=0,R,F;b<x;++b)S=i[b],T=S.source,w=S.target,E=w.x+w.vx-T.x-T.vx||El(d),l>1&&(A=w.y+w.vy-T.y-T.vy||El(d)),l>2&&(M=w.z+w.vz-T.z-T.vz||El(d)),R=Math.sqrt(E*E+A*A+M*M),R=(R-o[b])/R*g*r[b],E*=R,A*=R,M*=R,w.vx-=E*(F=u[b]),l>1&&(w.vy-=A*F),l>2&&(w.vz-=M*F),T.vx+=E*(F=1-F),l>1&&(T.vy+=A*F),l>2&&(T.vz+=M*F)}function m(){if(a){var g,_=a.length,x=i.length,b=new Map(a.map((T,w)=>[e(T,w,a),T])),S;for(g=0,c=new Array(_);g<x;++g)S=i[g],S.index=g,typeof S.source!="object"&&(S.source=CF(b,S.source)),typeof S.target!="object"&&(S.target=CF(b,S.target)),c[S.source.index]=(c[S.source.index]||0)+1,c[S.target.index]=(c[S.target.index]||0)+1;for(g=0,u=new Array(x);g<x;++g)S=i[g],u[g]=c[S.source.index]/(c[S.source.index]+c[S.target.index]);r=new Array(x),y(),o=new Array(x),v()}}function y(){if(a)for(var g=0,_=i.length;g<_;++g)r[g]=+n(i[g],g,i)}function v(){if(a)for(var g=0,_=i.length;g<_;++g)o[g]=+s(i[g],g,i)}return p.initialize=function(g,..._){a=g,d=_.find(x=>typeof x=="function")||Math.random,l=_.find(x=>[1,2,3].includes(x))||2,m()},p.links=function(g){return arguments.length?(i=g,m(),p):i},p.id=function(g){return arguments.length?(e=g,p):e},p.iterations=function(g){return arguments.length?(h=+g,p):h},p.strength=function(g){return arguments.length?(n=typeof g=="function"?g:Fl(+g),y(),p):n},p.distance=function(g){return arguments.length?(s=typeof g=="function"?g:Fl(+g),v(),p):s},p}var Vye={value:()=>{}};function q0(){for(var i=0,e=arguments.length,n={},r;i<e;++i){if(!(r=arguments[i]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new G_(n)}function G_(i){this._=i}function $ye(i,e){return i.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}G_.prototype=q0.prototype={constructor:G_,on:function(i,e){var n=this._,r=$ye(i+"",n),s,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((s=(i=r[o]).type)&&(s=Gye(n[s],i.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(s=(i=r[o]).type)n[s]=RF(n[s],i.name,e);else if(e==null)for(s in n)n[s]=RF(n[s],i.name,null);return this},copy:function(){var i={},e=this._;for(var n in e)i[n]=e[n].slice();return new G_(i)},call:function(i,e){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,o;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(o=this._[i],r=0,s=o.length;r<s;++r)o[r].value.apply(e,n)},apply:function(i,e,n){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var r=this._[i],s=0,o=r.length;s<o;++s)r[s].value.apply(e,n)}};function Gye(i,e){for(var n=0,r=i.length,s;n<r;++n)if((s=i[n]).name===e)return s.value}function RF(i,e,n){for(var r=0,s=i.length;r<s;++r)if(i[r].name===e){i[r]=Vye,i=i.slice(0,r).concat(i.slice(r+1));break}return n!=null&&i.push({name:e,value:n}),i}var Rp=0,bg=0,Wm=0,NG=1e3,i1,Sg,r1=0,Hd=0,aw=0,r0=typeof performance=="object"&&performance.now?performance:Date,kG=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function g2(){return Hd||(kG(Hye),Hd=r0.now()+aw)}function Hye(){Hd=0}function s1(){this._call=this._time=this._next=null}s1.prototype=y2.prototype={constructor:s1,restart:function(i,e,n){if(typeof i!="function")throw new TypeError("callback is not a function");n=(n==null?g2():+n)+(e==null?0:+e),!this._next&&Sg!==this&&(Sg?Sg._next=this:i1=this,Sg=this),this._call=i,this._time=n,$C()},stop:function(){this._call&&(this._call=null,this._time=1/0,$C())}};function y2(i,e,n){var r=new s1;return r.restart(i,e,n),r}function Wye(){g2(),++Rp;for(var i=i1,e;i;)(e=Hd-i._time)>=0&&i._call.call(void 0,e),i=i._next;--Rp}function PF(){Hd=(r1=r0.now())+aw,Rp=bg=0;try{Wye()}finally{Rp=0,qye(),Hd=0}}function jye(){var i=r0.now(),e=i-r1;e>NG&&(aw-=e,r1=i)}function qye(){for(var i,e=i1,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),i=e,e=e._next):(n=e._next,e._next=null,e=i?i._next=n:i1=n);Sg=i,$C(r)}function $C(i){if(!Rp){bg&&(bg=clearTimeout(bg));var e=i-Hd;e>24?(i<1/0&&(bg=setTimeout(PF,i-r0.now()-aw)),Wm&&(Wm=clearInterval(Wm))):(Wm||(r1=r0.now(),Wm=setInterval(jye,NG)),Rp=1,kG(PF))}}function NF(i,e,n){var r=new s1;return e=e==null?0:+e,r.restart(s=>{r.stop(),i(s+e)},e,n),r}const Xye=1664525,Kye=1013904223,kF=4294967296;function Yye(){let i=1;return()=>(i=(Xye*i+Kye)%kF)/kF}var LF=3;function WE(i){return i.x}function IF(i){return i.y}function Zye(i){return i.z}var Qye=10,Jye=Math.PI*(3-Math.sqrt(5)),e0e=Math.PI*20/(9+Math.sqrt(221));function LG(i,e){e=e||2;var n=Math.min(LF,Math.max(1,Math.round(e))),r,s=1,o=.001,a=1-Math.pow(o,1/300),l=0,c=.6,u=new Map,d=y2(p),h=q0("tick","end"),f=Yye();i==null&&(i=[]);function p(){m(),h.call("tick",r),s<o&&(d.stop(),h.call("end",r))}function m(g){var _,x=i.length,b;g===void 0&&(g=1);for(var S=0;S<g;++S)for(s+=(l-s)*a,u.forEach(function(T){T(s)}),_=0;_<x;++_)b=i[_],b.fx==null?b.x+=b.vx*=c:(b.x=b.fx,b.vx=0),n>1&&(b.fy==null?b.y+=b.vy*=c:(b.y=b.fy,b.vy=0)),n>2&&(b.fz==null?b.z+=b.vz*=c:(b.z=b.fz,b.vz=0));return r}function y(){for(var g=0,_=i.length,x;g<_;++g){if(x=i[g],x.index=g,x.fx!=null&&(x.x=x.fx),x.fy!=null&&(x.y=x.fy),x.fz!=null&&(x.z=x.fz),isNaN(x.x)||n>1&&isNaN(x.y)||n>2&&isNaN(x.z)){var b=Qye*(n>2?Math.cbrt(.5+g):n>1?Math.sqrt(.5+g):g),S=g*Jye,T=g*e0e;n===1?x.x=b:n===2?(x.x=b*Math.cos(S),x.y=b*Math.sin(S)):(x.x=b*Math.sin(S)*Math.cos(T),x.y=b*Math.cos(S),x.z=b*Math.sin(S)*Math.sin(T))}(isNaN(x.vx)||n>1&&isNaN(x.vy)||n>2&&isNaN(x.vz))&&(x.vx=0,n>1&&(x.vy=0),n>2&&(x.vz=0))}}function v(g){return g.initialize&&g.initialize(i,f,n),g}return y(),r={tick:m,restart:function(){return d.restart(p),r},stop:function(){return d.stop(),r},numDimensions:function(g){return arguments.length?(n=Math.min(LF,Math.max(1,Math.round(g))),u.forEach(v),r):n},nodes:function(g){return arguments.length?(i=g,y(),u.forEach(v),r):i},alpha:function(g){return arguments.length?(s=+g,r):s},alphaMin:function(g){return arguments.length?(o=+g,r):o},alphaDecay:function(g){return arguments.length?(a=+g,r):+a},alphaTarget:function(g){return arguments.length?(l=+g,r):l},velocityDecay:function(g){return arguments.length?(c=1-g,r):1-c},randomSource:function(g){return arguments.length?(f=g,u.forEach(v),r):f},force:function(g,_){return arguments.length>1?(_==null?u.delete(g):u.set(g,v(_)),r):u.get(g)},find:function(){var g=Array.prototype.slice.call(arguments),_=g.shift()||0,x=(n>1?g.shift():null)||0,b=(n>2?g.shift():null)||0,S=g.shift()||1/0,T=0,w=i.length,E,A,M,R,F,B;for(S*=S,T=0;T<w;++T)F=i[T],E=_-F.x,A=x-(F.y||0),M=b-(F.z||0),R=E*E+A*A+M*M,R<S&&(B=F,S=R);return B},on:function(g,_){return arguments.length>1?(h.on(g,_),r):h.on(g)}}}function IG(){var i,e,n,r,s,o=Fl(-30),a,l=1,c=1/0,u=.81;function d(m){var y,v=i.length,g=(e===1?EG(i,WE):e===2?AG(i,WE,IF):e===3?RG(i,WE,IF,Zye):null).visitAfter(f);for(s=m,y=0;y<v;++y)n=i[y],g.visit(p)}function h(){if(i){var m,y=i.length,v;for(a=new Array(y),m=0;m<y;++m)v=i[m],a[v.index]=+o(v,m,i)}}function f(m){var y=0,v,g,_=0,x,b,S,T,w=m.length;if(w){for(x=b=S=T=0;T<w;++T)(v=m[T])&&(g=Math.abs(v.value))&&(y+=v.value,_+=g,x+=g*(v.x||0),b+=g*(v.y||0),S+=g*(v.z||0));y*=Math.sqrt(4/w),m.x=x/_,e>1&&(m.y=b/_),e>2&&(m.z=S/_)}else{v=m,v.x=v.data.x,e>1&&(v.y=v.data.y),e>2&&(v.z=v.data.z);do y+=a[v.data.index];while(v=v.next)}m.value=y}function p(m,y,v,g,_){if(!m.value)return!0;var x=[v,g,_][e-1],b=m.x-n.x,S=e>1?m.y-n.y:0,T=e>2?m.z-n.z:0,w=x-y,E=b*b+S*S+T*T;if(w*w/u<E)return E<c&&(b===0&&(b=El(r),E+=b*b),e>1&&S===0&&(S=El(r),E+=S*S),e>2&&T===0&&(T=El(r),E+=T*T),E<l&&(E=Math.sqrt(l*E)),n.vx+=b*m.value*s/E,e>1&&(n.vy+=S*m.value*s/E),e>2&&(n.vz+=T*m.value*s/E)),!0;if(m.length||E>=c)return;(m.data!==n||m.next)&&(b===0&&(b=El(r),E+=b*b),e>1&&S===0&&(S=El(r),E+=S*S),e>2&&T===0&&(T=El(r),E+=T*T),E<l&&(E=Math.sqrt(l*E)));do m.data!==n&&(w=a[m.data.index]*s/E,n.vx+=b*w,e>1&&(n.vy+=S*w),e>2&&(n.vz+=T*w));while(m=m.next)}return d.initialize=function(m,...y){i=m,r=y.find(v=>typeof v=="function")||Math.random,e=y.find(v=>[1,2,3].includes(v))||2,h()},d.strength=function(m){return arguments.length?(o=typeof m=="function"?m:Fl(+m),h(),d):o},d.distanceMin=function(m){return arguments.length?(l=m*m,d):Math.sqrt(l)},d.distanceMax=function(m){return arguments.length?(c=m*m,d):Math.sqrt(c)},d.theta=function(m){return arguments.length?(u=m*m,d):Math.sqrt(u)},d}function DG(i,e,n,r){var s,o,a=Fl(.1),l,c;typeof i!="function"&&(i=Fl(+i)),e==null&&(e=0),n==null&&(n=0),r==null&&(r=0);function u(h){for(var f=0,p=s.length;f<p;++f){var m=s[f],y=m.x-e||1e-6,v=(m.y||0)-n||1e-6,g=(m.z||0)-r||1e-6,_=Math.sqrt(y*y+v*v+g*g),x=(c[f]-_)*l[f]*h/_;m.vx+=y*x,o>1&&(m.vy+=v*x),o>2&&(m.vz+=g*x)}}function d(){if(s){var h,f=s.length;for(l=new Array(f),c=new Array(f),h=0;h<f;++h)c[h]=+i(s[h],h,s),l[h]=isNaN(c[h])?0:+a(s[h],h,s)}}return u.initialize=function(h,...f){s=h,o=f.find(p=>[1,2,3].includes(p))||2,d()},u.strength=function(h){return arguments.length?(a=typeof h=="function"?h:Fl(+h),d(),u):a},u.radius=function(h){return arguments.length?(i=typeof h=="function"?h:Fl(+h),d(),u):i},u.x=function(h){return arguments.length?(e=+h,u):e},u.y=function(h){return arguments.length?(n=+h,u):n},u.z=function(h){return arguments.length?(r=+h,u):r},u}var v2=function(e){n0e(e);var n=t0e(e);return e.on=n.on,e.off=n.off,e.fire=n.fire,e};function t0e(i){var e=Object.create(null);return{on:function(n,r,s){if(typeof r!="function")throw new Error("callback is expected to be a function");var o=e[n];return o||(o=e[n]=[]),o.push({callback:r,ctx:s}),i},off:function(n,r){var s=typeof n>"u";if(s)return e=Object.create(null),i;if(e[n]){var o=typeof r!="function";if(o)delete e[n];else for(var a=e[n],l=0;l<a.length;++l)a[l].callback===r&&a.splice(l,1)}return i},fire:function(n){var r=e[n];if(!r)return i;var s;arguments.length>1&&(s=Array.prototype.splice.call(arguments,1));for(var o=0;o<r.length;++o){var a=r[o];a.callback.apply(a.ctx,s)}return i}}}function n0e(i){if(!i)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],n=0;n<e.length;++n)if(i.hasOwnProperty(e[n]))throw new Error("Subject cannot be eventified, since it already has property '"+e[n]+"'")}var i0e=s0e,r0e=v2;function s0e(i){if(i=i||{},"uniqueLinkId"in i&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),i.multigraph=i.uniqueLinkId),i.multigraph===void 0&&(i.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var e=new Map,n=new Map,r={},s=0,o=i.multigraph?b:x,a=[],l=P,c=P,u=P,d=P,h={version:20,addNode:y,addLink:_,removeLink:E,removeNode:g,getNode:v,getNodeCount:S,getLinkCount:T,getEdgeCount:T,getLinksCount:T,getNodesCount:S,getLinks:w,forEachNode:X,forEachLinkedNode:B,forEachLink:F,beginUpdate:u,endUpdate:d,clear:R,hasLink:M,hasNode:v,getLink:M};return r0e(h),f(),h;function f(){var q=h.on;h.on=J;function J(){return h.beginUpdate=u=W,h.endUpdate=d=D,l=p,c=m,h.on=q,q.apply(h,arguments)}}function p(q,J){a.push({link:q,changeType:J})}function m(q,J){a.push({node:q,changeType:J})}function y(q,J){if(q===void 0)throw new Error("Invalid node identifier");u();var se=v(q);return se?(se.data=J,c(se,"update")):(se=new o0e(q,J),c(se,"add")),e.set(q,se),d(),se}function v(q){return e.get(q)}function g(q){var J=v(q);if(!J)return!1;u();var se=J.links;return se&&(se.forEach(A),J.links=null),e.delete(q),c(J,"remove"),d(),!0}function _(q,J,se){u();var de=v(q)||y(q),G=v(J)||y(J),Q=o(q,J,se),ee=n.has(Q.id);return n.set(Q.id,Q),DF(de,Q),q!==J&&DF(G,Q),l(Q,ee?"update":"add"),d(),Q}function x(q,J,se){var de=kx(q,J),G=n.get(de);return G?(G.data=se,G):new OF(q,J,se,de)}function b(q,J,se){var de=kx(q,J),G=r.hasOwnProperty(de);if(G||M(q,J)){G||(r[de]=0);var Q="@"+ ++r[de];de=kx(q+Q,J+Q)}return new OF(q,J,se,de)}function S(){return e.size}function T(){return n.size}function w(q){var J=v(q);return J?J.links:null}function E(q,J){return J!==void 0&&(q=M(q,J)),A(q)}function A(q){if(!q||!n.get(q.id))return!1;u(),n.delete(q.id);var J=v(q.fromId),se=v(q.toId);return J&&J.links.delete(q),se&&se.links.delete(q),l(q,"remove"),d(),!0}function M(q,J){if(!(q===void 0||J===void 0))return n.get(kx(q,J))}function R(){u(),X(function(q){g(q.id)}),d()}function F(q){if(typeof q=="function")for(var J=n.values(),se=J.next();!se.done;){if(q(se.value))return!0;se=J.next()}}function B(q,J,se){var de=v(q);if(de&&de.links&&typeof J=="function")return se?L(de.links,q,J):C(de.links,q,J)}function C(q,J,se){for(var de,G=q.values(),Q=G.next();!Q.done;){var ee=Q.value,ie=ee.fromId===J?ee.toId:ee.fromId;if(de=se(e.get(ie),ee),de)return!0;Q=G.next()}}function L(q,J,se){for(var de,G=q.values(),Q=G.next();!Q.done;){var ee=Q.value;if(ee.fromId===J&&(de=se(e.get(ee.toId),ee),de))return!0;Q=G.next()}}function P(){}function W(){s+=1}function D(){s-=1,s===0&&a.length>0&&(h.fire("changed",a),a.length=0)}function X(q){if(typeof q!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+q);for(var J=e.values(),se=J.next();!se.done;){if(q(se.value))return!0;se=J.next()}}}function o0e(i,e){this.id=i,this.links=null,this.data=e}function DF(i,e){i.links?i.links.add(e):i.links=new Set([e])}function OF(i,e,n,r){this.fromId=i,this.toId=e,this.data=n,this.id=r}function kx(i,e){return i.toString()+"👉 "+e.toString()}const a0e=_0(i0e);var x2={exports:{}},X0={exports:{}},OG=function(e){return e===0?"x":e===1?"y":e===2?"z":"c"+(e+1)};const l0e=OG;var om=function(e){return n;function n(r,s){let o=s&&s.indent||0,a=s&&s.join!==void 0?s.join:`
`,l=Array(o+1).join(" "),c=[];for(let u=0;u<e;++u){let d=l0e(u),h=u===0?"":l;c.push(h+r.replace(/{var}/g,d))}return c.join(a)}};const FG=om;X0.exports=c0e;X0.exports.generateCreateBodyFunctionBody=BG;X0.exports.getVectorCode=zG;X0.exports.getBodyCode=UG;function c0e(i,e){let n=BG(i,e),{Body:r}=new Function(n)();return r}function BG(i,e){return`
${zG(i,e)}
${UG(i)}
return {Body: Body, Vector: Vector};
`}function UG(i){let e=FG(i),n=e("{var}",{join:", "});return`
function Body(${n}) {
  this.isPinned = false;
  this.pos = new Vector(${n});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${n}) {
  ${e("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function zG(i,e){let n=FG(i),r="";return e&&(r=`${n(`
   var v{var};
Object.defineProperty(this, '{var}', {
  set: function(v) { 
    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
    v{var} = v; 
  },
  get: function() { return v{var}; }
});`)}`),`function Vector(${n("{var}",{join:", "})}) {
  ${r}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${n('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${n("this.{var} = v.{var};",{indent:4})}
    } else {
      ${n('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${n("this.{var} = ",{join:""})}0;
  };`}var u0e=X0.exports,Mu={exports:{}};const _2=om,Lc=OG;Mu.exports=d0e;Mu.exports.generateQuadTreeFunctionBody=VG;Mu.exports.getInsertStackCode=jG;Mu.exports.getQuadNodeCode=WG;Mu.exports.isSamePosition=$G;Mu.exports.getChildBodyCode=HG;Mu.exports.setChildBodyCode=GG;function d0e(i){let e=VG(i);return new Function(e)()}function VG(i){let e=_2(i),n=Math.pow(2,i);return`
${jG()}
${WG(i)}
${$G(i)}
${HG(i)}
${GG(i)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${a("      node.")}
      node.body = null;
      node.mass = ${e("node.mass_{var} = ",{join:""})}0;
      ${e("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${e("var d{var};",{indent:4})}
    var r; 
    ${e("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${e("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${e("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${e("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < θ, treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${Lc(0)} - node.min_${Lc(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${e("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${o()}
        }
      }
    }

    ${e("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${e("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${e("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${e("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${e("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${e("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${e("root.min_{var} = {var}min;",{indent:4})}
    ${e("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${e("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${e("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${e("var min_{var} = node.min_{var};",{indent:8})}
        ${e("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${s(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${e("child.min_{var} = min_{var};",{indent:10})}
          ${e("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${e("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${e("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function s(l){let c=[],u=Array(l+1).join(" ");for(let d=0;d<i;++d)c.push(u+`if (${Lc(d)} > max_${Lc(d)}) {`),c.push(u+`  quadIdx = quadIdx + ${Math.pow(2,d)};`),c.push(u+`  min_${Lc(d)} = max_${Lc(d)};`),c.push(u+`  max_${Lc(d)} = node.max_${Lc(d)};`),c.push(u+"}");return c.join(`
`)}function o(){let l=Array(11).join(" "),c=[];for(let u=0;u<n;++u)c.push(l+`if (node.quad${u}) {`),c.push(l+`  queue[pushIdx] = node.quad${u};`),c.push(l+"  queueLength += 1;"),c.push(l+"  pushIdx += 1;"),c.push(l+"}");return c.join(`
`)}function a(l){let c=[];for(let u=0;u<n;++u)c.push(`${l}quad${u} = null;`);return c.join(`
`)}}function $G(i){let e=_2(i);return`
  function isSamePosition(point1, point2) {
    ${e("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${e("d{var} < 1e-8",{join:" && "})};
  }  
`}function GG(i){var e=Math.pow(2,i);return`
function setChild(node, idx, child) {
  ${n()}
}`;function n(){let r=[];for(let s=0;s<e;++s){let o=s===0?"  ":"  else ";r.push(`${o}if (idx === ${s}) node.quad${s} = child;`)}return r.join(`
`)}}function HG(i){return`function getChild(node, idx) {
${e()}
  return null;
}`;function e(){let n=[],r=Math.pow(2,i);for(let s=0;s<r;++s)n.push(`  if (idx === ${s}) return node.quad${s};`);return n.join(`
`)}}function WG(i){let e=_2(i),n=Math.pow(2,i);var r=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${s("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${e("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${e("this.min_{var} = 0;",{indent:2})}
  ${e("this.max_{var} = 0;",{indent:2})}
}
`;return r;function s(o){let a=[];for(let l=0;l<n;++l)a.push(`${o}quad${l} = null;`);return a.join(`
`)}}function jG(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}var h0e=Mu.exports,b2={exports:{}};b2.exports=p0e;b2.exports.generateFunctionBody=qG;const f0e=om;function p0e(i){let e=qG(i);return new Function("bodies","settings","random",e)}function qG(i){let e=f0e(i);return`
  var boundingBox = {
    ${e("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${e("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${e("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${e("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${e("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${e("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${e("var max_{var} = -Infinity;",{indent:4})}
    ${e("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${e("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${e("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${e("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${e("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${e("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}var m0e=b2.exports,S2={exports:{}};const g0e=om;S2.exports=y0e;S2.exports.generateCreateDragForceFunctionBody=XG;function y0e(i){let e=XG(i);return new Function("options",e)}function XG(i){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${g0e(i)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}var v0e=S2.exports,w2={exports:{}};const x0e=om;w2.exports=_0e;w2.exports.generateCreateSpringForceFunctionBody=KG;function _0e(i){let e=KG(i);return new Function("options","random",e)}function KG(i){let e=x0e(i);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${e("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${e("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${e("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}var b0e=w2.exports,T2={exports:{}};const S0e=om;T2.exports=w0e;T2.exports.generateIntegratorFunctionBody=YG;function w0e(i){let e=YG(i);return new Function("bodies","timeStep","adaptiveTimeStepWeight",e)}function YG(i){let e=S0e(i);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${e("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${e("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${e("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${e("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${e("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${e("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${e("body.pos.{var} += d{var};",{indent:4})}

    ${e("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${e("t{var} * t{var}",{join:" + "})})/length;
`}var T0e=T2.exports,jE,FF;function E0e(){if(FF)return jE;FF=1,jE=i;function i(e,n,r,s){this.from=e,this.to=n,this.length=r,this.coefficient=s}return jE}var qE,BF;function M0e(){if(BF)return qE;BF=1,qE=i;function i(e,n){var r;if(e||(e={}),n){for(r in n)if(n.hasOwnProperty(r)){var s=e.hasOwnProperty(r),o=typeof n[r],a=!s||typeof e[r]!==o;a?e[r]=n[r]:o==="object"&&(e[r]=i(e[r],n[r]))}}return e}return qE}var jm={exports:{}},UF;function A0e(){if(UF)return jm.exports;UF=1,jm.exports=i,jm.exports.random=i,jm.exports.randomIterator=l;function i(c){var u=typeof c=="number"?c:+new Date;return new e(u)}function e(c){this.seed=c}e.prototype.next=a,e.prototype.nextDouble=o,e.prototype.uniform=o,e.prototype.gaussian=n,e.prototype.random=o;function n(){var c,u,d;do u=this.nextDouble()*2-1,d=this.nextDouble()*2-1,c=u*u+d*d;while(c>=1||c===0);return u*Math.sqrt(-2*Math.log(c)/c)}e.prototype.levy=r;function r(){var c=1.5,u=Math.pow(s(1+c)*Math.sin(Math.PI*c/2)/(s((1+c)/2)*c*Math.pow(2,(c-1)/2)),1/c);return this.gaussian()*u/Math.pow(Math.abs(this.gaussian()),1/c)}function s(c){return Math.sqrt(2*Math.PI/c)*Math.pow(1/Math.E*(c+1/(12*c-1/(10*c))),c)}function o(){var c=this.seed;return c=c+2127912214+(c<<12)&4294967295,c=(c^3345072700^c>>>19)&4294967295,c=c+374761393+(c<<5)&4294967295,c=(c+3550635116^c<<9)&4294967295,c=c+4251993797+(c<<3)&4294967295,c=(c^3042594569^c>>>16)&4294967295,this.seed=c,(c&268435455)/268435456}function a(c){return Math.floor(this.nextDouble()*c)}function l(c,u){var d=u||i();if(typeof d.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:f,shuffle:h};function h(){var p,m,y;for(p=c.length-1;p>0;--p)m=d.next(p+1),y=c[m],c[m]=c[p],c[p]=y;return c}function f(p){var m,y,v;for(m=c.length-1;m>0;--m)y=d.next(m+1),v=c[y],c[y]=c[m],c[m]=v,p(v);c.length&&p(c[0])}}return jm.exports}var ZG=I0e,C0e=u0e,R0e=h0e,P0e=m0e,N0e=v0e,k0e=b0e,L0e=T0e,zF={};function I0e(i){var e=E0e(),n=M0e(),r=v2;if(i){if(i.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(i.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}i=n(i,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var s=zF[i.dimensions];if(!s){var o=i.dimensions;s={Body:C0e(o,i.debug),createQuadTree:R0e(o),createBounds:P0e(o),createDragForce:N0e(o),createSpringForce:k0e(o),integrate:L0e(o)},zF[o]=s}var a=s.Body,l=s.createQuadTree,c=s.createBounds,u=s.createDragForce,d=s.createSpringForce,h=s.integrate,f=L=>new a(L),p=A0e().random(42),m=[],y=[],v=l(i,p),g=c(m,i,p),_=d(i,p),x=u(i),b=0,S=[],T=new Map,w=0;M("nbody",B),M("spring",C);var E={bodies:m,quadTree:v,springs:y,settings:i,addForce:M,removeForce:R,getForces:F,step:function(){for(var L=0;L<S.length;++L)S[L](w);var P=h(m,i.timeStep,i.adaptiveTimeStepWeight);return w+=1,P},addBody:function(L){if(!L)throw new Error("Body is required");return m.push(L),L},addBodyAt:function(L){if(!L)throw new Error("Body position is required");var P=f(L);return m.push(P),P},removeBody:function(L){if(L){var P=m.indexOf(L);if(!(P<0))return m.splice(P,1),m.length===0&&g.reset(),!0}},addSpring:function(L,P,W,D){if(!L||!P)throw new Error("Cannot add null spring to force simulator");typeof W!="number"&&(W=-1);var X=new e(L,P,W,D>=0?D:-1);return y.push(X),X},getTotalMovement:function(){return b},removeSpring:function(L){if(L){var P=y.indexOf(L);if(P>-1)return y.splice(P,1),!0}},getBestNewBodyPosition:function(L){return g.getBestNewPosition(L)},getBBox:A,getBoundingBox:A,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(L){return L!==void 0?(i.gravity=L,v.options({gravity:L}),this):i.gravity},theta:function(L){return L!==void 0?(i.theta=L,v.options({theta:L}),this):i.theta},random:p};return D0e(i,E),r(E),E;function A(){return g.update(),g.box}function M(L,P){if(T.has(L))throw new Error("Force "+L+" is already added");T.set(L,P),S.push(P)}function R(L){var P=S.indexOf(T.get(L));P<0||(S.splice(P,1),T.delete(L))}function F(){return T}function B(){if(m.length!==0){v.insertBodies(m);for(var L=m.length;L--;){var P=m[L];P.isPinned||(P.reset(),v.updateBodyForce(P),x.update(P))}}}function C(){for(var L=y.length;L--;)_.update(y[L])}}function D0e(i,e){for(var n in i)O0e(i,e,n)}function O0e(i,e,n){if(i.hasOwnProperty(n)&&typeof e[n]!="function"){var r=Number.isFinite(i[n]);r?e[n]=function(s){if(s!==void 0){if(!Number.isFinite(s))throw new Error("Value of "+n+" should be a valid number.");return i[n]=s,e}return i[n]}:e[n]=function(s){return s!==void 0?(i[n]=s,e):i[n]}}}x2.exports=B0e;x2.exports.simulator=ZG;var F0e=v2;function B0e(i,e){if(!i)throw new Error("Graph structure cannot be undefined");var n=e&&e.createSimulator||ZG,r=n(e);if(Array.isArray(e))throw new Error("Physics settings is expected to be an object");var s=i.version>19?B:F;e&&typeof e.nodeMass=="function"&&(s=e.nodeMass);var o=new Map,a={},l=0,c=r.settings.springTransform||U0e;x(),v();var u=!1,d={step:function(){if(l===0)return h(!0),!0;var C=r.step();d.lastMove=C,d.fire("step");var L=C/l,P=L<=.01;return h(P),P},getNodePosition:function(C){return R(C).pos},setNodePosition:function(C){var L=R(C);L.setPosition.apply(L,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(C){var L=a[C];if(L)return{from:L.from.pos,to:L.to.pos}},getGraphRect:function(){return r.getBBox()},forEachBody:f,pinNode:function(C,L){var P=R(C.id);P.isPinned=!!L},isNodePinned:function(C){return R(C.id).isPinned},dispose:function(){i.off("changed",_),d.fire("disposed")},getBody:y,getSpring:m,getForceVectorLength:p,simulator:r,graph:i,lastMove:0};return F0e(d),d;function h(C){u!==C&&(u=C,g(C))}function f(C){o.forEach(C)}function p(){var C=0,L=0;return f(function(P){C+=Math.abs(P.force.x),L+=Math.abs(P.force.y)}),Math.sqrt(C*C+L*L)}function m(C,L){var P;if(L===void 0)typeof C!="object"?P=C:P=C.id;else{var W=i.hasLink(C,L);if(!W)return;P=W.id}return a[P]}function y(C){return o.get(C)}function v(){i.on("changed",_)}function g(C){d.fire("stable",C)}function _(C){for(var L=0;L<C.length;++L){var P=C[L];P.changeType==="add"?(P.node&&b(P.node.id),P.link&&T(P.link)):P.changeType==="remove"&&(P.node&&S(P.node),P.link&&w(P.link))}l=i.getNodesCount()}function x(){l=0,i.forEachNode(function(C){b(C.id),l+=1}),i.forEachLink(T)}function b(C){var L=o.get(C);if(!L){var P=i.getNode(C);if(!P)throw new Error("initBody() was called with unknown node id");var W=P.position;if(!W){var D=E(P);W=r.getBestNewBodyPosition(D)}L=r.addBodyAt(W),L.id=C,o.set(C,L),A(C),M(P)&&(L.isPinned=!0)}}function S(C){var L=C.id,P=o.get(L);P&&(o.delete(L),r.removeBody(P))}function T(C){A(C.fromId),A(C.toId);var L=o.get(C.fromId),P=o.get(C.toId),W=r.addSpring(L,P,C.length);c(C,W),a[C.id]=W}function w(C){var L=a[C.id];if(L){var P=i.getNode(C.fromId),W=i.getNode(C.toId);P&&A(P.id),W&&A(W.id),delete a[C.id],r.removeSpring(L)}}function E(C){var L=[];if(!C.links)return L;for(var P=Math.min(C.links.length,2),W=0;W<P;++W){var D=C.links[W],X=D.fromId!==C.id?o.get(D.fromId):o.get(D.toId);X&&X.pos&&L.push(X)}return L}function A(C){var L=o.get(C);if(L.mass=s(C),Number.isNaN(L.mass))throw new Error("Node mass should be a number")}function M(C){return C&&(C.isPinned||C.data&&C.data.isPinned)}function R(C){var L=o.get(C);return L||(b(C),L=o.get(C)),L}function F(C){var L=i.getLinks(C);return L?1+L.length/3:1}function B(C){var L=i.getLinks(C);return L?1+L.size/3:1}}function U0e(){}var z0e=x2.exports;const V0e=_0(z0e);function o1(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}var $0e=typeof global=="object"&&global&&global.Object===Object&&global;const G0e=$0e;var H0e=typeof self=="object"&&self&&self.Object===Object&&self,W0e=G0e||H0e||Function("return this")();const QG=W0e;var j0e=function(){return QG.Date.now()};const XE=j0e;var q0e=/\s/;function X0e(i){for(var e=i.length;e--&&q0e.test(i.charAt(e)););return e}var K0e=/^\s+/;function Y0e(i){return i&&i.slice(0,X0e(i)+1).replace(K0e,"")}var Z0e=QG.Symbol;const a1=Z0e;var JG=Object.prototype,Q0e=JG.hasOwnProperty,J0e=JG.toString,qm=a1?a1.toStringTag:void 0;function eve(i){var e=Q0e.call(i,qm),n=i[qm];try{i[qm]=void 0;var r=!0}catch{}var s=J0e.call(i);return r&&(e?i[qm]=n:delete i[qm]),s}var tve=Object.prototype,nve=tve.toString;function ive(i){return nve.call(i)}var rve="[object Null]",sve="[object Undefined]",VF=a1?a1.toStringTag:void 0;function ove(i){return i==null?i===void 0?sve:rve:VF&&VF in Object(i)?eve(i):ive(i)}function ave(i){return i!=null&&typeof i=="object"}var lve="[object Symbol]";function cve(i){return typeof i=="symbol"||ave(i)&&ove(i)==lve}var $F=0/0,uve=/^[-+]0x[0-9a-f]+$/i,dve=/^0b[01]+$/i,hve=/^0o[0-7]+$/i,fve=parseInt;function GF(i){if(typeof i=="number")return i;if(cve(i))return $F;if(o1(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=o1(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=Y0e(i);var n=dve.test(i);return n||hve.test(i)?fve(i.slice(2),n?2:8):uve.test(i)?$F:+i}var pve="Expected a function",mve=Math.max,gve=Math.min;function eH(i,e,n){var r,s,o,a,l,c,u=0,d=!1,h=!1,f=!0;if(typeof i!="function")throw new TypeError(pve);e=GF(e)||0,o1(n)&&(d=!!n.leading,h="maxWait"in n,o=h?mve(GF(n.maxWait)||0,e):o,f="trailing"in n?!!n.trailing:f);function p(T){var w=r,E=s;return r=s=void 0,u=T,a=i.apply(E,w),a}function m(T){return u=T,l=setTimeout(g,e),d?p(T):a}function y(T){var w=T-c,E=T-u,A=e-w;return h?gve(A,o-E):A}function v(T){var w=T-c,E=T-u;return c===void 0||w>=e||w<0||h&&E>=o}function g(){var T=XE();if(v(T))return _(T);l=setTimeout(g,y(T))}function _(T){return l=void 0,f&&r?p(T):(r=s=void 0,a)}function x(){l!==void 0&&clearTimeout(l),u=0,r=c=s=l=void 0}function b(){return l===void 0?a:_(XE())}function S(){var T=XE(),w=v(T);if(r=arguments,s=this,c=T,w){if(l===void 0)return m(c);if(h)return clearTimeout(l),l=setTimeout(g,e),p(c)}return l===void 0&&(l=setTimeout(g,e)),a}return S.cancel=x,S.flush=b,S}function HF(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function yve(i){if(Array.isArray(i))return i}function vve(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function xve(i,e,n){return Object.defineProperty(i,"prototype",{writable:!1}),i}function _ve(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function bve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sve(i,e){return yve(i)||_ve(i,e)||wve(i,e)||bve()}function wve(i,e){if(i){if(typeof i=="string")return HF(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?HF(i,e):void 0}}var Tve=xve(function i(e,n){var r=n.default,s=r===void 0?null:r,o=n.triggerUpdate,a=o===void 0?!0:o,l=n.onChange,c=l===void 0?function(u,d){}:l;vve(this,i),this.name=e,this.defaultVal=s,this.triggerUpdate=a,this.onChange=c});function Au(i){var e=i.stateInit,n=e===void 0?function(){return{}}:e,r=i.props,s=r===void 0?{}:r,o=i.methods,a=o===void 0?{}:o,l=i.aliases,c=l===void 0?{}:l,u=i.init,d=u===void 0?function(){}:u,h=i.update,f=h===void 0?function(){}:h,p=Object.keys(s).map(function(m){return new Tve(m,s[m])});return function m(){for(var y=arguments.length,v=new Array(y),g=0;g<y;g++)v[g]=arguments[g];var _=!!(this instanceof m&&this.constructor),x=_?v.shift():void 0,b=v[0],S=b===void 0?{}:b,T=Object.assign({},n instanceof Function?n(S):n,{initialised:!1}),w={};function E(R){return A(R,S),M(),E}var A=function(F,B){d.call(E,F,T,B),T.initialised=!0},M=eH(function(){T.initialised&&(f.call(E,T,w),w={})},1);return p.forEach(function(R){E[R.name]=F(R);function F(B){var C=B.name,L=B.triggerUpdate,P=L===void 0?!1:L,W=B.onChange,D=W===void 0?function(J,se){}:W,X=B.defaultVal,q=X===void 0?null:X;return function(J){var se=T[C];if(!arguments.length)return se;var de=J===void 0?q:J;return T[C]=de,D.call(E,de,T,se),!w.hasOwnProperty(C)&&(w[C]=se),P&&M(),E}}}),Object.keys(a).forEach(function(R){E[R]=function(){for(var F,B=arguments.length,C=new Array(B),L=0;L<B;L++)C[L]=arguments[L];return(F=a[R]).call.apply(F,[E,T].concat(C))}}),Object.entries(c).forEach(function(R){var F=Sve(R,2),B=F[0],C=F[1];return E[B]=E[C]}),E.resetProps=function(){return p.forEach(function(R){E[R.name](R.defaultVal)}),E},E.resetProps(),T._rerender=M,_&&x&&E(x),E}}var yt=function(i){return typeof i=="function"?i:typeof i=="string"?function(e){return e[i]}:function(e){return i}};class WF extends Map{constructor(e,n=Ave){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,s]of e)this.set(r,s)}get(e){return super.get(jF(this,e))}has(e){return super.has(jF(this,e))}set(e,n){return super.set(Eve(this,e),n)}delete(e){return super.delete(Mve(this,e))}}function jF({_intern:i,_key:e},n){const r=e(n);return i.has(r)?i.get(r):n}function Eve({_intern:i,_key:e},n){const r=e(n);return i.has(r)?i.get(r):(i.set(r,n),n)}function Mve({_intern:i,_key:e},n){const r=e(n);return i.has(r)&&(n=i.get(r),i.delete(r)),n}function Ave(i){return i!==null&&typeof i=="object"?i.valueOf():i}function GC(i,e){let n;if(e===void 0)for(const r of i)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let s of i)(s=e(s,++r,i))!=null&&(n<s||n===void 0&&s>=s)&&(n=s)}return n}function HC(i,e){let n;if(e===void 0)for(const r of i)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let s of i)(s=e(s,++r,i))!=null&&(n>s||n===void 0&&s>=s)&&(n=s)}return n}function Cve(i,e){let n=0;if(e===void 0)for(let r of i)(r=+r)&&(n+=r);else{let r=-1;for(let s of i)(s=+e(s,++r,i))&&(n+=s)}return n}function WC(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function Rve(i){if(Array.isArray(i))return i}function Pve(i){if(Array.isArray(i))return WC(i)}function tH(i,e,n){if(typeof i=="function"?i===e:i.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function Nve(i,e){if(e.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kve(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Lr(i,e){return i.get(tH(i,e))}function zh(i,e,n){Nve(i,e),e.set(i,n)}function Lx(i,e,n){return i.set(tH(i,e),n),n}function Lve(i,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,$ve(r.key),r)}}function Ive(i,e,n){return e&&Lve(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function Dve(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Ove(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function Fve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uve(i,e){return Rve(i)||Ove(i,e)||nH(i,e)||Fve()}function zve(i){return Pve(i)||Dve(i)||nH(i)||Bve()}function Vve(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function $ve(i){var e=Vve(i,"string");return typeof e=="symbol"?e:e+""}function nH(i,e){if(i){if(typeof i=="string")return WC(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?WC(i,e):void 0}}var Vh=new WeakMap,Xm=new WeakMap,$h=new WeakMap,KE=new WeakMap,YE=new WeakMap,ZE=new WeakMap,Gve=function(){function i(){kve(this,i),zh(this,Vh,new Map),zh(this,Xm,new Map),zh(this,$h,function(e){return e}),zh(this,KE,function(){return{}}),zh(this,YE,function(){}),zh(this,ZE,function(){})}return Ive(i,[{key:"getObj",value:function(n){return Lr(Vh,this).get(Lr($h,this).call(this,n))}},{key:"getData",value:function(n){return Lr(Xm,this).get(n)}},{key:"entries",value:function(){return zve(Lr(Xm,this).entries()).map(function(n){var r=Uve(n,2),s=r[0],o=r[1];return[o,s]})}},{key:"id",value:function(n){return Lx($h,this,yt(n)),this}},{key:"onCreateObj",value:function(n){return Lx(KE,this,n),this}},{key:"onUpdateObj",value:function(n){return Lx(YE,this,n),this}},{key:"onRemoveObj",value:function(n){return Lx(ZE,this,n),this}},{key:"digest",value:function(n){var r=this;n.filter(function(o){return!Lr(Vh,r).has(Lr($h,r).call(r,o))}).forEach(function(o){var a=Lr(KE,r).call(r,o);Lr(Vh,r).set(Lr($h,r).call(r,o),a),Lr(Xm,r).set(a,o)});var s=new Map(n.map(function(o){return[Lr($h,r).call(r,o),o]}));return Lr(Vh,this).forEach(function(o,a){s.has(a)?Lr(YE,r).call(r,o,s.get(a)):(Lr(ZE,r).call(r,o,a),Lr(Vh,r).delete(a),Lr(Xm,r).delete(o))}),this}},{key:"clear",value:function(){return this.digest([]),this}}])}();function Hve(i,e){switch(arguments.length){case 0:break;case 1:this.range(i);break;default:this.range(e).domain(i);break}return this}const qF=Symbol("implicit");function E2(){var i=new WF,e=[],n=[],r=qF;function s(o){let a=i.get(o);if(a===void 0){if(r!==qF)return r;i.set(o,a=e.push(o)-1)}return n[a%n.length]}return s.domain=function(o){if(!arguments.length)return e.slice();e=[],i=new WF;for(const a of o)i.has(a)||i.set(a,e.push(a)-1);return s},s.range=function(o){return arguments.length?(n=Array.from(o),s):n.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.copy=function(){return E2(e,n).unknown(r)},Hve.apply(s,arguments),s}function M2(i,e,n){i.prototype=e.prototype=n,n.constructor=i}function iH(i,e){var n=Object.create(i.prototype);for(var r in e)n[r]=e[r];return n}function K0(){}var s0=.7,l1=1/s0,Hf="\\s*([+-]?\\d+)\\s*",o0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wve=/^#([0-9a-f]{3,8})$/,jve=new RegExp(`^rgb\\(${Hf},${Hf},${Hf}\\)$`),qve=new RegExp(`^rgb\\(${qa},${qa},${qa}\\)$`),Xve=new RegExp(`^rgba\\(${Hf},${Hf},${Hf},${o0}\\)$`),Kve=new RegExp(`^rgba\\(${qa},${qa},${qa},${o0}\\)$`),Yve=new RegExp(`^hsl\\(${o0},${qa},${qa}\\)$`),Zve=new RegExp(`^hsla\\(${o0},${qa},${qa},${o0}\\)$`),XF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};M2(K0,a0,{copy(i){return Object.assign(new this.constructor,this,i)},displayable(){return this.rgb().displayable()},hex:KF,formatHex:KF,formatHex8:Qve,formatHsl:Jve,formatRgb:YF,toString:YF});function KF(){return this.rgb().formatHex()}function Qve(){return this.rgb().formatHex8()}function Jve(){return rH(this).formatHsl()}function YF(){return this.rgb().formatRgb()}function a0(i){var e,n;return i=(i+"").trim().toLowerCase(),(e=Wve.exec(i))?(n=e[1].length,e=parseInt(e[1],16),n===6?ZF(e):n===3?new bs(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ix(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ix(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=jve.exec(i))?new bs(e[1],e[2],e[3],1):(e=qve.exec(i))?new bs(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Xve.exec(i))?Ix(e[1],e[2],e[3],e[4]):(e=Kve.exec(i))?Ix(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Yve.exec(i))?e3(e[1],e[2]/100,e[3]/100,1):(e=Zve.exec(i))?e3(e[1],e[2]/100,e[3]/100,e[4]):XF.hasOwnProperty(i)?ZF(XF[i]):i==="transparent"?new bs(NaN,NaN,NaN,0):null}function ZF(i){return new bs(i>>16&255,i>>8&255,i&255,1)}function Ix(i,e,n,r){return r<=0&&(i=e=n=NaN),new bs(i,e,n,r)}function exe(i){return i instanceof K0||(i=a0(i)),i?(i=i.rgb(),new bs(i.r,i.g,i.b,i.opacity)):new bs}function jC(i,e,n,r){return arguments.length===1?exe(i):new bs(i,e,n,r??1)}function bs(i,e,n,r){this.r=+i,this.g=+e,this.b=+n,this.opacity=+r}M2(bs,jC,iH(K0,{brighter(i){return i=i==null?l1:Math.pow(l1,i),new bs(this.r*i,this.g*i,this.b*i,this.opacity)},darker(i){return i=i==null?s0:Math.pow(s0,i),new bs(this.r*i,this.g*i,this.b*i,this.opacity)},rgb(){return this},clamp(){return new bs(Ed(this.r),Ed(this.g),Ed(this.b),c1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:QF,formatHex:QF,formatHex8:txe,formatRgb:JF,toString:JF}));function QF(){return`#${vd(this.r)}${vd(this.g)}${vd(this.b)}`}function txe(){return`#${vd(this.r)}${vd(this.g)}${vd(this.b)}${vd((isNaN(this.opacity)?1:this.opacity)*255)}`}function JF(){const i=c1(this.opacity);return`${i===1?"rgb(":"rgba("}${Ed(this.r)}, ${Ed(this.g)}, ${Ed(this.b)}${i===1?")":`, ${i})`}`}function c1(i){return isNaN(i)?1:Math.max(0,Math.min(1,i))}function Ed(i){return Math.max(0,Math.min(255,Math.round(i)||0))}function vd(i){return i=Ed(i),(i<16?"0":"")+i.toString(16)}function e3(i,e,n,r){return r<=0?i=e=n=NaN:n<=0||n>=1?i=e=NaN:e<=0&&(i=NaN),new ra(i,e,n,r)}function rH(i){if(i instanceof ra)return new ra(i.h,i.s,i.l,i.opacity);if(i instanceof K0||(i=a0(i)),!i)return new ra;if(i instanceof ra)return i;i=i.rgb();var e=i.r/255,n=i.g/255,r=i.b/255,s=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,l=o-s,c=(o+s)/2;return l?(e===o?a=(n-r)/l+(n<r)*6:n===o?a=(r-e)/l+2:a=(e-n)/l+4,l/=c<.5?o+s:2-o-s,a*=60):l=c>0&&c<1?0:a,new ra(a,l,c,i.opacity)}function nxe(i,e,n,r){return arguments.length===1?rH(i):new ra(i,e,n,r??1)}function ra(i,e,n,r){this.h=+i,this.s=+e,this.l=+n,this.opacity=+r}M2(ra,nxe,iH(K0,{brighter(i){return i=i==null?l1:Math.pow(l1,i),new ra(this.h,this.s,this.l*i,this.opacity)},darker(i){return i=i==null?s0:Math.pow(s0,i),new ra(this.h,this.s,this.l*i,this.opacity)},rgb(){var i=this.h%360+(this.h<0)*360,e=isNaN(i)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,s=2*n-r;return new bs(QE(i>=240?i-240:i+120,s,r),QE(i,s,r),QE(i<120?i+240:i-120,s,r),this.opacity)},clamp(){return new ra(t3(this.h),Dx(this.s),Dx(this.l),c1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const i=c1(this.opacity);return`${i===1?"hsl(":"hsla("}${t3(this.h)}, ${Dx(this.s)*100}%, ${Dx(this.l)*100}%${i===1?")":`, ${i})`}`}}));function t3(i){return i=(i||0)%360,i<0?i+360:i}function Dx(i){return Math.max(0,Math.min(1,i||0))}function QE(i,e,n){return(i<60?e+(n-e)*i/60:i<180?n:i<240?e+(n-e)*(240-i)/60:e)*255}const sH=i=>()=>i;function ixe(i,e){return function(n){return i+n*e}}function rxe(i,e,n){return i=Math.pow(i,n),e=Math.pow(e,n)-i,n=1/n,function(r){return Math.pow(i+r*e,n)}}function sxe(i){return(i=+i)==1?oH:function(e,n){return n-e?rxe(e,n,i):sH(isNaN(e)?n:e)}}function oH(i,e){var n=e-i;return n?ixe(i,n):sH(isNaN(i)?e:i)}const n3=function i(e){var n=sxe(e);function r(s,o){var a=n((s=jC(s)).r,(o=jC(o)).r),l=n(s.g,o.g),c=n(s.b,o.b),u=oH(s.opacity,o.opacity);return function(d){return s.r=a(d),s.g=l(d),s.b=c(d),s.opacity=u(d),s+""}}return r.gamma=i,r}(1);function Vc(i,e){return i=+i,e=+e,function(n){return i*(1-n)+e*n}}var qC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,JE=new RegExp(qC.source,"g");function oxe(i){return function(){return i}}function axe(i){return function(e){return i(e)+""}}function lxe(i,e){var n=qC.lastIndex=JE.lastIndex=0,r,s,o,a=-1,l=[],c=[];for(i=i+"",e=e+"";(r=qC.exec(i))&&(s=JE.exec(e));)(o=s.index)>n&&(o=e.slice(n,o),l[a]?l[a]+=o:l[++a]=o),(r=r[0])===(s=s[0])?l[a]?l[a]+=s:l[++a]=s:(l[++a]=null,c.push({i:a,x:Vc(r,s)})),n=JE.lastIndex;return n<e.length&&(o=e.slice(n),l[a]?l[a]+=o:l[++a]=o),l.length<2?c[0]?axe(c[0].x):oxe(e):(e=c.length,function(u){for(var d=0,h;d<e;++d)l[(h=c[d]).i]=h.x(u);return l.join("")})}var i3=180/Math.PI,XC={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function aH(i,e,n,r,s,o){var a,l,c;return(a=Math.sqrt(i*i+e*e))&&(i/=a,e/=a),(c=i*n+e*r)&&(n-=i*c,r-=e*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),i*r<e*n&&(i=-i,e=-e,c=-c,a=-a),{translateX:s,translateY:o,rotate:Math.atan2(e,i)*i3,skewX:Math.atan(c)*i3,scaleX:a,scaleY:l}}var Ox;function cxe(i){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(i+"");return e.isIdentity?XC:aH(e.a,e.b,e.c,e.d,e.e,e.f)}function uxe(i){return i==null||(Ox||(Ox=document.createElementNS("http://www.w3.org/2000/svg","g")),Ox.setAttribute("transform",i),!(i=Ox.transform.baseVal.consolidate()))?XC:(i=i.matrix,aH(i.a,i.b,i.c,i.d,i.e,i.f))}function lH(i,e,n,r){function s(u){return u.length?u.pop()+" ":""}function o(u,d,h,f,p,m){if(u!==h||d!==f){var y=p.push("translate(",null,e,null,n);m.push({i:y-4,x:Vc(u,h)},{i:y-2,x:Vc(d,f)})}else(h||f)&&p.push("translate("+h+e+f+n)}function a(u,d,h,f){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),f.push({i:h.push(s(h)+"rotate(",null,r)-2,x:Vc(u,d)})):d&&h.push(s(h)+"rotate("+d+r)}function l(u,d,h,f){u!==d?f.push({i:h.push(s(h)+"skewX(",null,r)-2,x:Vc(u,d)}):d&&h.push(s(h)+"skewX("+d+r)}function c(u,d,h,f,p,m){if(u!==h||d!==f){var y=p.push(s(p)+"scale(",null,",",null,")");m.push({i:y-4,x:Vc(u,h)},{i:y-2,x:Vc(d,f)})}else(h!==1||f!==1)&&p.push(s(p)+"scale("+h+","+f+")")}return function(u,d){var h=[],f=[];return u=i(u),d=i(d),o(u.translateX,u.translateY,d.translateX,d.translateY,h,f),a(u.rotate,d.rotate,h,f),l(u.skewX,d.skewX,h,f),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,h,f),u=d=null,function(p){for(var m=-1,y=f.length,v;++m<y;)h[(v=f[m]).i]=v.x(p);return h.join("")}}}var dxe=lH(cxe,"px, ","px)","deg)"),hxe=lH(uxe,", ",")",")"),fxe=1e-12;function r3(i){return((i=Math.exp(i))+1/i)/2}function pxe(i){return((i=Math.exp(i))-1/i)/2}function mxe(i){return((i=Math.exp(2*i))-1)/(i+1)}const gxe=function i(e,n,r){function s(o,a){var l=o[0],c=o[1],u=o[2],d=a[0],h=a[1],f=a[2],p=d-l,m=h-c,y=p*p+m*m,v,g;if(y<fxe)g=Math.log(f/u)/e,v=function(w){return[l+w*p,c+w*m,u*Math.exp(e*w*g)]};else{var _=Math.sqrt(y),x=(f*f-u*u+r*y)/(2*u*n*_),b=(f*f-u*u-r*y)/(2*f*n*_),S=Math.log(Math.sqrt(x*x+1)-x),T=Math.log(Math.sqrt(b*b+1)-b);g=(T-S)/e,v=function(w){var E=w*g,A=r3(S),M=u/(n*_)*(A*mxe(e*E+S)-pxe(S));return[l+M*p,c+M*m,u*A/r3(e*E+S)]}}return v.duration=g*1e3*e/Math.SQRT2,v}return s.rho=function(o){var a=Math.max(.001,+o),l=a*a,c=l*l;return i(a,l,c)},s}(Math.SQRT2,2,4);function yxe(i){for(var e=i.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+i.slice(r*6,++r*6);return n}const cH=yxe("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function u1(i){"@babel/helpers - typeof";return u1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u1(i)}var vxe=/^\s+/,xxe=/\s+$/;function wt(i,e){if(i=i||"",e=e||{},i instanceof wt)return i;if(!(this instanceof wt))return new wt(i,e);var n=_xe(i);this._originalInput=i,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}wt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,r,s,o,a,l;return n=e.r/255,r=e.g/255,s=e.b/255,n<=.03928?o=n/12.92:o=Math.pow((n+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),s<=.03928?l=s/12.92:l=Math.pow((s+.055)/1.055,2.4),.2126*o+.7152*a+.0722*l},setAlpha:function(e){return this._a=uH(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=o3(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=o3(this._r,this._g,this._b),n=Math.round(e.h*360),r=Math.round(e.s*100),s=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+r+"%, "+s+"%)":"hsva("+n+", "+r+"%, "+s+"%, "+this._roundA+")"},toHsl:function(){var e=s3(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=s3(this._r,this._g,this._b),n=Math.round(e.h*360),r=Math.round(e.s*100),s=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+r+"%, "+s+"%)":"hsla("+n+", "+r+"%, "+s+"%, "+this._roundA+")"},toHex:function(e){return a3(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return Txe(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Jn(this._r,255)*100)+"%",g:Math.round(Jn(this._g,255)*100)+"%",b:Math.round(Jn(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Jn(this._r,255)*100)+"%, "+Math.round(Jn(this._g,255)*100)+"%, "+Math.round(Jn(this._b,255)*100)+"%)":"rgba("+Math.round(Jn(this._r,255)*100)+"%, "+Math.round(Jn(this._g,255)*100)+"%, "+Math.round(Jn(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:Oxe[a3(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+l3(this._r,this._g,this._b,this._a),r=n,s=this._gradientType?"GradientType = 1, ":"";if(e){var o=wt(e);r="#"+l3(o._r,o._g,o._b,o._a)}return"progid:DXImageTransform.Microsoft.gradient("+s+"startColorstr="+n+",endColorstr="+r+")"},toString:function(e){var n=!!e;e=e||this._format;var r=!1,s=this._a<1&&this._a>=0,o=!n&&s&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return o?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return wt(this.toString())},_applyModification:function(e,n){var r=e.apply(null,[this].concat([].slice.call(n)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(Cxe,arguments)},brighten:function(){return this._applyModification(Rxe,arguments)},darken:function(){return this._applyModification(Pxe,arguments)},desaturate:function(){return this._applyModification(Exe,arguments)},saturate:function(){return this._applyModification(Mxe,arguments)},greyscale:function(){return this._applyModification(Axe,arguments)},spin:function(){return this._applyModification(Nxe,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(Ixe,arguments)},complement:function(){return this._applyCombination(kxe,arguments)},monochromatic:function(){return this._applyCombination(Dxe,arguments)},splitcomplement:function(){return this._applyCombination(Lxe,arguments)},triad:function(){return this._applyCombination(c3,[3])},tetrad:function(){return this._applyCombination(c3,[4])}};wt.fromRatio=function(i,e){if(u1(i)=="object"){var n={};for(var r in i)i.hasOwnProperty(r)&&(r==="a"?n[r]=i[r]:n[r]=wg(i[r]));i=n}return wt(i,e)};function _xe(i){var e={r:0,g:0,b:0},n=1,r=null,s=null,o=null,a=!1,l=!1;return typeof i=="string"&&(i=zxe(i)),u1(i)=="object"&&(yl(i.r)&&yl(i.g)&&yl(i.b)?(e=bxe(i.r,i.g,i.b),a=!0,l=String(i.r).substr(-1)==="%"?"prgb":"rgb"):yl(i.h)&&yl(i.s)&&yl(i.v)?(r=wg(i.s),s=wg(i.v),e=wxe(i.h,r,s),a=!0,l="hsv"):yl(i.h)&&yl(i.s)&&yl(i.l)&&(r=wg(i.s),o=wg(i.l),e=Sxe(i.h,r,o),a=!0,l="hsl"),i.hasOwnProperty("a")&&(n=i.a)),n=uH(n),{ok:a,format:i.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function bxe(i,e,n){return{r:Jn(i,255)*255,g:Jn(e,255)*255,b:Jn(n,255)*255}}function s3(i,e,n){i=Jn(i,255),e=Jn(e,255),n=Jn(n,255);var r=Math.max(i,e,n),s=Math.min(i,e,n),o,a,l=(r+s)/2;if(r==s)o=a=0;else{var c=r-s;switch(a=l>.5?c/(2-r-s):c/(r+s),r){case i:o=(e-n)/c+(e<n?6:0);break;case e:o=(n-i)/c+2;break;case n:o=(i-e)/c+4;break}o/=6}return{h:o,s:a,l}}function Sxe(i,e,n){var r,s,o;i=Jn(i,360),e=Jn(e,100),n=Jn(n,100);function a(u,d,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?u+(d-u)*6*h:h<1/2?d:h<2/3?u+(d-u)*(2/3-h)*6:u}if(e===0)r=s=o=n;else{var l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;r=a(c,l,i+1/3),s=a(c,l,i),o=a(c,l,i-1/3)}return{r:r*255,g:s*255,b:o*255}}function o3(i,e,n){i=Jn(i,255),e=Jn(e,255),n=Jn(n,255);var r=Math.max(i,e,n),s=Math.min(i,e,n),o,a,l=r,c=r-s;if(a=r===0?0:c/r,r==s)o=0;else{switch(r){case i:o=(e-n)/c+(e<n?6:0);break;case e:o=(n-i)/c+2;break;case n:o=(i-e)/c+4;break}o/=6}return{h:o,s:a,v:l}}function wxe(i,e,n){i=Jn(i,360)*6,e=Jn(e,100),n=Jn(n,100);var r=Math.floor(i),s=i-r,o=n*(1-e),a=n*(1-s*e),l=n*(1-(1-s)*e),c=r%6,u=[n,a,o,o,l,n][c],d=[l,n,n,a,o,o][c],h=[o,o,l,n,n,a][c];return{r:u*255,g:d*255,b:h*255}}function a3(i,e,n,r){var s=[aa(Math.round(i).toString(16)),aa(Math.round(e).toString(16)),aa(Math.round(n).toString(16))];return r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function Txe(i,e,n,r,s){var o=[aa(Math.round(i).toString(16)),aa(Math.round(e).toString(16)),aa(Math.round(n).toString(16)),aa(dH(r))];return s&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function l3(i,e,n,r){var s=[aa(dH(r)),aa(Math.round(i).toString(16)),aa(Math.round(e).toString(16)),aa(Math.round(n).toString(16))];return s.join("")}wt.equals=function(i,e){return!i||!e?!1:wt(i).toRgbString()==wt(e).toRgbString()};wt.random=function(){return wt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function Exe(i,e){e=e===0?0:e||10;var n=wt(i).toHsl();return n.s-=e/100,n.s=lw(n.s),wt(n)}function Mxe(i,e){e=e===0?0:e||10;var n=wt(i).toHsl();return n.s+=e/100,n.s=lw(n.s),wt(n)}function Axe(i){return wt(i).desaturate(100)}function Cxe(i,e){e=e===0?0:e||10;var n=wt(i).toHsl();return n.l+=e/100,n.l=lw(n.l),wt(n)}function Rxe(i,e){e=e===0?0:e||10;var n=wt(i).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),wt(n)}function Pxe(i,e){e=e===0?0:e||10;var n=wt(i).toHsl();return n.l-=e/100,n.l=lw(n.l),wt(n)}function Nxe(i,e){var n=wt(i).toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,wt(n)}function kxe(i){var e=wt(i).toHsl();return e.h=(e.h+180)%360,wt(e)}function c3(i,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=wt(i).toHsl(),r=[wt(i)],s=360/e,o=1;o<e;o++)r.push(wt({h:(n.h+o*s)%360,s:n.s,l:n.l}));return r}function Lxe(i){var e=wt(i).toHsl(),n=e.h;return[wt(i),wt({h:(n+72)%360,s:e.s,l:e.l}),wt({h:(n+216)%360,s:e.s,l:e.l})]}function Ixe(i,e,n){e=e||6,n=n||30;var r=wt(i).toHsl(),s=360/n,o=[wt(i)];for(r.h=(r.h-(s*e>>1)+720)%360;--e;)r.h=(r.h+s)%360,o.push(wt(r));return o}function Dxe(i,e){e=e||6;for(var n=wt(i).toHsv(),r=n.h,s=n.s,o=n.v,a=[],l=1/e;e--;)a.push(wt({h:r,s,v:o})),o=(o+l)%1;return a}wt.mix=function(i,e,n){n=n===0?0:n||50;var r=wt(i).toRgb(),s=wt(e).toRgb(),o=n/100,a={r:(s.r-r.r)*o+r.r,g:(s.g-r.g)*o+r.g,b:(s.b-r.b)*o+r.b,a:(s.a-r.a)*o+r.a};return wt(a)};wt.readability=function(i,e){var n=wt(i),r=wt(e);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)};wt.isReadable=function(i,e,n){var r=wt.readability(i,e),s,o;switch(o=!1,s=Vxe(n),s.level+s.size){case"AAsmall":case"AAAlarge":o=r>=4.5;break;case"AAlarge":o=r>=3;break;case"AAAsmall":o=r>=7;break}return o};wt.mostReadable=function(i,e,n){var r=null,s=0,o,a,l,c;n=n||{},a=n.includeFallbackColors,l=n.level,c=n.size;for(var u=0;u<e.length;u++)o=wt.readability(i,e[u]),o>s&&(s=o,r=wt(e[u]));return wt.isReadable(i,r,{level:l,size:c})||!a?r:(n.includeFallbackColors=!1,wt.mostReadable(i,["#fff","#000"],n))};var KC=wt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Oxe=wt.hexNames=Fxe(KC);function Fxe(i){var e={};for(var n in i)i.hasOwnProperty(n)&&(e[i[n]]=n);return e}function uH(i){return i=parseFloat(i),(isNaN(i)||i<0||i>1)&&(i=1),i}function Jn(i,e){Bxe(i)&&(i="100%");var n=Uxe(i);return i=Math.min(e,Math.max(0,parseFloat(i))),n&&(i=parseInt(i*e,10)/100),Math.abs(i-e)<1e-6?1:i%e/parseFloat(e)}function lw(i){return Math.min(1,Math.max(0,i))}function Vs(i){return parseInt(i,16)}function Bxe(i){return typeof i=="string"&&i.indexOf(".")!=-1&&parseFloat(i)===1}function Uxe(i){return typeof i=="string"&&i.indexOf("%")!=-1}function aa(i){return i.length==1?"0"+i:""+i}function wg(i){return i<=1&&(i=i*100+"%"),i}function dH(i){return Math.round(parseFloat(i)*255).toString(16)}function u3(i){return Vs(i)/255}var Ko=function(){var i="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+i+")",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",s="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+s),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+s),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+s),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function yl(i){return!!Ko.CSS_UNIT.exec(i)}function zxe(i){i=i.replace(vxe,"").replace(xxe,"").toLowerCase();var e=!1;if(KC[i])i=KC[i],e=!0;else if(i=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=Ko.rgb.exec(i))?{r:n[1],g:n[2],b:n[3]}:(n=Ko.rgba.exec(i))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Ko.hsl.exec(i))?{h:n[1],s:n[2],l:n[3]}:(n=Ko.hsla.exec(i))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Ko.hsv.exec(i))?{h:n[1],s:n[2],v:n[3]}:(n=Ko.hsva.exec(i))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Ko.hex8.exec(i))?{r:Vs(n[1]),g:Vs(n[2]),b:Vs(n[3]),a:u3(n[4]),format:e?"name":"hex8"}:(n=Ko.hex6.exec(i))?{r:Vs(n[1]),g:Vs(n[2]),b:Vs(n[3]),format:e?"name":"hex"}:(n=Ko.hex4.exec(i))?{r:Vs(n[1]+""+n[1]),g:Vs(n[2]+""+n[2]),b:Vs(n[3]+""+n[3]),a:u3(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=Ko.hex3.exec(i))?{r:Vs(n[1]+""+n[1]),g:Vs(n[2]+""+n[2]),b:Vs(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function Vxe(i){var e,n;return i=i||{level:"AA",size:"small"},e=(i.level||"AA").toUpperCase(),n=(i.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}function YC(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function $xe(i){if(Array.isArray(i))return i}function Gxe(i){if(Array.isArray(i))return YC(i)}function hH(i,e,n){if(typeof i=="function"?i===e:i.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function Hxe(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function fH(i,e,n){return e=Pp(e),Qxe(i,A2()?Reflect.construct(e,n||[],Pp(i).constructor):e.apply(i,n))}function Wxe(i,e){if(e.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pH(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function eM(i,e){return i.get(hH(i,e))}function d3(i,e,n){Wxe(i,e),e.set(i,n)}function h3(i,e,n){return i.set(hH(i,e),n),n}function mH(i,e,n){if(A2())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var s=new(i.bind.apply(i,r));return s}function jxe(i,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,vH(r.key),r)}}function gH(i,e,n){return e&&jxe(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function cw(i,e,n){return(e=vH(e))in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function ZC(){return ZC=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,e,n){var r=Jxe(i,e);if(r){var s=Object.getOwnPropertyDescriptor(r,e);return s.get?s.get.call(arguments.length<3?i:n):s.value}},ZC.apply(null,arguments)}function Pp(i){return Pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pp(i)}function yH(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&QC(i,e)}function A2(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(A2=function(){return!!i})()}function qxe(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Xxe(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function Kxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),n.push.apply(n,r)}return n}function Zxe(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?f3(Object(n),!0).forEach(function(r){cw(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):f3(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}function Qxe(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hxe(i)}function QC(i,e){return QC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},QC(i,e)}function Zg(i,e){return $xe(i)||Xxe(i,e)||xH(i,e)||Kxe()}function Jxe(i,e){for(;!{}.hasOwnProperty.call(i,e)&&(i=Pp(i))!==null;);return i}function tM(i,e,n,r){var s=ZC(Pp(i.prototype),e,n);return typeof s=="function"?function(o){return s.apply(n,o)}:s}function ta(i){return Gxe(i)||qxe(i)||xH(i)||Yxe()}function e_e(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function vH(i){var e=e_e(i,"string");return typeof e=="symbol"?e:e+""}function JC(i){"@babel/helpers - typeof";return JC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},JC(i)}function xH(i,e){if(i){if(typeof i=="string")return YC(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YC(i,e):void 0}}var _H=function(e){e instanceof Array?e.forEach(_H):(e.map&&e.map.dispose(),e.dispose())},bH=function(e){e.geometry&&e.geometry.dispose(),e.material&&_H(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(bH)},eR=function(e){for(;e.children.length;){var n=e.children[0];e.remove(n),bH(n)}},nM=new WeakMap,Fx=new WeakMap,Km=function(i){function e(n){var r,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=s.dataBindAttr,a=o===void 0?"__data":o,l=s.objBindAttr,c=l===void 0?"__threeObj":l;return pH(this,e),r=fH(this,e),cw(r,"scene",void 0),d3(r,nM,void 0),d3(r,Fx,void 0),r.scene=n,h3(nM,r,a),h3(Fx,r,c),r.onRemoveObj(function(){}),r}return yH(e,i),gH(e,[{key:"onCreateObj",value:function(r){var s=this;return tM(e,"onCreateObj",this)([function(o){var a=r(o);return o[eM(Fx,s)]=a,a[eM(nM,s)]=o,s.scene.add(a),a}]),this}},{key:"onRemoveObj",value:function(r){var s=this;return tM(e,"onRemoveObj",this)([function(o,a){var l=tM(e,"getData",s)([o]);r(o,a),s.scene.remove(o),eR(o),delete l[eM(Fx,s)]}]),this}}])}(Gve),Ym=function(e){return isNaN(e)?parseInt(wt(e).toHex(),16):e},iM=function(e){return isNaN(e)?wt(e).getAlpha():1},t_e=E2(cH);function p3(i,e,n){!e||typeof n!="string"||i.filter(function(r){return!r[n]}).forEach(function(r){r[n]=t_e(e(r))})}function n_e(i,e){var n=i.nodes,r=i.links,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.nodeFilter,a=o===void 0?function(){return!0}:o,l=s.onLoopError,c=l===void 0?function(p){throw"Invalid DAG structure! Found cycle in node path: ".concat(p.join(" -> "),".")}:l,u={};n.forEach(function(p){return u[e(p)]={data:p,out:[],depth:-1,skip:!a(p)}}),r.forEach(function(p){var m=p.source,y=p.target,v=b(m),g=b(y);if(!u.hasOwnProperty(v))throw"Missing source node with id: ".concat(v);if(!u.hasOwnProperty(g))throw"Missing target node with id: ".concat(g);var _=u[v],x=u[g];_.out.push(x);function b(S){return JC(S)==="object"?e(S):S}});var d=[];f(Object.values(u));var h=Object.assign.apply(Object,[{}].concat(ta(Object.entries(u).filter(function(p){var m=Zg(p,2),y=m[1];return!y.skip}).map(function(p){var m=Zg(p,2),y=m[0],v=m[1];return cw({},y,v.depth)}))));return h;function f(p){for(var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=function(){var b=p[g];if(m.indexOf(b)!==-1){var S=[].concat(ta(m.slice(m.indexOf(b))),[b]).map(function(T){return e(T.data)});return d.some(function(T){return T.length===S.length&&T.every(function(w,E){return w===S[E]})})||(d.push(S),c(S)),1}y>b.depth&&(b.depth=y,f(b.out,[].concat(ta(m),[b]),y+(b.skip?0:1)))},g=0,_=p.length;g<_;g++)v()}}var Lt=window.THREE?window.THREE:{Group:xf,Mesh:Xn,MeshLambertMaterial:uG,Color:St,BufferGeometry:Tr,BufferAttribute:Yi,Matrix4:ln,Vector3:K,SphereGeometry:Gd,CylinderGeometry:H0,TubeGeometry:c2,ConeGeometry:o2,Line:sG,LineBasicMaterial:G0,QuadraticBezierCurve3:l2,CubicBezierCurve3:lG,Box3:Kd},m3={graph:a0e,forcelayout:V0e},i_e=2,rM=new Lt.BufferGeometry().setAttribute?"setAttribute":"addAttribute",Bx=new Lt.BufferGeometry().applyMatrix4?"applyMatrix4":"applyMatrix",r_e=Au({props:{jsonUrl:{onChange:function(e,n){var r=this;e&&!n.fetchingJson&&(n.fetchingJson=!0,n.onLoading(),fetch(e).then(function(s){return s.json()}).then(function(s){n.fetchingJson=!1,n.onFinishLoading(s),r.graphData(s)}))},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1}},numDimensions:{default:3,onChange:function(e,n){var r=n.d3ForceLayout.force("charge");r&&r.strength(e>2?-60:-30),e<3&&s(n.graphData.nodes,"z"),e<2&&s(n.graphData.nodes,"y");function s(o,a){o.forEach(function(l){delete l[a],delete l["v".concat(a)]})}}},dagMode:{onChange:function(e,n){!e&&n.forceEngine==="d3"&&(n.graphData.nodes||[]).forEach(function(r){return r.fx=r.fy=r.fz=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeVisibility:{default:!0},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},nodePositionUpdate:{triggerUpdate:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{},linkResolution:{default:6},linkCurvature:{default:0,triggerUpdate:!1},linkCurveRotation:{default:0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.d3ForceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.d3ForceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.d3ForceLayout.velocityDecay(e)}},ngraphPhysics:{default:{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8e-4,dragCoefficient:.02}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onLoading:{default:function(){},triggerUpdate:!1},onFinishLoading:{default:function(){},triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1}},methods:{refresh:function(e){return e._flushObjects=!0,e._rerender(),this},d3Force:function(e,n,r){return r===void 0?e.d3ForceLayout.force(n):(e.d3ForceLayout.force(n,r),this)},d3ReheatSimulation:function(e){return e.d3ForceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},tickFrame:function(e){var n=e.forceEngine!=="ngraph";return e.engineRunning&&r(),s(),o(),this;function r(){++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||n&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.layout[n?"tick":"step"](),e.onEngineTick());var a=yt(e.nodeThreeObjectExtend);e.nodeDataMapper.entries().forEach(function(f){var p=Zg(f,2),m=p[0],y=p[1];if(y){var v=n?m:e.layout.getNodePosition(m[e.nodeId]),g=a(m);(!e.nodePositionUpdate||!e.nodePositionUpdate(g?y.children[0]:y,{x:v.x,y:v.y,z:v.z},m)||g)&&(y.position.x=v.x,y.position.y=v.y||0,y.position.z=v.z||0)}});var l=yt(e.linkWidth),c=yt(e.linkCurvature),u=yt(e.linkCurveRotation),d=yt(e.linkThreeObjectExtend);e.linkDataMapper.entries().forEach(function(f){var p=Zg(f,2),m=p[0],y=p[1];if(y){var v=n?m:e.layout.getLinkPosition(e.layout.graph.getLink(m.source,m.target).id),g=v[n?"source":"from"],_=v[n?"target":"to"];if(!(!g||!_||!g.hasOwnProperty("x")||!_.hasOwnProperty("x"))){h(m);var x=d(m);if(!(e.linkPositionUpdate&&e.linkPositionUpdate(x?y.children[1]:y,{start:{x:g.x,y:g.y,z:g.z},end:{x:_.x,y:_.y,z:_.z}},m)&&!x)){var b=30,S=m.__curve,T=y.children.length?y.children[0]:y;if(T.type==="Line"){if(S){var E=S.getPoints(b);T.geometry.getAttribute("position").array.length!==E.length*3&&T.geometry[rM]("position",new Lt.BufferAttribute(new Float32Array(E.length*3),3)),T.geometry.setFromPoints(E)}else{var w=T.geometry.getAttribute("position");(!w||!w.array||w.array.length!==6)&&T.geometry[rM]("position",w=new Lt.BufferAttribute(new Float32Array(2*3),3)),w.array[0]=g.x,w.array[1]=g.y||0,w.array[2]=g.z||0,w.array[3]=_.x,w.array[4]=_.y||0,w.array[5]=_.z||0,w.needsUpdate=!0}T.geometry.computeBoundingSphere()}else if(T.type==="Mesh")if(S){T.geometry.type.match(/^Tube(Buffer)?Geometry$/)||(T.position.set(0,0,0),T.rotation.set(0,0,0),T.scale.set(1,1,1));var L=Math.ceil(l(m)*10)/10,P=L/2,W=new Lt.TubeGeometry(S,b,P,e.linkResolution,!1);T.geometry.dispose(),T.geometry=W}else{if(!T.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)){var A=Math.ceil(l(m)*10)/10,M=A/2,R=new Lt.CylinderGeometry(M,M,1,e.linkResolution,1,!1);R[Bx](new Lt.Matrix4().makeTranslation(0,1/2,0)),R[Bx](new Lt.Matrix4().makeRotationX(Math.PI/2)),T.geometry.dispose(),T.geometry=R}var F=new Lt.Vector3(g.x,g.y||0,g.z||0),B=new Lt.Vector3(_.x,_.y||0,_.z||0),C=F.distanceTo(B);T.position.x=F.x,T.position.y=F.y,T.position.z=F.z,T.scale.z=C,T.parent.localToWorld(B),T.lookAt(B)}}}}});function h(f){var p=n?f:e.layout.getLinkPosition(e.layout.graph.getLink(f.source,f.target).id),m=p[n?"source":"from"],y=p[n?"target":"to"];if(!(!m||!y||!m.hasOwnProperty("x")||!y.hasOwnProperty("x"))){var v=c(f);if(!v)f.__curve=null;else{var g=new Lt.Vector3(m.x,m.y||0,m.z||0),_=new Lt.Vector3(y.x,y.y||0,y.z||0),x=g.distanceTo(_),b,S=u(f);if(x>0){var T=y.x-m.x,w=y.y-m.y||0,E=new Lt.Vector3().subVectors(_,g),A=E.clone().multiplyScalar(v).cross(T!==0||w!==0?new Lt.Vector3(0,0,1):new Lt.Vector3(0,1,0)).applyAxisAngle(E.normalize(),S).add(new Lt.Vector3().addVectors(g,_).divideScalar(2));b=new Lt.QuadraticBezierCurve3(g,A,_)}else{var M=v*70,R=-S,F=R+Math.PI/2;b=new Lt.CubicBezierCurve3(g,new Lt.Vector3(M*Math.cos(F),M*Math.sin(F),0).add(g),new Lt.Vector3(M*Math.cos(R),M*Math.sin(R),0).add(g),_)}f.__curve=b}}}}function s(){var a=yt(e.linkDirectionalArrowRelPos),l=yt(e.linkDirectionalArrowLength),c=yt(e.nodeVal);e.arrowDataMapper.entries().forEach(function(u){var d=Zg(u,2),h=d[0],f=d[1];if(f){var p=n?h:e.layout.getLinkPosition(e.layout.graph.getLink(h.source,h.target).id),m=p[n?"source":"from"],y=p[n?"target":"to"];if(!(!m||!y||!m.hasOwnProperty("x")||!y.hasOwnProperty("x"))){var v=Math.cbrt(Math.max(0,c(m)||1))*e.nodeRelSize,g=Math.cbrt(Math.max(0,c(y)||1))*e.nodeRelSize,_=l(h),x=a(h),b=h.__curve?function(M){return h.__curve.getPoint(M)}:function(M){var R=function(B,C,L,P){return C[B]+(L[B]-C[B])*P||0};return{x:R("x",m,y,M),y:R("y",m,y,M),z:R("z",m,y,M)}},S=h.__curve?h.__curve.getLength():Math.sqrt(["x","y","z"].map(function(M){return Math.pow((y[M]||0)-(m[M]||0),2)}).reduce(function(M,R){return M+R},0)),T=v+_+(S-v-g-_)*x,w=b(T/S),E=b((T-_)/S);["x","y","z"].forEach(function(M){return f.position[M]=E[M]});var A=mH(Lt.Vector3,ta(["x","y","z"].map(function(M){return w[M]})));f.parent.localToWorld(A),f.lookAt(A)}}})}function o(){var a=yt(e.linkDirectionalParticleSpeed);e.graphData.links.forEach(function(l){var c=e.particlesDataMapper.getObj(l),u=c&&c.children,d=l.__singleHopPhotonsObj&&l.__singleHopPhotonsObj.children;if(!((!d||!d.length)&&(!u||!u.length))){var h=n?l:e.layout.getLinkPosition(e.layout.graph.getLink(l.source,l.target).id),f=h[n?"source":"from"],p=h[n?"target":"to"];if(!(!f||!p||!f.hasOwnProperty("x")||!p.hasOwnProperty("x"))){var m=a(l),y=l.__curve?function(g){return l.__curve.getPoint(g)}:function(g){var _=function(b,S,T,w){return S[b]+(T[b]-S[b])*w||0};return{x:_("x",f,p,g),y:_("y",f,p,g),z:_("z",f,p,g)}},v=[].concat(ta(u||[]),ta(d||[]));v.forEach(function(g,_){var x=g.parent.__linkThreeObjType==="singleHopPhotons";if(g.hasOwnProperty("__progressRatio")||(g.__progressRatio=x?0:_/u.length),g.__progressRatio+=m,g.__progressRatio>=1)if(!x)g.__progressRatio=g.__progressRatio%1;else{g.parent.remove(g),eR(g);return}var b=g.__progressRatio,S=y(b);["x","y","z"].forEach(function(T){return g.position[T]=S[T]})})}}})}},emitParticle:function(e,n){if(n&&e.graphData.links.includes(n)){if(!n.__singleHopPhotonsObj){var r=new Lt.Group;r.__linkThreeObjType="singleHopPhotons",n.__singleHopPhotonsObj=r,e.graphScene.add(r)}var s=yt(e.linkDirectionalParticleWidth),o=Math.ceil(s(n)*10)/10/2,a=e.linkDirectionalParticleResolution,l=new Lt.SphereGeometry(o,a,a),c=yt(e.linkColor),u=yt(e.linkDirectionalParticleColor),d=u(n)||c(n)||"#f0f0f0",h=new Lt.Color(Ym(d)),f=e.linkOpacity*3,p=new Lt.MeshLambertMaterial({color:h,transparent:!0,opacity:f});n.__singleHopPhotonsObj.add(new Lt.Mesh(l,p))}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0};if(!e.initialised)return null;var r=function s(o){var a=[];if(o.geometry){o.geometry.computeBoundingBox();var l=new Lt.Box3;l.copy(o.geometry.boundingBox).applyMatrix4(o.matrixWorld),a.push(l)}return a.concat.apply(a,ta((o.children||[]).filter(function(c){return!c.hasOwnProperty("__graphObjType")||c.__graphObjType==="node"&&n(c.__data)}).map(s)))}(e.graphScene);return r.length?Object.assign.apply(Object,ta(["x","y","z"].map(function(s){return cw({},s,[HC(r,function(o){return o.min[s]}),GC(r,function(o){return o.max[s]})])}))):null}},stateInit:function(){return{d3ForceLayout:LG().force("link",PG()).force("charge",IG()).force("center",wG()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.graphScene=e,n.nodeDataMapper=new Km(e,{objBindAttr:"__threeObj"}),n.linkDataMapper=new Km(e,{objBindAttr:"__lineObj"}),n.arrowDataMapper=new Km(e,{objBindAttr:"__arrowObj"}),n.particlesDataMapper=new Km(e,{objBindAttr:"__photonsObj"})},update:function(e,n){var r=function(Q){return Q.some(function(ee){return n.hasOwnProperty(ee)})};if(e.engineRunning=!1,typeof e.onUpdate=="function"&&e.onUpdate(),e.nodeAutoColorBy!==null&&r(["nodeAutoColorBy","graphData","nodeColor"])&&p3(e.graphData.nodes,yt(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&r(["linkAutoColorBy","graphData","linkColor"])&&p3(e.graphData.links,yt(e.linkAutoColorBy),e.linkColor),e._flushObjects||r(["graphData","nodeThreeObject","nodeThreeObjectExtend","nodeVal","nodeColor","nodeVisibility","nodeRelSize","nodeResolution","nodeOpacity"])){var s=yt(e.nodeThreeObject),o=yt(e.nodeThreeObjectExtend),a=yt(e.nodeVal),l=yt(e.nodeColor),c=yt(e.nodeVisibility),u={},d={};(e._flushObjects||r(["nodeThreeObject","nodeThreeObjectExtend"]))&&e.nodeDataMapper.clear(),e.nodeDataMapper.onCreateObj(function(G){var Q=s(G),ee=o(G);Q&&e.nodeThreeObject===Q&&(Q=Q.clone());var ie;return Q&&!ee?ie=Q:(ie=new Lt.Mesh,ie.__graphDefaultObj=!0,Q&&ee&&ie.add(Q)),ie.__graphObjType="node",ie}).onUpdateObj(function(G,Q){if(G.__graphDefaultObj){var ee=a(Q)||1,ie=Math.cbrt(ee)*e.nodeRelSize,Se=e.nodeResolution;(!G.geometry.type.match(/^Sphere(Buffer)?Geometry$/)||G.geometry.parameters.radius!==ie||G.geometry.parameters.widthSegments!==Se)&&(u.hasOwnProperty(ee)||(u[ee]=new Lt.SphereGeometry(ie,Se,Se)),G.geometry.dispose(),G.geometry=u[ee]);var Fe=l(Q),Be=new Lt.Color(Ym(Fe||"#ffffaa")),ct=e.nodeOpacity*iM(Fe);(G.material.type!=="MeshLambertMaterial"||!G.material.color.equals(Be)||G.material.opacity!==ct)&&(d.hasOwnProperty(Fe)||(d[Fe]=new Lt.MeshLambertMaterial({color:Be,transparent:!0,opacity:ct})),G.material.dispose(),G.material=d[Fe])}}).digest(e.graphData.nodes.filter(c))}if(e._flushObjects||r(["graphData","linkThreeObject","linkThreeObjectExtend","linkMaterial","linkColor","linkWidth","linkVisibility","linkResolution","linkOpacity","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution"])){var h=yt(e.linkThreeObject),f=yt(e.linkThreeObjectExtend),p=yt(e.linkMaterial),m=yt(e.linkVisibility),y=yt(e.linkColor),v=yt(e.linkWidth),g={},_={},x={},b=e.graphData.links.filter(m);if((e._flushObjects||r(["linkThreeObject","linkThreeObjectExtend","linkWidth"]))&&e.linkDataMapper.clear(),e.linkDataMapper.onRemoveObj(function(G){var Q=G.__data&&G.__data.__singleHopPhotonsObj;Q&&(Q.parent.remove(Q),eR(Q),delete G.__data.__singleHopPhotonsObj)}).onCreateObj(function(G){var Q=h(G),ee=f(G);Q&&e.linkThreeObject===Q&&(Q=Q.clone());var ie;if(!Q||ee){var Se=!!v(G);if(Se)ie=new Lt.Mesh;else{var Fe=new Lt.BufferGeometry;Fe[rM]("position",new Lt.BufferAttribute(new Float32Array(2*3),3)),ie=new Lt.Line(Fe)}}var Be;return Q?ee?(Be=new Lt.Group,Be.__graphDefaultObj=!0,Be.add(ie),Be.add(Q)):Be=Q:(Be=ie,Be.__graphDefaultObj=!0),Be.renderOrder=10,Be.__graphObjType="link",Be}).onUpdateObj(function(G,Q){if(G.__graphDefaultObj){var ee=G.children.length?G.children[0]:G,ie=Math.ceil(v(Q)*10)/10,Se=!!ie;if(Se){var Fe=ie/2,Be=e.linkResolution;if(!ee.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)||ee.geometry.parameters.radiusTop!==Fe||ee.geometry.parameters.radialSegments!==Be){if(!g.hasOwnProperty(ie)){var ct=new Lt.CylinderGeometry(Fe,Fe,1,Be,1,!1);ct[Bx](new Lt.Matrix4().makeTranslation(0,1/2,0)),ct[Bx](new Lt.Matrix4().makeRotationX(Math.PI/2)),g[ie]=ct}ee.geometry.dispose(),ee.geometry=g[ie]}}var xt=p(Q);if(xt)ee.material=xt;else{var He=y(Q),Z=new Lt.Color(Ym(He||"#f0f0f0")),Nt=e.linkOpacity*iM(He),Rt=Se?"MeshLambertMaterial":"LineBasicMaterial";if(ee.material.type!==Rt||!ee.material.color.equals(Z)||ee.material.opacity!==Nt){var mt=Se?_:x;mt.hasOwnProperty(He)||(mt[He]=new Lt[Rt]({color:Z,transparent:Nt<1,opacity:Nt,depthWrite:Nt>=1})),ee.material.dispose(),ee.material=mt[He]}}}}).digest(b),e.linkDirectionalArrowLength||n.hasOwnProperty("linkDirectionalArrowLength")){var S=yt(e.linkDirectionalArrowLength),T=yt(e.linkDirectionalArrowColor);e.arrowDataMapper.onCreateObj(function(){var G=new Lt.Mesh(void 0,new Lt.MeshLambertMaterial({transparent:!0}));return G.__linkThreeObjType="arrow",G}).onUpdateObj(function(G,Q){var ee=S(Q),ie=e.linkDirectionalArrowResolution;if(!G.geometry.type.match(/^Cone(Buffer)?Geometry$/)||G.geometry.parameters.height!==ee||G.geometry.parameters.radialSegments!==ie){var Se=new Lt.ConeGeometry(ee*.25,ee,ie);Se.translate(0,ee/2,0),Se.rotateX(Math.PI/2),G.geometry.dispose(),G.geometry=Se}var Fe=T(Q)||y(Q)||"#f0f0f0";G.material.color=new Lt.Color(Ym(Fe)),G.material.opacity=e.linkOpacity*3*iM(Fe)}).digest(b.filter(S))}if(e.linkDirectionalParticles||n.hasOwnProperty("linkDirectionalParticles")){var w=yt(e.linkDirectionalParticles),E=yt(e.linkDirectionalParticleWidth),A=yt(e.linkDirectionalParticleColor),M={},R={};e.particlesDataMapper.onCreateObj(function(){var G=new Lt.Group;return G.__linkThreeObjType="photons",G.__photonDataMapper=new Km(G),G}).onUpdateObj(function(G,Q){var ee=Math.round(Math.abs(w(Q))),ie=!!G.children.length&&G.children[0],Se=Math.ceil(E(Q)*10)/10/2,Fe=e.linkDirectionalParticleResolution,Be;ie&&ie.geometry.parameters.radius===Se&&ie.geometry.parameters.widthSegments===Fe?Be=ie.geometry:(R.hasOwnProperty(Se)||(R[Se]=new Lt.SphereGeometry(Se,Fe,Fe)),Be=R[Se],ie&&ie.geometry.dispose());var ct=A(Q)||y(Q)||"#f0f0f0",xt=new Lt.Color(Ym(ct)),He=e.linkOpacity*3,Z;ie&&ie.material.color.equals(xt)&&ie.material.opacity===He?Z=ie.material:(M.hasOwnProperty(ct)||(M[ct]=new Lt.MeshLambertMaterial({color:xt,transparent:!0,opacity:He})),Z=M[ct],ie&&ie.material.dispose()),G.__photonDataMapper.id(function(Nt){return Nt.idx}).onCreateObj(function(){return new Lt.Mesh(Be,Z)}).onUpdateObj(function(Nt){Nt.geometry=Be,Nt.material=Z}).digest(ta(new Array(ee)).map(function(Nt,Rt){return{idx:Rt}}))}).digest(b.filter(w))}}if(e._flushObjects=!1,r(["graphData","nodeId","linkSource","linkTarget","numDimensions","forceEngine","dagMode","dagNodeFilter","dagLevelDistance"])){e.engineRunning=!1,e.graphData.links.forEach(function(G){G.source=G[e.linkSource],G.target=G[e.linkTarget]});var F=e.forceEngine!=="ngraph",B;if(F){(B=e.d3ForceLayout).stop().alpha(1).numDimensions(e.numDimensions).nodes(e.graphData.nodes);var C=e.d3ForceLayout.force("link");C&&C.id(function(G){return G[e.nodeId]}).links(e.graphData.links);var L=e.dagMode&&n_e(e.graphData,function(G){return G[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),P=Math.max.apply(Math,ta(Object.values(L||[]))),W=e.dagLevelDistance||e.graphData.nodes.length/(P||1)*i_e*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(["lr","rl","td","bu","zin","zout"].includes(n.dagMode)){var D=["lr","rl"].includes(n.dagMode)?"fx":["td","bu"].includes(n.dagMode)?"fy":"fz";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(G){return delete G[D]})}if(["lr","rl","td","bu","zin","zout"].includes(e.dagMode)){var X=["rl","td","zout"].includes(e.dagMode),q=function(Q){return(L[Q[e.nodeId]]-P/2)*W*(X?-1:1)},J=["lr","rl"].includes(e.dagMode)?"fx":["td","bu"].includes(e.dagMode)?"fy":"fz";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(G){return G[J]=q(G)})}e.d3ForceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?DG(function(G){var Q=L[G[e.nodeId]]||-1;return(e.dagMode==="radialin"?P-Q:Q)*W}).strength(function(G){return e.dagNodeFilter(G)?1:0}):null)}else{var se=m3.graph();e.graphData.nodes.forEach(function(G){se.addNode(G[e.nodeId])}),e.graphData.links.forEach(function(G){se.addLink(G.source,G.target)}),B=m3.forcelayout(se,Zxe({dimensions:e.numDimensions},e.ngraphPhysics)),B.graph=se}for(var de=0;de<e.warmupTicks&&!(F&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin);de++)B[F?"tick":"step"]();e.layout=B,this.resetCountdown()}e.engineRunning=!0,e.onFinishUpdate()}});function s_e(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=function(s){function o(){var a;pH(this,o);for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return a=fH(this,o,[].concat(c)),a.__kapsuleInstance=mH(i,[].concat(ta(n?[a]:[]),c)),a}return yH(o,s),gH(o)}(e);return Object.keys(i()).forEach(function(s){return r.prototype[s]=function(){var o,a=(o=this.__kapsuleInstance)[s].apply(o,arguments);return a===this.__kapsuleInstance?this:a}}),r}var o_e=window.THREE?window.THREE:{Group:xf},bf=s_e(r_e,o_e.Group,!0);if(typeof AFRAME>"u")throw new Error("Component attempted to register before AFRAME was available.");var sM=function(e){return typeof e=="string"?JSON.parse(e):e},Yo=function(e){if(typeof e=="function")return e;var n=eval;try{var r=n("("+e+")");return r}catch{}return null},hi=function(e){return isNaN(parseFloat(e))?Yo(e)?Yo(e):e:parseFloat(e)};AFRAME.components.hasOwnProperty("forcegraph")||AFRAME.registerComponent("forcegraph",{schema:{jsonUrl:{type:"string",default:""},nodes:{parse:sM,default:[]},links:{parse:sM,default:[]},numDimensions:{type:"number",default:3},dagMode:{type:"string",default:""},dagLevelDistance:{type:"number",default:0},dagNodeFilter:{parse:Yo,default:function(){return!0}},onDagError:{parse:Yo,default:void 0},nodeRelSize:{type:"number",default:4},nodeId:{type:"string",default:"id"},nodeVal:{parse:hi,default:"val"},nodeResolution:{type:"number",default:8},nodeVisibility:{parse:hi,default:!0},nodeColor:{parse:hi,default:"color"},nodeAutoColorBy:{parse:hi,default:""},nodeOpacity:{type:"number",default:.75},nodeThreeObject:{parse:hi,default:null},nodeThreeObjectExtend:{parse:hi,default:!1},linkSource:{type:"string",default:"source"},linkTarget:{type:"string",default:"target"},linkVisibility:{parse:hi,default:!0},linkColor:{parse:hi,default:"color"},linkAutoColorBy:{parse:hi,default:""},linkOpacity:{type:"number",default:.2},linkWidth:{parse:hi,default:0},linkResolution:{type:"number",default:6},linkCurvature:{parse:hi,default:0},linkCurveRotation:{parse:hi,default:0},linkMaterial:{parse:hi,default:null},linkThreeObject:{parse:hi,default:null},linkThreeObjectExtend:{parse:hi,default:!1},linkPositionUpdate:{parse:Yo,default:null},linkDirectionalArrowLength:{parse:hi,default:0},linkDirectionalArrowColor:{parse:hi,default:null},linkDirectionalArrowRelPos:{parse:hi,default:.5},linkDirectionalArrowResolution:{type:"number",default:8},linkDirectionalParticles:{parse:hi,default:0},linkDirectionalParticleSpeed:{parse:hi,default:.01},linkDirectionalParticleWidth:{parse:hi,default:.5},linkDirectionalParticleColor:{parse:hi,default:null},linkDirectionalParticleResolution:{type:"number",default:4},onNodeHover:{parse:Yo,default:function(){}},onLinkHover:{parse:Yo,default:function(){}},onNodeClick:{parse:Yo,default:function(){}},onLinkClick:{parse:Yo,default:function(){}},forceEngine:{type:"string",default:"d3"},d3AlphaMin:{type:"number",default:0},d3AlphaDecay:{type:"number",default:.0228},d3VelocityDecay:{type:"number",default:.4},ngraphPhysics:{parse:sM,default:null},warmupTicks:{type:"int",default:0},cooldownTicks:{type:"int",default:1e18},cooldownTime:{type:"int",default:15e3},onEngineTick:{parse:Yo,default:function(){}},onEngineStop:{parse:Yo,default:function(){}}},getGraphBbox:function(e){return this.forceGraph||(this.forceGraph=new bf),this.forceGraph.getGraphBbox(e)},emitParticle:function(){this.forceGraph||(this.forceGraph=new bf);var e=this.forceGraph,n=e.emitParticle.apply(e,arguments);return n===e?this:n},d3Force:function(){this.forceGraph||(this.forceGraph=new bf);var e=this.forceGraph,n=e.d3Force.apply(e,arguments);return n===e?this:n},d3ReheatSimulation:function(){return this.forceGraph&&this.forceGraph.d3ReheatSimulation(),this},refresh:function(){return this.forceGraph&&this.forceGraph.refresh(),this},init:function(){var e=this,n=this.state={};n.infoEl=document.createElement("a-text"),n.infoEl.setAttribute("position","0 -0.1 -1"),n.infoEl.setAttribute("width",1),n.infoEl.setAttribute("align","center"),n.infoEl.setAttribute("color","lavender");var r=document.querySelector("a-entity[camera], a-camera");r.appendChild(n.infoEl),n.cameraObj=r.object3D.children.filter(function(s){return s.type==="PerspectiveCamera"})[0],this.el.sceneEl.addEventListener("camera-set-active",function(s){n.cameraObj=s.detail.cameraEl.components.camera.camera}),this.forceGraph||(this.forceGraph=new bf),this.forceGraph.onFinishUpdate(function(){return e.el.setObject3D("forcegraphGroup",e.forceGraph)}).onLoading(function(){return n.infoEl.setAttribute("value","Loading...")}).onFinishLoading(function(){return n.infoEl.setAttribute("value","")}),this.el.addEventListener("raycaster-intersected",function(s){return n.hoverDetail=s.detail}),this.el.addEventListener("raycaster-intersected-cleared",function(s){return n.hoverDetail=s.detail}),this.el.addEventListener("click",function(){return n.hoverObj&&e.data["on"+(n.hoverObj.__graphObjType==="node"?"Node":"Link")+"Click"](n.hoverObj.__data)})},remove:function(){this.state.infoEl.remove(),this.el.removeObject3D("forcegraphGroup")},update:function(e){var n=this,r=this.data,s=AFRAME.utils.diff(r,e),o=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"];o.filter(function(a){return a in s}).forEach(function(a){n.forceGraph[a](r[a]!==""?r[a]:null)}),("nodes"in s||"links"in s)&&n.forceGraph.graphData({nodes:r.nodes,links:r.links})},tick:function(e,n){for(var r=this.state,s=this.data,o=r.hoverDetail?r.hoverDetail.getIntersection?r.hoverDetail.getIntersection(this.el):r.hoverDetail.intersection||void 0:void 0,a=o?o.object:void 0;a&&!a.hasOwnProperty("__graphObjType");)a=a.parent;if(a!==r.hoverObj){var l=r.hoverObj?r.hoverObj.__graphObjType:null,c=r.hoverObj?r.hoverObj.__data:null,u=a?a.__graphObjType:null,d=a?a.__data:null;l&&l!==u&&s["on"+(l==="node"?"Node":"Link")+"Hover"](null,c),u&&s["on"+(u==="node"?"Node":"Link")+"Hover"](d,l===u?c:null),r.hoverObj=a}this.forceGraph.tickFrame()}});function tR(i){return tR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tR(i)}function a_e(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}function SH(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SH=function(){return!!i})()}function l_e(i,e,n){if(SH())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var s=new(i.bind.apply(i,r));return n&&Ry(s,n.prototype),s}function nR(i){var e=typeof Map=="function"?new Map:void 0;return nR=function(r){if(r===null||!a_e(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(r))return e.get(r);e.set(r,s)}function s(){return l_e(r,arguments,tR(this).constructor)}return s.prototype=Object.create(r.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),Ry(s,r)},nR(i)}var za=function(i){iN(e,i);function e(n){var r;return r=i.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+n+" for more information.")||this,iV(r)}return e}(nR(Error));function oM(i){return Math.round(i*255)}function c_e(i,e,n){return oM(i)+","+oM(e)+","+oM(n)}function l0(i,e,n,r){if(r===void 0&&(r=c_e),e===0)return r(n,n,n);var s=(i%360+360)%360/60,o=(1-Math.abs(2*n-1))*e,a=o*(1-Math.abs(s%2-1)),l=0,c=0,u=0;s>=0&&s<1?(l=o,c=a):s>=1&&s<2?(l=a,c=o):s>=2&&s<3?(c=o,u=a):s>=3&&s<4?(c=a,u=o):s>=4&&s<5?(l=a,u=o):s>=5&&s<6&&(l=o,u=a);var d=n-o/2,h=l+d,f=c+d,p=u+d;return r(h,f,p)}var g3={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function u_e(i){if(typeof i!="string")return i;var e=i.toLowerCase();return g3[e]?"#"+g3[e]:i}var d_e=/^#[a-fA-F0-9]{6}$/,h_e=/^#[a-fA-F0-9]{8}$/,f_e=/^#[a-fA-F0-9]{3}$/,p_e=/^#[a-fA-F0-9]{4}$/,aM=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,m_e=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,g_e=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,y_e=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function yu(i){if(typeof i!="string")throw new za(3);var e=u_e(i);if(e.match(d_e))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(h_e)){var n=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:n}}if(e.match(f_e))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(p_e)){var r=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:r}}var s=aM.exec(e);if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10)};var o=m_e.exec(e.substring(0,50));if(o)return{red:parseInt(""+o[1],10),green:parseInt(""+o[2],10),blue:parseInt(""+o[3],10),alpha:parseFloat(""+o[4])>1?parseFloat(""+o[4])/100:parseFloat(""+o[4])};var a=g_e.exec(e);if(a){var l=parseInt(""+a[1],10),c=parseInt(""+a[2],10)/100,u=parseInt(""+a[3],10)/100,d="rgb("+l0(l,c,u)+")",h=aM.exec(d);if(!h)throw new za(4,e,d);return{red:parseInt(""+h[1],10),green:parseInt(""+h[2],10),blue:parseInt(""+h[3],10)}}var f=y_e.exec(e.substring(0,50));if(f){var p=parseInt(""+f[1],10),m=parseInt(""+f[2],10)/100,y=parseInt(""+f[3],10)/100,v="rgb("+l0(p,m,y)+")",g=aM.exec(v);if(!g)throw new za(4,e,v);return{red:parseInt(""+g[1],10),green:parseInt(""+g[2],10),blue:parseInt(""+g[3],10),alpha:parseFloat(""+f[4])>1?parseFloat(""+f[4])/100:parseFloat(""+f[4])}}throw new za(5)}function v_e(i){var e=i.red/255,n=i.green/255,r=i.blue/255,s=Math.max(e,n,r),o=Math.min(e,n,r),a=(s+o)/2;if(s===o)return i.alpha!==void 0?{hue:0,saturation:0,lightness:a,alpha:i.alpha}:{hue:0,saturation:0,lightness:a};var l,c=s-o,u=a>.5?c/(2-s-o):c/(s+o);switch(s){case e:l=(n-r)/c+(n<r?6:0);break;case n:l=(r-e)/c+2;break;default:l=(e-n)/c+4;break}return l*=60,i.alpha!==void 0?{hue:l,saturation:u,lightness:a,alpha:i.alpha}:{hue:l,saturation:u,lightness:a}}function Cu(i){return v_e(yu(i))}var x_e=function(e){return e.length===7&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},iR=x_e;function id(i){var e=i.toString(16);return e.length===1?"0"+e:e}function lM(i){return id(Math.round(i*255))}function __e(i,e,n){return iR("#"+lM(i)+lM(e)+lM(n))}function d1(i,e,n){return l0(i,e,n,__e)}function b_e(i,e,n){if(typeof i=="number"&&typeof e=="number"&&typeof n=="number")return d1(i,e,n);if(typeof i=="object"&&e===void 0&&n===void 0)return d1(i.hue,i.saturation,i.lightness);throw new za(1)}function S_e(i,e,n,r){if(typeof i=="number"&&typeof e=="number"&&typeof n=="number"&&typeof r=="number")return r>=1?d1(i,e,n):"rgba("+l0(i,e,n)+","+r+")";if(typeof i=="object"&&e===void 0&&n===void 0&&r===void 0)return i.alpha>=1?d1(i.hue,i.saturation,i.lightness):"rgba("+l0(i.hue,i.saturation,i.lightness)+","+i.alpha+")";throw new za(2)}function rR(i,e,n){if(typeof i=="number"&&typeof e=="number"&&typeof n=="number")return iR("#"+id(i)+id(e)+id(n));if(typeof i=="object"&&e===void 0&&n===void 0)return iR("#"+id(i.red)+id(i.green)+id(i.blue));throw new za(6)}function uw(i,e,n,r){if(typeof i=="string"&&typeof e=="number"){var s=yu(i);return"rgba("+s.red+","+s.green+","+s.blue+","+e+")"}else{if(typeof i=="number"&&typeof e=="number"&&typeof n=="number"&&typeof r=="number")return r>=1?rR(i,e,n):"rgba("+i+","+e+","+n+","+r+")";if(typeof i=="object"&&e===void 0&&n===void 0&&r===void 0)return i.alpha>=1?rR(i.red,i.green,i.blue):"rgba("+i.red+","+i.green+","+i.blue+","+i.alpha+")"}throw new za(7)}var w_e=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},T_e=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"},E_e=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},M_e=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"};function Ru(i){if(typeof i!="object")throw new za(8);if(T_e(i))return uw(i);if(w_e(i))return rR(i);if(M_e(i))return S_e(i);if(E_e(i))return b_e(i);throw new za(8)}function wH(i,e,n){return function(){var s=n.concat(Array.prototype.slice.call(arguments));return s.length>=e?i.apply(this,s):wH(i,e,s)}}function uo(i){return wH(i,i.length,[])}function A_e(i,e){if(e==="transparent")return e;var n=Cu(e);return Ru(z({},n,{hue:n.hue+parseFloat(i)}))}uo(A_e);function am(i,e,n){return Math.max(i,Math.min(e,n))}function C_e(i,e){if(e==="transparent")return e;var n=Cu(e);return Ru(z({},n,{lightness:am(0,1,n.lightness-parseFloat(i))}))}uo(C_e);function R_e(i,e){if(e==="transparent")return e;var n=Cu(e);return Ru(z({},n,{saturation:am(0,1,n.saturation-parseFloat(i))}))}uo(R_e);function P_e(i,e){if(e==="transparent")return e;var n=Cu(e);return Ru(z({},n,{lightness:am(0,1,n.lightness+parseFloat(i))}))}uo(P_e);function N_e(i,e,n){if(e==="transparent")return n;if(n==="transparent")return e;if(i===0)return n;var r=yu(e),s=z({},r,{alpha:typeof r.alpha=="number"?r.alpha:1}),o=yu(n),a=z({},o,{alpha:typeof o.alpha=="number"?o.alpha:1}),l=s.alpha-a.alpha,c=parseFloat(i)*2-1,u=c*l===-1?c:c+l,d=1+c*l,h=(u/d+1)/2,f=1-h,p={red:Math.floor(s.red*h+a.red*f),green:Math.floor(s.green*h+a.green*f),blue:Math.floor(s.blue*h+a.blue*f),alpha:s.alpha*parseFloat(i)+a.alpha*(1-parseFloat(i))};return uw(p)}var k_e=uo(N_e),TH=k_e;function L_e(i,e){if(e==="transparent")return e;var n=yu(e),r=typeof n.alpha=="number"?n.alpha:1,s=z({},n,{alpha:am(0,1,(r*100+parseFloat(i)*100)/100)});return uw(s)}var I_e=uo(L_e),EH=I_e;function D_e(i,e){if(e==="transparent")return e;var n=Cu(e);return Ru(z({},n,{saturation:am(0,1,n.saturation+parseFloat(i))}))}uo(D_e);function O_e(i,e){return e==="transparent"?e:Ru(z({},Cu(e),{hue:parseFloat(i)}))}uo(O_e);function F_e(i,e){return e==="transparent"?e:Ru(z({},Cu(e),{lightness:parseFloat(i)}))}uo(F_e);function B_e(i,e){return e==="transparent"?e:Ru(z({},Cu(e),{saturation:parseFloat(i)}))}uo(B_e);function U_e(i,e){return e==="transparent"?e:TH(parseFloat(i),"rgb(0, 0, 0)",e)}uo(U_e);function z_e(i,e){return e==="transparent"?e:TH(parseFloat(i),"rgb(255, 255, 255)",e)}uo(z_e);function V_e(i,e){if(e==="transparent")return e;var n=yu(e),r=typeof n.alpha=="number"?n.alpha:1,s=z({},n,{alpha:am(0,1,+(r*100-parseFloat(i)*100).toFixed(2)/100)});return uw(s)}uo(V_e);function $_e(i,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var G_e=`.graph-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: Sans-serif;
  z-index: 1000;
}`;$_e(G_e);function sR(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function H_e(i){if(Array.isArray(i))return i}function W_e(i){if(Array.isArray(i))return sR(i)}function Tg(i,e,n){return(e=Z_e(e))in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function j_e(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function q_e(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function X_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),n.push.apply(n,r)}return n}function v3(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?y3(Object(n),!0).forEach(function(r){Tg(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):y3(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}function cM(i,e){return H_e(i)||q_e(i,e)||MH(i,e)||X_e()}function Ux(i){return W_e(i)||j_e(i)||MH(i)||K_e()}function Y_e(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Z_e(i){var e=Y_e(i,"string");return typeof e=="symbol"?e:e+""}function MH(i,e){if(i){if(typeof i=="string")return sR(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sR(i,e):void 0}}var Q_e=Au({props:{width:{default:window.innerWidth,triggerUpdate:!1,onChange:function(e,n){n.container&&(n.container.style.width="".concat(e,"px"))}},height:{default:window.innerHeight,triggerUpdate:!1,onChange:function(e,n){n.container&&(n.container.style.height="".concat(e,"px"))}},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},backgroundColor:{default:"#002"},showNavInfo:{default:!0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeLabel:{default:"name"},nodeDesc:{default:"desc"},onNodeHover:{},onNodeClick:{},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkLabel:{default:"name"},linkDesc:{default:"desc"},onLinkHover:{},onLinkClick:{},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:v3(v3({},Object.assign.apply(Object,[{}].concat(Ux(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(i){return Tg({},i,function(e){for(var n=e.forcegraph.components.forcegraph,r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];var a=n[i].apply(n,s);return a===n?this:a})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(e,n){e.innerHTML="",n.container=document.createElement("div"),e.appendChild(n.container),n.container.style.position="relative",n.container.style.width="".concat(n.width,"px"),n.container.style.height="".concat(n.height,"px"),n.container.appendChild(n.navInfo=document.createElement("div")),n.navInfo.className="graph-nav-info",n.navInfo.textContent="Mouse drag: look, gamepad/arrow/wasd keys: move";var r=document.createElement("a-scene");r.setAttribute("embedded",""),r.appendChild(n.sky=document.createElement("a-sky")),n.sky.setAttribute("radius",3e3);var s;r.appendChild(s=document.createElement("a-entity")),s.setAttribute("position","0 0 300"),s.setAttribute("movement-controls","controls: gamepad, touch; fly: true; speed: 7");var o;s.appendChild(o=document.createElement("a-entity")),o.setAttribute("camera",""),o.setAttribute("position","0 0 0"),o.setAttribute("look-controls","pointerLockEnabled: false"),o.setAttribute("wasd-controls","fly: true; acceleration: 700");var a;o.appendChild(a=document.createElement("a-text")),a.setAttribute("position","0 -0.3 -1"),a.setAttribute("width",2),a.setAttribute("align","center"),a.setAttribute("color","lavender"),a.setAttribute("value","");var l;o.appendChild(l=document.createElement("a-text")),l.setAttribute("position","0 -0.4 -1"),l.setAttribute("width",1.3),l.setAttribute("align","center"),l.setAttribute("color","lavender"),l.setAttribute("value",""),n.raycasterEls=[];var c;r.appendChild(c=document.createElement("a-entity")),c.setAttribute("cursor","rayOrigin: mouse; mouseCursorStylesEnabled: true"),c.setAttribute("raycaster","objects: [forcegraph]; interval: 100"),n.raycasterEls.push(c),["left","right"].forEach(function(u){var d;s.appendChild(d=document.createElement("a-entity")),d.setAttribute("laser-controls","hand: ".concat(u,"; model: false;")),d.setAttribute("raycaster","objects: [forcegraph]; interval: 100; lineColor: steelblue; lineOpacity: 0.85"),n.raycasterEls.push(d)}),r.appendChild(n.forcegraph=document.createElement("a-entity")),n.forcegraph.setAttribute("forcegraph",null),n.container.appendChild(r),n.forcegraph.setAttribute("forcegraph",Object.assign.apply(Object,Ux(["node","link"].map(function(u){var d={node:"Node",link:"Link"}[u];return Tg({},"on".concat(d,"Hover"),function(f,p){var m=f&&yt(n["".concat(u,"Label")])(f)||"",y=f&&yt(n["".concat(u,"Desc")])(f)||"";a.setAttribute("value",m),l.setAttribute("value",y),n["on".concat(d,"Hover")]&&n["on".concat(d,"Hover")](f,p)})}))))},update:function(e,n){if(n.hasOwnProperty("backgroundColor")){var r=yu(e.backgroundColor).alpha;r===void 0&&(r=1),e.sky.setAttribute("color",EH(1,e.backgroundColor)),e.sky.setAttribute("opacity",r)}n.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none");var s=["onNodeHover","onLinkHover","onNodeClick","onLinkClick"].some(function(l){return e[l]})||["nodeLabel","linkLabel"].some(function(l){return e[l]!=="name"})||["nodeDesc","linkDesc"].some(function(l){return e[l]!=="desc"});e.raycasterEls.forEach(function(l){return l.setAttribute("raycaster",s?"objects: [forcegraph]; interval: 100":"objects: __none__")});var o=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","onNodeClick","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","onLinkClick","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],a=Object.assign.apply(Object,[{}].concat(Ux(Object.entries(e).filter(function(l){var c=cM(l,2),u=c[0],d=c[1];return n.hasOwnProperty(u)&&o.indexOf(u)!==-1&&d!==void 0&&d!==null}).map(function(l){var c=cM(l,2),u=c[0],d=c[1];return Tg({},u,d)})),Ux(Object.entries(e.graphData).map(function(l){var c=cM(l,2),u=c[0],d=c[1];return Tg({},u,d)}))));e.forcegraph.setAttribute("forcegraph",a)}});function oR(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function J_e(i){if(Array.isArray(i))return i}function ebe(i){if(Array.isArray(i))return oR(i)}function H_(i,e,n){return(e=obe(e))in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function tbe(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function nbe(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function ibe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x3(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),n.push.apply(n,r)}return n}function _3(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?x3(Object(n),!0).forEach(function(r){H_(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):x3(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}function zx(i,e){return J_e(i)||nbe(i,e)||AH(i,e)||ibe()}function Vx(i){return ebe(i)||tbe(i)||AH(i)||rbe()}function sbe(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function obe(i){var e=sbe(i,"string");return typeof e=="symbol"?e:e+""}function AH(i,e){if(i){if(typeof i=="string")return oR(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oR(i,e):void 0}}var abe=Au({props:{width:{},height:{},yOffset:{default:1.5},glScale:{default:200},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},onNodeHover:{},onNodeClick:{},onLinkHover:{},onLinkClick:{},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:_3(_3({},Object.assign.apply(Object,[{}].concat(Vx(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(i){return H_({},i,function(e){for(var n=e.forcegraph.components.forcegraph,r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];var a=n[i].apply(n,s);return a===n?this:a})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=r.markerAttrs,o=s===void 0?{preset:"hiro"}:s;e.innerHTML="",n.container=document.createElement("div"),e.appendChild(n.container);var a=document.createElement("a-scene");a.setAttribute("embedded",""),a.setAttribute("vr-mode-ui","enabled: false"),a.setAttribute("arjs","debugUIEnabled: false;");var l=document.createElement("a-marker");Object.entries(o).forEach(function(d){var h=zx(d,2),f=h[0],p=h[1];return l.setAttribute(f,p)}),a.appendChild(l);var c;a.appendChild(c=document.createElement("a-entity")),c.setAttribute("cursor"),c.setAttribute("raycaster","objects: [forcegraph]"),n.forcegraph=document.createElement("a-entity"),n.forcegraph.setAttribute("forcegraph",null),l.appendChild(n.forcegraph);var u=document.createElement("a-entity");u.setAttribute("camera",""),a.appendChild(u),n.container.appendChild(a)},update:function(e,n){n.hasOwnProperty("width")&&e.width&&(e.container.style.width="".concat(e.width,"px")),n.hasOwnProperty("height")&&e.height&&(e.container.style.height="".concat(e.height,"px")),n.hasOwnProperty("glScale")&&e.forcegraph.setAttribute("scale",Vx(new Array(3)).map(function(){return 1/e.glScale}).join(" ")),n.hasOwnProperty("yOffset")&&e.forcegraph.setAttribute("position","0 ".concat(e.yOffset," 0"));var r=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","onNodeHover","onNodeClick","onLinkHover","onLinkClick","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],s=Object.assign.apply(Object,[{}].concat(Vx(Object.entries(e).filter(function(o){var a=zx(o,2),l=a[0],c=a[1];return n.hasOwnProperty(l)&&r.indexOf(l)!==-1&&c!==void 0&&c!==null}).map(function(o){var a=zx(o,2),l=a[0],c=a[1];return H_({},l,c)})),Vx(Object.entries(e.graphData).map(function(o){var a=zx(o,2),l=a[0],c=a[1];return H_({},l,c)}))));e.forcegraph.setAttribute("forcegraph",s)}});const Wf=new Ws,Rl=new Oe,CH=new K,uM=new Oe,W_=new Oe,h1=new K,aR=new K,RH=new ln,PH=new K,NH=new K;let ys=null,Ca=null;const Pl=[],cu={NONE:-1,PAN:0,ROTATE:1};class lbe extends sw{constructor(e,n,r=null){super(n,r),this.objects=e,this.recursive=!0,this.transformGroup=!1,this.rotateSpeed=1,this.raycaster=new gG,this.mouseButtons={LEFT:_r.PAN,MIDDLE:_r.PAN,RIGHT:_r.ROTATE},this.touches={ONE:Il.PAN},this._onPointerMove=cbe.bind(this),this._onPointerDown=ube.bind(this),this._onPointerCancel=dbe.bind(this),this._onContextMenu=hbe.bind(this),r!==null&&this.connect(r)}connect(e){super.connect(e),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerCancel),this.domElement.addEventListener("pointerleave",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerCancel),this.domElement.removeEventListener("pointerleave",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto",this.domElement.style.cursor=""}dispose(){this.disconnect()}_updatePointer(e){const n=this.domElement.getBoundingClientRect();Rl.x=(e.clientX-n.left)/n.width*2-1,Rl.y=-(e.clientY-n.top)/n.height*2+1}_updateState(e){let n;if(e.pointerType==="touch")n=this.touches.ONE;else switch(e.button){case 0:n=this.mouseButtons.LEFT;break;case 1:n=this.mouseButtons.MIDDLE;break;case 2:n=this.mouseButtons.RIGHT;break;default:n=null}switch(n){case _r.PAN:case Il.PAN:this.state=cu.PAN;break;case _r.ROTATE:case Il.ROTATE:this.state=cu.ROTATE;break;default:this.state=cu.NONE}}getRaycaster(){return console.warn("THREE.DragControls: getRaycaster() has been deprecated. Use controls.raycaster instead."),this.raycaster}setObjects(e){console.warn("THREE.DragControls: setObjects() has been deprecated. Use controls.objects instead."),this.objects=e}getObjects(){return console.warn("THREE.DragControls: getObjects() has been deprecated. Use controls.objects instead."),this.objects}activate(){console.warn("THREE.DragControls: activate() has been renamed to connect()."),this.connect()}deactivate(){console.warn("THREE.DragControls: deactivate() has been renamed to disconnect()."),this.disconnect()}set mode(e){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}get mode(){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}}function cbe(i){const e=this.object,n=this.domElement,r=this.raycaster;if(this.enabled!==!1){if(this._updatePointer(i),r.setFromCamera(Rl,e),ys)this.state===cu.PAN?r.ray.intersectPlane(Wf,h1)&&ys.position.copy(h1.sub(CH).applyMatrix4(RH)):this.state===cu.ROTATE&&(uM.subVectors(Rl,W_).multiplyScalar(this.rotateSpeed),ys.rotateOnWorldAxis(PH,uM.x),ys.rotateOnWorldAxis(NH.normalize(),-uM.y)),this.dispatchEvent({type:"drag",object:ys}),W_.copy(Rl);else if(i.pointerType==="mouse"||i.pointerType==="pen")if(Pl.length=0,r.setFromCamera(Rl,e),r.intersectObjects(this.objects,this.recursive,Pl),Pl.length>0){const s=Pl[0].object;Wf.setFromNormalAndCoplanarPoint(e.getWorldDirection(Wf.normal),aR.setFromMatrixPosition(s.matrixWorld)),Ca!==s&&Ca!==null&&(this.dispatchEvent({type:"hoveroff",object:Ca}),n.style.cursor="auto",Ca=null),Ca!==s&&(this.dispatchEvent({type:"hoveron",object:s}),n.style.cursor="pointer",Ca=s)}else Ca!==null&&(this.dispatchEvent({type:"hoveroff",object:Ca}),n.style.cursor="auto",Ca=null);W_.copy(Rl)}}function ube(i){const e=this.object,n=this.domElement,r=this.raycaster;this.enabled!==!1&&(this._updatePointer(i),this._updateState(i),Pl.length=0,r.setFromCamera(Rl,e),r.intersectObjects(this.objects,this.recursive,Pl),Pl.length>0&&(this.transformGroup===!0?ys=kH(Pl[0].object):ys=Pl[0].object,Wf.setFromNormalAndCoplanarPoint(e.getWorldDirection(Wf.normal),aR.setFromMatrixPosition(ys.matrixWorld)),r.ray.intersectPlane(Wf,h1)&&(this.state===cu.PAN?(RH.copy(ys.parent.matrixWorld).invert(),CH.copy(h1).sub(aR.setFromMatrixPosition(ys.matrixWorld))):this.state===cu.ROTATE&&(PH.set(0,1,0).applyQuaternion(e.quaternion).normalize(),NH.set(1,0,0).applyQuaternion(e.quaternion).normalize())),n.style.cursor="move",this.dispatchEvent({type:"dragstart",object:ys})),W_.copy(Rl))}function dbe(){this.enabled!==!1&&(ys&&(this.dispatchEvent({type:"dragend",object:ys}),ys=null),this.domElement.style.cursor=Ca?"pointer":"auto",this.state=cu.NONE)}function hbe(i){this.enabled!==!1&&i.preventDefault()}function kH(i,e=null){return i.isGroup&&(e=i),i.parent===null?e:kH(i.parent,e)}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const fbe=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveMap","envMap","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class pbe{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=fbe,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const n=e.getMRT();return n!==null&&n.has("velocity")}getRenderObjectData(e){let n=this.renderObjects.get(e);if(n===void 0){const{geometry:r,material:s,object:o}=e;if(n={material:this.getMaterialData(s),geometry:{id:r.id,attributes:this.getAttributesData(r.attributes),indexVersion:r.index?r.index.version:null,drawRange:{start:r.drawRange.start,count:r.drawRange.count}},worldMatrix:o.matrixWorld.clone()},o.center&&(n.center=o.center.clone()),o.morphTargetInfluences&&(n.morphTargetInfluences=o.morphTargetInfluences.slice()),e.bundle!==null&&(n.version=e.bundle.version),n.material.transmission>0){const{width:a,height:l}=e.context;n.bufferWidth=a,n.bufferHeight=l}this.renderObjects.set(e,n)}return n}getAttributesData(e){const n={};for(const r in e){const s=e[r];n[r]={version:s.version}}return n}containsNode(e){const n=e.material;for(const r in n)if(n[r]&&n[r].isNode)return!0;return e.renderer.overrideNodes.modelViewMatrix!==null||e.renderer.overrideNodes.modelNormalViewMatrix!==null}getMaterialData(e){const n={};for(const r of this.refreshUniforms){const s=e[r];s!=null&&(typeof s=="object"&&s.clone!==void 0?s.isTexture===!0?n[r]={id:s.id,version:s.version}:n[r]=s.clone():n[r]=s)}return n}equals(e){const{object:n,material:r,geometry:s}=e,o=this.getRenderObjectData(e);if(o.worldMatrix.equals(n.matrixWorld)!==!0)return o.worldMatrix.copy(n.matrixWorld),!1;const a=o.material;for(const y in a){const v=a[y],g=r[y];if(v.equals!==void 0){if(v.equals(g)===!1)return v.copy(g),!1}else if(g.isTexture===!0){if(v.id!==g.id||v.version!==g.version)return v.id=g.id,v.version=g.version,!1}else if(v!==g)return a[y]=g,!1}if(a.transmission>0){const{width:y,height:v}=e.context;if(o.bufferWidth!==y||o.bufferHeight!==v)return o.bufferWidth=y,o.bufferHeight=v,!1}const l=o.geometry,c=s.attributes,u=l.attributes,d=Object.keys(u),h=Object.keys(c);if(l.id!==s.id)return l.id=s.id,!1;if(d.length!==h.length)return o.geometry.attributes=this.getAttributesData(c),!1;for(const y of d){const v=u[y],g=c[y];if(g===void 0)return delete u[y],!1;if(v.version!==g.version)return v.version=g.version,!1}const f=s.index,p=l.indexVersion,m=f?f.version:null;if(p!==m)return l.indexVersion=m,!1;if(l.drawRange.start!==s.drawRange.start||l.drawRange.count!==s.drawRange.count)return l.drawRange.start=s.drawRange.start,l.drawRange.count=s.drawRange.count,!1;if(o.morphTargetInfluences){let y=!1;for(let v=0;v<o.morphTargetInfluences.length;v++)o.morphTargetInfluences[v]!==n.morphTargetInfluences[v]&&(y=!0);if(y)return!0}return o.center&&o.center.equals(n.center)===!1?(o.center.copy(n.center),!0):(e.bundle!==null&&(o.version=e.bundle.version),!0)}needsRefresh(e,n){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(n.renderer))return!0;const{renderId:r}=n;if(this.renderId!==r)return this.renderId=r,!0;const s=e.object.static===!0,o=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return s||o?!1:this.equals(e)!==!0}}function c0(i,e=0){let n=3735928559^e,r=1103547991^e;if(i instanceof Array)for(let s=0,o;s<i.length;s++)o=i[s],n=Math.imul(n^o,2654435761),r=Math.imul(r^o,1597334677);else for(let s=0,o;s<i.length;s++)o=i.charCodeAt(s),n=Math.imul(n^o,2654435761),r=Math.imul(r^o,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}const mbe=i=>c0(i),C2=i=>c0(i),u0=(...i)=>c0(i);function LH(i,e=!1){const n=[];i.isNode===!0&&(n.push(i.id),i=i.getSelf());for(const{property:r,childNode:s}of f1(i))n.push(c0(r.slice(0,-4)),s.getCacheKey(e));return c0(n)}function*f1(i,e=!1){for(const n in i){if(n.startsWith("_")===!0)continue;const r=i[n];if(Array.isArray(r)===!0)for(let s=0;s<r.length;s++){const o=r[s];o&&(o.isNode===!0||e&&typeof o.toJSON=="function")&&(yield{property:n,index:s,childNode:o})}else if(r&&r.isNode===!0)yield{property:n,childNode:r};else if(typeof r=="object")for(const s in r){const o=r[s];o&&(o.isNode===!0||e&&typeof o.toJSON=="function")&&(yield{property:n,index:s,childNode:o})}}}const gbe=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),b3=new WeakMap;function ybe(i){return gbe.get(i)}function p1(i){if(i==null)return null;const e=typeof i;return i.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":i.isVector2===!0?"vec2":i.isVector3===!0?"vec3":i.isVector4===!0?"vec4":i.isMatrix2===!0?"mat2":i.isMatrix3===!0?"mat3":i.isMatrix4===!0?"mat4":i.isColor===!0?"color":i instanceof ArrayBuffer?"ArrayBuffer":null}function IH(i,...e){const n=i?i.slice(-4):void 0;return e.length===1&&(n==="vec2"?e=[e[0],e[0]]:n==="vec3"?e=[e[0],e[0],e[0]]:n==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),i==="color"?new St(...e):n==="vec2"?new Oe(...e):n==="vec3"?new K(...e):n==="vec4"?new Dt(...e):n==="mat2"?new rw(...e):n==="mat3"?new Vt(...e):n==="mat4"?new ln(...e):i==="bool"?e[0]||!1:i==="float"||i==="int"||i==="uint"?e[0]||0:i==="string"?e[0]||"":i==="ArrayBuffer"?xbe(e[0]):null}function DH(i){let e=b3.get(i);return e===void 0&&(e={},b3.set(i,e)),e}function vbe(i){let e="";const n=new Uint8Array(i);for(let r=0;r<n.length;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function xbe(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0)).buffer}const S3={VERTEX:"vertex",FRAGMENT:"fragment"},sn={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},Bl={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},_be=["fragment","vertex"],w3=["setup","analyze","generate"],T3=[..._be,"compute"],lm=["x","y","z","w"];let bbe=0,Ht=class extends dc{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=sn.NONE,this.updateBeforeType=sn.NONE,this.updateAfterType=sn.NONE,this.uuid=e1.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:bbe++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,n){return this.updateType=n,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,sn.FRAME)}onRenderUpdate(e){return this.onUpdate(e,sn.RENDER)}onObjectUpdate(e){return this.onUpdate(e,sn.OBJECT)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of f1(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const n of this.getChildren())n.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=u0(LH(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const n=this.getNodeType(e);return e.getElementType(n)}getMemberType(){return"void"}getNodeType(e){const n=e.getNodeProperties(this);return n.outputNode?n.outputNode.getNodeType(e):this.nodeType}getShared(e){const n=this.getHash(e);return e.getNodeFromHash(n)||this}setup(e){const n=e.getNodeProperties(this);let r=0;for(const s of this.getChildren())n["node"+r++]=s;return n.outputNode||null}analyze(e){if(e.increaseUsage(this)===1){const r=e.getNodeProperties(this);for(const s of Object.values(r))s&&s.isNode===!0&&s.build(e)}}generate(e,n){const{outputNode:r}=e.getNodeProperties(this);if(r&&r.isNode===!0)return r.build(e,n)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,n=null){const r=this.getShared(e);if(this!==r)return r.build(e,n);e.addNode(this),e.addChain(this);let s=null;const o=e.getBuildStage();if(o==="setup"){this.updateReference(e);const a=e.getNodeProperties(this);if(a.initialized!==!0){a.initialized=!0;const l=this.setup(e),c=l&&l.isNode===!0;for(const u of Object.values(a))if(u&&u.isNode===!0){if(u.parents===!0){const d=e.getNodeProperties(u);d.parents=d.parents||[],d.parents.push(this)}u.build(e)}c&&l.build(e),a.outputNode=l}s=a.outputNode||null}else if(o==="analyze")this.analyze(e);else if(o==="generate")if(this.generate.length===1){const l=this.getNodeType(e),c=e.getDataFromNode(this);s=c.snippet,s===void 0?c.generated===void 0?(c.generated=!0,s=this.generate(e)||"",c.snippet=s):(console.warn("THREE.Node: Recursion detected.",this),s=""):c.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),s=e.format(s,l,n)}else s=this.generate(e,n)||"";return e.removeChain(this),e.addSequentialNode(this),s}getSerializeChildren(){return f1(this)}serialize(e){const n=this.getSerializeChildren(),r={};for(const{property:s,index:o,childNode:a}of n)o!==void 0?(r[s]===void 0&&(r[s]=Number.isInteger(o)?[]:{}),r[s][o]=a.toJSON(e.meta).uuid):r[s]=a.toJSON(e.meta).uuid;Object.keys(r).length>0&&(e.inputNodes=r)}deserialize(e){if(e.inputNodes!==void 0){const n=e.meta.nodes;for(const r in e.inputNodes)if(Array.isArray(e.inputNodes[r])){const s=[];for(const o of e.inputNodes[r])s.push(n[o]);this[r]=s}else if(typeof e.inputNodes[r]=="object"){const s={};for(const o in e.inputNodes[r]){const a=e.inputNodes[r][o];s[o]=n[a]}this[r]=s}else{const s=e.inputNodes[r];this[r]=n[s]}}}toJSON(e){const{uuid:n,type:r}=this,s=e===void 0||typeof e=="string";s&&(e={textures:{},images:{},nodes:{}});let o=e.nodes[n];o===void 0&&(o={uuid:n,type:r,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},s!==!0&&(e.nodes[o.uuid]=o),this.serialize(o),delete o.meta);function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}if(s){const l=a(e.textures),c=a(e.images),u=a(e.nodes);l.length>0&&(o.textures=l),c.length>0&&(o.images=c),u.length>0&&(o.nodes=u)}return o}};class Y0 extends Ht{static get type(){return"ArrayElementNode"}constructor(e,n){super(),this.node=e,this.indexNode=n,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const n=this.indexNode.getNodeType(e),r=this.node.build(e),s=this.indexNode.build(e,!e.isVector(n)&&e.isInteger(n)?n:"uint");return`${r}[ ${s} ]`}}class OH extends Ht{static get type(){return"ConvertNode"}constructor(e,n){super(),this.node=e,this.convertTo=n}getNodeType(e){const n=this.node.getNodeType(e);let r=null;for(const s of this.convertTo.split("|"))(r===null||e.getTypeLength(n)===e.getTypeLength(s))&&(r=s);return r}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,n){const r=this.node,s=this.getNodeType(e),o=r.build(e,s);return e.format(o,s,n)}}class zi extends Ht{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,n){if(e.getBuildStage()==="generate"){const s=e.getVectorType(this.getNodeType(e,n)),o=e.getDataFromNode(this);if(o.propertyName!==void 0)return e.format(o.propertyName,s,n);if(s!=="void"&&n!=="void"&&this.hasDependencies(e)){const a=super.build(e,s),l=e.getVarFromNode(this,null,s),c=e.getPropertyName(l);return e.addLineFlowCode(`${c} = ${a}`,this),o.snippet=a,o.propertyName=c,e.format(o.propertyName,s,n)}}return super.build(e,n)}}class Sbe extends zi{static get type(){return"JoinNode"}constructor(e=[],n=null){super(n),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((n,r)=>n+e.getTypeLength(r.getNodeType(e)),0))}generate(e,n){const r=this.getNodeType(e),s=e.getTypeLength(r),o=this.nodes,a=e.getComponentType(r),l=[];let c=0;for(const d of o){if(c>=s){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${r}()' type.`);break}let h=d.getNodeType(e),f=e.getTypeLength(h),p;c+f>s&&(console.error(`THREE.TSL: Length of '${r}()' data exceeds maximum length of output type.`),f=s-c,h=e.getTypeFromLength(f)),c+=f,p=d.build(e,h);const m=e.getComponentType(h);m!==a&&(p=e.format(p,m,a)),l.push(p)}const u=`${e.getType(r)}( ${l.join(", ")} )`;return e.format(u,r,n)}}const wbe=lm.join("");class E3 extends Ht{static get type(){return"SplitNode"}constructor(e,n="x"){super(),this.node=e,this.components=n,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const n of this.components)e=Math.max(lm.indexOf(n)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,n){const r=this.node,s=e.getTypeLength(r.getNodeType(e));let o=null;if(s>1){let a=null;this.getVectorLength()>=s&&(a=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const c=r.build(e,a);this.components.length===s&&this.components===wbe.slice(0,this.components.length)?o=e.format(c,a,n):o=e.format(`${c}.${this.components}`,this.getNodeType(e),n)}else o=r.build(e,n);return o}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class Tbe extends zi{static get type(){return"SetNode"}constructor(e,n,r){super(),this.sourceNode=e,this.components=n,this.targetNode=r}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:n,components:r,targetNode:s}=this,o=this.getNodeType(e),a=e.getComponentType(s.getNodeType(e)),l=e.getTypeFromLength(r.length,a),c=s.build(e,l),u=n.build(e,o),d=e.getTypeLength(o),h=[];for(let f=0;f<d;f++){const p=lm[f];p===r[0]?(h.push(c),f+=r.length-1):h.push(u+"."+p)}return`${e.getType(o)}( ${h.join(", ")} )`}}class Ebe extends zi{static get type(){return"FlipNode"}constructor(e,n){super(),this.sourceNode=e,this.components=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:n,sourceNode:r}=this,s=this.getNodeType(e),o=r.build(e),a=e.getVarFromNode(this),l=e.getPropertyName(a);e.addLineFlowCode(l+" = "+o,this);const c=e.getTypeLength(s),u=[];let d=0;for(let h=0;h<c;h++){const f=lm[h];f===n[d]?(u.push("1.0 - "+(l+"."+f)),d++):u.push(l+"."+f)}return`${e.getType(s)}( ${u.join(", ")} )`}}class R2 extends Ht{static get type(){return"InputNode"}constructor(e,n=null){super(n),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?p1(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=p1(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=vbe(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?IH(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const M3=/float|u?int/;class fc extends R2{static get type(){return"ConstNode"}constructor(e,n=null){super(e,n),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,n){const r=this.getNodeType(e);return M3.test(r)&&M3.test(n)?e.generateConst(n,this.value):e.format(this.generateConst(e),r,n)}}class Mbe extends Ht{static get type(){return"MemberNode"}constructor(e,n){super(),this.node=e,this.property=n,this.isMemberNode=!0}getNodeType(e){return this.node.getMemberType(e,this.property)}generate(e){return this.node.build(e)+"."+this.property}}let Np=null;const Sf=new Map;function xe(i,e){if(Sf.has(i)){console.warn(`THREE.TSL: Redefinition of method chaining '${i}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${i} is not a function`);Sf.set(i,e)}const FH=i=>i.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),A3=i=>FH(i).split("").sort().join(""),BH={setup(i,e){const n=e.shift();return i(fw(n),...e)},get(i,e,n){if(typeof e=="string"&&i[e]===void 0){if(i.isStackNode!==!0&&e==="assign")return(...r)=>(Np.assign(n,...r),n);if(Sf.has(e)){const r=Sf.get(e);return i.isStackNode?(...s)=>n.add(r(...s)):(...s)=>r(n,...s)}else{if(e==="self")return i;if(e.endsWith("Assign")&&Sf.has(e.slice(0,e.length-6))){const r=Sf.get(e.slice(0,e.length-6));return i.isStackNode?(...s)=>n.assign(s[0],r(...s)):(...s)=>n.assign(r(n,...s))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=FH(e),De(new E3(n,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=A3(e.slice(3).toLowerCase()),r=>De(new Tbe(i,e,r));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=A3(e.slice(4).toLowerCase()),()=>De(new Ebe(De(i),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),De(new E3(i,e));if(/^\d+$/.test(e)===!0)return De(new Y0(n,new fc(Number(e),"uint")));if(/^get$/.test(e)===!0)return r=>De(new Mbe(n,r))}}}return Reflect.get(i,e,n)},set(i,e,n,r){return typeof e=="string"&&i[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(r[e].assign(n),!0):Reflect.set(i,e,n,r)}},dM=new WeakMap,C3=new WeakMap,Abe=function(i,e=null){const n=p1(i);if(n==="node"){let r=dM.get(i);return r===void 0&&(r=new Proxy(i,BH),dM.set(i,r),dM.set(r,r)),r}else{if(e===null&&(n==="float"||n==="boolean")||n&&n!=="shader"&&n!=="string")return De(lR(i,e));if(n==="shader")return Le(i)}return i},Cbe=function(i,e=null){for(const n in i)i[n]=De(i[n],e);return i},Rbe=function(i,e=null){const n=i.length;for(let r=0;r<n;r++)i[r]=De(i[r],e);return i},Pbe=function(i,e=null,n=null,r=null){const s=d=>De(r!==null?Object.assign(d,r):d);let o,a=e,l,c;function u(d){let h;return a?h=/[a-z]/i.test(a)?a+"()":a:h=i.type,l!==void 0&&d.length<l?(console.error(`THREE.TSL: "${h}" parameter length is less than minimum required.`),d.concat(new Array(l-d.length).fill(0))):c!==void 0&&d.length>c?(console.error(`THREE.TSL: "${h}" parameter length exceeds limit.`),d.slice(0,c)):d}return e===null?o=(...d)=>s(new i(...jf(u(d)))):n!==null?(n=De(n),o=(...d)=>s(new i(e,...jf(u(d)),n))):o=(...d)=>s(new i(e,...jf(u(d)))),o.setParameterLength=(...d)=>(d.length===1?l=c=d[0]:d.length===2&&([l,c]=d),o),o.setName=d=>(a=d,o),o},Nbe=function(i,...e){return De(new i(...jf(e)))};class kbe extends Ht{constructor(e,n){super(),this.shaderNode=e,this.inputNodes=n,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,n){return this.getOutputNode(e).getMemberType(e,n)}call(e){const{shaderNode:n,inputNodes:r}=this,s=e.getNodeProperties(n);if(s.onceOutput)return s.onceOutput;let o=null;if(n.layout){let a=C3.get(e.constructor);a===void 0&&(a=new WeakMap,C3.set(e.constructor,a));let l=a.get(n);l===void 0&&(l=De(e.buildFunctionNode(n)),a.set(n,l)),e.addInclude(l),o=De(l.call(r))}else{const a=n.jsFunc,l=r!==null||a.length>1?a(r||[],e):a(e);o=De(l)}return n.once&&(s.onceOutput=o),o}getOutputNode(e){const n=e.getNodeProperties(this);return n.outputNode===null&&(n.outputNode=this.setupOutput(e)),n.outputNode}setup(e){return this.getOutputNode(e)}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,n){return this.getOutputNode(e).build(e,n)}}class Lbe extends Ht{constructor(e,n){super(n),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return fw(e),De(new kbe(this,e))}setup(){return this.call()}}const Ibe=[!1,!0],Dbe=[0,1,2,3],Obe=[-1,-2],UH=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],P2=new Map;for(const i of Ibe)P2.set(i,new fc(i));const N2=new Map;for(const i of Dbe)N2.set(i,new fc(i,"uint"));const k2=new Map([...N2].map(i=>new fc(i.value,"int")));for(const i of Obe)k2.set(i,new fc(i,"int"));const dw=new Map([...k2].map(i=>new fc(i.value)));for(const i of UH)dw.set(i,new fc(i));for(const i of UH)dw.set(-i,new fc(-i));const hw={bool:P2,uint:N2,ints:k2,float:dw},R3=new Map([...P2,...dw]),lR=(i,e)=>R3.has(i)?R3.get(i):i.isNode===!0?i:new fc(i,e),Fbe=i=>{try{return i.getNodeType()}catch{return}},Vi=function(i,e=null){return(...n)=>{if((n.length===0||!["bool","float","int","uint"].includes(i)&&n.every(s=>typeof s!="object"))&&(n=[IH(i,...n)]),n.length===1&&e!==null&&e.has(n[0]))return De(e.get(n[0]));if(n.length===1){const s=lR(n[0],i);return Fbe(s)===i?De(s):De(new OH(s,i))}const r=n.map(s=>lR(s));return De(new Sbe(r,i))}},P3=i=>typeof i=="object"&&i!==null?i.value:i,Bbe=i=>i!=null?i.nodeType||i.convertTo||(typeof i=="string"?i:null):null;function Eg(i,e){return new Proxy(new Lbe(i,e),BH)}const De=(i,e=null)=>Abe(i,e),fw=(i,e=null)=>new Cbe(i,e),jf=(i,e=null)=>new Rbe(i,e),Re=(...i)=>new Pbe(...i),je=(...i)=>new Nbe(...i);let Ube=0;const Le=(i,e=null)=>{let n=null;e!==null&&(typeof e=="object"?n=e.return:(typeof e=="string"?n=e:console.error("THREE.TSL: Invalid layout type."),e=null));const r=new Eg(i,n),s=(...o)=>{let a;fw(o),o[0]&&o[0].isNode?a=[...o]:a=o[0];const l=r.call(a);return n==="void"&&l.toStack(),l};if(s.shaderNode=r,s.setLayout=o=>(r.setLayout(o),s),s.once=()=>(r.once=!0,s),e!==null){if(typeof e.inputs!="object"){const o={name:"fn"+Ube++,type:n,inputs:[]};for(const a in e)a!=="return"&&o.inputs.push({name:a,type:e[a]});e=o}s.setLayout(e)}return s};xe("toGlobal",i=>(i.global=!0,i));const m1=i=>{Np=i},zH=()=>Np,Ei=(...i)=>Np.If(...i);function VH(i){return Np&&Np.add(i),i}xe("toStack",VH);const zbe=new Vi("color"),be=new Vi("float",hw.float),Un=new Vi("int",hw.ints),Vbe=new Vi("uint",hw.uint),$H=new Vi("bool",hw.bool),qe=new Vi("vec2"),Ml=new Vi("ivec2"),$be=new Vi("uvec2"),Gbe=new Vi("bvec2"),Te=new Vi("vec3"),Hbe=new Vi("ivec3"),Wbe=new Vi("uvec3"),jbe=new Vi("bvec3"),Gt=new Vi("vec4"),qbe=new Vi("ivec4"),Xbe=new Vi("uvec4"),Kbe=new Vi("bvec4"),L2=new Vi("mat2"),os=new Vi("mat3"),qf=new Vi("mat4");xe("toColor",zbe);xe("toFloat",be);xe("toInt",Un);xe("toUint",Vbe);xe("toBool",$H);xe("toVec2",qe);xe("toIVec2",Ml);xe("toUVec2",$be);xe("toBVec2",Gbe);xe("toVec3",Te);xe("toIVec3",Hbe);xe("toUVec3",Wbe);xe("toBVec3",jbe);xe("toVec4",Gt);xe("toIVec4",qbe);xe("toUVec4",Xbe);xe("toBVec4",Kbe);xe("toMat2",L2);xe("toMat3",os);xe("toMat4",qf);const Ybe=Re(Y0).setParameterLength(2),Zbe=(i,e)=>De(new OH(De(i),e));xe("element",Ybe);xe("convert",Zbe);xe("append",i=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),VH(i)));class En extends Ht{static get type(){return"PropertyNode"}constructor(e,n=null,r=!1){super(e),this.name=n,this.varying=r,this.isPropertyNode=!0}getHash(e){return this.name||super.getHash(e)}isGlobal(){return!0}generate(e){let n;return this.varying===!0?(n=e.getVaryingFromNode(this,this.name),n.needsInterpolation=!0):n=e.getVarFromNode(this,this.name),e.getPropertyName(n)}}const Z0=(i,e)=>De(new En(i,e)),g1=(i,e)=>De(new En(i,e,!0)),Sn=je(En,"vec4","DiffuseColor"),N3=je(En,"vec3","EmissiveColor"),Nl=je(En,"float","Roughness"),y1=je(En,"float","Metalness"),cR=je(En,"float","Clearcoat"),v1=je(En,"float","ClearcoatRoughness"),wf=je(En,"vec3","Sheen"),I2=je(En,"float","SheenRoughness"),D2=je(En,"float","Iridescence"),GH=je(En,"float","IridescenceIOR"),HH=je(En,"float","IridescenceThickness"),uR=je(En,"float","AlphaT"),rd=je(En,"float","Anisotropy"),j_=je(En,"vec3","AnisotropyT"),Xf=je(En,"vec3","AnisotropyB"),$s=je(En,"color","SpecularColor"),x1=je(En,"float","SpecularF90"),dR=je(En,"float","Shininess"),Qg=je(En,"vec4","Output"),hM=je(En,"float","dashSize"),k3=je(En,"float","gapSize"),q_=je(En,"float","IOR"),hR=je(En,"float","Transmission"),WH=je(En,"float","Thickness"),jH=je(En,"float","AttenuationDistance"),qH=je(En,"color","AttenuationColor"),XH=je(En,"float","Dispersion");class KH extends Ht{static get type(){return"UniformGroupNode"}constructor(e,n=!1,r=1){super("string"),this.name=e,this.shared=n,this.order=r,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const Qbe=i=>new KH(i),O2=(i,e=0)=>new KH(i,!0,e),Jbe=O2("frame"),Ut=O2("render"),YH=Qbe("object");class Q0 extends R2{static get type(){return"UniformNode"}constructor(e,n=null){super(e,n),this.isUniformNode=!0,this.name="",this.groupNode=YH}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,n){const r=this.getSelf();return e=e.bind(r),super.onUpdate(s=>{const o=e(s,r);o!==void 0&&(this.value=o)},n)}generate(e,n){const r=this.getNodeType(e),s=this.getUniformHash(e);let o=e.getNodeFromHash(s);o===void 0&&(e.setHashNode(this,s),o=this);const a=o.getInputType(e),l=e.getUniformFromNode(o,a,e.shaderStage,this.name||e.context.label),c=e.getPropertyName(l);return e.context.label!==void 0&&delete e.context.label,e.format(c,r,n)}}const zt=(i,e)=>{const n=Bbe(e||i),r=i&&i.isNode===!0?i.node&&i.node.value||i.value:i;return De(new Q0(r,n))};class L3 extends zi{static get type(){return"ArrayNode"}constructor(e,n,r=null){super(e),this.count=n,this.values=r,this.isArrayNode=!0}getNodeType(e){return this.nodeType===null&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const n=this.getNodeType(e);return e.generateArray(n,this.count,this.values)}}const e1e=(...i)=>{let e;if(i.length===1){const n=i[0];e=new L3(null,n.length,n)}else{const n=i[0],r=i[1];e=new L3(n,r)}return De(e)};xe("toArray",(i,e)=>e1e(Array(e).fill(i)));class t1e extends zi{static get type(){return"AssignNode"}constructor(e,n){super(),this.targetNode=e,this.sourceNode=n}hasDependencies(){return!1}getNodeType(e,n){return n!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:n}=this;if(e.isAvailable("swizzleAssign")===!1&&n.isSplitNode&&n.components.length>1){const r=e.getTypeLength(n.node.getNodeType(e));return lm.join("").slice(0,r)!==n.components}return!1}generate(e,n){const{targetNode:r,sourceNode:s}=this,o=this.needsSplitAssign(e),a=r.getNodeType(e),l=r.context({assign:!0}).build(e),c=s.build(e,a),u=s.getNodeType(e),d=e.getDataFromNode(this);let h;if(d.initialized===!0)n!=="void"&&(h=l);else if(o){const f=e.getVarFromNode(this,null,a),p=e.getPropertyName(f);e.addLineFlowCode(`${p} = ${c}`,this);const m=r.node.context({assign:!0}).build(e);for(let y=0;y<r.components.length;y++){const v=r.components[y];e.addLineFlowCode(`${m}.${v} = ${p}[ ${y} ]`,this)}n!=="void"&&(h=l)}else h=`${l} = ${c}`,(n==="void"||u==="void")&&(e.addLineFlowCode(h,this),n!=="void"&&(h=l));return d.initialized=!0,e.format(h,a,n)}}const n1e=Re(t1e).setParameterLength(2);xe("assign",n1e);class i1e extends zi{static get type(){return"FunctionCallNode"}constructor(e=null,n={}){super(),this.functionNode=e,this.parameters=n}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const n=[],r=this.functionNode,s=r.getInputs(e),o=this.parameters,a=(c,u)=>{const d=u.type,h=d==="pointer";let f;return h?f="&"+c.build(e):f=c.build(e,d),f};if(Array.isArray(o)){if(o.length>s.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),o.length=s.length;else if(o.length<s.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");o.length<s.length;)o.push(be(0));for(let c=0;c<o.length;c++)n.push(a(o[c],s[c]))}else for(const c of s){const u=o[c.name];u!==void 0?n.push(a(u,c)):(console.error(`THREE.TSL: Input '${c.name}' not found in 'Fn()'.`),n.push(a(be(0),c)))}return`${r.build(e,"property")}( ${n.join(", ")} )`}}const r1e=(i,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?jf(e):fw(e[0]),De(new i1e(De(i),e)));xe("call",r1e);const s1e={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class ni extends zi{static get type(){return"OperatorNode"}constructor(e,n,r,...s){if(super(),s.length>0){let o=new ni(e,n,r);for(let a=0;a<s.length-1;a++)o=new ni(e,o,s[a]);n=o,r=s[s.length-1]}this.op=e,this.aNode=n,this.bNode=r,this.isOperatorNode=!0}getOperatorMethod(e,n){return e.getMethod(s1e[this.op],n)}getNodeType(e){const n=this.op,r=this.aNode,s=this.bNode,o=r.getNodeType(e),a=typeof s<"u"?s.getNodeType(e):null;if(o==="void"||a==="void")return"void";if(n==="%")return o;if(n==="~"||n==="&"||n==="|"||n==="^"||n===">>"||n==="<<")return e.getIntegerType(o);if(n==="!"||n==="&&"||n==="||"||n==="^^")return"bool";if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">="){const l=Math.max(e.getTypeLength(o),e.getTypeLength(a));return l>1?`bvec${l}`:"bool"}else{if(e.isMatrix(o)){if(a==="float")return o;if(e.isVector(a))return e.getVectorFromMatrix(o);if(e.isMatrix(a))return o}else if(e.isMatrix(a)){if(o==="float")return a;if(e.isVector(o))return e.getVectorFromMatrix(a)}return e.getTypeLength(a)>e.getTypeLength(o)?a:o}}generate(e,n){const r=this.op,s=this.aNode,o=this.bNode,a=this.getNodeType(e);let l=null,c=null;a!=="void"?(l=s.getNodeType(e),c=typeof o<"u"?o.getNodeType(e):null,r==="<"||r===">"||r==="<="||r===">="||r==="=="||r==="!="?e.isVector(l)?c=l:e.isVector(c)?l=c:l!==c&&(l=c="float"):r===">>"||r==="<<"?(l=a,c=e.changeComponentType(c,"uint")):r==="%"?(l=a,c=e.isInteger(l)&&e.isInteger(c)?c:l):e.isMatrix(l)?c==="float"?c="float":e.isVector(c)?c=e.getVectorFromMatrix(l):e.isMatrix(c)||(l=c=a):e.isMatrix(c)?l==="float"?l="float":e.isVector(l)?l=e.getVectorFromMatrix(c):l=c=a:l=c=a):l=c=a;const u=s.build(e,l),d=typeof o<"u"?o.build(e,c):null,h=e.getFunctionOperator(r);if(n!=="void"){const f=e.renderer.coordinateSystem===is;if(r==="=="||r==="!="||r==="<"||r===">"||r==="<="||r===">=")return f?e.isVector(l)?e.format(`${this.getOperatorMethod(e,n)}( ${u}, ${d} )`,a,n):e.format(`( ${u} ${r} ${d} )`,a,n):e.format(`( ${u} ${r} ${d} )`,a,n);if(r==="%")return e.isInteger(c)?e.format(`( ${u} % ${d} )`,a,n):e.format(`${this.getOperatorMethod(e,a)}( ${u}, ${d} )`,a,n);if(r==="!"||r==="~")return e.format(`(${r}${u})`,l,n);if(h)return e.format(`${h}( ${u}, ${d} )`,a,n);if(e.isMatrix(l)&&c==="float")return e.format(`( ${d} ${r} ${u} )`,a,n);if(l==="float"&&e.isMatrix(c))return e.format(`${u} ${r} ${d}`,a,n);{let p=`( ${u} ${r} ${d} )`;return!f&&a==="bool"&&e.isVector(l)&&e.isVector(c)&&(p=`all${p}`),e.format(p,a,n)}}else if(l!=="void")return h?e.format(`${h}( ${u}, ${d} )`,a,n):e.isMatrix(l)&&c==="float"?e.format(`${d} ${r} ${u}`,a,n):e.format(`${u} ${r} ${d}`,a,n)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const as=Re(ni,"+").setParameterLength(2,1/0).setName("add"),vs=Re(ni,"-").setParameterLength(2,1/0).setName("sub"),an=Re(ni,"*").setParameterLength(2,1/0).setName("mul"),nc=Re(ni,"/").setParameterLength(2,1/0).setName("div"),pw=Re(ni,"%").setParameterLength(2).setName("mod"),ZH=Re(ni,"==").setParameterLength(2).setName("equal"),o1e=Re(ni,"!=").setParameterLength(2).setName("notEqual"),a1e=Re(ni,"<").setParameterLength(2).setName("lessThan"),l1e=Re(ni,">").setParameterLength(2).setName("greaterThan"),c1e=Re(ni,"<=").setParameterLength(2).setName("lessThanEqual"),u1e=Re(ni,">=").setParameterLength(2).setName("greaterThanEqual"),d1e=Re(ni,"&&").setParameterLength(2,1/0).setName("and"),h1e=Re(ni,"||").setParameterLength(2,1/0).setName("or"),f1e=Re(ni,"!").setParameterLength(1).setName("not"),p1e=Re(ni,"^^").setParameterLength(2).setName("xor"),m1e=Re(ni,"&").setParameterLength(2).setName("bitAnd"),g1e=Re(ni,"~").setParameterLength(2).setName("bitNot"),y1e=Re(ni,"|").setParameterLength(2).setName("bitOr"),v1e=Re(ni,"^").setParameterLength(2).setName("bitXor"),x1e=Re(ni,"<<").setParameterLength(2).setName("shiftLeft"),_1e=Re(ni,">>").setParameterLength(2).setName("shiftRight"),b1e=Le(([i])=>(i.addAssign(1),i)),S1e=Le(([i])=>(i.subAssign(1),i)),w1e=Le(([i])=>{const e=Un(i).toConst();return i.addAssign(1),e}),T1e=Le(([i])=>{const e=Un(i).toConst();return i.subAssign(1),e});xe("add",as);xe("sub",vs);xe("mul",an);xe("div",nc);xe("mod",pw);xe("equal",ZH);xe("notEqual",o1e);xe("lessThan",a1e);xe("greaterThan",l1e);xe("lessThanEqual",c1e);xe("greaterThanEqual",u1e);xe("and",d1e);xe("or",h1e);xe("not",f1e);xe("xor",p1e);xe("bitAnd",m1e);xe("bitNot",g1e);xe("bitOr",y1e);xe("bitXor",v1e);xe("shiftLeft",x1e);xe("shiftRight",_1e);xe("incrementBefore",b1e);xe("decrementBefore",S1e);xe("increment",w1e);xe("decrement",T1e);const E1e=(i,e)=>(console.warn('THREE.TSL: "remainder()" is deprecated. Use "mod( int( ... ) )" instead.'),pw(i,e)),M1e=(i,e)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),pw(Un(i),Un(e)));xe("remainder",E1e);xe("modInt",M1e);class ae extends zi{static get type(){return"MathNode"}constructor(e,n,r=null,s=null){if(super(),(e===ae.MAX||e===ae.MIN)&&arguments.length>3){let o=new ae(e,n,r);for(let a=2;a<arguments.length-1;a++)o=new ae(e,o,arguments[a]);n=o,r=arguments[arguments.length-1],s=null}this.method=e,this.aNode=n,this.bNode=r,this.cNode=s,this.isMathNode=!0}getInputType(e){const n=this.aNode.getNodeType(e),r=this.bNode?this.bNode.getNodeType(e):null,s=this.cNode?this.cNode.getNodeType(e):null,o=e.isMatrix(n)?0:e.getTypeLength(n),a=e.isMatrix(r)?0:e.getTypeLength(r),l=e.isMatrix(s)?0:e.getTypeLength(s);return o>a&&o>l?n:a>l?r:l>o?s:n}getNodeType(e){const n=this.method;return n===ae.LENGTH||n===ae.DISTANCE||n===ae.DOT?"float":n===ae.CROSS?"vec3":n===ae.ALL||n===ae.ANY?"bool":n===ae.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}generate(e,n){let r=this.method;const s=this.getNodeType(e),o=this.getInputType(e),a=this.aNode,l=this.bNode,c=this.cNode,u=e.renderer.coordinateSystem;if(r===ae.TRANSFORM_DIRECTION){let d=a,h=l;e.isMatrix(d.getNodeType(e))?h=Gt(Te(h),0):d=Gt(Te(d),0);const f=an(d,h).xyz;return h0(f).build(e,n)}else{if(r===ae.NEGATE)return e.format("( - "+a.build(e,o)+" )",s,n);if(r===ae.ONE_MINUS)return vs(1,a).build(e,n);if(r===ae.RECIPROCAL)return nc(1,a).build(e,n);if(r===ae.DIFFERENCE)return So(vs(a,l)).build(e,n);{const d=[];return r===ae.CROSS?d.push(a.build(e,s),l.build(e,s)):u===is&&r===ae.STEP?d.push(a.build(e,e.getTypeLength(a.getNodeType(e))===1?"float":o),l.build(e,o)):u===is&&(r===ae.MIN||r===ae.MAX)?d.push(a.build(e,o),l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":o)):r===ae.REFRACT?d.push(a.build(e,o),l.build(e,o),c.build(e,"float")):r===ae.MIX?d.push(a.build(e,o),l.build(e,o),c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":o)):(u===mu&&r===ae.ATAN&&l!==null&&(r="atan2"),e.shaderStage!=="fragment"&&(r===ae.DFDX||r===ae.DFDY)&&(console.warn(`THREE.TSL: '${r}' is not supported in the ${e.shaderStage} stage.`),r="/*"+r+"*/"),d.push(a.build(e,o)),l!==null&&d.push(l.build(e,o)),c!==null&&d.push(c.build(e,o))),e.format(`${e.getMethod(r,s)}( ${d.join(", ")} )`,s,n)}}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}ae.ALL="all";ae.ANY="any";ae.RADIANS="radians";ae.DEGREES="degrees";ae.EXP="exp";ae.EXP2="exp2";ae.LOG="log";ae.LOG2="log2";ae.SQRT="sqrt";ae.INVERSE_SQRT="inversesqrt";ae.FLOOR="floor";ae.CEIL="ceil";ae.NORMALIZE="normalize";ae.FRACT="fract";ae.SIN="sin";ae.COS="cos";ae.TAN="tan";ae.ASIN="asin";ae.ACOS="acos";ae.ATAN="atan";ae.ABS="abs";ae.SIGN="sign";ae.LENGTH="length";ae.NEGATE="negate";ae.ONE_MINUS="oneMinus";ae.DFDX="dFdx";ae.DFDY="dFdy";ae.ROUND="round";ae.RECIPROCAL="reciprocal";ae.TRUNC="trunc";ae.FWIDTH="fwidth";ae.TRANSPOSE="transpose";ae.BITCAST="bitcast";ae.EQUALS="equals";ae.MIN="min";ae.MAX="max";ae.STEP="step";ae.REFLECT="reflect";ae.DISTANCE="distance";ae.DIFFERENCE="difference";ae.DOT="dot";ae.CROSS="cross";ae.POW="pow";ae.TRANSFORM_DIRECTION="transformDirection";ae.MIX="mix";ae.CLAMP="clamp";ae.REFRACT="refract";ae.SMOOTHSTEP="smoothstep";ae.FACEFORWARD="faceforward";const A1e=be(1e-6),C1e=be(Math.PI),R1e=Re(ae,ae.ALL).setParameterLength(1),P1e=Re(ae,ae.ANY).setParameterLength(1),N1e=Re(ae,ae.RADIANS).setParameterLength(1),k1e=Re(ae,ae.DEGREES).setParameterLength(1),QH=Re(ae,ae.EXP).setParameterLength(1),d0=Re(ae,ae.EXP2).setParameterLength(1),JH=Re(ae,ae.LOG).setParameterLength(1),jl=Re(ae,ae.LOG2).setParameterLength(1),F2=Re(ae,ae.SQRT).setParameterLength(1),L1e=Re(ae,ae.INVERSE_SQRT).setParameterLength(1),Md=Re(ae,ae.FLOOR).setParameterLength(1),B2=Re(ae,ae.CEIL).setParameterLength(1),h0=Re(ae,ae.NORMALIZE).setParameterLength(1),Pu=Re(ae,ae.FRACT).setParameterLength(1),ia=Re(ae,ae.SIN).setParameterLength(1),$c=Re(ae,ae.COS).setParameterLength(1),I1e=Re(ae,ae.TAN).setParameterLength(1),D1e=Re(ae,ae.ASIN).setParameterLength(1),O1e=Re(ae,ae.ACOS).setParameterLength(1),e8=Re(ae,ae.ATAN).setParameterLength(1,2),So=Re(ae,ae.ABS).setParameterLength(1),_1=Re(ae,ae.SIGN).setParameterLength(1),uu=Re(ae,ae.LENGTH).setParameterLength(1),F1e=Re(ae,ae.NEGATE).setParameterLength(1),B1e=Re(ae,ae.ONE_MINUS).setParameterLength(1),t8=Re(ae,ae.DFDX).setParameterLength(1),n8=Re(ae,ae.DFDY).setParameterLength(1),U1e=Re(ae,ae.ROUND).setParameterLength(1),z1e=Re(ae,ae.RECIPROCAL).setParameterLength(1),V1e=Re(ae,ae.TRUNC).setParameterLength(1),$1e=Re(ae,ae.FWIDTH).setParameterLength(1),G1e=Re(ae,ae.TRANSPOSE).setParameterLength(1),H1e=(i,e)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),ZH(i,e)),f0=Re(ae,ae.MIN).setParameterLength(2,1/0),Ls=Re(ae,ae.MAX).setParameterLength(2,1/0),i8=Re(ae,ae.STEP).setParameterLength(2),W1e=Re(ae,ae.REFLECT).setParameterLength(2),j1e=Re(ae,ae.DISTANCE).setParameterLength(2),q1e=Re(ae,ae.DIFFERENCE).setParameterLength(2),U2=Re(ae,ae.DOT).setParameterLength(2),r8=Re(ae,ae.CROSS).setParameterLength(2),mw=Re(ae,ae.POW).setParameterLength(2),s8=Re(ae,ae.POW,2).setParameterLength(1),X1e=Re(ae,ae.POW,3).setParameterLength(1),K1e=Re(ae,ae.POW,4).setParameterLength(1),Y1e=Re(ae,ae.TRANSFORM_DIRECTION).setParameterLength(2),Z1e=i=>an(_1(i),mw(So(i),1/3)),o8=i=>U2(i,i),Wn=Re(ae,ae.MIX).setParameterLength(3),ic=(i,e=0,n=1)=>De(new ae(ae.CLAMP,De(i),De(e),De(n))),Q1e=i=>ic(i),a8=Re(ae,ae.REFRACT).setParameterLength(3),vu=Re(ae,ae.SMOOTHSTEP).setParameterLength(3),J1e=Re(ae,ae.FACEFORWARD).setParameterLength(3),eSe=Le(([i])=>{const r=43758.5453,s=U2(i.xy,qe(12.9898,78.233)),o=pw(s,C1e);return Pu(ia(o).mul(r))}),tSe=(i,e,n)=>Wn(e,n,i),nSe=(i,e,n)=>vu(e,n,i),iSe=(i,e)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),e8(i,e));xe("all",R1e);xe("any",P1e);xe("equals",H1e);xe("radians",N1e);xe("degrees",k1e);xe("exp",QH);xe("exp2",d0);xe("log",JH);xe("log2",jl);xe("sqrt",F2);xe("inverseSqrt",L1e);xe("floor",Md);xe("ceil",B2);xe("normalize",h0);xe("fract",Pu);xe("sin",ia);xe("cos",$c);xe("tan",I1e);xe("asin",D1e);xe("acos",O1e);xe("atan",e8);xe("abs",So);xe("sign",_1);xe("length",uu);xe("lengthSq",o8);xe("negate",F1e);xe("oneMinus",B1e);xe("dFdx",t8);xe("dFdy",n8);xe("round",U1e);xe("reciprocal",z1e);xe("trunc",V1e);xe("fwidth",$1e);xe("atan2",iSe);xe("min",f0);xe("max",Ls);xe("step",i8);xe("reflect",W1e);xe("distance",j1e);xe("dot",U2);xe("cross",r8);xe("pow",mw);xe("pow2",s8);xe("pow3",X1e);xe("pow4",K1e);xe("transformDirection",Y1e);xe("mix",tSe);xe("clamp",ic);xe("refract",a8);xe("smoothstep",nSe);xe("faceForward",J1e);xe("difference",q1e);xe("saturate",Q1e);xe("cbrt",Z1e);xe("transpose",G1e);xe("rand",eSe);class rSe extends Ht{static get type(){return"ConditionalNode"}constructor(e,n,r=null){super(),this.condNode=e,this.ifNode=n,this.elseNode=r}getNodeType(e){const{ifNode:n,elseNode:r}=e.getNodeProperties(this);if(n===void 0)return this.setup(e),this.getNodeType(e);const s=n.getNodeType(e);if(r!==null){const o=r.getNodeType(e);if(e.getTypeLength(o)>e.getTypeLength(s))return o}return s}setup(e){const n=this.condNode.cache(),r=this.ifNode.cache(),s=this.elseNode?this.elseNode.cache():null,o=e.context.nodeBlock;e.getDataFromNode(r).parentNodeBlock=o,s!==null&&(e.getDataFromNode(s).parentNodeBlock=o);const a=e.getNodeProperties(this);a.condNode=n,a.ifNode=r.context({nodeBlock:r}),a.elseNode=s?s.context({nodeBlock:s}):null}generate(e,n){const r=this.getNodeType(e),s=e.getDataFromNode(this);if(s.nodeProperty!==void 0)return s.nodeProperty;const{condNode:o,ifNode:a,elseNode:l}=e.getNodeProperties(this),c=e.currentFunctionNode,u=n!=="void",d=u?Z0(r).build(e):"";s.nodeProperty=d;const h=o.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${h} ) {

`).addFlowTab();let f=a.build(e,r);if(f&&(u?f=d+" = "+f+";":(f="return "+f+";",c===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),f="// "+f))),e.removeFlowTab().addFlowCode(e.tab+"	"+f+`

`+e.tab+"}"),l!==null){e.addFlowCode(` else {

`).addFlowTab();let p=l.build(e,r);p&&(u?p=d+" = "+p+";":(p="return "+p+";",c===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),p="// "+p))),e.removeFlowTab().addFlowCode(e.tab+"	"+p+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(d,r,n)}}const rs=Re(rSe).setParameterLength(2,3);xe("select",rs);const sSe=(...i)=>(console.warn("THREE.TSL: cond() has been renamed to select()."),rs(...i));xe("cond",sSe);class l8 extends Ht{static get type(){return"ContextNode"}constructor(e,n={}){super(),this.isContextNode=!0,this.node=e,this.value=n}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){this.node.build(e)}setup(e){const n=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e);return e.setContext(n),r}generate(e,n){const r=e.getContext();e.setContext({...e.context,...this.value});const s=this.node.build(e,n);return e.setContext(r),s}}const z2=Re(l8).setParameterLength(1,2),oSe=(i,e)=>z2(i,{label:e});xe("context",z2);xe("label",oSe);class X_ extends Ht{static get type(){return"VarNode"}constructor(e,n=null,r=!1){super(),this.node=e,this.name=n,this.global=!0,this.isVarNode=!0,this.readOnly=r}getMemberType(e,n){return this.node.getMemberType(e,n)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:n,name:r,readOnly:s}=this,{renderer:o}=e,a=o.backend.isWebGPUBackend===!0;let l=!1,c=!1;s&&(l=e.isDeterministic(n),c=a?s:l);const u=e.getVectorType(this.getNodeType(e)),d=n.build(e,u),h=e.getVarFromNode(this,r,u,void 0,c),f=e.getPropertyName(h);let p=f;if(c)if(a)p=l?`const ${f}`:`let ${f}`;else{const m=e.getArrayCount(n);p=`const ${e.getVar(h.type,f,m)}`}return e.addLineFlowCode(`${p} = ${d}`,this),f}}const V2=Re(X_),aSe=(i,e=null)=>V2(i,e).toStack(),lSe=(i,e=null)=>V2(i,e,!0).toStack();xe("toVar",aSe);xe("toConst",lSe);const cSe=i=>(console.warn('TSL: "temp( node )" is deprecated. Use "Var( node )" or "node.toVar()" instead.'),V2(i));xe("temp",cSe);class uSe extends Ht{static get type(){return"VaryingNode"}constructor(e,n=null){super(),this.node=e,this.name=n,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null}isGlobal(){return!0}setInterpolation(e,n=null){return this.interpolationType=e,this.interpolationSampling=n,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const n=e.getNodeProperties(this);let r=n.varying;if(r===void 0){const s=this.name,o=this.getNodeType(e),a=this.interpolationType,l=this.interpolationSampling;n.varying=r=e.getVaryingFromNode(this,s,o,a,l),n.node=this.node}return r.needsInterpolation||(r.needsInterpolation=e.shaderStage==="fragment"),r}setup(e){this.setupVarying(e)}analyze(e){return this.setupVarying(e),this.node.analyze(e)}generate(e){const n=e.getNodeProperties(this),r=this.setupVarying(e),s=e.shaderStage==="fragment"&&n.reassignPosition===!0&&e.context.needsPositionReassign;if(n.propertyName===void 0||s){const o=this.getNodeType(e),a=e.getPropertyName(r,S3.VERTEX);e.flowNodeFromShaderStage(S3.VERTEX,this.node,o,a),n.propertyName=a,s?n.reassignPosition=!1:n.reassignPosition===void 0&&e.context.isPositionNodeInput&&(n.reassignPosition=!0)}return e.getPropertyName(r)}}const ba=Re(uSe).setParameterLength(1,2),dSe=i=>ba(i);xe("toVarying",ba);xe("toVertexStage",dSe);xe("varying",(...i)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),ba(...i)));xe("vertexStage",(...i)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),ba(...i)));const hSe=Le(([i])=>{const e=i.mul(.9478672986).add(.0521327014).pow(2.4),n=i.mul(.0773993808),r=i.lessThanEqual(.04045);return Wn(e,n,r)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),fSe=Le(([i])=>{const e=i.pow(.41666).mul(1.055).sub(.055),n=i.mul(12.92),r=i.lessThanEqual(.0031308);return Wn(e,n,r)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),J0="WorkingColorSpace",$2="OutputColorSpace";class gw extends zi{static get type(){return"ColorSpaceNode"}constructor(e,n,r){super("vec4"),this.colorNode=e,this.source=n,this.target=r}resolveColorSpace(e,n){return n===J0?rn.workingColorSpace:n===$2?e.context.outputColorSpace||e.renderer.outputColorSpace:n}setup(e){const{colorNode:n}=this,r=this.resolveColorSpace(e,this.source),s=this.resolveColorSpace(e,this.target);let o=n;return rn.enabled===!1||r===s||!r||!s||(rn.getTransfer(r)===Tn&&(o=Gt(hSe(o.rgb),o.a)),rn.getPrimaries(r)!==rn.getPrimaries(s)&&(o=Gt(os(rn._getMatrix(new Vt,r,s)).mul(o.rgb),o.a)),rn.getTransfer(s)===Tn&&(o=Gt(fSe(o.rgb),o.a))),o}}const pSe=i=>De(new gw(De(i),J0,$2)),mSe=i=>De(new gw(De(i),$2,J0)),gSe=(i,e)=>De(new gw(De(i),J0,e)),G2=(i,e)=>De(new gw(De(i),e,J0));xe("toOutputColorSpace",pSe);xe("toWorkingColorSpace",mSe);xe("workingToColorSpace",gSe);xe("colorSpaceToWorking",G2);let ySe=class extends Y0{static get type(){return"ReferenceElementNode"}constructor(e,n){super(e,n),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const n=super.generate(e),r=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(n,r,s)}};class c8 extends Ht{static get type(){return"ReferenceBaseNode"}constructor(e,n,r=null,s=null){super(),this.property=e,this.uniformType=n,this.object=r,this.count=s,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.updateType=sn.OBJECT}setGroup(e){return this.group=e,this}element(e){return De(new ySe(this,De(e)))}setNodeType(e){const n=zt(null,e).getSelf();this.group!==null&&n.setGroup(this.group),this.node=n}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:n}=this;let r=e[n[0]];for(let s=1;s<n.length;s++)r=r[n[s]];return r}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const vSe=(i,e,n)=>De(new c8(i,e,n));class xSe extends c8{static get type(){return"RendererReferenceNode"}constructor(e,n,r=null){super(e,n,r),this.renderer=r,this.setGroup(Ut)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const _Se=(i,e,n=null)=>De(new xSe(i,e,n));class bSe extends zi{static get type(){return"ToneMappingNode"}constructor(e,n=wSe,r=null){super("vec3"),this.toneMapping=e,this.exposureNode=n,this.colorNode=r}customCacheKey(){return u0(this.toneMapping)}setup(e){const n=this.colorNode||e.context.color,r=this.toneMapping;if(r===Ps)return n;let s=null;const o=e.renderer.library.getToneMappingFunction(r);return o!==null?s=Gt(o(n.rgb,this.exposureNode),n.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",r),s=n),s}}const SSe=(i,e,n)=>De(new bSe(i,De(e),De(n))),wSe=_Se("toneMappingExposure","float");xe("toneMapping",(i,e,n)=>SSe(e,n,i));class TSe extends R2{static get type(){return"BufferAttributeNode"}constructor(e,n=null,r=0,s=0){super(e,n),this.isBufferNode=!0,this.bufferType=n,this.bufferStride=r,this.bufferOffset=s,this.usage=Jb,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let n=e.globalCache.getData(this.value);return n===void 0&&(n={node:this},e.globalCache.setData(this.value,n)),n.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const n=this.getNodeType(e),r=this.value,s=e.getTypeLength(n),o=this.bufferStride||s,a=this.bufferOffset,l=r.isInterleavedBuffer===!0?r:new rG(r,o),c=new r2(l,s,a);l.setUsage(this.usage),this.attribute=c,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const n=this.getNodeType(e),r=e.getBufferAttributeFromNode(this,n),s=e.getPropertyName(r);let o=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=s,o=s):o=ba(this).build(e,n),o}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const H2=(i,e=null,n=0,r=0)=>De(new TSe(i,e,n,r)),ESe=(i,e=null,n=0,r=0)=>H2(i,e,n,r).setUsage(vf),I3=(i,e=null,n=0,r=0)=>H2(i,e,n,r).setInstanced(!0),D3=(i,e=null,n=0,r=0)=>ESe(i,e,n,r).setInstanced(!0);xe("toAttribute",i=>H2(i.value));class MSe extends Ht{static get type(){return"ComputeNode"}constructor(e,n,r=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=n,this.workgroupSize=r,this.dispatchCount=0,this.version=1,this.name="",this.updateBeforeType=sn.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}label(e){return this.name=e,this}updateDispatchCount(){const{count:e,workgroupSize:n}=this;let r=n[0];for(let s=1;s<n.length;s++)r*=n[s];this.dispatchCount=Math.ceil(e/r)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const n=this.computeNode.build(e);if(n){const r=e.getNodeProperties(this);r.outputComputeNode=n.outputNode,n.outputNode=null}return n}generate(e,n){const{shaderStage:r}=e;if(r==="compute"){const s=this.computeNode.build(e,"void");s!==""&&e.addLineFlowCode(s,this)}else{const o=e.getNodeProperties(this).outputComputeNode;if(o)return o.build(e,n)}}}const ASe=(i,e,n)=>De(new MSe(De(i),e,n));xe("compute",ASe);class CSe extends Ht{static get type(){return"CacheNode"}constructor(e,n=!0){super(),this.node=e,this.parent=n,this.isCacheNode=!0}getNodeType(e){const n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.getNodeType(e);return e.setCache(n),s}build(e,...n){const r=e.getCache(),s=e.getCacheFromNode(this,this.parent);e.setCache(s);const o=this.node.build(e,...n);return e.setCache(r),o}}const K_=(i,e)=>De(new CSe(De(i),e));xe("cache",K_);class RSe extends Ht{static get type(){return"BypassNode"}constructor(e,n){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=n}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const n=this.callNode.build(e,"void");return n!==""&&e.addLineFlowCode(n,this),this.outputNode.build(e)}}const PSe=Re(RSe).setParameterLength(2);xe("bypass",PSe);class u8 extends Ht{static get type(){return"RemapNode"}constructor(e,n,r,s=be(0),o=be(1)){super(),this.node=e,this.inLowNode=n,this.inHighNode=r,this.outLowNode=s,this.outHighNode=o,this.doClamp=!0}setup(){const{node:e,inLowNode:n,inHighNode:r,outLowNode:s,outHighNode:o,doClamp:a}=this;let l=e.sub(n).div(r.sub(n));return a===!0&&(l=l.clamp()),l.mul(o.sub(s)).add(s)}}const NSe=Re(u8,null,null,{doClamp:!1}).setParameterLength(3,5),kSe=Re(u8).setParameterLength(3,5);xe("remap",NSe);xe("remapClamp",kSe);class Y_ extends Ht{static get type(){return"ExpressionNode"}constructor(e="",n="void"){super(n),this.snippet=e}generate(e,n){const r=this.getNodeType(e),s=this.snippet;if(r==="void")e.addLineFlowCode(s,this);else return e.format(s,r,n)}}const kp=Re(Y_).setParameterLength(1,2),LSe=i=>(i?rs(i,kp("discard")):kp("discard")).toStack();xe("discard",LSe);class ISe extends zi{static get type(){return"RenderOutputNode"}constructor(e,n,r){super("vec4"),this.colorNode=e,this.toneMapping=n,this.outputColorSpace=r,this.isRenderOutputNode=!0}setup({context:e}){let n=this.colorNode||e.color;const r=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||Ps,s=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||qs;return r!==Ps&&(n=n.toneMapping(r)),s!==qs&&s!==rn.workingColorSpace&&(n=n.workingToColorSpace(s)),n}}const DSe=(i,e=null,n=null)=>De(new ISe(De(i),e,n));xe("renderOutput",DSe);class OSe extends zi{static get type(){return"DebugNode"}constructor(e,n=null){super(),this.node=e,this.callback=n}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const n=this.callback,r=this.node.build(e),s="--- TSL debug - "+e.shaderStage+" shader ---",o="-".repeat(s.length);let a="";return a+="// #"+s+`#
`,a+=e.flow.code.replace(/^\t/mg,"")+`
`,a+="/* ... */ "+r+` /* ... */
`,a+="// #"+o+`#
`,n!==null?n(e,a):console.log(a),r}}const FSe=(i,e=null)=>De(new OSe(De(i),e));xe("debug",FSe);class d8 extends Ht{static get type(){return"AttributeNode"}constructor(e,n=null){super(n),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let n=this.nodeType;if(n===null){const r=this.getAttributeName(e);if(e.hasGeometryAttribute(r)){const s=e.geometry.getAttribute(r);n=e.getTypeFromAttribute(s)}else n="float"}return n}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const n=this.getAttributeName(e),r=this.getNodeType(e);if(e.hasGeometryAttribute(n)===!0){const o=e.geometry.getAttribute(n),a=e.getTypeFromAttribute(o),l=e.getAttribute(n,a);return e.shaderStage==="vertex"?e.format(l.name,a,r):ba(this).build(e,r)}else return console.warn(`AttributeNode: Vertex attribute "${n}" not found on geometry.`),e.generateConst(r)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const xu=(i,e=null)=>De(new d8(i,e)),ev=(i=0)=>xu("uv"+(i>0?i:""),"vec2");class BSe extends Ht{static get type(){return"TextureSizeNode"}constructor(e,n=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=n}generate(e,n){const r=this.textureNode.build(e,"property"),s=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${r}, ${s} )`,this.getNodeType(e),n)}}const Kf=Re(BSe).setParameterLength(1,2);class USe extends Q0{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=sn.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,n=e.images,r=n&&n.length>0?n[0]&&n[0].image||n[0]:e.image;if(r&&r.width!==void 0){const{width:s,height:o}=r;this.value=Math.log2(Math.max(s,o))}}}const zSe=Re(USe).setParameterLength(1);class cm extends Q0{static get type(){return"TextureNode"}constructor(e,n=null,r=null,s=null){super(e),this.isTextureNode=!0,this.uvNode=n,this.levelNode=r,this.biasNode=s,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=sn.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(n===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===Dn?"uvec4":this.value.type===or?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return ev(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=zt(this.value.matrix)),this._matrixUniform.mul(Te(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?sn.OBJECT:sn.NONE,this}setupUV(e,n){const r=this.value;return e.isFlipY()&&(r.image instanceof ImageBitmap&&r.flipY===!0||r.isRenderTargetTexture===!0||r.isFramebufferTexture===!0||r.isDepthTexture===!0)&&(this.sampler?n=n.flipY():n=n.setY(Un(Kf(this,this.levelNode).y).sub(n.y).sub(1))),n}setup(e){const n=e.getNodeProperties(this);n.referenceNode=this.referenceNode;const r=this.value;if(!r||r.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let s=this.uvNode;(s===null||e.context.forceUVContext===!0)&&e.context.getUV&&(s=e.context.getUV(this,e)),s||(s=this.getDefaultUV()),this.updateMatrix===!0&&(s=this.getTransformedUV(s)),s=this.setupUV(e,s);let o=this.levelNode;o===null&&e.context.getTextureLevel&&(o=e.context.getTextureLevel(this)),n.uvNode=s,n.levelNode=o,n.biasNode=this.biasNode,n.compareNode=this.compareNode,n.gradNode=this.gradNode,n.depthNode=this.depthNode}generateUV(e,n){return n.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,n,r,s,o,a,l,c){const u=this.value;let d;return s?d=e.generateTextureLevel(u,n,r,s,a):o?d=e.generateTextureBias(u,n,r,o,a):c?d=e.generateTextureGrad(u,n,r,c,a):l?d=e.generateTextureCompare(u,n,r,l,a):this.sampler===!1?d=e.generateTextureLoad(u,n,r,a):d=e.generateTexture(u,n,r,a),d}generate(e,n){const r=this.value,s=e.getNodeProperties(this),o=super.generate(e,"property");if(/^sampler/.test(n))return o+"_sampler";if(e.isReference(n))return o;{const a=e.getDataFromNode(this);let l=a.propertyName;if(l===void 0){const{uvNode:d,levelNode:h,biasNode:f,compareNode:p,depthNode:m,gradNode:y}=s,v=this.generateUV(e,d),g=h?h.build(e,"float"):null,_=f?f.build(e,"float"):null,x=m?m.build(e,"int"):null,b=p?p.build(e,"float"):null,S=y?[y[0].build(e,"vec2"),y[1].build(e,"vec2")]:null,T=e.getVarFromNode(this);l=e.getPropertyName(T);const w=this.generateSnippet(e,o,v,g,_,x,b,S);e.addLineFlowCode(`${l} = ${w}`,this),a.snippet=w,a.propertyName=l}let c=l;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(r)&&(c=G2(kp(c,u),r.colorSpace).setup(e).build(e,u)),e.format(c,u,n)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const n=this.clone();return n.uvNode=De(e),n.referenceNode=this.getSelf(),De(n)}blur(e){const n=this.clone();n.biasNode=De(e).mul(zSe(n)),n.referenceNode=this.getSelf();const r=n.value;return n.generateMipmaps===!1&&(r&&r.generateMipmaps===!1||r.minFilter===Vn||r.magFilter===Vn)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),n.biasNode=null),De(n)}level(e){const n=this.clone();return n.levelNode=De(e),n.referenceNode=this.getSelf(),De(n)}size(e){return Kf(this,e)}bias(e){const n=this.clone();return n.biasNode=De(e),n.referenceNode=this.getSelf(),De(n)}compare(e){const n=this.clone();return n.compareNode=De(e),n.referenceNode=this.getSelf(),De(n)}grad(e,n){const r=this.clone();return r.gradNode=[De(e),De(n)],r.referenceNode=this.getSelf(),De(r)}depth(e){const n=this.clone();return n.depthNode=De(e),n.referenceNode=this.getSelf(),De(n)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,n=this._matrixUniform;n!==null&&(n.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}const dn=Re(cm).setParameterLength(1,4),Zo=(...i)=>dn(...i).setSampler(!1);class h8 extends Q0{static get type(){return"BufferNode"}constructor(e,n,r=0){super(e,n),this.isBufferNode=!0,this.bufferType=n,this.bufferCount=r}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const f8=(i,e,n)=>De(new h8(i,e,n));class VSe extends Y0{static get type(){return"UniformArrayElementNode"}constructor(e,n){super(e,n),this.isArrayBufferElementNode=!0}generate(e){const n=super.generate(e),r=this.getNodeType(),s=this.node.getPaddedType();return e.format(n,s,r)}}class $Se extends h8{static get type(){return"UniformArrayNode"}constructor(e,n=null){super(null),this.array=e,this.elementType=n===null?p1(e[0]):n,this.paddedType=this.getPaddedType(),this.updateType=sn.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let n="vec4";return e==="mat2"?n="mat2":/mat/.test(e)===!0?n="mat4":e.charAt(0)==="i"?n="ivec4":e.charAt(0)==="u"&&(n="uvec4"),n}update(){const{array:e,value:n}=this,r=this.elementType;if(r==="float"||r==="int"||r==="uint")for(let s=0;s<e.length;s++){const o=s*4;n[o]=e[s]}else if(r==="color")for(let s=0;s<e.length;s++){const o=s*4,a=e[s];n[o]=a.r,n[o+1]=a.g,n[o+2]=a.b||0}else if(r==="mat2")for(let s=0;s<e.length;s++){const o=s*4,a=e[s];n[o]=a.elements[0],n[o+1]=a.elements[1],n[o+2]=a.elements[2],n[o+3]=a.elements[3]}else if(r==="mat3")for(let s=0;s<e.length;s++){const o=s*16,a=e[s];n[o]=a.elements[0],n[o+1]=a.elements[1],n[o+2]=a.elements[2],n[o+4]=a.elements[3],n[o+5]=a.elements[4],n[o+6]=a.elements[5],n[o+8]=a.elements[6],n[o+9]=a.elements[7],n[o+10]=a.elements[8],n[o+15]=1}else if(r==="mat4")for(let s=0;s<e.length;s++){const o=s*16,a=e[s];for(let l=0;l<a.elements.length;l++)n[o+l]=a.elements[l]}else for(let s=0;s<e.length;s++){const o=s*4,a=e[s];n[o]=a.x,n[o+1]=a.y,n[o+2]=a.z||0,n[o+3]=a.w||0}}setup(e){const n=this.array.length,r=this.elementType;let s=Float32Array;const o=this.paddedType,a=e.getTypeLength(o);return r.charAt(0)==="i"&&(s=Int32Array),r.charAt(0)==="u"&&(s=Uint32Array),this.value=new s(n*a),this.bufferCount=n,this.bufferType=o,super.setup(e)}element(e){return De(new VSe(this,De(e)))}}const Fa=(i,e)=>De(new $Se(i,e));class GSe extends Ht{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const yw=Re(GSe).setParameterLength(1),p8=zt(0,"uint").label("u_cameraIndex").setGroup(O2("cameraIndex")).toVarying("v_cameraIndex"),ad=zt("float").label("cameraNear").setGroup(Ut).onRenderUpdate(({camera:i})=>i.near),ld=zt("float").label("cameraFar").setGroup(Ut).onRenderUpdate(({camera:i})=>i.far),W2=Le(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const n=[];for(const s of i.cameras)n.push(s.projectionMatrix);e=Fa(n).setGroup(Ut).label("cameraProjectionMatrices").element(i.isMultiViewCamera?yw("gl_ViewID_OVR"):p8).toVar("cameraProjectionMatrix")}else e=zt("mat4").label("cameraProjectionMatrix").setGroup(Ut).onRenderUpdate(({camera:n})=>n.projectionMatrix);return e}).once()(),pc=Le(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const n=[];for(const s of i.cameras)n.push(s.matrixWorldInverse);e=Fa(n).setGroup(Ut).label("cameraViewMatrices").element(i.isMultiViewCamera?yw("gl_ViewID_OVR"):p8).toVar("cameraViewMatrix")}else e=zt("mat4").label("cameraViewMatrix").setGroup(Ut).onRenderUpdate(({camera:n})=>n.matrixWorldInverse);return e}).once()(),HSe=zt(new K).label("cameraPosition").setGroup(Ut).onRenderUpdate(({camera:i},e)=>e.value.setFromMatrixPosition(i.matrixWorld)),O3=new V0;class Pn extends Ht{static get type(){return"Object3DNode"}constructor(e,n=null){super(),this.scope=e,this.object3d=n,this.updateType=sn.OBJECT,this._uniformNode=new Q0(null)}getNodeType(){const e=this.scope;if(e===Pn.WORLD_MATRIX)return"mat4";if(e===Pn.POSITION||e===Pn.VIEW_POSITION||e===Pn.DIRECTION||e===Pn.SCALE)return"vec3";if(e===Pn.RADIUS)return"float"}update(e){const n=this.object3d,r=this._uniformNode,s=this.scope;if(s===Pn.WORLD_MATRIX)r.value=n.matrixWorld;else if(s===Pn.POSITION)r.value=r.value||new K,r.value.setFromMatrixPosition(n.matrixWorld);else if(s===Pn.SCALE)r.value=r.value||new K,r.value.setFromMatrixScale(n.matrixWorld);else if(s===Pn.DIRECTION)r.value=r.value||new K,n.getWorldDirection(r.value);else if(s===Pn.VIEW_POSITION){const o=e.camera;r.value=r.value||new K,r.value.setFromMatrixPosition(n.matrixWorld),r.value.applyMatrix4(o.matrixWorldInverse)}else if(s===Pn.RADIUS){const o=e.object.geometry;o.boundingSphere===null&&o.computeBoundingSphere(),O3.copy(o.boundingSphere).applyMatrix4(n.matrixWorld),r.value=O3.radius}}generate(e){const n=this.scope;return n===Pn.WORLD_MATRIX?this._uniformNode.nodeType="mat4":n===Pn.POSITION||n===Pn.VIEW_POSITION||n===Pn.DIRECTION||n===Pn.SCALE?this._uniformNode.nodeType="vec3":n===Pn.RADIUS&&(this._uniformNode.nodeType="float"),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Pn.WORLD_MATRIX="worldMatrix";Pn.POSITION="position";Pn.SCALE="scale";Pn.VIEW_POSITION="viewPosition";Pn.DIRECTION="direction";Pn.RADIUS="radius";const WSe=Re(Pn,Pn.POSITION).setParameterLength(1);class Do extends Pn{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}Do.DIRECTION;const Wd=je(Do,Do.WORLD_MATRIX);Do.POSITION;Do.SCALE;Do.VIEW_POSITION;Do.RADIUS;const jSe=zt(new Vt).onObjectUpdate(({object:i},e)=>e.value.getNormalMatrix(i.matrixWorld)),vw=Le(i=>i.renderer.overrideNodes.modelViewMatrix||qSe).once()().toVar("modelViewMatrix"),qSe=pc.mul(Wd),F3=Le(i=>(i.context.isHighPrecisionModelViewMatrix=!0,zt("mat4").onObjectUpdate(({object:e,camera:n})=>e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),B3=Le(i=>{const e=i.context.isHighPrecisionModelViewMatrix;return zt("mat3").onObjectUpdate(({object:n,camera:r})=>(e!==!0&&n.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,n.matrixWorld),n.normalMatrix.getNormalMatrix(n.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),xw=xu("position","vec3"),zr=xw.toVarying("positionLocal"),U3=xw.toVarying("positionPrevious"),p0=Wd.mul(zr).xyz.toVarying("v_positionWorld").context({needsPositionReassign:!0}),m8=zr.transformDirection(Wd).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection").context({needsPositionReassign:!0}),Fi=Le(i=>i.context.setupPositionView(),"vec3").once()().toVarying("v_positionView").context({needsPositionReassign:!0}),ai=Fi.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class XSe extends Ht{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:n,material:r}=e;return n.coordinateSystem===is&&r.side===On?"false":e.getFrontFacing()}}const KSe=je(XSe),_w=be(KSe).mul(2).sub(1),g8=xu("normal","vec3"),Ya=Le(i=>i.geometry.hasAttribute("normal")===!1?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),Te(0,1,0)):g8,"vec3").once()().toVar("normalLocal"),YSe=Fi.dFdx().cross(Fi.dFdy()).normalize().toVar("normalFlat"),ya=Le(i=>{let e;return i.material.flatShading===!0?e=YSe:e=ba(v8(Ya),"v_normalView").normalize(),e},"vec3").once()().toVar("normalView"),y8=Le(i=>{let e=ya.transformDirection(pc);return i.material.flatShading!==!0&&(e=ba(e,"v_normalWorld")),e},"vec3").once()().normalize().toVar("normalWorld"),Di=Le(i=>{let e=i.context.setupNormal().context({getUV:null});return i.material.flatShading!==!0&&(e=e.mul(_w)),e},"vec3").once()().toVar("transformedNormalView"),j2=Di.transformDirection(pc).toVar("transformedNormalWorld"),Mg=Le(i=>{let e=i.context.setupClearcoatNormal().context({getUV:null});return i.material.flatShading!==!0&&(e=e.mul(_w)),e},"vec3").once()().toVar("transformedClearcoatNormalView"),ZSe=Le(([i,e=Wd])=>{const n=os(e),r=i.div(Te(n[0].dot(n[0]),n[1].dot(n[1]),n[2].dot(n[2])));return n.mul(r).xyz}),v8=Le(([i],e)=>{const n=e.renderer.overrideNodes.modelNormalViewMatrix;if(n!==null)return n.transformDirection(i);const r=jSe.mul(i);return pc.transformDirection(r)}),z3=new ks,fM=new ln,QSe=zt(0).onReference(({material:i})=>i).onObjectUpdate(({material:i})=>i.refractionRatio),pM=zt(1).onReference(({material:i})=>i).onObjectUpdate(function({material:i,scene:e}){return i.envMap?i.envMapIntensity:e.environmentIntensity}),x8=zt(new ln).onReference(function(i){return i.material}).onObjectUpdate(function({material:i,scene:e}){const n=e.environment!==null&&i.envMap===null?e.environmentRotation:i.envMapRotation;return n?(z3.copy(n),fM.makeRotationFromEuler(z3)):fM.identity(),fM}),JSe=ai.negate().reflect(Di),ewe=ai.negate().refract(Di,QSe),twe=JSe.transformDirection(pc).toVar("reflectVector"),nwe=ewe.transformDirection(pc).toVar("reflectVector");class iwe extends cm{static get type(){return"CubeTextureNode"}constructor(e,n=null,r=null,s=null){super(e,n,r,s),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===pa?twe:e.mapping===ma?nwe:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Te(0,0,0))}setUpdateMatrix(){}setupUV(e,n){const r=this.value;return(e.renderer.coordinateSystem===mu||!r.isRenderTargetTexture)&&(n=Te(n.x.negate(),n.yz)),x8.mul(n)}generateUV(e,n){return n.build(e,"vec3")}}const m0=Re(iwe).setParameterLength(1,4).setName("cubeTexture");class rwe extends Y0{static get type(){return"ReferenceElementNode"}constructor(e,n){super(e,n),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const n=super.generate(e),r=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(n,r,s)}}class q2 extends Ht{static get type(){return"ReferenceNode"}constructor(e,n,r=null,s=null){super(),this.property=e,this.uniformType=n,this.object=r,this.count=s,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.name=null,this.updateType=sn.OBJECT}element(e){return De(new rwe(this,De(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let n=null;this.count!==null?n=f8(null,e,this.count):Array.isArray(this.getValueFromReference())?n=Fa(null,e):e==="texture"?n=dn(null):e==="cubeTexture"?n=m0(null):n=zt(null,e),this.group!==null&&n.setGroup(this.group),this.name!==null&&n.label(this.name),this.node=n.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:n}=this;let r=e[n[0]];for(let s=1;s<n.length;s++)r=r[n[s]];return r}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const In=(i,e,n)=>De(new q2(i,e,n)),V3=(i,e,n,r)=>De(new q2(i,e,r,n));class swe extends q2{static get type(){return"MaterialReferenceNode"}constructor(e,n,r=null){super(e,n,r),this.material=r,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const Wc=(i,e,n=null)=>De(new swe(i,e,n)),_8=Le(i=>(i.geometry.hasAttribute("tangent")===!1&&i.geometry.computeTangents(),xu("tangent","vec4")))(),X2=_8.xyz.toVar("tangentLocal"),b8=vw.mul(Gt(X2,0)).xyz.toVarying("v_tangentView").normalize().toVar("tangentView"),owe=Le(([i,e],n)=>{let r=i.mul(_8.w).xyz;return n.material.flatShading!==!0&&(r=ba(i,e)),r}).once(),awe=owe(ya.cross(b8),"v_bitangentView").normalize().toVar("bitangentView"),Ag=os(b8,awe,ya),lwe=(()=>{let i=Xf.cross(ai);return i=i.cross(Xf).normalize(),i=Wn(i,Di,rd.mul(Nl.oneMinus()).oneMinus().pow2().pow2()).normalize(),i})(),cwe=Le(i=>{const{eye_pos:e,surf_norm:n,mapN:r,uv:s}=i,o=e.dFdx(),a=e.dFdy(),l=s.dFdx(),c=s.dFdy(),u=n,d=a.cross(u),h=u.cross(o),f=d.mul(l.x).add(h.mul(c.x)),p=d.mul(l.y).add(h.mul(c.y)),m=f.dot(f).max(p.dot(p)),y=_w.mul(m.inverseSqrt());return as(f.mul(r.x,y),p.mul(r.y,y),u.mul(r.z)).normalize()});class uwe extends zi{static get type(){return"NormalMapNode"}constructor(e,n=null){super("vec3"),this.node=e,this.scaleNode=n,this.normalMapType=tc}setup(e){const{normalMapType:n,scaleNode:r}=this;let s=this.node.mul(2).sub(1);r!==null&&(s=Te(s.xy.mul(r),s.z));let o=null;return n===Y$?o=v8(s):n===tc&&(e.hasGeometryAttribute("tangent")===!0?o=Ag.mul(s).normalize():o=cwe({eye_pos:Fi,surf_norm:ya,mapN:s,uv:ev()})),o}}const $3=Re(uwe).setParameterLength(1,2),dwe=Le(({textureNode:i,bumpScale:e})=>{const n=s=>i.cache().context({getUV:o=>s(o.uvNode||ev()),forceUVContext:!0}),r=be(n(s=>s));return qe(be(n(s=>s.add(s.dFdx()))).sub(r),be(n(s=>s.add(s.dFdy()))).sub(r)).mul(e)}),hwe=Le(i=>{const{surf_pos:e,surf_norm:n,dHdxy:r}=i,s=e.dFdx().normalize(),o=e.dFdy().normalize(),a=n,l=o.cross(a),c=a.cross(s),u=s.dot(l).mul(_w),d=u.sign().mul(r.x.mul(l).add(r.y.mul(c)));return u.abs().mul(n).sub(d).normalize()});class fwe extends zi{static get type(){return"BumpMapNode"}constructor(e,n=null){super("vec3"),this.textureNode=e,this.scaleNode=n}setup(){const e=this.scaleNode!==null?this.scaleNode:1,n=dwe({textureNode:this.textureNode,bumpScale:e});return hwe({surf_pos:Fi,surf_norm:ya,dHdxy:n})}}const pwe=Re(fwe).setParameterLength(1,2),G3=new Map;class _e extends Ht{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,n){let r=G3.get(e);return r===void 0&&(r=Wc(e,n),G3.set(e,r)),r}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const n=e.context.material,r=this.scope;let s=null;if(r===_e.COLOR){const o=n.color!==void 0?this.getColor(r):Te();n.map&&n.map.isTexture===!0?s=o.mul(this.getTexture("map")):s=o}else if(r===_e.OPACITY){const o=this.getFloat(r);n.alphaMap&&n.alphaMap.isTexture===!0?s=o.mul(this.getTexture("alpha")):s=o}else if(r===_e.SPECULAR_STRENGTH)n.specularMap&&n.specularMap.isTexture===!0?s=this.getTexture("specular").r:s=be(1);else if(r===_e.SPECULAR_INTENSITY){const o=this.getFloat(r);n.specularIntensityMap&&n.specularIntensityMap.isTexture===!0?s=o.mul(this.getTexture(r).a):s=o}else if(r===_e.SPECULAR_COLOR){const o=this.getColor(r);n.specularColorMap&&n.specularColorMap.isTexture===!0?s=o.mul(this.getTexture(r).rgb):s=o}else if(r===_e.ROUGHNESS){const o=this.getFloat(r);n.roughnessMap&&n.roughnessMap.isTexture===!0?s=o.mul(this.getTexture(r).g):s=o}else if(r===_e.METALNESS){const o=this.getFloat(r);n.metalnessMap&&n.metalnessMap.isTexture===!0?s=o.mul(this.getTexture(r).b):s=o}else if(r===_e.EMISSIVE){const o=this.getFloat("emissiveIntensity"),a=this.getColor(r).mul(o);n.emissiveMap&&n.emissiveMap.isTexture===!0?s=a.mul(this.getTexture(r)):s=a}else if(r===_e.NORMAL)n.normalMap?(s=$3(this.getTexture("normal"),this.getCache("normalScale","vec2")),s.normalMapType=n.normalMapType):n.bumpMap?s=pwe(this.getTexture("bump").r,this.getFloat("bumpScale")):s=ya;else if(r===_e.CLEARCOAT){const o=this.getFloat(r);n.clearcoatMap&&n.clearcoatMap.isTexture===!0?s=o.mul(this.getTexture(r).r):s=o}else if(r===_e.CLEARCOAT_ROUGHNESS){const o=this.getFloat(r);n.clearcoatRoughnessMap&&n.clearcoatRoughnessMap.isTexture===!0?s=o.mul(this.getTexture(r).r):s=o}else if(r===_e.CLEARCOAT_NORMAL)n.clearcoatNormalMap?s=$3(this.getTexture(r),this.getCache(r+"Scale","vec2")):s=ya;else if(r===_e.SHEEN){const o=this.getColor("sheenColor").mul(this.getFloat("sheen"));n.sheenColorMap&&n.sheenColorMap.isTexture===!0?s=o.mul(this.getTexture("sheenColor").rgb):s=o}else if(r===_e.SHEEN_ROUGHNESS){const o=this.getFloat(r);n.sheenRoughnessMap&&n.sheenRoughnessMap.isTexture===!0?s=o.mul(this.getTexture(r).a):s=o,s=s.clamp(.07,1)}else if(r===_e.ANISOTROPY)if(n.anisotropyMap&&n.anisotropyMap.isTexture===!0){const o=this.getTexture(r);s=L2(Zm.x,Zm.y,Zm.y.negate(),Zm.x).mul(o.rg.mul(2).sub(qe(1)).normalize().mul(o.b))}else s=Zm;else if(r===_e.IRIDESCENCE_THICKNESS){const o=In("1","float",n.iridescenceThicknessRange);if(n.iridescenceThicknessMap){const a=In("0","float",n.iridescenceThicknessRange);s=o.sub(a).mul(this.getTexture(r).g).add(a)}else s=o}else if(r===_e.TRANSMISSION){const o=this.getFloat(r);n.transmissionMap?s=o.mul(this.getTexture(r).r):s=o}else if(r===_e.THICKNESS){const o=this.getFloat(r);n.thicknessMap?s=o.mul(this.getTexture(r).g):s=o}else if(r===_e.IOR)s=this.getFloat(r);else if(r===_e.LIGHT_MAP)s=this.getTexture(r).rgb.mul(this.getFloat("lightMapIntensity"));else if(r===_e.AO)s=this.getTexture(r).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{const o=this.getNodeType(e);s=this.getCache(r,o)}return s}}_e.ALPHA_TEST="alphaTest";_e.COLOR="color";_e.OPACITY="opacity";_e.SHININESS="shininess";_e.SPECULAR="specular";_e.SPECULAR_STRENGTH="specularStrength";_e.SPECULAR_INTENSITY="specularIntensity";_e.SPECULAR_COLOR="specularColor";_e.REFLECTIVITY="reflectivity";_e.ROUGHNESS="roughness";_e.METALNESS="metalness";_e.NORMAL="normal";_e.CLEARCOAT="clearcoat";_e.CLEARCOAT_ROUGHNESS="clearcoatRoughness";_e.CLEARCOAT_NORMAL="clearcoatNormal";_e.EMISSIVE="emissive";_e.ROTATION="rotation";_e.SHEEN="sheen";_e.SHEEN_ROUGHNESS="sheenRoughness";_e.ANISOTROPY="anisotropy";_e.IRIDESCENCE="iridescence";_e.IRIDESCENCE_IOR="iridescenceIOR";_e.IRIDESCENCE_THICKNESS="iridescenceThickness";_e.IOR="ior";_e.TRANSMISSION="transmission";_e.THICKNESS="thickness";_e.ATTENUATION_DISTANCE="attenuationDistance";_e.ATTENUATION_COLOR="attenuationColor";_e.LINE_SCALE="scale";_e.LINE_DASH_SIZE="dashSize";_e.LINE_GAP_SIZE="gapSize";_e.LINE_WIDTH="linewidth";_e.LINE_DASH_OFFSET="dashOffset";_e.POINT_SIZE="size";_e.DISPERSION="dispersion";_e.LIGHT_MAP="light";_e.AO="ao";const mwe=je(_e,_e.ALPHA_TEST),gwe=je(_e,_e.COLOR),ywe=je(_e,_e.SHININESS),vwe=je(_e,_e.EMISSIVE),S8=je(_e,_e.OPACITY),xwe=je(_e,_e.SPECULAR),H3=je(_e,_e.SPECULAR_INTENSITY),_we=je(_e,_e.SPECULAR_COLOR),Z_=je(_e,_e.SPECULAR_STRENGTH),mM=je(_e,_e.REFLECTIVITY),bwe=je(_e,_e.ROUGHNESS),Swe=je(_e,_e.METALNESS),wwe=je(_e,_e.NORMAL),Twe=je(_e,_e.CLEARCOAT),Ewe=je(_e,_e.CLEARCOAT_ROUGHNESS),Mwe=je(_e,_e.CLEARCOAT_NORMAL),Awe=je(_e,_e.ROTATION),Cwe=je(_e,_e.SHEEN),Rwe=je(_e,_e.SHEEN_ROUGHNESS),Pwe=je(_e,_e.ANISOTROPY),Nwe=je(_e,_e.IRIDESCENCE),kwe=je(_e,_e.IRIDESCENCE_IOR),Lwe=je(_e,_e.IRIDESCENCE_THICKNESS),Iwe=je(_e,_e.TRANSMISSION),Dwe=je(_e,_e.THICKNESS),Owe=je(_e,_e.IOR),Fwe=je(_e,_e.ATTENUATION_DISTANCE),Bwe=je(_e,_e.ATTENUATION_COLOR),Uwe=je(_e,_e.LINE_SCALE),zwe=je(_e,_e.LINE_DASH_SIZE),Vwe=je(_e,_e.LINE_GAP_SIZE);_e.LINE_WIDTH;const $we=je(_e,_e.LINE_DASH_OFFSET),Gwe=je(_e,_e.POINT_SIZE),Hwe=je(_e,_e.DISPERSION),w8=je(_e,_e.LIGHT_MAP),Wwe=je(_e,_e.AO),Zm=zt(new Oe).onReference(function(i){return i.material}).onRenderUpdate(function({material:i}){this.value.set(i.anisotropy*Math.cos(i.anisotropyRotation),i.anisotropy*Math.sin(i.anisotropyRotation))}),T8=Le(i=>i.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class jn extends Ht{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const n=this.getNodeType(e),r=this.scope;let s;if(r===jn.VERTEX)s=e.getVertexIndex();else if(r===jn.INSTANCE)s=e.getInstanceIndex();else if(r===jn.DRAW)s=e.getDrawIndex();else if(r===jn.INVOCATION_LOCAL)s=e.getInvocationLocalIndex();else if(r===jn.INVOCATION_SUBGROUP)s=e.getInvocationSubgroupIndex();else if(r===jn.SUBGROUP)s=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+r);let o;return e.shaderStage==="vertex"||e.shaderStage==="compute"?o=s:o=ba(this).build(e,n),o}}jn.VERTEX="vertex";jn.INSTANCE="instance";jn.SUBGROUP="subgroup";jn.INVOCATION_LOCAL="invocationLocal";jn.INVOCATION_SUBGROUP="invocationSubgroup";jn.DRAW="draw";const jwe=je(jn,jn.VERTEX),K2=je(jn,jn.INSTANCE);jn.SUBGROUP;jn.INVOCATION_SUBGROUP;jn.INVOCATION_LOCAL;const qwe=je(jn,jn.DRAW);class Xwe extends Ht{static get type(){return"InstanceNode"}constructor(e,n,r=null){super("void"),this.count=e,this.instanceMatrix=n,this.instanceColor=r,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=sn.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{count:n,instanceMatrix:r,instanceColor:s}=this;let{instanceMatrixNode:o,instanceColorNode:a}=this;if(o===null){if(n<=1e3)o=f8(r.array,"mat4",Math.max(n,1)).element(K2);else{const c=new the(r.array,16,1);this.buffer=c;const u=r.usage===vf?D3:I3,d=[u(c,"vec4",16,0),u(c,"vec4",16,4),u(c,"vec4",16,8),u(c,"vec4",16,12)];o=qf(...d)}this.instanceMatrixNode=o}if(s&&a===null){const c=new fde(s.array,3),u=s.usage===vf?D3:I3;this.bufferColor=c,a=Te(u(c,"vec3",3,0)),this.instanceColorNode=a}const l=o.mul(zr).xyz;if(zr.assign(l),e.hasGeometryAttribute("normal")){const c=ZSe(Ya,o);Ya.assign(c)}this.instanceColorNode!==null&&g1("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==vf&&this.buffer!==null&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==vf&&this.bufferColor!==null&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}class Kwe extends Xwe{static get type(){return"InstancedMeshNode"}constructor(e){const{count:n,instanceMatrix:r,instanceColor:s}=e;super(n,r,s),this.instancedMesh=e}}const Ywe=Re(Kwe).setParameterLength(1);class Zwe extends Ht{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=K2:this.batchingIdNode=qwe);const r=Le(([m])=>{const y=Un(Kf(Zo(this.batchMesh._indirectTexture),0).x),v=Un(m).mod(y),g=Un(m).div(y);return Zo(this.batchMesh._indirectTexture,Ml(v,g)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(Un(this.batchingIdNode)),s=this.batchMesh._matricesTexture,o=Un(Kf(Zo(s),0).x),a=be(r).mul(4).toInt().toVar(),l=a.mod(o),c=a.div(o),u=qf(Zo(s,Ml(l,c)),Zo(s,Ml(l.add(1),c)),Zo(s,Ml(l.add(2),c)),Zo(s,Ml(l.add(3),c))),d=this.batchMesh._colorsTexture;if(d!==null){const y=Le(([v])=>{const g=Un(Kf(Zo(d),0).x),_=v,x=_.mod(g),b=_.div(g);return Zo(d,Ml(x,b)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(r);g1("vec3","vBatchColor").assign(y)}const h=os(u);zr.assign(u.mul(zr));const f=Ya.div(Te(h[0].dot(h[0]),h[1].dot(h[1]),h[2].dot(h[2]))),p=h.mul(f).xyz;Ya.assign(p),e.hasGeometryAttribute("tangent")&&X2.mulAssign(h)}}const Qwe=Re(Zwe).setParameterLength(1),W3=new WeakMap;class Jwe extends Ht{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=sn.OBJECT,this.skinIndexNode=xu("skinIndex","uvec4"),this.skinWeightNode=xu("skinWeight","vec4"),this.bindMatrixNode=In("bindMatrix","mat4"),this.bindMatrixInverseNode=In("bindMatrixInverse","mat4"),this.boneMatricesNode=V3("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=zr,this.toPositionNode=zr,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,n=this.positionNode){const{skinIndexNode:r,skinWeightNode:s,bindMatrixNode:o,bindMatrixInverseNode:a}=this,l=e.element(r.x),c=e.element(r.y),u=e.element(r.z),d=e.element(r.w),h=o.mul(n),f=as(l.mul(s.x).mul(h),c.mul(s.y).mul(h),u.mul(s.z).mul(h),d.mul(s.w).mul(h));return a.mul(f).xyz}getSkinnedNormal(e=this.boneMatricesNode,n=Ya){const{skinIndexNode:r,skinWeightNode:s,bindMatrixNode:o,bindMatrixInverseNode:a}=this,l=e.element(r.x),c=e.element(r.y),u=e.element(r.z),d=e.element(r.w);let h=as(s.x.mul(l),s.y.mul(c),s.z.mul(u),s.w.mul(d));return h=a.mul(h).mul(o),h.transformDirection(n).xyz}getPreviousSkinnedPosition(e){const n=e.object;return this.previousBoneMatricesNode===null&&(n.skeleton.previousBoneMatrices=new Float32Array(n.skeleton.boneMatrices),this.previousBoneMatricesNode=V3("skeleton.previousBoneMatrices","mat4",n.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,U3)}needsPreviousBoneMatrices(e){const n=e.renderer.getMRT();return n&&n.has("velocity")||DH(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&U3.assign(this.getPreviousSkinnedPosition(e));const n=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(n),e.hasGeometryAttribute("normal")){const r=this.getSkinnedNormal();Ya.assign(r),e.hasGeometryAttribute("tangent")&&X2.assign(r)}return n}generate(e,n){if(n!=="void")return super.generate(e,n)}update(e){const n=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;W3.get(n)!==e.frameId&&(W3.set(n,e.frameId),this.previousBoneMatricesNode!==null&&n.previousBoneMatrices.set(n.boneMatrices),n.update())}}const eTe=i=>De(new Jwe(i));class tTe extends Ht{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode("i".charCodeAt(0)+e)}getProperties(e){const n=e.getNodeProperties(this);if(n.stackNode!==void 0)return n;const r={};for(let a=0,l=this.params.length-1;a<l;a++){const c=this.params[a],u=c.isNode!==!0&&c.name||this.getVarName(a),d=c.isNode!==!0&&c.type||"int";r[u]=kp(u,d)}const s=e.addStack();n.returnsNode=this.params[this.params.length-1](r,e),n.stackNode=s;const o=this.params[0];return o.isNode!==!0&&typeof o.update=="function"&&(n.updateNode=Le(this.params[0].update)(r)),e.removeStack(),n}getNodeType(e){const{returnsNode:n}=this.getProperties(e);return n?n.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const n=this.getProperties(e),r=this.params,s=n.stackNode;for(let l=0,c=r.length-1;l<c;l++){const u=r[l];let d=!1,h=null,f=null,p=null,m=null,y=null,v=null;u.isNode?u.getNodeType(e)==="bool"?(d=!0,m="bool",f=u.build(e,m)):(m="int",p=this.getVarName(l),h="0",f=u.build(e,m),y="<"):(m=u.type||"int",p=u.name||this.getVarName(l),h=u.start,f=u.end,y=u.condition,v=u.update,typeof h=="number"?h=e.generateConst(m,h):h&&h.isNode&&(h=h.build(e,m)),typeof f=="number"?f=e.generateConst(m,f):f&&f.isNode&&(f=f.build(e,m)),h!==void 0&&f===void 0?(h=h+" - 1",f="0",y=">="):f!==void 0&&h===void 0&&(h="0",y="<"),y===void 0&&(Number(h)>Number(f)?y=">=":y="<"));let g;if(d)g=`while ( ${f} )`;else{const _={start:h,end:f},x=_.start,b=_.end;let S;const T=()=>y.includes("<")?"+=":"-=";if(v!=null)switch(typeof v){case"function":S=e.flowStagesNode(n.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":S=p+" "+T()+" "+e.generateConst(m,v);break;case"string":S=p+" "+v;break;default:v.isNode?S=p+" "+T()+" "+v.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),S="break /* invalid update */")}else m==="int"||m==="uint"?v=y.includes("<")?"++":"--":v=T()+" 1.",S=p+" "+v;const w=e.getVar(m,p)+" = "+x,E=p+" "+y+" "+b;g=`for ( ${w}; ${E}; ${S} )`}e.addFlowCode((l===0?`
`:"")+e.tab+g+` {

`).addFlowTab()}const o=s.build(e,"void"),a=n.returnsNode?n.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+o);for(let l=0,c=this.params.length-1;l<c;l++)e.addFlowCode((l===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),a}}const sa=(...i)=>De(new tTe(jf(i,"int"))).toStack(),nTe=()=>kp("break").toStack(),gM=new WeakMap,zs=new Dt,j3=Le(({bufferMap:i,influence:e,stride:n,width:r,depth:s,offset:o})=>{const a=Un(jwe).mul(n).add(o),l=a.div(r),c=a.sub(l.mul(r));return Zo(i,Ml(c,l)).depth(s).xyz.mul(e)});function iTe(i){const e=i.morphAttributes.position!==void 0,n=i.morphAttributes.normal!==void 0,r=i.morphAttributes.color!==void 0,s=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,o=s!==void 0?s.length:0;let a=gM.get(i);if(a===void 0||a.count!==o){let _=function(){v.dispose(),gM.delete(i),i.removeEventListener("dispose",_)};var l=_;a!==void 0&&a.texture.dispose();const c=i.morphAttributes.position||[],u=i.morphAttributes.normal||[],d=i.morphAttributes.color||[];let h=0;e===!0&&(h=1),n===!0&&(h=2),r===!0&&(h=3);let f=i.attributes.position.count*h,p=1;const m=4096;f>m&&(p=Math.ceil(f/m),f=m);const y=new Float32Array(f*p*4*o),v=new ew(y,f,p,o);v.type=wi,v.needsUpdate=!0;const g=h*4;for(let x=0;x<o;x++){const b=c[x],S=u[x],T=d[x],w=f*p*4*x;for(let E=0;E<b.count;E++){const A=E*g;e===!0&&(zs.fromBufferAttribute(b,E),y[w+A+0]=zs.x,y[w+A+1]=zs.y,y[w+A+2]=zs.z,y[w+A+3]=0),n===!0&&(zs.fromBufferAttribute(S,E),y[w+A+4]=zs.x,y[w+A+5]=zs.y,y[w+A+6]=zs.z,y[w+A+7]=0),r===!0&&(zs.fromBufferAttribute(T,E),y[w+A+8]=zs.x,y[w+A+9]=zs.y,y[w+A+10]=zs.z,y[w+A+11]=T.itemSize===4?zs.w:1)}}a={count:o,texture:v,stride:h,size:new Oe(f,p)},gM.set(i,a),i.addEventListener("dispose",_)}return a}class rTe extends Ht{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=zt(1),this.updateType=sn.OBJECT}setup(e){const{geometry:n}=e,r=n.morphAttributes.position!==void 0,s=n.hasAttribute("normal")&&n.morphAttributes.normal!==void 0,o=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,a=o!==void 0?o.length:0,{texture:l,stride:c,size:u}=iTe(n);r===!0&&zr.mulAssign(this.morphBaseInfluence),s===!0&&Ya.mulAssign(this.morphBaseInfluence);const d=Un(u.width);sa(a,({i:h})=>{const f=be(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?f.assign(Zo(this.mesh.morphTexture,Ml(Un(h).add(1),Un(K2))).r):f.assign(In("morphTargetInfluences","float").element(h).toVar()),Ei(f.notEqual(0),()=>{r===!0&&zr.addAssign(j3({bufferMap:l,influence:f,stride:c,width:d,depth:h,offset:Un(0)})),s===!0&&Ya.addAssign(j3({bufferMap:l,influence:f,stride:c,width:d,depth:h,offset:Un(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((n,r)=>n+r,0)}}const sTe=Re(rTe).setParameterLength(1);class um extends Ht{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class oTe extends um{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class aTe extends l8{static get type(){return"LightingContextNode"}constructor(e,n=null,r=null,s=null){super(e),this.lightingModel=n,this.backdropNode=r,this.backdropAlphaNode=s,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:n}=this,r=Te().toVar("directDiffuse"),s=Te().toVar("directSpecular"),o=Te().toVar("indirectDiffuse"),a=Te().toVar("indirectSpecular"),l={directDiffuse:r,directSpecular:s,indirectDiffuse:o,indirectSpecular:a};return{radiance:Te().toVar("radiance"),irradiance:Te().toVar("irradiance"),iblIrradiance:Te().toVar("iblIrradiance"),ambientOcclusion:be(1).toVar("ambientOcclusion"),reflectedLight:l,backdrop:e,backdropAlpha:n}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const lTe=Re(aTe);class cTe extends um{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}let Qm,Jm;class Li extends Ht{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===Li.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=sn.NONE;return(this.scope===Li.SIZE||this.scope===Li.VIEWPORT)&&(e=sn.RENDER),this.updateType=e,e}update({renderer:e}){const n=e.getRenderTarget();this.scope===Li.VIEWPORT?n!==null?Jm.copy(n.viewport):(e.getViewport(Jm),Jm.multiplyScalar(e.getPixelRatio())):n!==null?(Qm.width=n.width,Qm.height=n.height):e.getDrawingBufferSize(Qm)}setup(){const e=this.scope;let n=null;return e===Li.SIZE?n=zt(Qm||(Qm=new Oe)):e===Li.VIEWPORT?n=zt(Jm||(Jm=new Dt)):n=qe(bw.div(fR)),n}generate(e){if(this.scope===Li.COORDINATE){let n=e.getFragCoord();if(e.isFlipY()){const r=e.getNodeProperties(fR).outputNode.build(e);n=`${e.getType("vec2")}( ${n}.x, ${r}.y - ${n}.y )`}return n}return super.generate(e)}}Li.COORDINATE="coordinate";Li.VIEWPORT="viewport";Li.SIZE="size";Li.UV="uv";const Yf=je(Li,Li.UV),fR=je(Li,Li.SIZE),bw=je(Li,Li.COORDINATE),Jg=je(Li,Li.VIEWPORT);Jg.zw;Jg.xy;const eg=new Oe;class E8 extends cm{static get type(){return"ViewportTextureNode"}constructor(e=Yf,n=null,r=null){r===null&&(r=new yde,r.minFilter=_s),super(r,e,n),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=sn.FRAME}updateBefore(e){const n=e.renderer;n.getDrawingBufferSize(eg);const r=this.value;(r.image.width!==eg.width||r.image.height!==eg.height)&&(r.image.width=eg.width,r.image.height=eg.height,r.needsUpdate=!0);const s=r.generateMipmaps;r.generateMipmaps=this.generateMipmaps,n.copyFramebufferToTexture(r),r.generateMipmaps=s}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const M8=Re(E8,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let yM=null;class uTe extends E8{static get type(){return"ViewportDepthTextureNode"}constructor(e=Yf,n=null){yM===null&&(yM=new ro),super(e,n,yM)}}const dTe=Re(uTe).setParameterLength(0,2);class Ss extends Ht{static get type(){return"ViewportDepthNode"}constructor(e,n=null){super("float"),this.scope=e,this.valueNode=n,this.isViewportDepthNode=!0}generate(e){const{scope:n}=this;return n===Ss.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:n}=this,r=this.valueNode;let s=null;if(n===Ss.DEPTH_BASE)r!==null&&(s=R8().assign(r));else if(n===Ss.DEPTH)e.isPerspectiveCamera?s=hTe(Fi.z,ad,ld):s=ey(Fi.z,ad,ld);else if(n===Ss.LINEAR_DEPTH)if(r!==null)if(e.isPerspectiveCamera){const o=A8(r,ad,ld);s=ey(o,ad,ld)}else s=r;else s=ey(Fi.z,ad,ld);return s}}Ss.DEPTH_BASE="depthBase";Ss.DEPTH="depth";Ss.LINEAR_DEPTH="linearDepth";const ey=(i,e,n)=>i.add(e).div(e.sub(n)),hTe=(i,e,n)=>e.add(i).mul(n).div(n.sub(e).mul(i)),A8=(i,e,n)=>e.mul(n).div(n.sub(e).mul(i).sub(n)),C8=(i,e,n)=>{e=e.max(1e-6).toVar();const r=jl(i.negate().div(e)),s=jl(n.div(e));return r.div(s)},R8=Re(Ss,Ss.DEPTH_BASE),P8=je(Ss,Ss.DEPTH),fTe=Re(Ss,Ss.LINEAR_DEPTH).setParameterLength(0,1);dTe();P8.assign=i=>R8(i);class Po extends Ht{static get type(){return"ClippingNode"}constructor(e=Po.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const n=e.clippingContext,{intersectionPlanes:r,unionPlanes:s}=n;return this.hardwareClipping=e.material.hardwareClipping,this.scope===Po.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(r,s):this.scope===Po.HARDWARE?this.setupHardwareClipping(s,e):this.setupDefault(r,s)}setupAlphaToCoverage(e,n){return Le(()=>{const r=be().toVar("distanceToPlane"),s=be().toVar("distanceToGradient"),o=be(1).toVar("clipOpacity"),a=n.length;if(this.hardwareClipping===!1&&a>0){const c=Fa(n);sa(a,({i:u})=>{const d=c.element(u);r.assign(Fi.dot(d.xyz).negate().add(d.w)),s.assign(r.fwidth().div(2)),o.mulAssign(vu(s.negate(),s,r))})}const l=e.length;if(l>0){const c=Fa(e),u=be(1).toVar("intersectionClipOpacity");sa(l,({i:d})=>{const h=c.element(d);r.assign(Fi.dot(h.xyz).negate().add(h.w)),s.assign(r.fwidth().div(2)),u.mulAssign(vu(s.negate(),s,r).oneMinus())}),o.mulAssign(u.oneMinus())}Sn.a.mulAssign(o),Sn.a.equal(0).discard()})()}setupDefault(e,n){return Le(()=>{const r=n.length;if(this.hardwareClipping===!1&&r>0){const o=Fa(n);sa(r,({i:a})=>{const l=o.element(a);Fi.dot(l.xyz).greaterThan(l.w).discard()})}const s=e.length;if(s>0){const o=Fa(e),a=$H(!0).toVar("clipped");sa(s,({i:l})=>{const c=o.element(l);a.assign(Fi.dot(c.xyz).greaterThan(c.w).and(a))}),a.discard()}})()}setupHardwareClipping(e,n){const r=e.length;return n.enableHardwareClipping(r),Le(()=>{const s=Fa(e),o=yw(n.getClipDistance());sa(r,({i:a})=>{const l=s.element(a),c=Fi.dot(l.xyz).sub(l.w).negate();o.element(a).assign(c)})})()}}Po.ALPHA_TO_COVERAGE="alphaToCoverage";Po.DEFAULT="default";Po.HARDWARE="hardware";const pTe=()=>De(new Po),mTe=()=>De(new Po(Po.ALPHA_TO_COVERAGE)),gTe=()=>De(new Po(Po.HARDWARE)),yTe=.05,q3=Le(([i])=>Pu(an(1e4,ia(an(17,i.x).add(an(.1,i.y)))).mul(as(.1,So(ia(an(13,i.y).add(i.x))))))),X3=Le(([i])=>q3(qe(q3(i.xy),i.z))),vTe=Le(([i])=>{const e=Ls(uu(t8(i.xyz)),uu(n8(i.xyz))),n=be(1).div(be(yTe).mul(e)).toVar("pixScale"),r=qe(d0(Md(jl(n))),d0(B2(jl(n)))),s=qe(X3(Md(r.x.mul(i.xyz))),X3(Md(r.y.mul(i.xyz)))),o=Pu(jl(n)),a=as(an(o.oneMinus(),s.x),an(o,s.y)),l=f0(o,o.oneMinus()),c=Te(a.mul(a).div(an(2,l).mul(vs(1,l))),a.sub(an(.5,l)).div(vs(1,l)),vs(1,vs(1,a).mul(vs(1,a)).div(an(2,l).mul(vs(1,l))))),u=a.lessThan(l.oneMinus()).select(a.lessThan(l).select(c.x,c.y),c.z);return ic(u,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class xTe extends d8{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const n=this.getAttributeName(e),r=e.hasGeometryAttribute(n);let s;return r===!0?s=super.generate(e):s=e.generateConst(this.nodeType,new Dt(1,1,1,1)),s}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const _Te=(i=0)=>De(new xTe(i));class er extends $r{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+LH(this)}build(e){this.setup(e)}setupObserver(e){return new pbe(e)}setup(e){e.context.setupNormal=()=>this.setupNormal(e),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const n=e.renderer,r=n.getRenderTarget();e.addStack();const s=this.vertexNode||this.setupVertex(e);e.stack.outputNode=s,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let o;const a=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(r!==null?r.depthBuffer===!0&&this.setupDepth(e):n.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const l=this.setupLighting(e);a!==null&&e.stack.add(a);const c=Gt(l,Sn.a).max(0);o=this.setupOutput(e,c),Qg.assign(o);const u=this.outputNode!==null;if(u&&(o=this.outputNode),r!==null){const d=n.getMRT(),h=this.mrtNode;d!==null?(u&&Qg.assign(o),o=d,h!==null&&(o=d.merge(h))):h!==null&&(o=h)}}else{let l=this.fragmentNode;l.isOutputStructNode!==!0&&(l=Gt(l)),o=this.setupOutput(e,l)}e.stack.outputNode=o,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:n,intersectionPlanes:r}=e.clippingContext;let s=null;if(n.length>0||r.length>0){const o=e.renderer.samples;this.alphaToCoverage&&o>1?s=mTe():e.stack.add(pTe())}return s}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const n=e.clippingContext.unionPlanes.length;n>0&&n<=8&&e.isAvailable("clipDistance")&&(e.stack.add(gTe()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:n,camera:r}=e;let s=this.depthNode;if(s===null){const o=n.getMRT();o&&o.has("depth")?s=o.get("depth"):n.logarithmicDepthBuffer===!0&&(r.isPerspectiveCamera?s=C8(Fi.z,ad,ld):s=ey(Fi.z,ad,ld))}s!==null&&P8.assign(s).toStack()}setupPositionView(){return vw.mul(zr).xyz}setupModelViewProjection(){return W2.mul(Fi)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),T8}setupPosition(e){const{object:n,geometry:r}=e;if((r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color)&&sTe(n).toStack(),n.isSkinnedMesh===!0&&eTe(n).toStack(),this.displacementMap){const s=Wc("displacementMap","texture"),o=Wc("displacementScale","float"),a=Wc("displacementBias","float");zr.addAssign(Ya.normalize().mul(s.x.mul(o).add(a)))}return n.isBatchedMesh&&Qwe(n).toStack(),n.isInstancedMesh&&n.instanceMatrix&&n.instanceMatrix.isInstancedBufferAttribute===!0&&Ywe(n).toStack(),this.positionNode!==null&&zr.assign(this.positionNode.context({isPositionNodeInput:!0})),zr}setupDiffuseColor({object:e,geometry:n}){let r=this.colorNode?Gt(this.colorNode):gwe;this.vertexColors===!0&&n.hasAttribute("color")&&(r=r.mul(_Te())),e.instanceColor&&(r=g1("vec3","vInstanceColor").mul(r)),e.isBatchedMesh&&e._colorsTexture&&(r=g1("vec3","vBatchColor").mul(r)),Sn.assign(r);const s=this.opacityNode?be(this.opacityNode):S8;if(Sn.a.assign(Sn.a.mul(s)),this.alphaTestNode!==null||this.alphaTest>0){const o=this.alphaTestNode!==null?be(this.alphaTestNode):mwe;Sn.a.lessThanEqual(o).discard()}this.alphaHash===!0&&Sn.a.lessThan(vTe(zr)).discard(),this.transparent===!1&&this.blending===eo&&this.alphaToCoverage===!1&&Sn.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?Te(0):Sn.rgb}setupNormal(){return this.normalNode?Te(this.normalNode):wwe}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?Wc("envMap","cubeTexture"):Wc("envMap","texture")),e}setupLightMap(e){let n=null;return e.material.lightMap&&(n=new cTe(w8)),n}setupLights(e){const n=[],r=this.setupEnvironment(e);r&&r.isLightingNode&&n.push(r);const s=this.setupLightMap(e);if(s&&s.isLightingNode&&n.push(s),this.aoNode!==null||e.material.aoMap){const a=this.aoNode!==null?this.aoNode:Wwe;n.push(new oTe(a))}let o=this.lightsNode||e.lightsNode;return n.length>0&&(o=e.renderer.lighting.createNode([...o.getLights(),...n])),o}setupLightingModel(){}setupLighting(e){const{material:n}=e,{backdropNode:r,backdropAlphaNode:s,emissiveNode:o}=this,l=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let c=this.setupOutgoingLight(e);if(l&&l.getScope().hasLights){const u=this.setupLightingModel(e)||null;c=lTe(l,u,r,s)}else r!==null&&(c=Te(s!==null?Wn(c,r,s):r));return(o&&o.isNode===!0||n.emissive&&n.emissive.isColor===!0)&&(N3.assign(Te(o||vwe)),c=c.add(N3)),c}setupFog(e,n){const r=e.fogNode;return r&&(Qg.assign(n),n=Gt(r)),n}setupOutput(e,n){return this.fog===!0&&(n=this.setupFog(e,n)),n}setDefaultValues(e){for(const r in e){const s=e[r];this[r]===void 0&&(this[r]=s,s&&s.clone&&(this[r]=s.clone()))}const n=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const r in n)Object.getOwnPropertyDescriptor(this.constructor.prototype,r)===void 0&&n[r].get!==void 0&&Object.defineProperty(this.constructor.prototype,r,n[r])}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{},nodes:{}});const r=$r.prototype.toJSON.call(this,e),s=f1(this);r.inputNodes={};for(const{property:a,childNode:l}of s)r.inputNodes[a]=l.toJSON(e).uuid;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}if(n){const a=o(e.textures),l=o(e.images),c=o(e.nodes);a.length>0&&(r.textures=a),l.length>0&&(r.images=l),c.length>0&&(r.nodes=c)}return r}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const bTe=new G0;class STe extends er{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(bTe),this.setValues(e)}}const wTe=new Vde;class TTe extends er{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(wTe),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?be(this.offsetNode):$we,n=this.dashScaleNode?be(this.dashScaleNode):Uwe,r=this.dashSizeNode?be(this.dashSizeNode):zwe,s=this.gapSizeNode?be(this.gapSizeNode):Vwe;hM.assign(r),k3.assign(s);const o=ba(xu("lineDistance").mul(n));(e?o.add(e):o).mod(hM.add(k3)).greaterThan(hM).discard()}}const ETe=i=>De(i).mul(.5).add(.5),MTe=new Fde;class ATe extends er{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(MTe),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?be(this.opacityNode):S8;Sn.assign(G2(Gt(ETe(Di),e),Et))}}class CTe extends zi{static get type(){return"EquirectUVNode"}constructor(e=m8){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,n=e.z.atan(e.x).mul(1/(Math.PI*2)).add(.5),r=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return qe(n,r)}}const N8=Re(CTe).setParameterLength(0,1);class k8 extends iG{constructor(e=1,n={}){super(e,n),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,n){const r=n.minFilter,s=n.generateMipmaps;n.generateMipmaps=!0,this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const o=new ja(5,5,5),a=N8(m8),l=new er;l.colorNode=dn(n,a,0),l.side=On,l.blending=Rs;const c=new Xn(o,l),u=new iw;u.add(c),n.minFilter===_s&&(n.minFilter=Xi);const d=new nG(1,10,this),h=e.getMRT();return e.setMRT(null),d.update(e,u),e.setMRT(h),n.minFilter=r,n.currentGenerateMipmaps=s,c.geometry.dispose(),c.material.dispose(),this}}const ty=new WeakMap;class RTe extends zi{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=m0(null);const n=new nw;n.isRenderTargetTexture=!0,this._defaultTexture=n,this.updateBeforeType=sn.RENDER}updateBefore(e){const{renderer:n,material:r}=e,s=this.envNode;if(s.isTextureNode||s.isMaterialReferenceNode){const o=s.isTextureNode?s.value:r[s.property];if(o&&o.isTexture){const a=o.mapping;if(a===Fd||a===Bd){if(ty.has(o)){const l=ty.get(o);K3(l,o.mapping),this._cubeTexture=l}else{const l=o.image;if(PTe(l)){const c=new k8(l.height);c.fromEquirectangularTexture(n,o),K3(c.texture,o.mapping),this._cubeTexture=c.texture,ty.set(o,c.texture),o.addEventListener("dispose",L8)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function PTe(i){return i==null?!1:i.height>0}function L8(i){const e=i.target;e.removeEventListener("dispose",L8);const n=ty.get(e);n!==void 0&&(ty.delete(e),n.dispose())}function K3(i,e){e===Fd?i.mapping=pa:e===Bd&&(i.mapping=ma)}const I8=Re(RTe).setParameterLength(1);class Y2 extends um{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=I8(this.envNode)}}class NTe extends um{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const n=be(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(n)}}class Sw{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class D8 extends Sw{constructor(){super()}indirect({context:e}){const n=e.ambientOcclusion,r=e.reflectedLight,s=e.irradianceLightMap;r.indirectDiffuse.assign(Gt(0)),s?r.indirectDiffuse.addAssign(s):r.indirectDiffuse.addAssign(Gt(1,1,1,0)),r.indirectDiffuse.mulAssign(n),r.indirectDiffuse.mulAssign(Sn.rgb)}finish(e){const{material:n,context:r}=e,s=r.outgoingLight,o=e.context.environment;if(o)switch(n.combine){case B0:s.rgb.assign(Wn(s.rgb,s.rgb.mul(o.rgb),Z_.mul(mM)));break;case $$:s.rgb.assign(Wn(s.rgb,o.rgb,Z_.mul(mM)));break;case G$:s.rgb.addAssign(o.rgb.mul(Z_.mul(mM)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",n.combine);break}}}const kTe=new es;class LTe extends er{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(kTe),this.setValues(e)}setupNormal(){return ya}setupEnvironment(e){const n=super.setupEnvironment(e);return n?new Y2(n):null}setupLightMap(e){let n=null;return e.material.lightMap&&(n=new NTe(w8)),n}setupOutgoingLight(){return Sn.rgb}setupLightingModel(){return new D8}}const g0=Le(({f0:i,f90:e,dotVH:n})=>{const r=n.mul(-5.55473).sub(6.98316).mul(n).exp2();return i.mul(r.oneMinus()).add(e.mul(r))}),Lp=Le(i=>i.diffuseColor.mul(1/Math.PI)),ITe=()=>be(.25),DTe=Le(({dotNH:i})=>dR.mul(be(.5)).add(1).mul(be(1/Math.PI)).mul(i.pow(dR))),OTe=Le(({lightDirection:i})=>{const e=i.add(ai).normalize(),n=Di.dot(e).clamp(),r=ai.dot(e).clamp(),s=g0({f0:$s,f90:1,dotVH:r}),o=ITe(),a=DTe({dotNH:n});return s.mul(o).mul(a)});class O8 extends D8{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:n,reflectedLight:r}){const o=Di.dot(e).clamp().mul(n);r.directDiffuse.addAssign(o.mul(Lp({diffuseColor:Sn.rgb}))),this.specular===!0&&r.directSpecular.addAssign(o.mul(OTe({lightDirection:e})).mul(Z_))}indirect(e){const{ambientOcclusion:n,irradiance:r,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(r.mul(Lp({diffuseColor:Sn}))),s.indirectDiffuse.mulAssign(n)}}const FTe=new uG;class BTe extends er{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(FTe),this.setValues(e)}setupEnvironment(e){const n=super.setupEnvironment(e);return n?new Y2(n):null}setupLightingModel(){return new O8(!1)}}const UTe=new Dde;class zTe extends er{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(UTe),this.setValues(e)}setupEnvironment(e){const n=super.setupEnvironment(e);return n?new Y2(n):null}setupLightingModel(){return new O8}setupVariants(){const e=(this.shininessNode?be(this.shininessNode):ywe).max(1e-4);dR.assign(e);const n=this.specularNode||xwe;$s.assign(n)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const VTe=Le(i=>{if(i.geometry.hasAttribute("normal")===!1)return be(0);const e=ya.dFdx().abs().max(ya.dFdy().abs());return e.x.max(e.y).max(e.z)}),F8=Le(i=>{const{roughness:e}=i,n=VTe();let r=e.max(.0525);return r=r.add(n),r=r.min(1),r}),$Te=Le(({alpha:i,dotNL:e,dotNV:n})=>{const r=i.pow2(),s=e.mul(r.add(r.oneMinus().mul(n.pow2())).sqrt()),o=n.mul(r.add(r.oneMinus().mul(e.pow2())).sqrt());return nc(.5,s.add(o).max(A1e))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),GTe=Le(({alphaT:i,alphaB:e,dotTV:n,dotBV:r,dotTL:s,dotBL:o,dotNV:a,dotNL:l})=>{const c=l.mul(Te(i.mul(n),e.mul(r),a).length()),u=a.mul(Te(i.mul(s),e.mul(o),l).length());return nc(.5,c.add(u)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),HTe=Le(({alpha:i,dotNH:e})=>{const n=i.pow2(),r=e.pow2().mul(n.oneMinus()).oneMinus();return n.div(r.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),WTe=be(1/Math.PI),jTe=Le(({alphaT:i,alphaB:e,dotNH:n,dotTH:r,dotBH:s})=>{const o=i.mul(e),a=Te(e.mul(r),i.mul(s),o.mul(n)),l=a.dot(a),c=o.div(l);return WTe.mul(o.mul(c.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),Y3=Le(i=>{const{lightDirection:e,f0:n,f90:r,roughness:s,f:o,USE_IRIDESCENCE:a,USE_ANISOTROPY:l}=i,c=i.normalView||Di,u=s.pow2(),d=e.add(ai).normalize(),h=c.dot(e).clamp(),f=c.dot(ai).clamp(),p=c.dot(d).clamp(),m=ai.dot(d).clamp();let y=g0({f0:n,f90:r,dotVH:m}),v,g;if(P3(a)&&(y=D2.mix(y,o)),P3(l)){const _=j_.dot(e),x=j_.dot(ai),b=j_.dot(d),S=Xf.dot(e),T=Xf.dot(ai),w=Xf.dot(d);v=GTe({alphaT:uR,alphaB:u,dotTV:x,dotBV:T,dotTL:_,dotBL:S,dotNV:f,dotNL:h}),g=jTe({alphaT:uR,alphaB:u,dotNH:p,dotTH:b,dotBH:w})}else v=$Te({alpha:u,dotNL:h,dotNV:f}),g=HTe({alpha:u,dotNH:p});return y.mul(v).mul(g)}),B8=Le(({roughness:i,dotNV:e})=>{const n=Gt(-1,-.0275,-.572,.022),r=Gt(1,.0425,1.04,-.04),s=i.mul(n).add(r),o=s.x.mul(s.x).min(e.mul(-9.28).exp2()).mul(s.x).add(s.y);return qe(-1.04,1.04).mul(o).add(s.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),U8=Le(i=>{const{dotNV:e,specularColor:n,specularF90:r,roughness:s}=i,o=B8({dotNV:e,roughness:s});return n.mul(o.x).add(r.mul(o.y))}),qTe=Le(({f:i,f90:e,dotVH:n})=>{const r=n.oneMinus().saturate(),s=r.mul(r),o=r.mul(s,s).clamp(0,.9999);return i.sub(Te(e).mul(o)).div(o.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),XTe=Le(({roughness:i,dotNH:e})=>{const n=i.pow2(),r=be(1).div(n),o=e.pow2().oneMinus().max(.0078125);return be(2).add(r).mul(o.pow(r.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),KTe=Le(({dotNV:i,dotNL:e})=>be(1).div(be(4).mul(e.add(i).sub(e.mul(i))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),YTe=Le(({lightDirection:i})=>{const e=i.add(ai).normalize(),n=Di.dot(i).clamp(),r=Di.dot(ai).clamp(),s=Di.dot(e).clamp(),o=XTe({roughness:I2,dotNH:s}),a=KTe({dotNV:r,dotNL:n});return wf.mul(o).mul(a)}),ZTe=Le(({N:i,V:e,roughness:n})=>{const o=.0078125,a=i.dot(e).saturate(),l=qe(n,a.oneMinus().sqrt());return l.assign(l.mul(.984375).add(o)),l}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),QTe=Le(({f:i})=>{const e=i.length();return Ls(e.mul(e).add(i.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),$x=Le(({v1:i,v2:e})=>{const n=i.dot(e),r=n.abs().toVar(),s=r.mul(.0145206).add(.4965155).mul(r).add(.8543985).toVar(),o=r.add(4.1616724).mul(r).add(3.417594).toVar(),a=s.div(o),l=n.greaterThan(0).select(a,Ls(n.mul(n).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return i.cross(e).mul(l)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),Z3=Le(({N:i,V:e,P:n,mInv:r,p0:s,p1:o,p2:a,p3:l})=>{const c=o.sub(s).toVar(),u=l.sub(s).toVar(),d=c.cross(u),h=Te().toVar();return Ei(d.dot(n.sub(s)).greaterThanEqual(0),()=>{const f=e.sub(i.mul(e.dot(i))).normalize(),p=i.cross(f).negate(),m=r.mul(os(f,p,i).transpose()).toVar(),y=m.mul(s.sub(n)).normalize().toVar(),v=m.mul(o.sub(n)).normalize().toVar(),g=m.mul(a.sub(n)).normalize().toVar(),_=m.mul(l.sub(n)).normalize().toVar(),x=Te(0).toVar();x.addAssign($x({v1:y,v2:v})),x.addAssign($x({v1:v,v2:g})),x.addAssign($x({v1:g,v2:_})),x.addAssign($x({v1:_,v2:y})),h.assign(Te(QTe({f:x})))}),h}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),ww=1/6,z8=i=>an(ww,an(i,an(i,i.negate().add(3)).sub(3)).add(1)),pR=i=>an(ww,an(i,an(i,an(3,i).sub(6))).add(4)),V8=i=>an(ww,an(i,an(i,an(-3,i).add(3)).add(3)).add(1)),mR=i=>an(ww,mw(i,3)),Q3=i=>z8(i).add(pR(i)),J3=i=>V8(i).add(mR(i)),eB=i=>as(-1,pR(i).div(z8(i).add(pR(i)))),tB=i=>as(1,mR(i).div(V8(i).add(mR(i)))),nB=(i,e,n)=>{const r=i.uvNode,s=an(r,e.zw).add(.5),o=Md(s),a=Pu(s),l=Q3(a.x),c=J3(a.x),u=eB(a.x),d=tB(a.x),h=eB(a.y),f=tB(a.y),p=qe(o.x.add(u),o.y.add(h)).sub(.5).mul(e.xy),m=qe(o.x.add(d),o.y.add(h)).sub(.5).mul(e.xy),y=qe(o.x.add(u),o.y.add(f)).sub(.5).mul(e.xy),v=qe(o.x.add(d),o.y.add(f)).sub(.5).mul(e.xy),g=Q3(a.y).mul(as(l.mul(i.sample(p).level(n)),c.mul(i.sample(m).level(n)))),_=J3(a.y).mul(as(l.mul(i.sample(y).level(n)),c.mul(i.sample(v).level(n))));return g.add(_)},JTe=Le(([i,e=be(3)])=>{const n=qe(i.size(Un(e))),r=qe(i.size(Un(e.add(1)))),s=nc(1,n),o=nc(1,r),a=nB(i,Gt(s,n),Md(e)),l=nB(i,Gt(o,r),B2(e));return Pu(e).mix(a,l)}),iB=Le(([i,e,n,r,s])=>{const o=Te(a8(e.negate(),h0(i),nc(1,r))),a=Te(uu(s[0].xyz),uu(s[1].xyz),uu(s[2].xyz));return h0(o).mul(n.mul(a))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),eEe=Le(([i,e])=>i.mul(ic(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),tEe=M8(),nEe=M8(),rB=Le(([i,e,n],{material:r})=>{const o=(r.side===On?tEe:nEe).sample(i),a=jl(fR.x).mul(eEe(e,n));return JTe(o,a)}),sB=Le(([i,e,n])=>(Ei(n.notEqual(0),()=>{const r=JH(e).negate().div(n);return QH(r.negate().mul(i))}),Te(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),iEe=Le(([i,e,n,r,s,o,a,l,c,u,d,h,f,p,m])=>{let y,v;if(m){y=Gt().toVar(),v=Te().toVar();const S=d.sub(1).mul(m.mul(.025)),T=Te(d.sub(S),d,d.add(S));sa({start:0,end:3},({i:w})=>{const E=T.element(w),A=iB(i,e,h,E,l),M=a.add(A),R=u.mul(c.mul(Gt(M,1))),F=qe(R.xy.div(R.w)).toVar();F.addAssign(1),F.divAssign(2),F.assign(qe(F.x,F.y.oneMinus()));const B=rB(F,n,E);y.element(w).assign(B.element(w)),y.a.addAssign(B.a),v.element(w).assign(r.element(w).mul(sB(uu(A),f,p).element(w)))}),y.a.divAssign(3)}else{const S=iB(i,e,h,d,l),T=a.add(S),w=u.mul(c.mul(Gt(T,1))),E=qe(w.xy.div(w.w)).toVar();E.addAssign(1),E.divAssign(2),E.assign(qe(E.x,E.y.oneMinus())),y=rB(E,n,d),v=r.mul(sB(uu(S),f,p))}const g=v.rgb.mul(y.rgb),_=i.dot(e).clamp(),x=Te(U8({dotNV:_,specularColor:s,specularF90:o,roughness:n})),b=v.r.add(v.g,v.b).div(3);return Gt(x.oneMinus().mul(g),y.a.oneMinus().mul(b).oneMinus())}),rEe=os(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),sEe=i=>{const e=i.sqrt();return Te(1).add(e).div(Te(1).sub(e))},oB=(i,e)=>i.sub(e).div(i.add(e)).pow2(),oEe=(i,e)=>{const n=i.mul(2*Math.PI*1e-9),r=Te(54856e-17,44201e-17,52481e-17),s=Te(1681e3,1795300,2208400),o=Te(43278e5,93046e5,66121e5),a=be(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(n.mul(2239900).add(e.x).cos()).mul(n.pow2().mul(-45282e5).exp());let l=r.mul(o.mul(2*Math.PI).sqrt()).mul(s.mul(n).add(e).cos()).mul(n.pow2().negate().mul(o).exp());return l=Te(l.x.add(a),l.y,l.z).div(10685e-11),rEe.mul(l)},aEe=Le(({outsideIOR:i,eta2:e,cosTheta1:n,thinFilmThickness:r,baseF0:s})=>{const o=Wn(i,e,vu(0,.03,r)),l=i.div(o).pow2().mul(n.pow2().oneMinus()).oneMinus();Ei(l.lessThan(0),()=>Te(1));const c=l.sqrt(),u=oB(o,i),d=g0({f0:u,f90:1,dotVH:n}),h=d.oneMinus(),f=o.lessThan(i).select(Math.PI,0),p=be(Math.PI).sub(f),m=sEe(s.clamp(0,.9999)),y=oB(m,o.toVec3()),v=g0({f0:y,f90:1,dotVH:c}),g=Te(m.x.lessThan(o).select(Math.PI,0),m.y.lessThan(o).select(Math.PI,0),m.z.lessThan(o).select(Math.PI,0)),_=o.mul(r,c,2),x=Te(p).add(g),b=d.mul(v).clamp(1e-5,.9999),S=b.sqrt(),T=h.pow2().mul(v).div(Te(1).sub(b)),E=d.add(T).toVar(),A=T.sub(h).toVar();return sa({start:1,end:2,condition:"<=",name:"m"},({m:M})=>{A.mulAssign(S);const R=oEe(be(M).mul(_),be(M).mul(x)).mul(2);E.addAssign(A.mul(R))}),E.max(Te(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),lEe=Le(({normal:i,viewDir:e,roughness:n})=>{const r=i.dot(e).saturate(),s=n.pow2(),o=rs(n.lessThan(.25),be(-339.2).mul(s).add(be(161.4).mul(n)).sub(25.9),be(-8.48).mul(s).add(be(14.3).mul(n)).sub(9.95)),a=rs(n.lessThan(.25),be(44).mul(s).sub(be(23.7).mul(n)).add(3.26),be(1.97).mul(s).sub(be(3.27).mul(n)).add(.72));return rs(n.lessThan(.25),0,be(.1).mul(n).sub(.025)).add(o.mul(r).add(a).exp()).mul(1/Math.PI).saturate()}),vM=Te(.04),xM=be(1);class $8 extends Sw{constructor(e=!1,n=!1,r=!1,s=!1,o=!1,a=!1){super(),this.clearcoat=e,this.sheen=n,this.iridescence=r,this.anisotropy=s,this.transmission=o,this.dispersion=a,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=Te().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Te().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Te().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=Te().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Te().toVar("sheenSpecularIndirect")),this.iridescence===!0){const n=Di.dot(ai).clamp();this.iridescenceFresnel=aEe({outsideIOR:be(1),eta2:GH,cosTheta1:n,thinFilmThickness:HH,baseF0:$s}),this.iridescenceF0=qTe({f:this.iridescenceFresnel,f90:1,dotVH:n})}if(this.transmission===!0){const n=p0,r=HSe.sub(p0).normalize(),s=j2,o=e.context;o.backdrop=iEe(s,r,Nl,Sn,$s,x1,n,Wd,pc,W2,q_,WH,qH,jH,this.dispersion?XH:null),o.backdropAlpha=hR,Sn.a.mulAssign(Wn(1,o.backdrop.a,hR))}super.start(e)}computeMultiscattering(e,n,r){const s=Di.dot(ai).clamp(),o=B8({roughness:Nl,dotNV:s}),l=(this.iridescenceF0?D2.mix($s,this.iridescenceF0):$s).mul(o.x).add(r.mul(o.y)),u=o.x.add(o.y).oneMinus(),d=$s.add($s.oneMinus().mul(.047619)),h=l.mul(d).div(u.mul(d).oneMinus());e.addAssign(l),n.addAssign(h.mul(u))}direct({lightDirection:e,lightColor:n,reflectedLight:r}){const o=Di.dot(e).clamp().mul(n);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(o.mul(YTe({lightDirection:e}))),this.clearcoat===!0){const l=Mg.dot(e).clamp().mul(n);this.clearcoatSpecularDirect.addAssign(l.mul(Y3({lightDirection:e,f0:vM,f90:xM,roughness:v1,normalView:Mg})))}r.directDiffuse.addAssign(o.mul(Lp({diffuseColor:Sn.rgb}))),r.directSpecular.addAssign(o.mul(Y3({lightDirection:e,f0:$s,f90:1,roughness:Nl,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:n,halfWidth:r,halfHeight:s,reflectedLight:o,ltc_1:a,ltc_2:l}){const c=n.add(r).sub(s),u=n.sub(r).sub(s),d=n.sub(r).add(s),h=n.add(r).add(s),f=Di,p=ai,m=Fi.toVar(),y=ZTe({N:f,V:p,roughness:Nl}),v=a.sample(y).toVar(),g=l.sample(y).toVar(),_=os(Te(v.x,0,v.y),Te(0,1,0),Te(v.z,0,v.w)).toVar(),x=$s.mul(g.x).add($s.oneMinus().mul(g.y)).toVar();o.directSpecular.addAssign(e.mul(x).mul(Z3({N:f,V:p,P:m,mInv:_,p0:c,p1:u,p2:d,p3:h}))),o.directDiffuse.addAssign(e.mul(Sn).mul(Z3({N:f,V:p,P:m,mInv:os(1,0,0,0,1,0,0,0,1),p0:c,p1:u,p2:d,p3:h})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(Lp({diffuseColor:Sn})))}indirectSpecular(e){const{radiance:n,iblIrradiance:r,reflectedLight:s}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(r.mul(wf,lEe({normal:Di,viewDir:ai,roughness:I2}))),this.clearcoat===!0){const d=Mg.dot(ai).clamp(),h=U8({dotNV:d,specularColor:vM,specularF90:xM,roughness:v1});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(h))}const o=Te().toVar("singleScattering"),a=Te().toVar("multiScattering"),l=r.mul(1/Math.PI);this.computeMultiscattering(o,a,x1);const c=o.add(a),u=Sn.mul(c.r.max(c.g).max(c.b).oneMinus());s.indirectSpecular.addAssign(n.mul(o)),s.indirectSpecular.addAssign(a.mul(l)),s.indirectDiffuse.addAssign(u.mul(l))}ambientOcclusion(e){const{ambientOcclusion:n,reflectedLight:r}=e.context,o=Di.dot(ai).clamp().add(n),a=Nl.mul(-16).oneMinus().negate().exp2(),l=n.sub(o.pow(a).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(n),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(n),r.indirectDiffuse.mulAssign(n),r.indirectSpecular.mulAssign(l)}finish({context:e}){const{outgoingLight:n}=e;if(this.clearcoat===!0){const r=Mg.dot(ai).clamp(),s=g0({dotVH:r,f0:vM,f90:xM}),o=n.mul(cR.mul(s).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(cR));n.assign(o)}if(this.sheen===!0){const r=wf.r.max(wf.g).max(wf.b).mul(.157).oneMinus(),s=n.mul(r).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);n.assign(s)}}}const aB=be(1),gR=be(-2),Gx=be(.8),_M=be(-1),Hx=be(.4),bM=be(2),Wx=be(.305),SM=be(3),lB=be(.21),cEe=be(4),cB=be(4),uEe=be(16),dEe=Le(([i])=>{const e=Te(So(i)).toVar(),n=be(-1).toVar();return Ei(e.x.greaterThan(e.z),()=>{Ei(e.x.greaterThan(e.y),()=>{n.assign(rs(i.x.greaterThan(0),0,3))}).Else(()=>{n.assign(rs(i.y.greaterThan(0),1,4))})}).Else(()=>{Ei(e.z.greaterThan(e.y),()=>{n.assign(rs(i.z.greaterThan(0),2,5))}).Else(()=>{n.assign(rs(i.y.greaterThan(0),1,4))})}),n}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),hEe=Le(([i,e])=>{const n=qe().toVar();return Ei(e.equal(0),()=>{n.assign(qe(i.z,i.y).div(So(i.x)))}).ElseIf(e.equal(1),()=>{n.assign(qe(i.x.negate(),i.z.negate()).div(So(i.y)))}).ElseIf(e.equal(2),()=>{n.assign(qe(i.x.negate(),i.y).div(So(i.z)))}).ElseIf(e.equal(3),()=>{n.assign(qe(i.z.negate(),i.y).div(So(i.x)))}).ElseIf(e.equal(4),()=>{n.assign(qe(i.x.negate(),i.z).div(So(i.y)))}).Else(()=>{n.assign(qe(i.x,i.y).div(So(i.z)))}),an(.5,n.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),fEe=Le(([i])=>{const e=be(0).toVar();return Ei(i.greaterThanEqual(Gx),()=>{e.assign(aB.sub(i).mul(_M.sub(gR)).div(aB.sub(Gx)).add(gR))}).ElseIf(i.greaterThanEqual(Hx),()=>{e.assign(Gx.sub(i).mul(bM.sub(_M)).div(Gx.sub(Hx)).add(_M))}).ElseIf(i.greaterThanEqual(Wx),()=>{e.assign(Hx.sub(i).mul(SM.sub(bM)).div(Hx.sub(Wx)).add(bM))}).ElseIf(i.greaterThanEqual(lB),()=>{e.assign(Wx.sub(i).mul(cEe.sub(SM)).div(Wx.sub(lB)).add(SM))}).Else(()=>{e.assign(be(-2).mul(jl(an(1.16,i))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),pEe=Le(([i,e])=>{const n=i.toVar();n.assign(an(2,n).sub(1));const r=Te(n,1).toVar();return Ei(e.equal(0),()=>{r.assign(r.zyx)}).ElseIf(e.equal(1),()=>{r.assign(r.xzy),r.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{r.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{r.assign(r.zyx),r.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{r.assign(r.xzy),r.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{r.z.mulAssign(-1)}),r}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),mEe=Le(([i,e,n,r,s,o])=>{const a=be(n),l=Te(e),c=ic(fEe(a),gR,o),u=Pu(c),d=Md(c),h=Te(yR(i,l,d,r,s,o)).toVar();return Ei(u.notEqual(0),()=>{const f=Te(yR(i,l,d.add(1),r,s,o)).toVar();h.assign(Wn(h,f,u))}),h}),yR=Le(([i,e,n,r,s,o])=>{const a=be(n).toVar(),l=Te(e),c=be(dEe(l)).toVar(),u=be(Ls(cB.sub(a),0)).toVar();a.assign(Ls(a,cB));const d=be(d0(a)).toVar(),h=qe(hEe(l,c).mul(d.sub(2)).add(1)).toVar();return Ei(c.greaterThan(2),()=>{h.y.addAssign(d),c.subAssign(3)}),h.x.addAssign(c.mul(d)),h.x.addAssign(u.mul(an(3,uEe))),h.y.addAssign(an(4,d0(o).sub(d))),h.x.mulAssign(r),h.y.mulAssign(s),i.sample(h).grad(qe(),qe())}),wM=Le(({envMap:i,mipInt:e,outputDirection:n,theta:r,axis:s,CUBEUV_TEXEL_WIDTH:o,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:l})=>{const c=$c(r),u=n.mul(c).add(s.cross(n).mul(ia(r))).add(s.mul(s.dot(n).mul(c.oneMinus())));return yR(i,u,e,o,a,l)}),gEe=Le(({n:i,latitudinal:e,poleAxis:n,outputDirection:r,weights:s,samples:o,dTheta:a,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:h})=>{const f=Te(rs(e,n,r8(n,r))).toVar();Ei(f.equal(Te(0)),()=>{f.assign(Te(r.z,0,r.x.negate()))}),f.assign(h0(f));const p=Te().toVar();return p.addAssign(s.element(0).mul(wM({theta:0,axis:f,outputDirection:r,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:h}))),sa({start:Un(1),end:i},({i:m})=>{Ei(m.greaterThanEqual(o),()=>{nTe()});const y=be(a.mul(be(m))).toVar();p.addAssign(s.element(m).mul(wM({theta:y.mul(-1),axis:f,outputDirection:r,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:h}))),p.addAssign(s.element(m).mul(wM({theta:y,axis:f,outputDirection:r,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:h})))}),Gt(p,1)}),Tf=4,uB=[.125,.215,.35,.446,.526,.582],cd=20,TM=new j0(-1,1,1,-1,0,1),yEe=new ar(90,1),dB=new St;let EM=null,MM=0,AM=0;const sd=(1+Math.sqrt(5))/2,Gh=1/sd,hB=[new K(-sd,Gh,0),new K(sd,Gh,0),new K(-Gh,0,sd),new K(Gh,0,sd),new K(0,sd,-Gh),new K(0,sd,Gh),new K(-1,1,-1),new K(1,1,-1),new K(-1,1,1),new K(1,1,1)],vEe=new K,G8=new WeakMap,xEe=[3,1,5,0,4,2],CM=pEe(ev(),xu("faceIndex")).normalize(),Z2=Te(CM.x,CM.y,CM.z);class _Ee{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,n=0,r=.1,s=100,o={}){const{size:a=256,position:l=vEe,renderTarget:c=null}=o;if(this._setSize(a),this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const d=c||this._allocateTargets();return o.renderTarget=d,this.fromSceneAsync(e,n,r,s,o),d}EM=this._renderer.getRenderTarget(),MM=this._renderer.getActiveCubeFace(),AM=this._renderer.getActiveMipmapLevel();const u=c||this._allocateTargets();return u.depthBuffer=!0,this._sceneToCubeUV(e,r,s,u,l),n>0&&this._blur(u,0,0,n),this._applyPMREM(u),this._cleanup(u),u}async fromSceneAsync(e,n=0,r=.1,s=100,o={}){return this._hasInitialized===!1&&await this._renderer.init(),this.fromScene(e,n,r,s,o)}fromEquirectangular(e,n=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const r=n||this._allocateTargets();return this.fromEquirectangularAsync(e,r),r}return this._fromTexture(e,n)}async fromEquirectangularAsync(e,n=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,n)}fromCubemap(e,n=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const r=n||this._allocateTargets();return this.fromCubemapAsync(e,n),r}return this._fromTexture(e,n)}async fromCubemapAsync(e,n=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,n)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=pB(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=mB(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===pa||e.mapping===ma?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(EM,MM,AM),e.scissorTest=!1,jx(e,0,0,e.width,e.height)}_fromTexture(e,n){this._setSizeFromTexture(e),EM=this._renderer.getRenderTarget(),MM=this._renderer.getActiveCubeFace(),AM=this._renderer.getActiveMipmapLevel();const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:Xi,minFilter:Xi,generateMipmaps:!1,type:lr,format:yi,colorSpace:Wa},s=fB(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=fB(e,n,r);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=bEe(o)),this._blurMaterial=SEe(o,e,n)}return s}async _compileMaterial(e){const n=new Xn(this._lodPlanes[0],e);await this._renderer.compile(n,TM)}_sceneToCubeUV(e,n,r,s,o){const a=yEe;a.near=n,a.far=r;const l=[1,1,1,1,-1,1],c=[1,-1,1,-1,1,-1],u=this._renderer,d=u.autoClear;u.getClearColor(dB),u.autoClear=!1;let h=this._backgroundBox;if(h===null){const m=new es({name:"PMREM.Background",side:On,depthWrite:!1,depthTest:!1});h=new Xn(new ja,m)}let f=!1;const p=e.background;p?p.isColor&&(h.material.color.copy(p),e.background=null,f=!0):(h.material.color.copy(dB),f=!0),u.setRenderTarget(s),u.clear(),f&&u.render(h,a);for(let m=0;m<6;m++){const y=m%3;y===0?(a.up.set(0,l[m],0),a.position.set(o.x,o.y,o.z),a.lookAt(o.x+c[m],o.y,o.z)):y===1?(a.up.set(0,0,l[m]),a.position.set(o.x,o.y,o.z),a.lookAt(o.x,o.y+c[m],o.z)):(a.up.set(0,l[m],0),a.position.set(o.x,o.y,o.z),a.lookAt(o.x,o.y,o.z+c[m]));const v=this._cubeSize;jx(s,y*v,m>2?v:0,v,v),u.render(e,a)}u.autoClear=d,e.background=p}_textureToCubeUV(e,n){const r=this._renderer,s=e.mapping===pa||e.mapping===ma;s?this._cubemapMaterial===null&&(this._cubemapMaterial=pB(e)):this._equirectMaterial===null&&(this._equirectMaterial=mB(e));const o=s?this._cubemapMaterial:this._equirectMaterial;o.fragmentNode.value=e;const a=this._lodMeshes[0];a.material=o;const l=this._cubeSize;jx(n,0,0,3*l,2*l),r.setRenderTarget(n),r.render(a,TM)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;const s=this._lodPlanes.length;for(let o=1;o<s;o++){const a=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),l=hB[(s-o-1)%hB.length];this._blur(e,o-1,o,a,l)}n.autoClear=r}_blur(e,n,r,s,o){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,r,s,"latitudinal",o),this._halfBlur(a,e,r,r,s,"longitudinal",o)}_halfBlur(e,n,r,s,o,a,l){const c=this._renderer,u=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,h=this._lodMeshes[s];h.material=u;const f=G8.get(u),p=this._sizeLods[r]-1,m=isFinite(o)?Math.PI/(2*p):2*Math.PI/(2*cd-1),y=o/m,v=isFinite(o)?1+Math.floor(d*y):cd;v>cd&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${cd}`);const g=[];let _=0;for(let w=0;w<cd;++w){const E=w/y,A=Math.exp(-E*E/2);g.push(A),w===0?_+=A:w<v&&(_+=2*A)}for(let w=0;w<g.length;w++)g[w]=g[w]/_;e.texture.frame=(e.texture.frame||0)+1,f.envMap.value=e.texture,f.samples.value=v,f.weights.array=g,f.latitudinal.value=a==="latitudinal"?1:0,l&&(f.poleAxis.value=l);const{_lodMax:x}=this;f.dTheta.value=m,f.mipInt.value=x-r;const b=this._sizeLods[s],S=3*b*(s>x-Tf?s-x+Tf:0),T=4*(this._cubeSize-b);jx(n,S,T,3*b,2*b),c.setRenderTarget(n),c.render(h,TM)}}function bEe(i){const e=[],n=[],r=[],s=[];let o=i;const a=i-Tf+1+uB.length;for(let l=0;l<a;l++){const c=Math.pow(2,o);n.push(c);let u=1/c;l>i-Tf?u=uB[l-i+Tf-1]:l===0&&(u=0),r.push(u);const d=1/(c-2),h=-d,f=1+d,p=[h,h,f,h,f,f,h,h,f,f,h,f],m=6,y=6,v=3,g=2,_=1,x=new Float32Array(v*y*m),b=new Float32Array(g*y*m),S=new Float32Array(_*y*m);for(let w=0;w<m;w++){const E=w%3*2/3-1,A=w>2?0:-1,M=[E,A,0,E+2/3,A,0,E+2/3,A+1,0,E,A,0,E+2/3,A+1,0,E,A+1,0],R=xEe[w];x.set(M,v*y*R),b.set(p,g*y*R);const F=[R,R,R,R,R,R];S.set(F,_*y*R)}const T=new Tr;T.setAttribute("position",new Yi(x,v)),T.setAttribute("uv",new Yi(b,g)),T.setAttribute("faceIndex",new Yi(S,_)),e.push(T),s.push(new Xn(T,null)),o>Tf&&o--}return{lodPlanes:e,sizeLods:n,sigmas:r,lodMeshes:s}}function fB(i,e,n){const r=new Eu(i,e,n);return r.texture.mapping=Ud,r.texture.name="PMREM.cubeUv",r.texture.isPMREMTexture=!0,r.scissorTest=!0,r}function jx(i,e,n,r,s){i.viewport.set(e,n,r,s),i.scissor.set(e,n,r,s)}function Q2(i){const e=new er;return e.depthTest=!1,e.depthWrite=!1,e.blending=Rs,e.name=`PMREM_${i}`,e}function SEe(i,e,n){const r=Fa(new Array(cd).fill(0)),s=zt(new K(0,1,0)),o=zt(0),a=be(cd),l=zt(0),c=zt(1),u=dn(null),d=zt(0),h=be(1/e),f=be(1/n),p=be(i),m={n:a,latitudinal:l,weights:r,poleAxis:s,outputDirection:Z2,dTheta:o,samples:c,envMap:u,mipInt:d,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:f,CUBEUV_MAX_MIP:p},y=Q2("blur");return y.fragmentNode=gEe({...m,latitudinal:l.equal(1)}),G8.set(y,m),y}function pB(i){const e=Q2("cubemap");return e.fragmentNode=m0(i,Z2),e}function mB(i){const e=Q2("equirect");return e.fragmentNode=dn(i,N8(Z2),0),e}const gB=new WeakMap;function wEe(i){const e=Math.log2(i)-2,n=1/i;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:n,maxMip:e}}function TEe(i,e,n){const r=EEe(e);let s=r.get(i);if((s!==void 0?s.pmremVersion:-1)!==i.pmremVersion){const a=i.image;if(i.isCubeTexture)if(AEe(a))s=n.fromCubemap(i,s);else return null;else if(CEe(a))s=n.fromEquirectangular(i,s);else return null;s.pmremVersion=i.pmremVersion,r.set(i,s)}return s.texture}function EEe(i){let e=gB.get(i);return e===void 0&&(e=new WeakMap,gB.set(i,e)),e}class MEe extends zi{static get type(){return"PMREMNode"}constructor(e,n=null,r=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=n,this.levelNode=r,this._generator=null;const s=new Ki;s.isRenderTargetTexture=!0,this._texture=dn(s),this._width=zt(0),this._height=zt(0),this._maxMip=zt(0),this.updateBeforeType=sn.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const n=wEe(e.image.height);this._texture.value=e,this._width.value=n.texelWidth,this._height.value=n.texelHeight,this._maxMip.value=n.maxMip}updateBefore(e){let n=this._pmrem;const r=n?n.pmremVersion:-1,s=this._value;r!==s.pmremVersion&&(s.isPMREMTexture===!0?n=s:n=TEe(s,e.renderer,this._generator),n!==null&&(this._pmrem=n,this.updateFromTexture(n)))}setup(e){this._generator===null&&(this._generator=new _Ee(e.renderer)),this.updateBefore(e);let n=this.uvNode;n===null&&e.context.getUV&&(n=e.context.getUV(this)),n=x8.mul(Te(n.x,n.y.negate(),n.z));let r=this.levelNode;return r===null&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),mEe(this._texture,n,r,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function AEe(i){if(i==null)return!1;let e=0;const n=6;for(let r=0;r<n;r++)i[r]!==void 0&&e++;return e===n}function CEe(i){return i==null?!1:i.height>0}const H8=Re(MEe).setParameterLength(1,3),yB=new WeakMap;class REe extends um{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:n}=e;let r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const h=r.isTextureNode?r.value:n[r.property];let f=yB.get(h);f===void 0&&(f=H8(h),yB.set(h,f)),r=f}const o=n.useAnisotropy===!0||n.anisotropy>0?lwe:Di,a=r.context(vB(Nl,o)).mul(pM),l=r.context(PEe(j2)).mul(Math.PI).mul(pM),c=K_(a),u=K_(l);e.context.radiance.addAssign(c),e.context.iblIrradiance.addAssign(u);const d=e.context.lightingModel.clearcoatRadiance;if(d){const h=r.context(vB(v1,Mg)).mul(pM),f=K_(h);d.addAssign(f)}}}const vB=(i,e)=>{let n=null;return{getUV:()=>(n===null&&(n=ai.negate().reflect(e),n=i.mul(i).mix(n,e).normalize(),n=n.transformDirection(pc)),n),getTextureLevel:()=>i}},PEe=i=>({getUV:()=>i,getTextureLevel:()=>be(1)}),NEe=new cG;class W8 extends er{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(NEe),this.setValues(e)}setupEnvironment(e){let n=super.setupEnvironment(e);return n===null&&e.environmentNode&&(n=e.environmentNode),n?new REe(n):null}setupLightingModel(){return new $8}setupSpecular(){const e=Wn(Te(.04),Sn.rgb,y1);$s.assign(e),x1.assign(1)}setupVariants(){const e=this.metalnessNode?be(this.metalnessNode):Swe;y1.assign(e);let n=this.roughnessNode?be(this.roughnessNode):bwe;n=F8({roughness:n}),Nl.assign(n),this.setupSpecular(),Sn.assign(Gt(Sn.rgb.mul(e.oneMinus()),Sn.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const kEe=new Ide;class LEe extends W8{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(kEe),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?be(this.iorNode):Owe;q_.assign(e),$s.assign(Wn(f0(s8(q_.sub(1).div(q_.add(1))).mul(_we),Te(1)).mul(H3),Sn.rgb,y1)),x1.assign(Wn(H3,1,y1))}setupLightingModel(){return new $8(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const n=this.clearcoatNode?be(this.clearcoatNode):Twe,r=this.clearcoatRoughnessNode?be(this.clearcoatRoughnessNode):Ewe;cR.assign(n),v1.assign(F8({roughness:r}))}if(this.useSheen){const n=this.sheenNode?Te(this.sheenNode):Cwe,r=this.sheenRoughnessNode?be(this.sheenRoughnessNode):Rwe;wf.assign(n),I2.assign(r)}if(this.useIridescence){const n=this.iridescenceNode?be(this.iridescenceNode):Nwe,r=this.iridescenceIORNode?be(this.iridescenceIORNode):kwe,s=this.iridescenceThicknessNode?be(this.iridescenceThicknessNode):Lwe;D2.assign(n),GH.assign(r),HH.assign(s)}if(this.useAnisotropy){const n=(this.anisotropyNode?qe(this.anisotropyNode):Pwe).toVar();rd.assign(n.length()),Ei(rd.equal(0),()=>{n.assign(qe(1,0))}).Else(()=>{n.divAssign(qe(rd)),rd.assign(rd.saturate())}),uR.assign(rd.pow2().mix(Nl.pow2(),1)),j_.assign(Ag[0].mul(n.x).add(Ag[1].mul(n.y))),Xf.assign(Ag[1].mul(n.x).sub(Ag[0].mul(n.y)))}if(this.useTransmission){const n=this.transmissionNode?be(this.transmissionNode):Iwe,r=this.thicknessNode?be(this.thicknessNode):Dwe,s=this.attenuationDistanceNode?be(this.attenuationDistanceNode):Fwe,o=this.attenuationColorNode?Te(this.attenuationColorNode):Bwe;if(hR.assign(n),WH.assign(r),jH.assign(s),qH.assign(o),this.useDispersion){const a=this.dispersionNode?be(this.dispersionNode):Hwe;XH.assign(a)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Te(this.clearcoatNormalNode):Mwe}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const IEe=Le(({normal:i,lightDirection:e,builder:n})=>{const r=i.dot(e),s=qe(r.mul(.5).add(.5),0);if(n.material.gradientMap){const o=Wc("gradientMap","texture").context({getUV:()=>s});return Te(o.r)}else{const o=s.fwidth().mul(.5);return Wn(Te(.7),Te(1),vu(be(.7).sub(o.x),be(.7).add(o.x),s.x))}});class DEe extends Sw{direct({lightDirection:e,lightColor:n,reflectedLight:r},s){const o=IEe({normal:g8,lightDirection:e,builder:s}).mul(n);r.directDiffuse.addAssign(o.mul(Lp({diffuseColor:Sn.rgb})))}indirect(e){const{ambientOcclusion:n,irradiance:r,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(r.mul(Lp({diffuseColor:Sn}))),s.indirectDiffuse.mulAssign(n)}}const OEe=new Ode;class FEe extends er{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(OEe),this.setValues(e)}setupLightingModel(){return new DEe}}class BEe extends zi{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=Te(ai.z,0,ai.x.negate()).normalize(),n=ai.cross(e);return qe(e.dot(Di),n.dot(Di)).mul(.495).add(.5)}}const UEe=je(BEe),zEe=new zde;class VEe extends er{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(zEe),this.setValues(e)}setupVariants(e){const n=UEe;let r;e.material.matcap?r=Wc("matcap","texture").context({getUV:()=>n}):r=Te(Wn(.2,.8,n.y)),Sn.rgb.mulAssign(r.rgb)}}class $Ee extends zi{static get type(){return"RotateNode"}constructor(e,n){super(),this.positionNode=e,this.rotationNode=n}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:n,positionNode:r}=this;if(this.getNodeType(e)==="vec2"){const o=n.cos(),a=n.sin();return L2(o,a,a.negate(),o).mul(r)}else{const o=n,a=qf(Gt(1,0,0,0),Gt(0,$c(o.x),ia(o.x).negate(),0),Gt(0,ia(o.x),$c(o.x),0),Gt(0,0,0,1)),l=qf(Gt($c(o.y),0,ia(o.y),0),Gt(0,1,0,0),Gt(ia(o.y).negate(),0,$c(o.y),0),Gt(0,0,0,1)),c=qf(Gt($c(o.z),ia(o.z).negate(),0,0),Gt(ia(o.z),$c(o.z),0,0),Gt(0,0,1,0),Gt(0,0,0,1));return a.mul(l).mul(c).mul(Gt(r,1)).xyz}}}const j8=Re($Ee).setParameterLength(2),GEe=new dde;class q8 extends er{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(GEe),this.setValues(e)}setupPositionView(e){const{object:n,camera:r}=e,s=this.sizeAttenuation,{positionNode:o,rotationNode:a,scaleNode:l}=this,c=vw.mul(Te(o||0));let u=qe(Wd[0].xyz.length(),Wd[1].xyz.length());if(l!==null&&(u=u.mul(qe(l))),s===!1)if(r.isPerspectiveCamera)u=u.mul(c.z.negate());else{const p=be(2).div(W2.element(1).element(1));u=u.mul(p.mul(2))}let d=xw.xy;if(n.center&&n.center.isVector2===!0){const p=vSe("center","vec2",n);d=d.sub(p.sub(.5))}d=d.mul(u);const h=be(a||Awe),f=j8(d,h);return Gt(c.xy.add(f),c.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const HEe=new gde;class WEe extends q8{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(HEe),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return vw.mul(Te(e||zr)).xyz}setupVertex(e){const n=super.setupVertex(e);if(e.material.isNodeMaterial!==!0)return n;const{rotationNode:r,scaleNode:s,sizeNode:o}=this,a=xw.xy.toVar(),l=Jg.z.div(Jg.w);if(r&&r.isNode){const u=be(r);a.assign(j8(a,u))}let c=o!==null?qe(o):Gwe;return this.sizeAttenuation===!0&&(c=c.mul(c.div(Fi.z.negate()))),s&&s.isNode&&(c=c.mul(qe(s))),a.mulAssign(c.mul(2)),a.assign(a.div(Jg.z)),a.y.assign(a.y.mul(l)),a.assign(a.mul(n.w)),n.addAssign(Gt(a,0,0)),n}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}class jEe extends Sw{constructor(){super(),this.shadowNode=be(1).toVar("shadowMask")}direct({lightNode:e}){this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){Sn.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Sn.rgb)}}const qEe=new Lde;class XEe extends er{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(qEe),this.setValues(e)}setupLightingModel(){return new jEe}}Z0("vec3");Z0("vec3");Z0("vec3");class KEe{constructor(e,n){this.nodes=e,this.info=n,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(n,r)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this._animationLoop!==null&&this._animationLoop(n,r)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class va{constructor(){this.weakMap=new WeakMap}get(e){let n=this.weakMap;for(let r=0;r<e.length-1;r++)if(n=n.get(e[r]),n===void 0)return;return n.get(e[e.length-1])}set(e,n){let r=this.weakMap;for(let s=0;s<e.length-1;s++){const o=e[s];r.has(o)===!1&&r.set(o,new WeakMap),r=r.get(o)}return r.set(e[e.length-1],n),this}delete(e){let n=this.weakMap;for(let r=0;r<e.length-1;r++)if(n=n.get(e[r]),n===void 0)return!1;return n.delete(e[e.length-1])}}let YEe=0;function ZEe(i){const e=Object.keys(i);let n=Object.getPrototypeOf(i);for(;n;){const r=Object.getOwnPropertyDescriptors(n);for(const s in r)if(r[s]!==void 0){const o=r[s];o&&typeof o.get=="function"&&e.push(s)}n=Object.getPrototypeOf(n)}return e}class QEe{constructor(e,n,r,s,o,a,l,c,u,d){this.id=YEe++,this._nodes=e,this._geometries=n,this.renderer=r,this.object=s,this.material=o,this.scene=a,this.camera=l,this.lightsNode=c,this.context=u,this.geometry=s.geometry,this.version=o.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=d,this.clippingContextCacheKey=d!==null?d.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const n of this.getBindings())if(n.name===e)return n}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,n=this.geometry,r=[],s=new Set;for(const o of e){const a=o.node&&o.node.attribute?o.node.attribute:n.getAttribute(o.name);if(a===void 0)continue;r.push(a);const l=a.isInterleavedBufferAttribute?a.data:a;s.add(l)}return this.attributes=r,this.vertexBuffers=Array.from(s.values()),r}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:n,geometry:r,group:s,drawRange:o}=this,a=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),l=this.getIndex(),c=l!==null;let u=1;if(r.isInstancedBufferGeometry===!0?u=r.instanceCount:e.count!==void 0&&(u=Math.max(0,e.count)),u===0)return null;if(a.instanceCount=u,e.isBatchedMesh===!0)return a;let d=1;n.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(d=2);let h=o.start*d,f=(o.start+o.count)*d;s!==null&&(h=Math.max(h,s.start*d),f=Math.min(f,(s.start+s.count)*d));const p=r.attributes.position;let m=1/0;c?m=l.count:p!=null&&(m=p.count),h=Math.max(h,0),f=Math.min(f,m);const y=f-h;return y<0||y===1/0?null:(a.vertexCount=y,a.firstVertex=h,a)}getGeometryCacheKey(){const{geometry:e}=this;let n="";for(const r of Object.keys(e.attributes).sort()){const s=e.attributes[r];n+=r+",",s.data&&(n+=s.data.stride+","),s.offset&&(n+=s.offset+","),s.itemSize&&(n+=s.itemSize+","),s.normalized&&(n+="n,")}for(const r of Object.keys(e.morphAttributes).sort()){const s=e.morphAttributes[r];n+="morph-"+r+",";for(let o=0,a=s.length;o<a;o++){const l=s[o];n+=l.id+","}}return e.index&&(n+="index,"),n}getMaterialCacheKey(){const{object:e,material:n}=this;let r=n.customProgramCacheKey();for(const s of ZEe(n)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(s))continue;const o=n[s];let a;if(o!==null){const l=typeof o;l==="number"?a=o!==0?"1":"0":l==="object"?(a="{",o.isTexture&&(a+=o.mapping),a+="}"):a=String(o)}else a=String(o);r+=a+","}return r+=this.clippingContextCacheKey+",",e.geometry&&(r+=this.getGeometryCacheKey()),e.skeleton&&(r+=e.skeleton.bones.length+","),e.isBatchedMesh&&(r+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(r+=e._colorsTexture.uuid+",")),e.count>1&&(r+=e.uuid+","),r+=e.receiveShadow+",",mbe(r)}get needsGeometryUpdate(){return this.geometry.id!==this.object.geometry.id}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=u0(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=u0(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const Wu=[];class JEe{constructor(e,n,r,s,o,a){this.renderer=e,this.nodes=n,this.geometries=r,this.pipelines=s,this.bindings=o,this.info=a,this.chainMaps={}}get(e,n,r,s,o,a,l,c){const u=this.getChainMap(c);Wu[0]=e,Wu[1]=n,Wu[2]=a,Wu[3]=o;let d=u.get(Wu);return d===void 0?(d=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,n,r,s,o,a,l,c),u.set(Wu,d)):(d.updateClipping(l),d.needsGeometryUpdate&&d.setGeometry(e.geometry),(d.version!==n.version||d.needsUpdate)&&(d.initialCacheKey!==d.getCacheKey()?(d.dispose(),d=this.get(e,n,r,s,o,a,l,c)):d.version=n.version)),Wu.length=0,d}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new va)}dispose(){this.chainMaps={}}createRenderObject(e,n,r,s,o,a,l,c,u,d,h){const f=this.getChainMap(h),p=new QEe(e,n,r,s,o,a,l,c,u,d);return p.onDispose=()=>{this.pipelines.delete(p),this.bindings.delete(p),this.nodes.delete(p),f.delete(p.getChainArray())},p}}class Nu{constructor(){this.data=new WeakMap}get(e){let n=this.data.get(e);return n===void 0&&(n={},this.data.set(e,n)),n}delete(e){let n=null;return this.data.has(e)&&(n=this.data.get(e),this.data.delete(e)),n}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const Co={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},jc=16,eMe=211,tMe=212;class nMe extends Nu{constructor(e){super(),this.backend=e}delete(e){const n=super.delete(e);return n!==null&&this.backend.destroyAttribute(e),n}update(e,n){const r=this.get(e);if(r.version===void 0)n===Co.VERTEX?this.backend.createAttribute(e):n===Co.INDEX?this.backend.createIndexAttribute(e):n===Co.STORAGE?this.backend.createStorageAttribute(e):n===Co.INDIRECT&&this.backend.createIndirectStorageAttribute(e),r.version=this._getBufferAttribute(e).version;else{const s=this._getBufferAttribute(e);(r.version<s.version||s.usage===vf)&&(this.backend.updateAttribute(e),r.version=s.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function X8(i){return i.index!==null?i.index.version:i.attributes.position.version}function xB(i){const e=[],n=i.index,r=i.attributes.position;if(n!==null){const o=n.array;for(let a=0,l=o.length;a<l;a+=3){const c=o[a+0],u=o[a+1],d=o[a+2];e.push(c,u,u,d,d,c)}}else{const o=r.array;for(let a=0,l=o.length/3-1;a<l;a+=3){const c=a+0,u=a+1,d=a+2;e.push(c,u,u,d,d,c)}}const s=new(QN(e)?n2:t2)(e,1);return s.version=X8(i),s}class iMe extends Nu{constructor(e,n){super(),this.attributes=e,this.info=n,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const n=e.geometry;return super.has(n)&&this.get(n).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const n=e.geometry,r=this.get(n);r.initialized=!0,this.info.memory.geometries++;const s=()=>{this.info.memory.geometries--;const o=n.index,a=e.getAttributes();o!==null&&this.attributes.delete(o);for(const c of a)this.attributes.delete(c);const l=this.wireframes.get(n);l!==void 0&&this.attributes.delete(l),n.removeEventListener("dispose",s)};n.addEventListener("dispose",s)}updateAttributes(e){const n=e.getAttributes();for(const o of n)o.isStorageBufferAttribute||o.isStorageInstancedBufferAttribute?this.updateAttribute(o,Co.STORAGE):this.updateAttribute(o,Co.VERTEX);const r=this.getIndex(e);r!==null&&this.updateAttribute(r,Co.INDEX);const s=e.geometry.indirect;s!==null&&this.updateAttribute(s,Co.INDIRECT)}updateAttribute(e,n){const r=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,n),this.attributeCall.set(e,r)):this.attributeCall.get(e.data)!==r&&(this.attributes.update(e,n),this.attributeCall.set(e.data,r),this.attributeCall.set(e,r)):this.attributeCall.get(e)!==r&&(this.attributes.update(e,n),this.attributeCall.set(e,r))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:n,material:r}=e;let s=n.index;if(r.wireframe===!0){const o=this.wireframes;let a=o.get(n);a===void 0?(a=xB(n),o.set(n,a)):a.version!==X8(n)&&(this.attributes.delete(a),a=xB(n),o.set(n,a)),s=a}return s}}class rMe{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,n,r){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=r*(n/3):e.isPoints?this.render.points+=r*n:e.isLineSegments?this.render.lines+=r*(n/2):e.isLine?this.render.lines+=r*(n-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class K8{constructor(e){this.cacheKey=e,this.usedTimes=0}}class sMe extends K8{constructor(e,n,r){super(e),this.vertexProgram=n,this.fragmentProgram=r}}class oMe extends K8{constructor(e,n){super(e),this.computeProgram=n,this.isComputePipeline=!0}}let aMe=0;class RM{constructor(e,n,r,s=null,o=null){this.id=aMe++,this.code=e,this.stage=n,this.name=r,this.transforms=s,this.attributes=o,this.usedTimes=0}}class lMe extends Nu{constructor(e,n){super(),this.backend=e,this.nodes=n,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,n){const{backend:r}=this,s=this.get(e);if(this._needsComputeUpdate(e)){const o=s.pipeline;o&&(o.usedTimes--,o.computeProgram.usedTimes--);const a=this.nodes.getForCompute(e);let l=this.programs.compute.get(a.computeShader);l===void 0&&(o&&o.computeProgram.usedTimes===0&&this._releaseProgram(o.computeProgram),l=new RM(a.computeShader,"compute",e.name,a.transforms,a.nodeAttributes),this.programs.compute.set(a.computeShader,l),r.createProgram(l));const c=this._getComputeCacheKey(e,l);let u=this.caches.get(c);u===void 0&&(o&&o.usedTimes===0&&this._releasePipeline(o),u=this._getComputePipeline(e,l,c,n)),u.usedTimes++,l.usedTimes++,s.version=e.version,s.pipeline=u}return s.pipeline}getForRender(e,n=null){const{backend:r}=this,s=this.get(e);if(this._needsRenderUpdate(e)){const o=s.pipeline;o&&(o.usedTimes--,o.vertexProgram.usedTimes--,o.fragmentProgram.usedTimes--);const a=e.getNodeBuilderState(),l=e.material?e.material.name:"";let c=this.programs.vertex.get(a.vertexShader);c===void 0&&(o&&o.vertexProgram.usedTimes===0&&this._releaseProgram(o.vertexProgram),c=new RM(a.vertexShader,"vertex",l),this.programs.vertex.set(a.vertexShader,c),r.createProgram(c));let u=this.programs.fragment.get(a.fragmentShader);u===void 0&&(o&&o.fragmentProgram.usedTimes===0&&this._releaseProgram(o.fragmentProgram),u=new RM(a.fragmentShader,"fragment",l),this.programs.fragment.set(a.fragmentShader,u),r.createProgram(u));const d=this._getRenderCacheKey(e,c,u);let h=this.caches.get(d);h===void 0?(o&&o.usedTimes===0&&this._releasePipeline(o),h=this._getRenderPipeline(e,c,u,d,n)):e.pipeline=h,h.usedTimes++,c.usedTimes++,u.usedTimes++,s.pipeline=h}return s.pipeline}delete(e){const n=this.get(e).pipeline;return n&&(n.usedTimes--,n.usedTimes===0&&this._releasePipeline(n),n.isComputePipeline?(n.computeProgram.usedTimes--,n.computeProgram.usedTimes===0&&this._releaseProgram(n.computeProgram)):(n.fragmentProgram.usedTimes--,n.vertexProgram.usedTimes--,n.vertexProgram.usedTimes===0&&this._releaseProgram(n.vertexProgram),n.fragmentProgram.usedTimes===0&&this._releaseProgram(n.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,n,r,s){r=r||this._getComputeCacheKey(e,n);let o=this.caches.get(r);return o===void 0&&(o=new oMe(r,n),this.caches.set(r,o),this.backend.createComputePipeline(o,s)),o}_getRenderPipeline(e,n,r,s,o){s=s||this._getRenderCacheKey(e,n,r);let a=this.caches.get(s);return a===void 0&&(a=new sMe(s,n,r),this.caches.set(s,a),e.pipeline=a,this.backend.createRenderPipeline(e,o)),a}_getComputeCacheKey(e,n){return e.id+","+n.id}_getRenderCacheKey(e,n,r){return n.id+","+r.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const n=e.code,r=e.stage;this.programs[r].delete(n)}_needsComputeUpdate(e){const n=this.get(e);return n.pipeline===void 0||n.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class cMe extends Nu{constructor(e,n,r,s,o,a){super(),this.backend=e,this.textures=r,this.pipelines=o,this.attributes=s,this.nodes=n,this.info=a,this.pipelines.bindings=this}getForRender(e){const n=e.getBindings();for(const r of n){const s=this.get(r);s.bindGroup===void 0&&(this._init(r),this.backend.createBindings(r,n,0),s.bindGroup=r)}return n}getForCompute(e){const n=this.nodes.getForCompute(e).bindings;for(const r of n){const s=this.get(r);s.bindGroup===void 0&&(this._init(r),this.backend.createBindings(r,n,0),s.bindGroup=r)}return n}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const n of e)this._update(n,e)}_init(e){for(const n of e.bindings)if(n.isSampledTexture)this.textures.updateTexture(n.texture);else if(n.isStorageBuffer){const r=n.attribute,s=r.isIndirectStorageBufferAttribute?Co.INDIRECT:Co.STORAGE;this.attributes.update(r,s)}}_update(e,n){const{backend:r}=this;let s=!1,o=!0,a=0,l=0;for(const c of e.bindings)if(!(c.isNodeUniformsGroup&&this.nodes.updateGroup(c)===!1)){if(c.isStorageBuffer){const u=c.attribute,d=u.isIndirectStorageBufferAttribute?Co.INDIRECT:Co.STORAGE;this.attributes.update(u,d)}if(c.isUniformBuffer)c.update()&&r.updateBinding(c);else if(c.isSampler)c.update();else if(c.isSampledTexture){const u=this.textures.get(c.texture);c.needsBindingsUpdate(u.generation)&&(s=!0);const d=c.update(),h=c.texture;d&&this.textures.updateTexture(h);const f=r.get(h);if(f.externalTexture!==void 0||u.isDefaultTexture?o=!1:(a=a*10+h.id,l+=h.version),r.isWebGPUBackend===!0&&f.texture===void 0&&f.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",c,d,h,c.textureNode.value,s),this.textures.updateTexture(h),s=!0),h.isStorageTexture===!0){const p=this.get(h);c.store===!0?p.needsMipmap=!0:this.textures.needsMipmaps(h)&&p.needsMipmap===!0&&(this.backend.generateMipmaps(h),p.needsMipmap=!1)}}}s===!0&&this.backend.updateBindings(e,n,o?a:0,l)}}function uMe(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?i.z-e.z:i.id-e.id}function _B(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function bB(i){return(i.transmission>0||i.transmissionNode)&&i.side===Qr&&i.forceSinglePass===!1}class dMe{constructor(e,n,r){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(n,r),this.lightsArray=[],this.scene=n,this.camera=r,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,n,r,s,o,a,l){let c=this.renderItems[this.renderItemsIndex];return c===void 0?(c={id:e.id,object:e,geometry:n,material:r,groupOrder:s,renderOrder:e.renderOrder,z:o,group:a,clippingContext:l},this.renderItems[this.renderItemsIndex]=c):(c.id=e.id,c.object=e,c.geometry=n,c.material=r,c.groupOrder=s,c.renderOrder=e.renderOrder,c.z=o,c.group=a,c.clippingContext=l),this.renderItemsIndex++,c}push(e,n,r,s,o,a,l){const c=this.getNextRenderItem(e,n,r,s,o,a,l);e.occlusionTest===!0&&this.occlusionQueryCount++,r.transparent===!0||r.transmission>0?(bB(r)&&this.transparentDoublePass.push(c),this.transparent.push(c)):this.opaque.push(c)}unshift(e,n,r,s,o,a,l){const c=this.getNextRenderItem(e,n,r,s,o,a,l);r.transparent===!0||r.transmission>0?(bB(r)&&this.transparentDoublePass.unshift(c),this.transparent.unshift(c)):this.opaque.unshift(c)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,n){this.opaque.length>1&&this.opaque.sort(e||uMe),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(n||_B),this.transparent.length>1&&this.transparent.sort(n||_B)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,n=this.renderItems.length;e<n;e++){const r=this.renderItems[e];if(r.id===null)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.groupOrder=null,r.renderOrder=null,r.z=null,r.group=null,r.clippingContext=null}}}const tg=[];class hMe{constructor(e){this.lighting=e,this.lists=new va}get(e,n){const r=this.lists;tg[0]=e,tg[1]=n;let s=r.get(tg);return s===void 0&&(s=new dMe(this.lighting,e,n),r.set(tg,s)),tg.length=0,s}dispose(){this.lists=new va}}let fMe=0;class pMe{constructor(){this.id=fMe++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new Dt,this.scissor=!1,this.scissorValue=new Dt,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return Y8(this)}}function Y8(i){const{textures:e,activeCubeFace:n}=i,r=[n];for(const s of e)r.push(s.id);return C2(r)}const ng=[],mMe=new iw,gMe=new i2;class yMe{constructor(){this.chainMaps={}}get(e,n,r=null){ng[0]=e,ng[1]=n;let s;if(r===null)s="default";else{const l=r.texture.format;s=`${r.textures.length}:${l}:${r.samples}:${r.depthBuffer}:${r.stencilBuffer}`}const o=this._getChainMap(s);let a=o.get(ng);return a===void 0&&(a=new pMe,o.set(ng,a)),ng.length=0,r!==null&&(a.sampleCount=r.samples===0?1:r.samples),a}getForClear(e=null){return this.get(mMe,gMe,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new va)}dispose(){this.chainMaps={}}}const vMe=new K;class xMe extends Nu{constructor(e,n,r){super(),this.renderer=e,this.backend=n,this.info=r}updateRenderTarget(e,n=0){const r=this.get(e),s=e.samples===0?1:e.samples,o=r.depthTextureMips||(r.depthTextureMips={}),a=e.textures,l=this.getSize(a[0]),c=l.width>>n,u=l.height>>n;let d=e.depthTexture||o[n];const h=e.depthBuffer===!0||e.stencilBuffer===!0;let f=!1;d===void 0&&h&&(e.multiview===!0&&l.depth>1?d=new oG:d=new ro,d.format=e.stencilBuffer?io:no,d.type=e.stencilBuffer?to:Dn,d.image.width=c,d.image.height=u,d.image.depth=l.depth,o[n]=d),(r.width!==l.width||l.height!==r.height)&&(f=!0,d&&(d.needsUpdate=!0,d.image.width=c,d.image.height=u,d.image.depth=d.isDepthArrayTexture?d.image.depth:1)),r.width=l.width,r.height=l.height,r.textures=a,r.depthTexture=d||null,r.depth=e.depthBuffer,r.stencil=e.stencilBuffer,r.renderTarget=e,r.sampleCount!==s&&(f=!0,d&&(d.needsUpdate=!0),r.sampleCount=s);const p={sampleCount:s};if(e.isXRRenderTarget!==!0){for(let m=0;m<a.length;m++){const y=a[m];y.isTextureArray=e.multiview===!0&&l.depth>1,f&&(y.needsUpdate=!0),this.updateTexture(y,p)}d&&this.updateTexture(d,p)}if(r.initialized!==!0){r.initialized=!0;const m=()=>{e.removeEventListener("dispose",m);for(let y=0;y<a.length;y++)this._destroyTexture(a[y]);d&&this._destroyTexture(d),this.delete(e)};e.addEventListener("dispose",m)}}updateTexture(e,n={}){const r=this.get(e);if(r.initialized===!0&&r.version===e.version)return;const s=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,o=this.backend;if(s&&r.initialized===!0&&(o.destroySampler(e),o.destroyTexture(e)),e.isFramebufferTexture){const u=this.renderer.getRenderTarget();u?e.type=u.texture.type:e.type=ci}const{width:a,height:l,depth:c}=this.getSize(e);if(n.width=a,n.height=l,n.depth=c,n.needsMipmaps=this.needsMipmaps(e),n.levels=n.needsMipmaps?this.getMipLevels(e,a,l):1,s||e.isStorageTexture===!0)o.createSampler(e),o.createTexture(e,n),r.generation=e.version;else if(r.initialized!==!0&&o.createSampler(e),e.version>0){const d=e.image;if(d===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(d.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const h=[];for(const f of e.images)h.push(f);n.images=h}else n.image=d;(r.isDefaultTexture===void 0||r.isDefaultTexture===!0)&&(o.createTexture(e,n),r.isDefaultTexture=!1,r.generation=e.version),e.source.dataReady===!0&&o.updateTexture(e,n),n.needsMipmaps&&e.mipmaps.length===0&&o.generateMipmaps(e)}}else o.createDefaultTexture(e),r.isDefaultTexture=!0,r.generation=e.version;if(r.initialized!==!0){r.initialized=!0,r.generation=e.version,this.info.memory.textures++;const u=()=>{e.removeEventListener("dispose",u),this._destroyTexture(e)};e.addEventListener("dispose",u)}r.version=e.version}getSize(e,n=vMe){let r=e.images?e.images[0]:e.image;return r?(r.image!==void 0&&(r=r.image),n.width=r.width||1,n.height=r.height||1,n.depth=e.isCubeTexture?6:r.depth||1):n.width=n.height=n.depth=1,n}getMipLevels(e,n,r){let s;return e.isCompressedTexture?e.mipmaps?s=e.mipmaps.length:s=1:s=Math.floor(Math.log2(Math.max(n,r)))+1,s}needsMipmaps(e){return e.isCompressedTexture===!0||e.generateMipmaps}_destroyTexture(e){this.has(e)===!0&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class J2 extends St{constructor(e,n,r,s=1){super(e,n,r),this.a=s}set(e,n,r,s=1){return this.a=s,super.set(e,n,r)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class _Me extends En{static get type(){return"ParameterNode"}constructor(e,n=null){super(e,n),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class bMe extends Ht{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}getMemberType(e,n){return this.outputNode?this.outputNode.getMemberType(e,n):"void"}add(e){return this.nodes.push(e),this}If(e,n){const r=new Eg(n);return this._currentCond=rs(e,r),this.add(this._currentCond)}ElseIf(e,n){const r=new Eg(n),s=rs(e,r);return this._currentCond.elseNode=s,this._currentCond=s,this}Else(e){return this._currentCond.elseNode=new Eg(e),this}Switch(e){return this._expressionNode=De(e),this}Case(...e){const n=[];if(e.length>=2)for(let l=0;l<e.length-1;l++)n.push(this._expressionNode.equal(De(e[l])));else throw new Error("TSL: Invalid parameter length. Case() requires at least two parameters.");const r=e[e.length-1],s=new Eg(r);let o=n[0];for(let l=1;l<n.length;l++)o=o.or(n[l]);const a=rs(o,s);return this._currentCond===null?(this._currentCond=a,this.add(this._currentCond)):(this._currentCond.elseNode=a,this._currentCond=a,this)}Default(e){return this.Else(e),this}build(e,...n){const r=zH();m1(this);for(const s of this.nodes)s.build(e,"void");return m1(r),this.outputNode?this.outputNode.build(e,...n):super.build(e,...n)}else(...e){return console.warn("THREE.TSL: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("THREE.TSL: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const PM=Re(bMe).setParameterLength(0,1);new Ws;new K;new K;new K;new ln;new K(0,0,-1);new Dt;new K;new K;new Dt;new Oe;const SMe=new Eu;Yf.flipX();SMe.depthTexture=new ro(1,1);const NM=new j0(-1,1,1,-1,0,1);class wMe extends Tr{constructor(e=!1){super();const n=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Ti([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Ti(n,2))}}const TMe=new wMe;class Z8 extends Xn{constructor(e=null){super(TMe,e),this.camera=NM,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,NM)}render(e){e.render(this,NM)}}const ig=new ks,kM=new ln;class ws extends Ht{static get type(){return"SceneNode"}constructor(e=ws.BACKGROUND_BLURRINESS,n=null){super(),this.scope=e,this.scene=n}setup(e){const n=this.scope,r=this.scene!==null?this.scene:e.scene;let s;return n===ws.BACKGROUND_BLURRINESS?s=In("backgroundBlurriness","float",r):n===ws.BACKGROUND_INTENSITY?s=In("backgroundIntensity","float",r):n===ws.BACKGROUND_ROTATION?s=zt("mat4").label("backgroundRotation").setGroup(Ut).onRenderUpdate(()=>{const o=r.background;return o!==null&&o.isTexture&&o.mapping!==VN?(ig.copy(r.backgroundRotation),ig.x*=-1,ig.y*=-1,ig.z*=-1,kM.makeRotationFromEuler(ig)):kM.identity(),kM}):console.error("THREE.SceneNode: Unknown scope:",n),s}}ws.BACKGROUND_BLURRINESS="backgroundBlurriness";ws.BACKGROUND_INTENSITY="backgroundIntensity";ws.BACKGROUND_ROTATION="backgroundRotation";const EMe=je(ws,ws.BACKGROUND_BLURRINESS),SB=je(ws,ws.BACKGROUND_INTENSITY),MMe=je(ws,ws.BACKGROUND_ROTATION),AMe=Le(({texture:i,uv:e})=>{const r=Te().toVar();return Ei(e.x.lessThan(1e-4),()=>{r.assign(Te(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{r.assign(Te(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{r.assign(Te(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{r.assign(Te(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{r.assign(Te(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{r.assign(Te(0,0,-1))}).Else(()=>{const o=i.sample(e.add(Te(-.01,0,0))).r.sub(i.sample(e.add(Te(.01,0,0))).r),a=i.sample(e.add(Te(0,-.01,0))).r.sub(i.sample(e.add(Te(0,.01,0))).r),l=i.sample(e.add(Te(0,0,-.01))).r.sub(i.sample(e.add(Te(0,0,.01))).r);r.assign(Te(o,a,l))}),r.normalize()});class CMe extends cm{static get type(){return"Texture3DNode"}constructor(e,n=null,r=null){super(e,n,r),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return Te(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,n){const r=this.value;return e.isFlipY()&&(r.isRenderTargetTexture===!0||r.isFramebufferTexture===!0)&&(this.sampler?n=n.flipY():n=n.setY(Un(Kf(this,this.levelNode).y).sub(n.y).sub(1))),n}generateUV(e,n){return n.build(e,"vec3")}normal(e){return AMe({texture:this,uv:e})}}const RMe=Re(CMe).setParameterLength(1,3),qx=new Oe;class PMe extends cm{static get type(){return"PassTextureNode"}constructor(e,n){super(n),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class wB extends PMe{static get type(){return"PassMultipleTextureNode"}constructor(e,n,r=!1){super(e,null),this.textureName=n,this.previousTexture=r}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class Tw extends zi{static get type(){return"PassNode"}constructor(e,n,r,s={}){super("vec4"),this.scope=e,this.scene=n,this.camera=r,this.options=s,this._pixelRatio=1,this._width=1,this._height=1;const o=new ro;o.isRenderTargetTexture=!0,o.name="depth";const a=new Eu(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:lr,...s});a.texture.name="output",a.depthTexture=o,this.renderTarget=a,this._textures={output:a.texture,depth:o},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=zt(0),this._cameraFar=zt(0),this._mrt=null,this._layers=null,this._resolution=1,this.isPassNode=!0,this.updateBeforeType=sn.FRAME}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}isGlobal(){return!0}getTexture(e){let n=this._textures[e];return n===void 0&&(n=this.renderTarget.texture.clone(),n.name=e,this._textures[e]=n,this.renderTarget.textures.push(n)),n}getPreviousTexture(e){let n=this._previousTextures[e];return n===void 0&&(n=this.getTexture(e).clone(),this._previousTextures[e]=n),n}toggleTexture(e){const n=this._previousTextures[e];if(n!==void 0){const r=this._textures[e],s=this.renderTarget.textures.indexOf(r);this.renderTarget.textures[s]=n,this._textures[e]=n,this._previousTextures[e]=r,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let n=this._textureNodes[e];return n===void 0&&(n=De(new wB(this,e)),n.updateTexture(),this._textureNodes[e]=n),n}getPreviousTextureNode(e="output"){let n=this._previousTextureNodes[e];return n===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),n=De(new wB(this,e,!0)),n.updateTexture(),this._previousTextureNodes[e]=n),n}getViewZNode(e="depth"){let n=this._viewZNodes[e];if(n===void 0){const r=this._cameraNear,s=this._cameraFar;this._viewZNodes[e]=n=A8(this.getTextureNode(e),r,s)}return n}getLinearDepthNode(e="depth"){let n=this._linearDepthNodes[e];if(n===void 0){const r=this._cameraNear,s=this._cameraFar,o=this.getViewZNode(e);this._linearDepthNodes[e]=n=ey(o,r,s)}return n}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.texture.type=e.getColorBufferType(),this.scope===Tw.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:n}=e,{scene:r}=this;let s,o;const a=n.getOutputRenderTarget();a&&a.isXRRenderTarget===!0?(o=1,s=n.xr.getCamera(),n.xr.updateCamera(s),qx.set(a.width,a.height)):(s=this.camera,o=n.getPixelRatio(),n.getSize(qx)),this._pixelRatio=o,this.setSize(qx.width,qx.height);const l=n.getRenderTarget(),c=n.getMRT(),u=s.layers.mask;this._cameraNear.value=s.near,this._cameraFar.value=s.far,this._layers!==null&&(s.layers.mask=this._layers.mask);for(const d in this._previousTextures)this.toggleTexture(d);n.setRenderTarget(this.renderTarget),n.setMRT(this._mrt),n.render(r,s),n.setRenderTarget(l),n.setMRT(c),s.layers.mask=u}setSize(e,n){this._width=e,this._height=n;const r=this._width*this._pixelRatio*this._resolution,s=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(r,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}Tw.COLOR="color";Tw.DEPTH="depth";const NMe=Le(([i,e])=>i.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),kMe=Le(([i,e])=>(i=i.mul(e),i.div(i.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),LMe=Le(([i,e])=>{i=i.mul(e),i=i.sub(.004).max(0);const n=i.mul(i.mul(6.2).add(.5)),r=i.mul(i.mul(6.2).add(1.7)).add(.06);return n.div(r).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),IMe=Le(([i])=>{const e=i.mul(i.add(.0245786)).sub(90537e-9),n=i.mul(i.add(.432951).mul(.983729)).add(.238081);return e.div(n)}),DMe=Le(([i,e])=>{const n=os(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),r=os(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return i=i.mul(e).div(.6),i=n.mul(i),i=IMe(i),i=r.mul(i),i.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),OMe=os(Te(1.6605,-.1246,-.0182),Te(-.5876,1.1329,-.1006),Te(-.0728,-.0083,1.1187)),FMe=os(Te(.6274,.0691,.0164),Te(.3293,.9195,.088),Te(.0433,.0113,.8956)),BMe=Le(([i])=>{const e=Te(i).toVar(),n=Te(e.mul(e)).toVar(),r=Te(n.mul(n)).toVar();return be(15.5).mul(r.mul(n)).sub(an(40.14,r.mul(e))).add(an(31.96,r).sub(an(6.868,n.mul(e))).add(an(.4298,n).add(an(.1191,e).sub(.00232))))}),UMe=Le(([i,e])=>{const n=Te(i).toVar(),r=os(Te(.856627153315983,.137318972929847,.11189821299995),Te(.0951212405381588,.761241990602591,.0767994186031903),Te(.0482516061458583,.101439036467562,.811302368396859)),s=os(Te(1.1271005818144368,-.1413297634984383,-.14132976349843826),Te(-.11060664309660323,1.157823702216272,-.11060664309660294),Te(-.016493938717834573,-.016493938717834257,1.2519364065950405)),o=be(-12.47393),a=be(4.026069);return n.mulAssign(e),n.assign(FMe.mul(n)),n.assign(r.mul(n)),n.assign(Ls(n,1e-10)),n.assign(jl(n)),n.assign(n.sub(o).div(a.sub(o))),n.assign(ic(n,0,1)),n.assign(BMe(n)),n.assign(s.mul(n)),n.assign(mw(Ls(Te(0),n),Te(2.2))),n.assign(OMe.mul(n)),n.assign(ic(n,0,1)),n}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),zMe=Le(([i,e])=>{const n=be(.76),r=be(.15);i=i.mul(e);const s=f0(i.r,f0(i.g,i.b)),o=rs(s.lessThan(.08),s.sub(an(6.25,s.mul(s))),.04);i.subAssign(o);const a=Ls(i.r,Ls(i.g,i.b));Ei(a.lessThan(n),()=>i);const l=vs(1,n),c=vs(1,l.mul(l).div(a.add(l.sub(n))));i.mulAssign(c.div(a));const u=vs(1,nc(1,r.mul(a.sub(c)).add(1)));return Wn(i,Te(c),u)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class Wi extends Ht{static get type(){return"CodeNode"}constructor(e="",n=[],r=""){super("code"),this.isCodeNode=!0,this.code=e,this.includes=n,this.language=r}isGlobal(){return!0}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const n=this.getIncludes(e);for(const s of n)s.build(e);const r=e.getCodeFromNode(this,this.getNodeType(e));return r.code=this.code,r.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}class VMe extends Wi{static get type(){return"FunctionNode"}constructor(e="",n=[],r=""){super(e,n,r)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const n=e.getDataFromNode(this);let r=n.nodeFunction;return r===void 0&&(r=e.parser.parseFunction(this.code),n.nodeFunction=r),r}generate(e,n){super.generate(e);const r=this.getNodeFunction(e),s=r.name,o=r.type,a=e.getCodeFromNode(this,o);s!==""&&(a.name=s);const l=e.getPropertyName(a),c=this.getNodeFunction(e).getCode(l);return a.code=c+`
`,n==="property"?l:e.format(`${l}()`,o,n)}}function Q8(i){let e;const n=i.context.getViewZ;return n!==void 0&&(e=n(this)),(e||Fi.z).negate()}const $Me=Le(([i,e],n)=>{const r=Q8(n);return vu(i,e,r)}),GMe=Le(([i],e)=>{const n=Q8(e);return i.mul(i,n,n).negate().exp().oneMinus()}),TB=Le(([i,e])=>Gt(e.toFloat().mix(Qg.rgb,i.toVec3()),Qg.a));class HMe extends Ht{constructor(e){super(),this.scope=e}generate(e){const{scope:n}=this,{renderer:r}=e;r.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${n}Barrier 
`):e.addLineFlowCode(`${n}Barrier()`,this)}}Re(HMe);class Ja extends Ht{static get type(){return"AtomicFunctionNode"}constructor(e,n,r){super("uint"),this.method=e,this.pointerNode=n,this.valueNode=r,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const n=e.getNodeProperties(this),r=n.parents,s=this.method,o=this.getNodeType(e),a=this.getInputType(e),l=this.pointerNode,c=this.valueNode,u=[];u.push(`&${l.build(e,a)}`),c!==null&&u.push(c.build(e,a));const d=`${e.getMethod(s,o)}( ${u.join(", ")} )`;if(r.length===1&&r[0].isStackNode===!0)e.addLineFlowCode(d,this);else return n.constNode===void 0&&(n.constNode=kp(d,o).toConst()),n.constNode.build(e)}}Ja.ATOMIC_LOAD="atomicLoad";Ja.ATOMIC_STORE="atomicStore";Ja.ATOMIC_ADD="atomicAdd";Ja.ATOMIC_SUB="atomicSub";Ja.ATOMIC_MAX="atomicMax";Ja.ATOMIC_MIN="atomicMin";Ja.ATOMIC_AND="atomicAnd";Ja.ATOMIC_OR="atomicOr";Ja.ATOMIC_XOR="atomicXor";Re(Ja);let Xx;function Ew(i){Xx=Xx||new WeakMap;let e=Xx.get(i);return e===void 0&&Xx.set(i,e={}),e}function J8(i){const e=Ew(i);return e.shadowMatrix||(e.shadowMatrix=zt("mat4").setGroup(Ut).onRenderUpdate(()=>(i.castShadow!==!0&&i.shadow.updateMatrices(i),i.shadow.matrix)))}function WMe(i,e=p0){const n=J8(i).mul(e);return n.xyz.div(n.w)}function e6(i){const e=Ew(i);return e.position||(e.position=zt(new K).setGroup(Ut).onRenderUpdate((n,r)=>r.value.setFromMatrixPosition(i.matrixWorld)))}function jMe(i){const e=Ew(i);return e.targetPosition||(e.targetPosition=zt(new K).setGroup(Ut).onRenderUpdate((n,r)=>r.value.setFromMatrixPosition(i.target.matrixWorld)))}function t6(i){const e=Ew(i);return e.viewPosition||(e.viewPosition=zt(new K).setGroup(Ut).onRenderUpdate(({camera:n},r)=>{r.value=r.value||new K,r.value.setFromMatrixPosition(i.matrixWorld),r.value.applyMatrix4(n.matrixWorldInverse)}))}const n6=i=>pc.transformDirection(e6(i).sub(jMe(i))),qMe=i=>i.sort((e,n)=>e.id-n.id),XMe=(i,e)=>{for(const n of e)if(n.isAnalyticLightNode&&n.light.id===i)return n;return null},LM=new WeakMap;class i6 extends Ht{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Te().toVar(),this.totalSpecularNode=Te().toVar(),this.outgoingLightNode=Te().toVar(),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=[],n=this._lights;for(let r=0;r<n.length;r++){const s=n[r];if(e.push(s.id),s.isSpotLight===!0){const o=s.map!==null?s.map.id:-1;e.push(o)}}return C2(e)}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const n=[];for(const r of this._lightNodes)n.push(r.getSelf().getHash());this._lightNodesHash="lights-"+n.join(",")}return this._lightNodesHash}analyze(e){const n=e.getDataFromNode(this);for(const r of n.nodes)r.build(e)}setupLightsNode(e){const n=[],r=this._lightNodes,s=qMe(this._lights),o=e.renderer.library;for(const a of s)if(a.isNode)n.push(De(a));else{let l=null;if(r!==null&&(l=XMe(a.id,r)),l===null){const c=o.getLightNodeClass(a.constructor);if(c===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${a.constructor.name}`);continue}let u=null;LM.has(a)?u=LM.get(a):(u=De(new c(a)),LM.set(a,u)),n.push(u)}}this._lightNodes=n}setupDirectLight(e,n,r){const{lightingModel:s,reflectedLight:o}=e.context;s.direct({...r,lightNode:n,reflectedLight:o},e)}setupDirectRectAreaLight(e,n,r){const{lightingModel:s,reflectedLight:o}=e.context;s.directRectArea({...r,lightNode:n,reflectedLight:o},e)}setupLights(e,n){for(const r of n)r.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const n=e.lightsNode;e.lightsNode=this;let r=this.outgoingLightNode;const s=e.context,o=s.lightingModel,a=e.getDataFromNode(this);if(o){const{totalDiffuseNode:l,totalSpecularNode:c}=this;s.outgoingLight=r;const u=e.addStack();a.nodes=u.nodes,o.start(e);const{backdrop:d,backdropAlpha:h}=s,{directDiffuse:f,directSpecular:p,indirectDiffuse:m,indirectSpecular:y}=s.reflectedLight;let v=f.add(m);d!==null&&(h!==null?v=Te(h.mix(v,d)):v=Te(d),s.material.transparent=!0),l.assign(v),c.assign(p.add(y)),r.assign(l.add(c)),o.finish(e),r=r.bypass(e.removeStack())}else a.nodes=[];return e.lightsNode=n,r}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}class KMe extends Ht{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=sn.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:n}){r6.assign(n.receivedShadowPositionNode||e.shadowPositionWorld||p0)}dispose(){this.updateBeforeType=sn.NONE}}const r6=Z0("vec3","shadowPositionWorld");function YMe(i,e={}){return e.toneMapping=i.toneMapping,e.toneMappingExposure=i.toneMappingExposure,e.outputColorSpace=i.outputColorSpace,e.renderTarget=i.getRenderTarget(),e.activeCubeFace=i.getActiveCubeFace(),e.activeMipmapLevel=i.getActiveMipmapLevel(),e.renderObjectFunction=i.getRenderObjectFunction(),e.pixelRatio=i.getPixelRatio(),e.mrt=i.getMRT(),e.clearColor=i.getClearColor(e.clearColor||new St),e.clearAlpha=i.getClearAlpha(),e.autoClear=i.autoClear,e.scissorTest=i.getScissorTest(),e}function ZMe(i,e){return e=YMe(i,e),i.setMRT(null),i.setRenderObjectFunction(null),i.setClearColor(0,1),i.autoClear=!0,e}function QMe(i,e){i.toneMapping=e.toneMapping,i.toneMappingExposure=e.toneMappingExposure,i.outputColorSpace=e.outputColorSpace,i.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),i.setRenderObjectFunction(e.renderObjectFunction),i.setPixelRatio(e.pixelRatio),i.setMRT(e.mrt),i.setClearColor(e.clearColor,e.clearAlpha),i.autoClear=e.autoClear,i.setScissorTest(e.scissorTest)}function JMe(i,e={}){return e.background=i.background,e.backgroundNode=i.backgroundNode,e.overrideMaterial=i.overrideMaterial,e}function eAe(i,e){return e=JMe(i,e),i.background=null,i.backgroundNode=null,i.overrideMaterial=null,e}function tAe(i,e){i.background=e.background,i.backgroundNode=e.backgroundNode,i.overrideMaterial=e.overrideMaterial}function nAe(i,e,n){return n=ZMe(i,n),n=eAe(e,n),n}function iAe(i,e,n){QMe(i,n),tAe(e,n)}const EB=new WeakMap,rAe=Le(({depthTexture:i,shadowCoord:e,depthLayer:n})=>{let r=dn(i,e.xy).label("t_basic");return i.isDepthArrayTexture&&(r=r.depth(n)),r.compare(e.z)}),sAe=Le(({depthTexture:i,shadowCoord:e,shadow:n,depthLayer:r})=>{const s=(v,g)=>{let _=dn(i,v);return i.isDepthArrayTexture&&(_=_.depth(r)),_.compare(g)},o=In("mapSize","vec2",n).setGroup(Ut),a=In("radius","float",n).setGroup(Ut),l=qe(1).div(o),c=l.x.negate().mul(a),u=l.y.negate().mul(a),d=l.x.mul(a),h=l.y.mul(a),f=c.div(2),p=u.div(2),m=d.div(2),y=h.div(2);return as(s(e.xy.add(qe(c,u)),e.z),s(e.xy.add(qe(0,u)),e.z),s(e.xy.add(qe(d,u)),e.z),s(e.xy.add(qe(f,p)),e.z),s(e.xy.add(qe(0,p)),e.z),s(e.xy.add(qe(m,p)),e.z),s(e.xy.add(qe(c,0)),e.z),s(e.xy.add(qe(f,0)),e.z),s(e.xy,e.z),s(e.xy.add(qe(m,0)),e.z),s(e.xy.add(qe(d,0)),e.z),s(e.xy.add(qe(f,y)),e.z),s(e.xy.add(qe(0,y)),e.z),s(e.xy.add(qe(m,y)),e.z),s(e.xy.add(qe(c,h)),e.z),s(e.xy.add(qe(0,h)),e.z),s(e.xy.add(qe(d,h)),e.z)).mul(1/17)}),oAe=Le(({depthTexture:i,shadowCoord:e,shadow:n,depthLayer:r})=>{const s=(h,f)=>{let p=dn(i,h);return i.isDepthArrayTexture&&(p=p.depth(r)),p.compare(f)},o=In("mapSize","vec2",n).setGroup(Ut),a=qe(1).div(o),l=a.x,c=a.y,u=e.xy,d=Pu(u.mul(o).add(.5));return u.subAssign(d.mul(a)),as(s(u,e.z),s(u.add(qe(l,0)),e.z),s(u.add(qe(0,c)),e.z),s(u.add(a),e.z),Wn(s(u.add(qe(l.negate(),0)),e.z),s(u.add(qe(l.mul(2),0)),e.z),d.x),Wn(s(u.add(qe(l.negate(),c)),e.z),s(u.add(qe(l.mul(2),c)),e.z),d.x),Wn(s(u.add(qe(0,c.negate())),e.z),s(u.add(qe(0,c.mul(2))),e.z),d.y),Wn(s(u.add(qe(l,c.negate())),e.z),s(u.add(qe(l,c.mul(2))),e.z),d.y),Wn(Wn(s(u.add(qe(l.negate(),c.negate())),e.z),s(u.add(qe(l.mul(2),c.negate())),e.z),d.x),Wn(s(u.add(qe(l.negate(),c.mul(2))),e.z),s(u.add(qe(l.mul(2),c.mul(2))),e.z),d.x),d.y)).mul(1/9)}),aAe=Le(({depthTexture:i,shadowCoord:e,depthLayer:n})=>{const r=be(1).toVar();let s=dn(i).sample(e.xy);(i.isDepthArrayTexture||i.isDataArrayTexture)&&(s=s.depth(n)),s=s.rg;const o=i8(e.z,s.x);return Ei(o.notEqual(be(1)),()=>{const a=e.z.sub(s.x),l=Ls(0,s.y.mul(s.y));let c=l.div(l.add(a.mul(a)));c=ic(vs(c,.3).div(.95-.3)),r.assign(ic(Ls(o,c)))}),r}),lAe=Le(([i,e,n])=>{let r=p0.sub(i).length();return r=r.sub(e).div(n.sub(e)),r=r.saturate(),r}),cAe=i=>{const e=i.shadow.camera,n=In("near","float",e).setGroup(Ut),r=In("far","float",e).setGroup(Ut),s=WSe(i);return lAe(s,n,r)},uAe=i=>{let e=EB.get(i);if(e===void 0){const n=i.isPointLight?cAe(i):null;e=new er,e.colorNode=Gt(0,0,0,1),e.depthNode=n,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,EB.set(i,e)}return e},MB=new va,Hh=[],dAe=(i,e,n,r)=>{Hh[0]=i,Hh[1]=e;let s=MB.get(Hh);return(s===void 0||s.shadowType!==n||s.useVelocity!==r)&&(s=(o,a,l,c,u,d,...h)=>{(o.castShadow===!0||o.receiveShadow&&n===Hs)&&(r&&(DH(o).useVelocity=!0),o.onBeforeShadow(i,o,l,e.camera,c,a.overrideMaterial,d),i.renderObject(o,a,l,c,u,d,...h),o.onAfterShadow(i,o,l,e.camera,c,a.overrideMaterial,d))},s.shadowType=n,s.useVelocity=r,MB.set(Hh,s)),Hh[0]=null,Hh[1]=null,s},hAe=Le(({samples:i,radius:e,size:n,shadowPass:r,depthLayer:s})=>{const o=be(0).toVar("meanVertical"),a=be(0).toVar("squareMeanVertical"),l=i.lessThanEqual(be(1)).select(be(0),be(2).div(i.sub(1))),c=i.lessThanEqual(be(1)).select(be(0),be(-1));sa({start:Un(0),end:Un(i),type:"int",condition:"<"},({i:d})=>{const h=c.add(be(d).mul(l));let f=r.sample(as(bw.xy,qe(0,h).mul(e)).div(n));(r.value.isDepthArrayTexture||r.value.isDataArrayTexture)&&(f=f.depth(s)),f=f.x,o.addAssign(f),a.addAssign(f.mul(f))}),o.divAssign(i),a.divAssign(i);const u=F2(a.sub(o.mul(o)));return qe(o,u)}),fAe=Le(({samples:i,radius:e,size:n,shadowPass:r,depthLayer:s})=>{const o=be(0).toVar("meanHorizontal"),a=be(0).toVar("squareMeanHorizontal"),l=i.lessThanEqual(be(1)).select(be(0),be(2).div(i.sub(1))),c=i.lessThanEqual(be(1)).select(be(0),be(-1));sa({start:Un(0),end:Un(i),type:"int",condition:"<"},({i:d})=>{const h=c.add(be(d).mul(l));let f=r.sample(as(bw.xy,qe(h,0).mul(e)).div(n));(r.value.isDepthArrayTexture||r.value.isDataArrayTexture)&&(f=f.depth(s)),o.addAssign(f.x),a.addAssign(as(f.y.mul(f.y),f.x.mul(f.x)))}),o.divAssign(i),a.divAssign(i);const u=F2(a.sub(o.mul(o)));return qe(o,u)}),pAe=[rAe,sAe,oAe,aAe];let IM;const Kx=new Z8;class s6 extends KMe{static get type(){return"ShadowNode"}constructor(e,n=null){super(e),this.shadow=n||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:n,depthTexture:r,shadowCoord:s,shadow:o,depthLayer:a}){const l=s.x.greaterThanEqual(0).and(s.x.lessThanEqual(1)).and(s.y.greaterThanEqual(0)).and(s.y.lessThanEqual(1)).and(s.z.lessThanEqual(1)),c=n({depthTexture:r,shadowCoord:s,shadow:o,depthLayer:a});return l.select(c,be(1))}setupShadowCoord(e,n){const{shadow:r}=this,{renderer:s}=e,o=In("bias","float",r).setGroup(Ut);let a=n,l;if(r.camera.isOrthographicCamera||s.logarithmicDepthBuffer!==!0)a=a.xyz.div(a.w),l=a.z,s.coordinateSystem===mu&&(l=l.mul(2).sub(1));else{const c=a.w;a=a.xy.div(c);const u=In("near","float",r.camera).setGroup(Ut),d=In("far","float",r.camera).setGroup(Ut);l=C8(c.negate(),u,d)}return a=Te(a.x,a.y.oneMinus(),l.add(o)),a}getShadowFilterFn(e){return pAe[e]}setupRenderTarget(e,n){const r=new ro(e.mapSize.width,e.mapSize.height);r.name="ShadowDepthTexture",r.compareFunction=QS;const s=n.createRenderTarget(e.mapSize.width,e.mapSize.height);return s.texture.name="ShadowMap",s.texture.type=e.mapType,s.depthTexture=r,{shadowMap:s,depthTexture:r}}setupShadow(e){const{renderer:n}=e,{light:r,shadow:s}=this,o=n.shadowMap.type,{depthTexture:a,shadowMap:l}=this.setupRenderTarget(s,e);if(s.camera.updateProjectionMatrix(),o===Hs){a.compareFunction=null,l.isRenderTargetArray?(l._vsmShadowMapVertical||(l._vsmShadowMapVertical=e.createRenderTargetArray(s.mapSize.width,s.mapSize.height,l.depth,{format:Ol,type:lr,depthBuffer:!1}),l._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=l._vsmShadowMapVertical,l._vsmShadowMapHorizontal||(l._vsmShadowMapHorizontal=e.createRenderTargetArray(s.mapSize.width,s.mapSize.height,l.depth,{format:Ol,type:lr,depthBuffer:!1}),l._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=l._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ol,type:lr,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ol,type:lr,depthBuffer:!1}));let g=dn(a);a.isDepthArrayTexture&&(g=g.depth(this.depthLayer));let _=dn(this.vsmShadowMapVertical.texture);a.isDepthArrayTexture&&(_=_.depth(this.depthLayer));const x=In("blurSamples","float",s).setGroup(Ut),b=In("radius","float",s).setGroup(Ut),S=In("mapSize","vec2",s).setGroup(Ut);let T=this.vsmMaterialVertical||(this.vsmMaterialVertical=new er);T.fragmentNode=hAe({samples:x,radius:b,size:S,shadowPass:g,depthLayer:this.depthLayer}).context(e.getSharedContext()),T.name="VSMVertical",T=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new er),T.fragmentNode=fAe({samples:x,radius:b,size:S,shadowPass:_,depthLayer:this.depthLayer}).context(e.getSharedContext()),T.name="VSMHorizontal"}const c=In("intensity","float",s).setGroup(Ut),u=In("normalBias","float",s).setGroup(Ut),d=J8(r).mul(r6.add(j2.mul(u))),h=this.setupShadowCoord(e,d),f=s.filterNode||this.getShadowFilterFn(n.shadowMap.type)||null;if(f===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const p=o===Hs?this.vsmShadowMapHorizontal.texture:a,m=this.setupShadowFilter(e,{filterFn:f,shadowTexture:l.texture,depthTexture:p,shadowCoord:h,shadow:s,depthLayer:this.depthLayer});let y=dn(l.texture,h);a.isDepthArrayTexture&&(y=y.depth(this.depthLayer));const v=Wn(1,m.rgb.mix(y,1),c.mul(y.a)).toVar();return this.shadowMap=l,this.shadow.map=l,v}setup(e){if(e.renderer.shadowMap.enabled!==!1)return Le(()=>{let n=this._node;return this.setupShadowPosition(e),n===null&&(this._node=n=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(n=e.material.receivedShadowNode(n)),n})()}renderShadow(e){const{shadow:n,shadowMap:r,light:s}=this,{renderer:o,scene:a}=e;n.updateMatrices(s),r.setSize(n.mapSize.width,n.mapSize.height,r.depth),o.render(a,n.camera)}updateShadow(e){const{shadowMap:n,light:r,shadow:s}=this,{renderer:o,scene:a,camera:l}=e,c=o.shadowMap.type,u=n.depthTexture.version;this._depthVersionCached=u;const d=s.camera.layers.mask;s.camera.layers.mask&4294967294||(s.camera.layers.mask=l.layers.mask);const h=o.getRenderObjectFunction(),f=o.getMRT(),p=f?f.has("velocity"):!1;IM=nAe(o,a,IM),a.overrideMaterial=uAe(r),o.setRenderObjectFunction(dAe(o,s,c,p)),o.setClearColor(0,0),o.setRenderTarget(n),this.renderShadow(e),o.setRenderObjectFunction(h),r.isPointLight!==!0&&c===Hs&&this.vsmPass(o),s.camera.layers.mask=d,iAe(o,a,IM)}vsmPass(e){const{shadow:n}=this,r=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(n.mapSize.width,n.mapSize.height,r),this.vsmShadowMapHorizontal.setSize(n.mapSize.width,n.mapSize.height,r),e.setRenderTarget(this.vsmShadowMapVertical),Kx.material=this.vsmMaterialVertical,Kx.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),Kx.material=this.vsmMaterialHorizontal,Kx.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:n}=this;let r=n.needsUpdate||n.autoUpdate;r&&(this._cameraFrameId[e.camera]===e.frameId&&(r=!1),this._cameraFrameId[e.camera]=e.frameId),r&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(n.needsUpdate=!1))}}const mAe=(i,e)=>De(new s6(i,e)),gAe=new St,Ra=Le(([i,e])=>{const n=i.toVar(),r=So(n),s=nc(1,Ls(r.x,Ls(r.y,r.z)));r.mulAssign(s),n.mulAssign(s.mul(e.mul(2).oneMinus()));const o=qe(n.xy).toVar(),l=e.mul(1.5).oneMinus();return Ei(r.z.greaterThanEqual(l),()=>{Ei(n.z.greaterThan(0),()=>{o.x.assign(vs(4,n.x))})}).ElseIf(r.x.greaterThanEqual(l),()=>{const c=_1(n.x);o.x.assign(n.z.mul(c).add(c.mul(2)))}).ElseIf(r.y.greaterThanEqual(l),()=>{const c=_1(n.y);o.x.assign(n.x.add(c.mul(2)).add(2)),o.y.assign(n.z.mul(c).sub(2))}),qe(.125,.25).mul(o).add(qe(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),yAe=Le(({depthTexture:i,bd3D:e,dp:n,texelSize:r})=>dn(i,Ra(e,r.y)).compare(n)),vAe=Le(({depthTexture:i,bd3D:e,dp:n,texelSize:r,shadow:s})=>{const o=In("radius","float",s).setGroup(Ut),a=qe(-1,1).mul(o).mul(r.y);return dn(i,Ra(e.add(a.xyy),r.y)).compare(n).add(dn(i,Ra(e.add(a.yyy),r.y)).compare(n)).add(dn(i,Ra(e.add(a.xyx),r.y)).compare(n)).add(dn(i,Ra(e.add(a.yyx),r.y)).compare(n)).add(dn(i,Ra(e,r.y)).compare(n)).add(dn(i,Ra(e.add(a.xxy),r.y)).compare(n)).add(dn(i,Ra(e.add(a.yxy),r.y)).compare(n)).add(dn(i,Ra(e.add(a.xxx),r.y)).compare(n)).add(dn(i,Ra(e.add(a.yxx),r.y)).compare(n)).mul(1/9)}),xAe=Le(({filterFn:i,depthTexture:e,shadowCoord:n,shadow:r})=>{const s=n.xyz.toVar(),o=s.length(),a=zt("float").setGroup(Ut).onRenderUpdate(()=>r.camera.near),l=zt("float").setGroup(Ut).onRenderUpdate(()=>r.camera.far),c=In("bias","float",r).setGroup(Ut),u=zt(r.mapSize).setGroup(Ut),d=be(1).toVar();return Ei(o.sub(l).lessThanEqual(0).and(o.sub(a).greaterThanEqual(0)),()=>{const h=o.sub(a).div(l.sub(a)).toVar();h.addAssign(c);const f=s.normalize(),p=qe(1).div(u.mul(qe(4,2)));d.assign(i({depthTexture:e,bd3D:f,dp:h,texelSize:p,shadow:r}))}),d}),AB=new Dt,Wh=new Oe,rg=new Oe;class _Ae extends s6{static get type(){return"PointShadowNode"}constructor(e,n=null){super(e,n)}getShadowFilterFn(e){return e===tue?yAe:vAe}setupShadowCoord(e,n){return n}setupShadowFilter(e,{filterFn:n,shadowTexture:r,depthTexture:s,shadowCoord:o,shadow:a}){return xAe({filterFn:n,shadowTexture:r,depthTexture:s,shadowCoord:o,shadow:a})}renderShadow(e){const{shadow:n,shadowMap:r,light:s}=this,{renderer:o,scene:a}=e,l=n.getFrameExtents();rg.copy(n.mapSize),rg.multiply(l),r.setSize(rg.width,rg.height),Wh.copy(n.mapSize);const c=o.autoClear,u=o.getClearColor(gAe),d=o.getClearAlpha();o.autoClear=!1,o.setClearColor(n.clearColor,n.clearAlpha),o.clear();const h=n.getViewportCount();for(let f=0;f<h;f++){const p=n.getViewport(f),m=Wh.x*p.x,y=rg.y-Wh.y-Wh.y*p.y;AB.set(m,y,Wh.x*p.z,Wh.y*p.w),r.viewport.copy(AB),n.updateMatrices(s,f),o.render(a,n.camera)}o.autoClear=c,o.setClearColor(u,d)}}const bAe=(i,e)=>De(new _Ae(i,e));class Zd extends um{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new St,this.colorNode=e&&e.colorNode||zt(this.color).setGroup(Ut),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=sn.FRAME}customCacheKey(){return u0(this.light.id,this.light.castShadow?1:0)}getHash(){return this.light.uuid}getLightVector(e){return t6(this.light).sub(e.context.positionView||Fi)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return mAe(this.light)}setupShadow(e){const{renderer:n}=e;if(n.shadowMap.enabled===!1)return;let r=this.shadowColorNode;if(r===null){const s=this.light.shadow.shadowNode;let o;s!==void 0?o=De(s):o=this.setupShadowNode(),this.shadowNode=o,this.shadowColorNode=r=this.colorNode.mul(o),this.baseColorNode=this.colorNode}this.colorNode=r}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const n=this.setupDirect(e),r=this.setupDirectRectArea(e);n&&e.lightsNode.setupDirectLight(e,this,n),r&&e.lightsNode.setupDirectRectAreaLight(e,this,r)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const o6=Le(({lightDistance:i,cutoffDistance:e,decayExponent:n})=>{const r=i.pow(n).max(.01).reciprocal();return e.greaterThan(0).select(r.mul(i.div(e).pow4().oneMinus().clamp().pow2()),r)}),SAe=({color:i,lightVector:e,cutoffDistance:n,decayExponent:r})=>{const s=e.normalize(),o=e.length(),a=o6({lightDistance:o,cutoffDistance:n,decayExponent:r}),l=i.mul(a);return{lightDirection:s,lightColor:l}};class wAe extends Zd{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=zt(0).setGroup(Ut),this.decayExponentNode=zt(2).setGroup(Ut)}update(e){const{light:n}=this;super.update(e),this.cutoffDistanceNode.value=n.distance,this.decayExponentNode.value=n.decay}setupShadowNode(){return bAe(this.light)}setupDirect(e){return SAe({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}Le(([i=ev()],{renderer:e,material:n})=>{const r=be(1).toVar(),s=o8(i.mul(2).sub(1));if(n.alphaToCoverage&&e.samples>1){const o=be(s.fwidth()).toVar();r.assign(vu(o.oneMinus(),o.add(1),s).oneMinus())}else s.greaterThan(1).discard();return r});const TAe=Le(([i,e])=>{const n=i.x,r=i.y,s=i.z;let o=e.element(0).mul(.886227);return o=o.add(e.element(1).mul(2*.511664).mul(r)),o=o.add(e.element(2).mul(2*.511664).mul(s)),o=o.add(e.element(3).mul(2*.511664).mul(n)),o=o.add(e.element(4).mul(2*.429043).mul(n).mul(r)),o=o.add(e.element(5).mul(2*.429043).mul(r).mul(s)),o=o.add(e.element(6).mul(s.mul(s).mul(.743125).sub(.247708))),o=o.add(e.element(7).mul(2*.429043).mul(n).mul(s)),o=o.add(e.element(8).mul(.429043).mul(an(n,n).sub(an(r,r)))),o}),Xo=new J2;class EAe extends Nu{constructor(e,n){super(),this.renderer=e,this.nodes=n}update(e,n,r){const s=this.renderer,o=this.nodes.getBackgroundNode(e)||e.background;let a=!1;if(o===null)s._clearColor.getRGB(Xo),Xo.a=s._clearColor.a;else if(o.isColor===!0)o.getRGB(Xo),Xo.a=1,a=!0;else if(o.isNode===!0){const u=this.get(e),d=o;Xo.copy(s._clearColor);let h=u.backgroundMesh;if(h===void 0){let v=function(){o.removeEventListener("dispose",v),h.material.dispose(),h.geometry.dispose()};var c=v;const p=z2(Gt(d).mul(SB),{getUV:()=>MMe.mul(y8),getTextureLevel:()=>EMe});let m=T8;m=m.setZ(m.w);const y=new er;y.name="Background.material",y.side=On,y.depthTest=!1,y.depthWrite=!1,y.allowOverride=!1,y.fog=!1,y.lights=!1,y.vertexNode=m,y.colorNode=p,u.backgroundMeshNode=p,u.backgroundMesh=h=new Xn(new Gd(1,32,32),y),h.frustumCulled=!1,h.name="Background.mesh",h.onBeforeRender=function(g,_,x){this.matrixWorld.copyPosition(x.matrixWorld)},o.addEventListener("dispose",v)}const f=d.getCacheKey();u.backgroundCacheKey!==f&&(u.backgroundMeshNode.node=Gt(d).mul(SB),u.backgroundMeshNode.needsUpdate=!0,h.material.needsUpdate=!0,u.backgroundCacheKey=f),n.unshift(h,h.geometry,h.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",o);const l=s.xr.getEnvironmentBlendMode();if(l==="additive"?Xo.set(0,0,0,1):l==="alpha-blend"&&Xo.set(0,0,0,0),s.autoClear===!0||a===!0){const u=r.clearColorValue;u.r=Xo.r,u.g=Xo.g,u.b=Xo.b,u.a=Xo.a,(s.backend.isWebGLBackend===!0||s.alpha===!0)&&(u.r*=u.a,u.g*=u.a,u.b*=u.a),r.depthClearValue=s._clearDepth,r.stencilClearValue=s._clearStencil,r.clearColor=s.autoClearColor===!0,r.clearDepth=s.autoClearDepth===!0,r.clearStencil=s.autoClearStencil===!0}else r.clearColor=!1,r.clearDepth=!1,r.clearStencil=!1}}let MAe=0;class vR{constructor(e="",n=[],r=0,s=[]){this.name=e,this.bindings=n,this.index=r,this.bindingsReference=s,this.id=MAe++}}class AAe{constructor(e,n,r,s,o,a,l,c,u,d=[]){this.vertexShader=e,this.fragmentShader=n,this.computeShader=r,this.transforms=d,this.nodeAttributes=s,this.bindings=o,this.updateNodes=a,this.updateBeforeNodes=l,this.updateAfterNodes=c,this.observer=u,this.usedTimes=0}createBindings(){const e=[];for(const n of this.bindings)if(n.bindings[0].groupNode.shared!==!0){const s=new vR(n.name,[],n.index,n);e.push(s);for(const o of n.bindings)s.bindings.push(o.clone())}else e.push(n);return e}}class CB{constructor(e,n,r=null){this.isNodeAttribute=!0,this.name=e,this.type=n,this.node=r}}class CAe{constructor(e,n,r){this.isNodeUniform=!0,this.name=e,this.type=n,this.node=r.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class a6{constructor(e,n,r=!1,s=null){this.isNodeVar=!0,this.name=e,this.type=n,this.readOnly=r,this.count=s}}class RAe extends a6{constructor(e,n,r=null,s=null){super(e,n),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=r,this.interpolationSampling=s}}class PAe{constructor(e,n,r=""){this.name=e,this.type=n,this.code=r,Object.defineProperty(this,"isNodeCode",{value:!0})}}let NAe=0;class DM{constructor(e=null){this.id=NAe++,this.nodesData=new WeakMap,this.parent=e}getData(e){let n=this.nodesData.get(e);return n===void 0&&this.parent!==null&&(n=this.parent.getData(e)),n}setData(e,n){this.nodesData.set(e,n)}}class kAe{constructor(e,n){this.name=e,this.members=n,this.output=!1}}class ku{constructor(e,n){this.name=e,this.value=n,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class LAe extends ku{constructor(e,n=0){super(e,n),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class IAe extends ku{constructor(e,n=new Oe){super(e,n),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class DAe extends ku{constructor(e,n=new K){super(e,n),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class OAe extends ku{constructor(e,n=new Dt){super(e,n),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class FAe extends ku{constructor(e,n=new St){super(e,n),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class BAe extends ku{constructor(e,n=new rw){super(e,n),this.isMatrix2Uniform=!0,this.boundary=16,this.itemSize=4}}class UAe extends ku{constructor(e,n=new Vt){super(e,n),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class zAe extends ku{constructor(e,n=new ln){super(e,n),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class VAe extends LAe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class $Ae extends IAe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class GAe extends DAe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class HAe extends OAe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class WAe extends FAe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class jAe extends BAe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class qAe extends UAe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class XAe extends zAe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const RB=new WeakMap,KAe=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),Yx=i=>/e/g.test(i)?String(i).replace(/\+/g,""):(i=Number(i),i+(i%1?"":".0"));class l6{constructor(e,n,r){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=n,this.parser=r,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=PM(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new DM,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null}getBindGroupsCache(){let e=RB.get(this.renderer);return e===void 0&&(e=new va,RB.set(this.renderer,e)),e}createRenderTarget(e,n,r){return new Eu(e,n,r)}createRenderTargetArray(e,n,r,s){return new ehe(e,n,r,s)}createCubeRenderTarget(e,n){return new k8(e,n)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,n){const r=this.getBindGroupsCache(),s=[];let o=!0;for(const l of n)s.push(l),o=o&&l.groupNode.shared!==!0;let a;return o?(a=r.get(s),a===void 0&&(a=new vR(e,s,this.bindingsIndexes[e].group,s),r.set(s,a))):a=new vR(e,s,this.bindingsIndexes[e].group,s),a}getBindGroupArray(e,n){const r=this.bindings[n];let s=r[e];return s===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),r[e]=s=[]),s}getBindings(){let e=this.bindGroups;if(e===null){const n={},r=this.bindings;for(const s of T3)for(const o in r[s]){const a=r[s][o];(n[o]||(n[o]=[])).push(...a)}e=[];for(const s in n){const o=n[s],a=this._getBindGroup(s,o);e.push(a)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((n,r)=>n.bindings[0].groupNode.order-r.bindings[0].groupNode.order);for(let n=0;n<e.length;n++){const r=e[n];this.bindingsIndexes[r.name].group=n,r.index=n}}setHashNode(e,n){this.hashNodes[n]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==sn.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const n=e.getUpdateBeforeType(),r=e.getUpdateAfterType();n!==sn.NONE&&this.updateBeforeNodes.push(e.getSelf()),r!==sn.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Xi||e.magFilter===$f||e.magFilter===Dl||e.magFilter===_s||e.minFilter===Xi||e.minFilter===$f||e.minFilter===Dl||e.minFilter===_s}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,n){return this.flowNodes[e].push(n),n}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,n=!0){const r=this.getDataFromNode(e);return r.cache===void 0&&(r.cache=new DM(n?this.getCache():null)),r.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const n=this.getDataFromNode(e);return n.usageCount=n.usageCount===void 0?1:n.usageCount+1,n.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,n){return this.getType(e)+"[ "+n+" ]"}generateArray(e,n,r=null){let s=this.generateArrayDeclaration(e,n)+"( ";for(let o=0;o<n;o++){const a=r?r[o]:null;a!==null?s+=a.build(this,e):s+=this.generateConst(e),o<n-1&&(s+=", ")}return s+=" )",s}generateStruct(e,n,r=null){const s=[];for(const o of n){const{name:a,type:l}=o;r&&r[a]&&r[a].isNode?s.push(r[a].build(this,l)):s.push(this.generateConst(l))}return e+"( "+s.join(", ")+" )"}generateConst(e,n=null){if(n===null&&(e==="float"||e==="int"||e==="uint"?n=0:e==="bool"?n=!1:e==="color"?n=new St:e==="vec2"?n=new Oe:e==="vec3"?n=new K:e==="vec4"&&(n=new Dt)),e==="float")return Yx(n);if(e==="int")return`${Math.round(n)}`;if(e==="uint")return n>=0?`${Math.round(n)}u`:"0u";if(e==="bool")return n?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${Yx(n.r)}, ${Yx(n.g)}, ${Yx(n.b)} )`;const r=this.getTypeLength(e),s=this.getComponentType(e),o=a=>this.generateConst(s,a);if(r===2)return`${this.getType(e)}( ${o(n.x)}, ${o(n.y)} )`;if(r===3)return`${this.getType(e)}( ${o(n.x)}, ${o(n.y)}, ${o(n.z)} )`;if(r===4&&e!=="mat2")return`${this.getType(e)}( ${o(n.x)}, ${o(n.y)}, ${o(n.z)}, ${o(n.w)} )`;if(r>=4&&n&&(n.isMatrix2||n.isMatrix3||n.isMatrix4))return`${this.getType(e)}( ${n.elements.map(o).join(", ")} )`;if(r>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,n){const r=this.attributes;for(const o of r)if(o.name===e)return o;const s=new CB(e,n);return this.registerDeclaration(s),r.push(s),s}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const n=e.type;if(e.isDataTexture){if(n===or)return"int";if(n===Dn)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const n=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return n===null?null:n[1]==="b"?"bool":n[1]==="i"?"int":n[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,n="float"){if(e===1)return n;let r=ybe(e);const s=n==="float"?"":n[0];return/mat2/.test(n)===!0&&(r=r.replace("vec","mat")),s+r}getTypeFromArray(e){return KAe.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const r=n.array,s=e.itemSize,o=e.normalized;let a;return!(e instanceof J$)&&o!==!0&&(a=this.getTypeFromArray(r)),this.getTypeFromLength(s,a)}getTypeLength(e){const n=this.getVectorType(e),r=/vec([2-4])/.exec(n);return r!==null?Number(r[1]):n==="float"||n==="bool"||n==="int"||n==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,n){return this.getTypeFromLength(this.getTypeLength(e),n)}getIntegerType(e){const n=this.getComponentType(e);return n==="int"||n==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=PM(this.stack),this.stacks.push(zH()||this.stack),m1(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,m1(this.stacks.pop()),e}getDataFromNode(e,n=this.shaderStage,r=null){r=r===null?e.isGlobal(this)?this.globalCache:this.cache:r;let s=r.getData(e);return s===void 0&&(s={},r.setData(e,s)),s[n]===void 0&&(s[n]={}),s[n]}getNodeProperties(e,n="any"){const r=this.getDataFromNode(e,n);return r.properties||(r.properties={outputNode:null})}getBufferAttributeFromNode(e,n){const r=this.getDataFromNode(e);let s=r.bufferAttribute;if(s===void 0){const o=this.uniforms.index++;s=new CB("nodeAttribute"+o,n,e),this.bufferAttributes.push(s),r.bufferAttribute=s}return s}getStructTypeFromNode(e,n,r=null,s=this.shaderStage){const o=this.getDataFromNode(e,s,this.globalCache);let a=o.structType;if(a===void 0){const l=this.structs.index++;r===null&&(r="StructType"+l),a=new kAe(r,n),this.structs[s].push(a),o.structType=a}return a}getOutputStructTypeFromNode(e,n){const r=this.getStructTypeFromNode(e,n,"OutputType","fragment");return r.output=!0,r}getUniformFromNode(e,n,r=this.shaderStage,s=null){const o=this.getDataFromNode(e,r,this.globalCache);let a=o.uniform;if(a===void 0){const l=this.uniforms.index++;a=new CAe(s||"nodeUniform"+l,n,e),this.uniforms[r].push(a),this.registerDeclaration(a),o.uniform=a}return a}getArrayCount(e){let n=null;return e.isArrayNode?n=e.count:e.isVarNode&&e.node.isArrayNode&&(n=e.node.count),n}getVarFromNode(e,n=null,r=e.getNodeType(this),s=this.shaderStage,o=!1){const a=this.getDataFromNode(e,s);let l=a.variable;if(l===void 0){const c=o?"_const":"_var",u=this.vars[s]||(this.vars[s]=[]),d=this.vars[c]||(this.vars[c]=0);n===null&&(n=(o?"nodeConst":"nodeVar")+d,this.vars[c]++);const h=this.getArrayCount(e);l=new a6(n,r,o,h),o||u.push(l),this.registerDeclaration(l),a.variable=l}return l}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const n of e.values)if(!this.isDeterministic(n))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,n=null,r=e.getNodeType(this),s=null,o=null){const a=this.getDataFromNode(e,"any");let l=a.varying;if(l===void 0){const c=this.varyings,u=c.length;n===null&&(n="nodeVarying"+u),l=new RAe(n,r,s,o),c.push(l),this.registerDeclaration(l),a.varying=l}return l}registerDeclaration(e){const n=this.shaderStage,r=this.declarations[n]||(this.declarations[n]={}),s=this.getPropertyName(e);let o=1,a=s;for(;r[a]!==void 0;)a=s+"_"+o++;o>1&&(e.name=a,console.warn(`THREE.TSL: Declaration name '${s}' of '${e.type}' already in use. Renamed to '${a}'.`)),r[a]=e}getCodeFromNode(e,n,r=this.shaderStage){const s=this.getDataFromNode(e);let o=s.code;if(o===void 0){const a=this.codes[r]||(this.codes[r]=[]),l=a.length;o=new PAe("nodeCode"+l,n),a.push(o),s.code=o}return o}addFlowCodeHierarchy(e,n){const{flowCodes:r,flowCodeBlock:s}=this.getDataFromNode(e);let o=!0,a=n;for(;a;){if(s.get(a)===!0){o=!1;break}a=this.getDataFromNode(a).parentNodeBlock}if(o)for(const l of r)this.addLineFlowCode(l)}addLineFlowCodeBlock(e,n,r){const s=this.getDataFromNode(e),o=s.flowCodes||(s.flowCodes=[]),a=s.flowCodeBlock||(s.flowCodeBlock=new WeakMap);o.push(n),a.set(r,!0)}addLineFlowCode(e,n=null){return e===""?this:(n!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(n,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const n=e.getNodeType(this),r=this.flowChildNode(e,n);return this.flowsData.set(e,r),r}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const n=new VMe,r=this.currentFunctionNode;return this.currentFunctionNode=n,n.code=this.buildFunctionCode(e),this.currentFunctionNode=r,n}flowShaderNode(e){const n=e.layout,r={[Symbol.iterator](){let a=0;const l=Object.values(this);return{next:()=>({value:l[a],done:a++>=l.length})}}};for(const a of n.inputs)r[a.name]=new _Me(a.type,a.name);e.layout=null;const s=e.call(r),o=this.flowStagesNode(s,n.type);return e.layout=n,o}flowStagesNode(e,n=null){const r=this.flow,s=this.vars,o=this.declarations,a=this.cache,l=this.buildStage,c=this.stack,u={code:""};this.flow=u,this.vars={},this.declarations={},this.cache=new DM,this.stack=PM();for(const d of w3)this.setBuildStage(d),u.result=e.build(this,n);return u.vars=this.getVars(this.shaderStage),this.flow=r,this.vars=s,this.declarations=o,this.cache=a,this.stack=c,this.setBuildStage(l),u}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,n=null){const r=this.flow,s={code:""};return this.flow=s,s.result=e.build(this,n),this.flow=r,s}flowNodeFromShaderStage(e,n,r=null,s=null){const o=this.shaderStage;this.setShaderStage(e);const a=this.flowChildNode(n,r);return s!==null&&(a.code+=`${this.tab+s} = ${a.result};
`),this.flowCode[e]=this.flowCode[e]+a.code,this.setShaderStage(o),a}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,n,r=null){return`${r!==null?this.generateArrayDeclaration(e,r):this.getType(e)} ${n}`}getVars(e){let n="";const r=this.vars[e];if(r!==void 0)for(const s of r)n+=`${this.getVar(s.type,s.name)}; `;return n}getUniforms(){console.warn("Abstract function.")}getCodes(e){const n=this.codes[e];let r="";if(n!==void 0)for(const s of n)r+=s.code+`
`;return r}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:n,renderer:r}=this;if(n!==null){let s=r.library.fromMaterial(n);s===null&&(console.error(`NodeMaterial: Material "${n.type}" is not compatible.`),s=new er),s.build(this)}else this.addFlow("compute",e);for(const s of w3){this.setBuildStage(s),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const o of T3){this.setShaderStage(o);const a=this.flowNodes[o];for(const l of a)s==="generate"?this.flowNode(l):l.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,n){if(n==="float"||n==="int"||n==="uint")return new VAe(e);if(n==="vec2"||n==="ivec2"||n==="uvec2")return new $Ae(e);if(n==="vec3"||n==="ivec3"||n==="uvec3")return new GAe(e);if(n==="vec4"||n==="ivec4"||n==="uvec4")return new HAe(e);if(n==="color")return new WAe(e);if(n==="mat2")return new jAe(e);if(n==="mat3")return new qAe(e);if(n==="mat4")return new XAe(e);throw new Error(`Uniform "${n}" not declared.`)}format(e,n,r){if(n=this.getVectorType(n),r=this.getVectorType(r),n===r||r===null||this.isReference(r))return e;const s=this.getTypeLength(n),o=this.getTypeLength(r);return s===16&&o===9?`${this.getType(r)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:s===9&&o===4?`${this.getType(r)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:s>4||o>4||o===0?e:s===o?`${this.getType(r)}( ${e} )`:s>o?(e=r==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,o)}`,this.format(e,this.getTypeFromLength(o,this.getComponentType(n)),r)):o===4&&s>1?`${this.getType(r)}( ${this.format(e,n,"vec3")}, 1.0 )`:s===2?`${this.getType(r)}( ${this.format(e,n,"vec2")}, 0.0 )`:(s===1&&o>1&&n!==this.getComponentType(r)&&(e=`${this.getType(this.getComponentType(r))}( ${e} )`),`${this.getType(r)}( ${e} )`)}getSignature(){return`// Three.js r${tm} - Node System
`}*[Symbol.iterator](){}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}}class PB{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,n){let r=e.get(n);return r===void 0&&(r={renderMap:new WeakMap,frameMap:new WeakMap},e.set(n,r)),r}updateBeforeNode(e){const n=e.getUpdateBeforeType(),r=e.updateReference(this);if(n===sn.FRAME){const{frameMap:s}=this._getMaps(this.updateBeforeMap,r);s.get(r)!==this.frameId&&e.updateBefore(this)!==!1&&s.set(r,this.frameId)}else if(n===sn.RENDER){const{renderMap:s}=this._getMaps(this.updateBeforeMap,r);s.get(r)!==this.renderId&&e.updateBefore(this)!==!1&&s.set(r,this.renderId)}else n===sn.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const n=e.getUpdateAfterType(),r=e.updateReference(this);if(n===sn.FRAME){const{frameMap:s}=this._getMaps(this.updateAfterMap,r);s.get(r)!==this.frameId&&e.updateAfter(this)!==!1&&s.set(r,this.frameId)}else if(n===sn.RENDER){const{renderMap:s}=this._getMaps(this.updateAfterMap,r);s.get(r)!==this.renderId&&e.updateAfter(this)!==!1&&s.set(r,this.renderId)}else n===sn.OBJECT&&e.updateAfter(this)}updateNode(e){const n=e.getUpdateType(),r=e.updateReference(this);if(n===sn.FRAME){const{frameMap:s}=this._getMaps(this.updateMap,r);s.get(r)!==this.frameId&&e.update(this)!==!1&&s.set(r,this.frameId)}else if(n===sn.RENDER){const{renderMap:s}=this._getMaps(this.updateMap,r);s.get(r)!==this.renderId&&e.update(this)!==!1&&s.set(r,this.renderId)}else n===sn.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class ek{constructor(e,n,r=null,s="",o=!1){this.type=e,this.name=n,this.count=r,this.qualifier=s,this.isConst=o}}ek.isNodeFunctionInput=!0;class YAe extends Zd{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:n6(this.light),lightColor:e}}}const OM=new ln,Zx=new ln;let sg=null;class ZAe extends Zd{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=zt(new K).setGroup(Ut),this.halfWidth=zt(new K).setGroup(Ut),this.updateType=sn.RENDER}update(e){super.update(e);const{light:n}=this,r=e.camera.matrixWorldInverse;Zx.identity(),OM.copy(n.matrixWorld),OM.premultiply(r),Zx.extractRotation(OM),this.halfWidth.value.set(n.width*.5,0,0),this.halfHeight.value.set(0,n.height*.5,0),this.halfWidth.value.applyMatrix4(Zx),this.halfHeight.value.applyMatrix4(Zx)}setupDirectRectArea(e){let n,r;e.isAvailable("float32Filterable")?(n=dn(sg.LTC_FLOAT_1),r=dn(sg.LTC_FLOAT_2)):(n=dn(sg.LTC_HALF_1),r=dn(sg.LTC_HALF_2));const{colorNode:s,light:o}=this,a=t6(o);return{lightColor:s,lightPosition:a,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:n,ltc_2:r}}static setLTC(e){sg=e}}class c6 extends Zd{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=zt(0).setGroup(Ut),this.penumbraCosNode=zt(0).setGroup(Ut),this.cutoffDistanceNode=zt(0).setGroup(Ut),this.decayExponentNode=zt(0).setGroup(Ut)}update(e){super.update(e);const{light:n}=this;this.coneCosNode.value=Math.cos(n.angle),this.penumbraCosNode.value=Math.cos(n.angle*(1-n.penumbra)),this.cutoffDistanceNode.value=n.distance,this.decayExponentNode.value=n.decay}getSpotAttenuation(e){const{coneCosNode:n,penumbraCosNode:r}=this;return vu(n,r,e)}setupDirect(e){const{colorNode:n,cutoffDistanceNode:r,decayExponentNode:s,light:o}=this,a=this.getLightVector(e),l=a.normalize(),c=l.dot(n6(o)),u=this.getSpotAttenuation(c),d=a.length(),h=o6({lightDistance:d,cutoffDistance:r,decayExponent:s});let f=n.mul(u).mul(h);if(o.map){const p=WMe(o,e.context.positionWorld),m=dn(o.map,p.xy).onRenderUpdate(()=>o.map);f=p.mul(2).sub(1).abs().lessThan(1).all().select(f.mul(m),f)}return{lightColor:f,lightDirection:l}}}class QAe extends c6{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e){const n=this.light.iesMap;let r=null;if(n&&n.isTexture===!0){const s=e.acos().mul(1/Math.PI);r=dn(n,qe(s,0),0).r}else r=super.getSpotAttenuation(e);return r}}class JAe extends Zd{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class eCe extends Zd{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=e6(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=zt(new St).setGroup(Ut)}update(e){const{light:n}=this;super.update(e),this.lightPositionNode.object3d=n,this.groundColorNode.value.copy(n.groundColor).multiplyScalar(n.intensity)}setup(e){const{colorNode:n,groundColorNode:r,lightDirectionNode:s}=this,a=ya.dot(s).mul(.5).add(.5),l=Wn(r,n,a);e.context.irradiance.addAssign(l)}}class tCe extends Zd{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const n=[];for(let r=0;r<9;r++)n.push(new K);this.lightProbe=Fa(n)}update(e){const{light:n}=this;super.update(e);for(let r=0;r<9;r++)this.lightProbe.array[r].copy(n.sh.coefficients[r]).multiplyScalar(n.intensity)}setup(e){const n=TAe(y8,this.lightProbe);e.context.irradiance.addAssign(n)}}class u6{parseFunction(){console.warn("Abstract function.")}}class tk{constructor(e,n,r="",s=""){this.type=e,this.inputs=n,this.name=r,this.precision=s}getCode(){console.warn("Abstract function.")}}tk.isNodeFunction=!0;const nCe=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,iCe=/[a-z_0-9]+/ig,NB="#pragma main",rCe=i=>{i=i.trim();const e=i.indexOf(NB),n=e!==-1?i.slice(e+NB.length):i,r=n.match(nCe);if(r!==null&&r.length===5){const s=r[4],o=[];let a=null;for(;(a=iCe.exec(s))!==null;)o.push(a);const l=[];let c=0;for(;c<o.length;){const m=o[c][0]==="const";m===!0&&c++;let y=o[c][0];y==="in"||y==="out"||y==="inout"?c++:y="";const v=o[c++][0];let g=Number.parseInt(o[c][0]);Number.isNaN(g)===!1?c++:g=null;const _=o[c++][0];l.push(new ek(v,_,g,y,m))}const u=n.substring(r[0].length),d=r[3]!==void 0?r[3]:"",h=r[2],f=r[1]!==void 0?r[1]:"",p=e!==-1?i.slice(0,e):"";return{type:h,inputs:l,name:d,precision:f,inputsCode:s,blockCode:u,headerCode:p}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class sCe extends tk{constructor(e){const{type:n,inputs:r,name:s,precision:o,inputsCode:a,blockCode:l,headerCode:c}=rCe(e);super(n,r,s,o),this.inputsCode=a,this.blockCode=l,this.headerCode=c}getCode(e=this.name){let n;const r=this.blockCode;if(r!==""){const{type:s,inputsCode:o,headerCode:a,precision:l}=this;let c=`${s} ${e} ( ${o.trim()} )`;l!==""&&(c=`${l} ${c}`),n=a+c+r}else n="";return n}}class oCe extends u6{parseFunction(e){return new sCe(e)}}const kB=new WeakMap,Aa=[],jh=[];class aCe extends Nu{constructor(e,n){super(),this.renderer=e,this.backend=n,this.nodeFrame=new PB,this.nodeBuilderCache=new Map,this.callHashCache=new va,this.groupsData=new va,this.cacheLib={}}updateGroup(e){const n=e.groupNode,r=n.name;if(r===YH.name)return!0;if(r===Ut.name){const o=this.get(e),a=this.nodeFrame.renderId;return o.renderId!==a?(o.renderId=a,!0):!1}if(r===Jbe.name){const o=this.get(e),a=this.nodeFrame.frameId;return o.frameId!==a?(o.frameId=a,!0):!1}Aa[0]=n,Aa[1]=e;let s=this.groupsData.get(Aa);return s===void 0&&this.groupsData.set(Aa,s={}),Aa.length=0,s.version!==n.version?(s.version=n.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const n=this.get(e);let r=n.nodeBuilderState;if(r===void 0){const{nodeBuilderCache:s}=this,o=this.getForRenderCacheKey(e);if(r=s.get(o),r===void 0){const a=this.backend.createNodeBuilder(e.object,this.renderer);a.scene=e.scene,a.material=e.material,a.camera=e.camera,a.context.material=e.material,a.lightsNode=e.lightsNode,a.environmentNode=this.getEnvironmentNode(e.scene),a.fogNode=this.getFogNode(e.scene),a.clippingContext=e.clippingContext,this.renderer.getRenderTarget()&&this.renderer.getRenderTarget().multiview&&a.enableMultiview(),a.build(),r=this._createNodeBuilderState(a),s.set(o,r)}r.usedTimes++,n.nodeBuilderState=r}return r}delete(e){if(e.isRenderObject){const n=this.get(e).nodeBuilderState;n.usedTimes--,n.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const n=this.get(e);let r=n.nodeBuilderState;if(r===void 0){const s=this.backend.createNodeBuilder(e,this.renderer);s.build(),r=this._createNodeBuilderState(s),n.nodeBuilderState=r}return r}_createNodeBuilderState(e){return new AAe(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let n=null;if(e.environmentNode&&e.environmentNode.isNode)n=e.environmentNode;else{const r=this.get(e);r.environmentNode&&(n=r.environmentNode)}return n}getBackgroundNode(e){this.updateBackground(e);let n=null;if(e.backgroundNode&&e.backgroundNode.isNode)n=e.backgroundNode;else{const r=this.get(e);r.backgroundNode&&(n=r.backgroundNode)}return n}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,n){Aa[0]=e,Aa[1]=n;const r=this.renderer.info.calls,s=this.callHashCache.get(Aa)||{};if(s.callId!==r){const o=this.getEnvironmentNode(e),a=this.getFogNode(e);n&&jh.push(n.getCacheKey(!0)),o&&jh.push(o.getCacheKey()),a&&jh.push(a.getCacheKey()),jh.push(this.renderer.shadowMap.enabled?1:0),s.callId=r,s.cacheKey=C2(jh),this.callHashCache.set(Aa,s),jh.length=0}return Aa.length=0,s.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const n=this.get(e),r=e.background;if(r){const s=e.backgroundBlurriness===0&&n.backgroundBlurriness>0||e.backgroundBlurriness>0&&n.backgroundBlurriness===0;if(n.background!==r||s){const o=this.getCacheNode("background",r,()=>{if(r.isCubeTexture===!0||r.mapping===Fd||r.mapping===Bd||r.mapping===Ud){if(e.backgroundBlurriness>0||r.mapping===Ud)return H8(r);{let a;return r.isCubeTexture===!0?a=m0(r):a=dn(r),I8(a)}}else{if(r.isTexture===!0)return dn(r,Yf.flipY()).setUpdateMatrix(!0);r.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",r)}},s);n.backgroundNode=o,n.background=r,n.backgroundBlurriness=e.backgroundBlurriness}}else n.backgroundNode&&(delete n.backgroundNode,delete n.background)}getCacheNode(e,n,r,s=!1){const o=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let a=o.get(n);return(a===void 0||s)&&(a=r(),o.set(n,a)),a}updateFog(e){const n=this.get(e),r=e.fog;if(r){if(n.fog!==r){const s=this.getCacheNode("fog",r,()=>{if(r.isFogExp2){const o=In("color","color",r).setGroup(Ut),a=In("density","float",r).setGroup(Ut);return TB(o,GMe(a))}else if(r.isFog){const o=In("color","color",r).setGroup(Ut),a=In("near","float",r).setGroup(Ut),l=In("far","float",r).setGroup(Ut);return TB(o,$Me(a,l))}else console.error("THREE.Renderer: Unsupported fog configuration.",r)});n.fogNode=s,n.fog=r}}else delete n.fogNode,delete n.fog}updateEnvironment(e){const n=this.get(e),r=e.environment;if(r){if(n.environment!==r){const s=this.getCacheNode("environment",r,()=>{if(r.isCubeTexture===!0)return m0(r);if(r.isTexture===!0)return dn(r);console.error("Nodes: Unsupported environment configuration.",r)});n.environmentNode=s,n.environment=r}}else n.environmentNode&&(delete n.environmentNode,delete n.environment)}getNodeFrame(e=this.renderer,n=null,r=null,s=null,o=null){const a=this.nodeFrame;return a.renderer=e,a.scene=n,a.object=r,a.camera=s,a.material=o,a}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return kB.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const n=this.renderer,r=this.getOutputCacheKey(),s=e.isTextureArray?RMe(e,Te(Yf,yw("gl_ViewID_OVR"))).renderOutput(n.toneMapping,n.currentColorSpace):dn(e,Yf).renderOutput(n.toneMapping,n.currentColorSpace);return kB.set(e,r),s}updateBefore(e){const n=e.getNodeBuilderState();for(const r of n.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(r)}updateAfter(e){const n=e.getNodeBuilderState();for(const r of n.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(r)}updateForCompute(e){const n=this.getNodeFrame(),r=this.getForCompute(e);for(const s of r.updateNodes)n.updateNode(s)}updateForRender(e){const n=this.getNodeFrameForRender(e),r=e.getNodeBuilderState();for(const s of r.updateNodes)n.updateNode(s)}needsRefresh(e){const n=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,n)}dispose(){super.dispose(),this.nodeFrame=new PB,this.nodeBuilderCache=new Map,this.cacheLib={}}}const FM=new Ws;class b1{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new Vt,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,n,r){const s=e.length;for(let o=0;o<s;o++){FM.copy(e[o]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const a=n[r+o],l=FM.normal;a.x=-l.x,a.y=-l.y,a.z=-l.z,a.w=FM.constant}}updateGlobal(e,n){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=n.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,n){let r=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==n.clipIntersection&&(this.clipIntersection=n.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const s=n.clippingPlanes,o=s.length;let a,l;if(this.clipIntersection?(a=this.intersectionPlanes,l=e.intersectionPlanes.length):(a=this.unionPlanes,l=e.unionPlanes.length),a.length!==l+o){a.length=l+o;for(let c=0;c<o;c++)a[l+c]=new Dt;r=!0}this.projectPlanes(s,a,l),r&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let n=this.clippingGroupContexts.get(e);return n===void 0&&(n=new b1(this),this.clippingGroupContexts.set(e,n)),n.update(this,e),n}get unionClippingCount(){return this.unionPlanes.length}}class lCe{constructor(e,n){this.bundleGroup=e,this.camera=n}}const og=[];class cCe{constructor(){this.bundles=new va}get(e,n){const r=this.bundles;og[0]=e,og[1]=n;let s=r.get(og);return s===void 0&&(s=new lCe(e,n),r.set(og,s)),og.length=0,s}dispose(){this.bundles=new va}}class d6{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let n=null;const r=this.getMaterialNodeClass(e.type);if(r!==null){n=new r;for(const s in e)n[s]=e[s]}return n}addToneMapping(e,n){this.addType(e,n,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,n){this.addType(e,n,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,n){this.addClass(e,n,this.lightNodes)}addType(e,n,r){if(r.has(n)){console.warn(`Redefinition of node ${n}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof n=="function"||typeof n=="object")throw new Error(`Base class ${n} is not a class.`);r.set(n,e)}addClass(e,n,r){if(r.has(n)){console.warn(`Redefinition of node ${n.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof n!="function")throw new Error(`Base class ${n.name} is not a class.`);r.set(n,e)}}const uCe=new i6,ag=[];class dCe extends va{constructor(){super()}createNode(e=[]){return new i6().setLights(e)}getNode(e,n){if(e.isQuadMesh)return uCe;ag[0]=e,ag[1]=n;let r=this.get(ag);return r===void 0&&(r=this.createNode(),this.set(ag,r)),ag.length=0,r}}class Cg extends Eu{constructor(e=1,n=1,r={}){super(e,n,r),this.isXRRenderTarget=!0,this.hasExternalTextures=!1,this.autoAllocateDepthBuffer=!0}copy(e){return super.copy(e),this.hasExternalTextures=e.hasExternalTextures,this.autoAllocateDepthBuffer=e.autoAllocateDepthBuffer,this}}const LB=new K,IB=new K;class hCe extends dc{constructor(e,n=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new ar,this._cameraL.viewport=new Dt,this._cameraR=new ar,this._cameraR.viewport=new Dt,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new pG,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._supportsLayers=!1,this._createXRLayer=vCe.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new Oe,this._onSessionEvent=mCe.bind(this),this._onSessionEnd=gCe.bind(this),this._onInputSourcesChange=yCe.bind(this),this._onAnimationFrame=xCe.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._useLayers=typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=n,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,n,r,s,o,a,l,c=[]){const u=new W0(e,n),d=new Cg(o,a,{format:yi,type:ci,depthTexture:new ro(o,a,c.stencil?to:Dn,void 0,void 0,void 0,void 0,void 0,void 0,c.stencil?io:no),stencilBuffer:c.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),h=new es({color:16777215,side:Cs});h.map=d.texture,h.map.offset.y=1,h.map.repeat.y=-1;const f=new Xn(u,h);f.position.copy(r),f.quaternion.copy(s);const p={type:"quad",width:e,height:n,translation:r,quaternion:s,pixelwidth:o,pixelheight:a,plane:f,material:h,rendercall:l,renderTarget:d};if(this._layers.push(p),this._session!==null){p.plane.material=new es({color:16777215,side:Cs}),p.plane.material.blending=Vf,p.plane.material.blendEquation=Ur,p.plane.material.blendSrc=Tl,p.plane.material.blendDst=Tl,p.xrlayer=this._createXRLayer(p);const m=this._session.renderState.layers;m.unshift(p.xrlayer),this._session.updateRenderState({layers:m})}else d.isXRRenderTarget=!1;return f}createCylinderLayer(e,n,r,s,o,a,l,c,u=[]){const d=new H0(e,e,e*n/r,64,64,!0,Math.PI-n/2,n),h=new Cg(a,l,{format:yi,type:ci,depthTexture:new ro(a,l,u.stencil?to:Dn,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?io:no),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),f=new es({color:16777215,side:On});f.map=h.texture,f.map.offset.y=1,f.map.repeat.y=-1;const p=new Xn(d,f);p.position.copy(s),p.quaternion.copy(o);const m={type:"cylinder",radius:e,centralAngle:n,aspectratio:r,translation:s,quaternion:o,pixelwidth:a,pixelheight:l,plane:p,material:f,rendercall:c,renderTarget:h};if(this._layers.push(m),this._session!==null){m.plane.material=new es({color:16777215,side:On}),m.plane.material.blending=Vf,m.plane.material.blendEquation=Ur,m.plane.material.blendSrc=Tl,m.plane.material.blendDst=Tl,m.xrlayer=this._createXRLayer(m);const y=this._session.renderState.layers;y.unshift(m.xrlayer),this._session.updateRenderState({layers:y})}else h.isXRRenderTarget=!1;return p}renderLayers(){const e=new K,n=new ga,r=this.isPresenting;this.isPresenting=!1;for(const s of this._layers){if(s.renderTarget.isXRRenderTarget=this._session!==null,s.renderTarget.hasExternalTextures=s.renderTarget.isXRRenderTarget,s.renderTarget.autoAllocateDepthBuffer=!s.renderTarget.isXRRenderTarget,s.renderTarget.isXRRenderTarget&&this._supportsLayers){s.xrlayer.transform=new XRRigidTransform(s.plane.getWorldPosition(e),s.plane.getWorldQuaternion(n));const o=this._glBinding.getSubImage(s.xrlayer,this._xrFrame);this._renderer.backend.setXRRenderTargetTextures(s.renderTarget,o.colorTexture,o.depthStencilTexture)}this._renderer.setRenderTarget(s.renderTarget),s.rendercall()}this.isPresenting=r,this._renderer.setRenderTarget(null)}getSession(){return this._session}async setSession(e){const n=this._renderer,r=n.backend;this._gl=n.getContext();const s=this._gl,o=s.getContextAttributes();if(this._session=e,e!==null){if(r.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await r.makeXRCompatible(),this._currentPixelRatio=n.getPixelRatio(),n.getSize(this._currentSize),this._currentAnimationContext=n._animation.getContext(),this._currentAnimationLoop=n._animation.getAnimationLoop(),n._animation.stop(),this._useLayers===!0){let a=null,l=null,c=null;n.depth&&(c=n.stencil?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24,a=n.stencil?io:no,l=n.stencil?to:Dn);const u={colorFormat:s.RGBA8,depthFormat:c,scaleFactor:this._framebufferScaleFactor};this._useMultiviewIfPossible&&n.hasFeature("OVR_multiview2")&&(u.textureType="texture-array",this._useMultiview=!0);const d=new XRWebGLBinding(e,s),h=d.createProjectionLayer(u),f=[h];this._glBinding=d,this._glProjLayer=h,n.setPixelRatio(1),n.setSize(h.textureWidth,h.textureHeight,!1);let p;if(this._useMultiview?(p=new oG(h.textureWidth,h.textureHeight,2),p.type=l,p.format=a):p=new ro(h.textureWidth,h.textureHeight,l,void 0,void 0,void 0,void 0,void 0,void 0,a),this._xrRenderTarget=new Cg(h.textureWidth,h.textureHeight,{format:yi,type:ci,colorSpace:n.outputColorSpace,depthTexture:p,stencilBuffer:n.stencil,samples:o.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1,resolveStencilBuffer:h.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget.hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._supportsLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._supportsLayers)for(const m of this._layers)m.plane.material=new es({color:16777215,side:m.type==="cylinder"?On:Cs}),m.plane.material.blending=Vf,m.plane.material.blendEquation=Ur,m.plane.material.blendSrc=Tl,m.plane.material.blendDst=Tl,m.xrlayer=this._createXRLayer(m),f.unshift(m.xrlayer);e.updateRenderState({layers:f})}else{const a={antialias:n.samples>0,alpha:!0,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},l=new XRWebGLLayer(e,s,a);this._glBaseLayer=l,e.updateRenderState({baseLayer:l}),n.setPixelRatio(1),n.setSize(l.framebufferWidth,l.framebufferHeight,!1),this._xrRenderTarget=new Cg(l.framebufferWidth,l.framebufferHeight,{format:yi,type:ci,colorSpace:n.outputColorSpace,stencilBuffer:n.stencil,resolveDepthBuffer:l.ignoreDepthValues===!1,resolveStencilBuffer:l.ignoreDepthValues===!1}),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),n._animation.setAnimationLoop(this._onAnimationFrame),n._animation.setContext(e),n._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const n=this._session;if(n===null)return;const r=e.near,s=e.far,o=this._cameraXR,a=this._cameraL,l=this._cameraR;o.near=l.near=a.near=r,o.far=l.far=a.far=s,o.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==o.near||this._currentDepthFar!==o.far)&&(n.updateRenderState({depthNear:o.near,depthFar:o.far}),this._currentDepthNear=o.near,this._currentDepthFar=o.far),a.layers.mask=e.layers.mask|2,l.layers.mask=e.layers.mask|4,o.layers.mask=a.layers.mask|l.layers.mask;const c=e.parent,u=o.cameras;DB(o,c);for(let d=0;d<u.length;d++)DB(u[d],c);u.length===2?fCe(o,a,l):o.projectionMatrix.copy(a.projectionMatrix),pCe(e,o,c)}_getController(e){let n=this._controllers[e];return n===void 0&&(n=new V_,this._controllers[e]=n),n}}function fCe(i,e,n){LB.setFromMatrixPosition(e.matrixWorld),IB.setFromMatrixPosition(n.matrixWorld);const r=LB.distanceTo(IB),s=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=s[14]/(s[10]-1),l=s[14]/(s[10]+1),c=(s[9]+1)/s[5],u=(s[9]-1)/s[5],d=(s[8]-1)/s[0],h=(o[8]+1)/o[0],f=a*d,p=a*h,m=r/(-d+h),y=m*-d;if(e.matrixWorld.decompose(i.position,i.quaternion,i.scale),i.translateX(y),i.translateZ(m),i.matrixWorld.compose(i.position,i.quaternion,i.scale),i.matrixWorldInverse.copy(i.matrixWorld).invert(),s[10]===-1)i.projectionMatrix.copy(e.projectionMatrix),i.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const v=a+m,g=l+m,_=f-y,x=p+(r-y),b=c*l/g*v,S=u*l/g*v;i.projectionMatrix.makePerspective(_,x,b,S,v,g),i.projectionMatrixInverse.copy(i.projectionMatrix).invert()}}function DB(i,e){e===null?i.matrixWorld.copy(i.matrix):i.matrixWorld.multiplyMatrices(e.matrixWorld,i.matrix),i.matrixWorldInverse.copy(i.matrixWorld).invert()}function pCe(i,e,n){n===null?i.matrix.copy(e.matrixWorld):(i.matrix.copy(n.matrixWorld),i.matrix.invert(),i.matrix.multiply(e.matrixWorld)),i.matrix.decompose(i.position,i.quaternion,i.scale),i.updateMatrixWorld(!0),i.projectionMatrix.copy(e.projectionMatrix),i.projectionMatrixInverse.copy(e.projectionMatrixInverse),i.isPerspectiveCamera&&(i.fov=$d*2*Math.atan(1/i.projectionMatrix.elements[5]),i.zoom=1)}function mCe(i){const e=this._controllerInputSources.indexOf(i.inputSource);if(e===-1)return;const n=this._controllers[e];if(n!==void 0){const r=this.getReferenceSpace();n.update(i.inputSource,i.frame,r),n.dispatchEvent({type:i.type,data:i.inputSource})}}function gCe(){const i=this._session,e=this._renderer;i.removeEventListener("select",this._onSessionEvent),i.removeEventListener("selectstart",this._onSessionEvent),i.removeEventListener("selectend",this._onSessionEvent),i.removeEventListener("squeeze",this._onSessionEvent),i.removeEventListener("squeezestart",this._onSessionEvent),i.removeEventListener("squeezeend",this._onSessionEvent),i.removeEventListener("end",this._onSessionEnd),i.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let n=0;n<this._controllers.length;n++){const r=this._controllerInputSources[n];r!==null&&(this._controllerInputSources[n]=null,this._controllers[n].disconnect(r))}if(this._currentDepthNear=null,this._currentDepthFar=null,e.backend.setXRTarget(null),e.setOutputRenderTarget(null),e.setRenderTarget(null),this._session=null,this._xrRenderTarget=null,this._supportsLayers===!0)for(const n of this._layers)n.renderTarget=new Cg(n.pixelwidth,n.pixelheight,{format:yi,type:ci,depthTexture:new ro(n.pixelwidth,n.pixelheight,n.stencilBuffer?to:Dn,void 0,void 0,void 0,void 0,void 0,void 0,n.stencilBuffer?io:no),stencilBuffer:n.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),n.renderTarget.isXRRenderTarget=!1,n.plane.material=n.material,n.material.map=n.renderTarget.texture,delete n.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function yCe(i){const e=this._controllers,n=this._controllerInputSources;for(let r=0;r<i.removed.length;r++){const s=i.removed[r],o=n.indexOf(s);o>=0&&(n[o]=null,e[o].disconnect(s))}for(let r=0;r<i.added.length;r++){const s=i.added[r];let o=n.indexOf(s);if(o===-1){for(let l=0;l<e.length;l++)if(l>=n.length){n.push(s),o=l;break}else if(n[l]===null){n[l]=s,o=l;break}if(o===-1)break}const a=e[o];a&&a.connect(s)}}function vCe(i){return i.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(i.translation,i.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,width:i.width/2,height:i.height/2,space:this._referenceSpace,viewPixelWidth:i.pixelwidth,viewPixelHeight:i.pixelheight}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(i.translation,i.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,radius:i.radius,centralAngle:i.centralAngle,aspectRatio:i.aspectRatio,space:this._referenceSpace,viewPixelWidth:i.pixelwidth,viewPixelHeight:i.pixelheight})}function xCe(i,e){if(e===void 0)return;const n=this._cameraXR,r=this._renderer,s=r.backend,o=this._glBaseLayer,a=this.getReferenceSpace(),l=e.getViewerPose(a);if(this._xrFrame=e,l!==null){const c=l.views;this._glBaseLayer!==null&&s.setXRTarget(o.framebuffer);let u=!1;c.length!==n.cameras.length&&(n.cameras.length=0,u=!0);for(let d=0;d<c.length;d++){const h=c[d];let f;if(this._useLayers===!0){const m=this._glBinding.getViewSubImage(this._glProjLayer,h);f=m.viewport,d===0&&s.setXRRenderTargetTextures(this._xrRenderTarget,m.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:m.depthStencilTexture)}else f=o.getViewport(h);let p=this._cameras[d];p===void 0&&(p=new ar,p.layers.enable(d),p.viewport=new Dt,this._cameras[d]=p),p.matrix.fromArray(h.transform.matrix),p.matrix.decompose(p.position,p.quaternion,p.scale),p.projectionMatrix.fromArray(h.projectionMatrix),p.projectionMatrixInverse.copy(p.projectionMatrix).invert(),p.viewport.set(f.x,f.y,f.width,f.height),d===0&&(n.matrix.copy(p.matrix),n.matrix.decompose(n.position,n.quaternion,n.scale)),u===!0&&n.cameras.push(p)}r.setOutputRenderTarget(this._xrRenderTarget)}for(let c=0;c<this._controllers.length;c++){const u=this._controllerInputSources[c],d=this._controllers[c];u!==null&&d!==void 0&&d.update(u,e,a)}this._currentAnimationLoop&&this._currentAnimationLoop(i,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}const OB=new iw,Qx=new Oe,BM=new Dt,UM=new $0,zM=new s2,Jx=new ln,Ic=new Dt;class _Ce{constructor(e,n={}){this.isRenderer=!0;const{logarithmicDepthBuffer:r=!1,alpha:s=!0,depth:o=!0,stencil:a=!1,antialias:l=!1,samples:c=0,getFallback:u=null,colorBufferType:d=lr,multiview:h=!1}=n;this.domElement=e.getDomElement(),this.backend=e,this.samples=c||l===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=s,this.logarithmicDepthBuffer=r,this.outputColorSpace=Et,this.toneMapping=Ps,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=o,this.stencil=a,this.info=new rMe,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new d6,this.lighting=new dCe,this._getFallback=u,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new Dt(0,0,this._width,this._height),this._scissor=new Dt(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new Z8(new er),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const f=this.alpha===!0?0:1;this._clearColor=new J2(0,0,0,f),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=d,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:PN},this.xr=new hCe(this,h),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(p,m,y)=>{await this.compileAsync(p,m);const v=this._renderLists.get(p,m),g=this._renderContexts.get(p,m,this._renderTarget),_=p.overrideMaterial||y.material,x=this._objects.get(y,_,p,m,v.lightsNode,g,g.clippingContext),{fragmentShader:b,vertexShader:S}=x.getNodeBuilderState();return{fragmentShader:b,vertexShader:S}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,n)=>{let r=this.backend;try{await r.init(this)}catch(s){if(this._getFallback!==null)try{this.backend=r=this._getFallback(s),await r.init(this)}catch(o){n(o);return}else{n(s);return}}this._nodes=new aCe(this,r),this._animation=new KEe(this._nodes,this.info),this._attributes=new nMe(r),this._background=new EAe(this,this._nodes),this._geometries=new iMe(this._attributes,this.info),this._textures=new xMe(this,r,this.info),this._pipelines=new lMe(r,this._nodes),this._bindings=new cMe(r,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new JEe(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new hMe(this.lighting),this._bundles=new cCe,this._renderContexts=new yMe,this._animation.start(),this._initialized=!0,e(this)}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,n,r=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const s=this._nodes.nodeFrame,o=s.renderId,a=this._currentRenderContext,l=this._currentRenderObjectFunction,c=this._compilationPromises,u=e.isScene===!0?e:OB;r===null&&(r=e);const d=this._renderTarget,h=this._renderContexts.get(r,n,d),f=this._activeMipmapLevel,p=[];this._currentRenderContext=h,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=p,s.renderId++,s.update(),h.depth=this.depth,h.stencil=this.stencil,h.clippingContext||(h.clippingContext=new b1),h.clippingContext.updateGlobal(u,n),u.onBeforeRender(this,e,n,d);const m=this._renderLists.get(e,n);if(m.begin(),this._projectObject(e,n,0,m,h.clippingContext),r!==e&&r.traverseVisible(function(x){x.isLight&&x.layers.test(n.layers)&&m.pushLight(x)}),m.finish(),d!==null){this._textures.updateRenderTarget(d,f);const x=this._textures.get(d);h.textures=x.textures,h.depthTexture=x.depthTexture}else h.textures=null,h.depthTexture=null;this._background.update(u,m,h);const y=m.opaque,v=m.transparent,g=m.transparentDoublePass,_=m.lightsNode;this.opaque===!0&&y.length>0&&this._renderObjects(y,n,u,_),this.transparent===!0&&v.length>0&&this._renderTransparents(v,g,n,u,_),s.renderId=o,this._currentRenderContext=a,this._currentRenderObjectFunction=l,this._compilationPromises=c,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(p)}async renderAsync(e,n){this._initialized===!1&&await this.init(),this._renderScene(e,n)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){e===!0?(this.overrideNodes.modelViewMatrix=F3,this.overrideNodes.modelNormalViewMatrix=B3):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===F3&&this.overrideNodes.modelNormalViewMatrix===B3}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let n=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(n+=`
Reason: ${e.reason}`),console.error(n),this._isDeviceLost=!0}_renderBundle(e,n,r){const{bundleGroup:s,camera:o,renderList:a}=e,l=this._currentRenderContext,c=this._bundles.get(s,o),u=this.backend.get(c);u.renderContexts===void 0&&(u.renderContexts=new Set);const d=s.version!==u.version,h=u.renderContexts.has(l)===!1||d;if(u.renderContexts.add(l),h){this.backend.beginBundle(l),(u.renderObjects===void 0||d)&&(u.renderObjects=[]),this._currentRenderBundle=c;const{transparentDoublePass:f,transparent:p,opaque:m}=a;this.opaque===!0&&m.length>0&&this._renderObjects(m,o,n,r),this.transparent===!0&&p.length>0&&this._renderTransparents(p,f,o,n,r),this._currentRenderBundle=null,this.backend.finishBundle(l,c),u.version=s.version}else{const{renderObjects:f}=u;for(let p=0,m=f.length;p<m;p++){const y=f[p];this._nodes.needsRefresh(y)&&(this._nodes.updateBefore(y),this._nodes.updateForRender(y),this._bindings.updateForRender(y),this._nodes.updateAfter(y))}}this.backend.addBundle(l,c)}render(e,n){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,n);this._renderScene(e,n)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:n}=this;if(e!==Ps===!1&&n!==Wa===!1)return null;const{width:o,height:a}=this.getDrawingBufferSize(Qx),{depth:l,stencil:c}=this;let u=this._frameBufferTarget;u===null&&(u=new Eu(o,a,{depthBuffer:l,stencilBuffer:c,type:this._colorBufferType,format:yi,colorSpace:Wa,generateMipmaps:!1,minFilter:Xi,magFilter:Xi,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u);const d=this.getOutputRenderTarget();return u.depthBuffer=l,u.stencilBuffer=c,u.setSize(o,a,d!==null?d.depth:1),u.viewport.copy(this._viewport),u.scissor.copy(this._scissor),u.viewport.multiplyScalar(this._pixelRatio),u.scissor.multiplyScalar(this._pixelRatio),u.scissorTest=this._scissorTest,u.multiview=d!==null?d.multiview:!1,u}_renderScene(e,n,r=!0){if(this._isDeviceLost===!0)return;const s=r?this._getFrameBufferTarget():null,o=this._nodes.nodeFrame,a=o.renderId,l=this._currentRenderContext,c=this._currentRenderObjectFunction,u=e.isScene===!0?e:OB,d=this._renderTarget||this._outputRenderTarget,h=this._activeCubeFace,f=this._activeMipmapLevel;let p;s!==null?(p=s,this.setRenderTarget(p)):p=d;const m=this._renderContexts.get(e,n,p);this._currentRenderContext=m,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,o.renderId=this.info.calls;const y=this.coordinateSystem,v=this.xr;if(n.coordinateSystem!==y&&v.isPresenting===!1&&(n.coordinateSystem=y,n.updateProjectionMatrix(),n.isArrayCamera))for(const B of n.cameras)B.coordinateSystem=y,B.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),n.parent===null&&n.matrixWorldAutoUpdate===!0&&n.updateMatrixWorld(),v.enabled===!0&&v.isPresenting===!0&&(v.cameraAutoUpdate===!0&&v.updateCamera(n),n=v.getCamera());let g=this._viewport,_=this._scissor,x=this._pixelRatio;p!==null&&(g=p.viewport,_=p.scissor,x=1),this.getDrawingBufferSize(Qx),BM.set(0,0,Qx.width,Qx.height);const b=g.minDepth===void 0?0:g.minDepth,S=g.maxDepth===void 0?1:g.maxDepth;m.viewportValue.copy(g).multiplyScalar(x).floor(),m.viewportValue.width>>=f,m.viewportValue.height>>=f,m.viewportValue.minDepth=b,m.viewportValue.maxDepth=S,m.viewport=m.viewportValue.equals(BM)===!1,m.scissorValue.copy(_).multiplyScalar(x).floor(),m.scissor=this._scissorTest&&m.scissorValue.equals(BM)===!1,m.scissorValue.width>>=f,m.scissorValue.height>>=f,m.clippingContext||(m.clippingContext=new b1),m.clippingContext.updateGlobal(u,n),u.onBeforeRender(this,e,n,p);const T=n.isArrayCamera?zM:UM;n.isArrayCamera||(Jx.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),T.setFromProjectionMatrix(Jx,y));const w=this._renderLists.get(e,n);if(w.begin(),this._projectObject(e,n,0,w,m.clippingContext),w.finish(),this.sortObjects===!0&&w.sort(this._opaqueSort,this._transparentSort),p!==null){this._textures.updateRenderTarget(p,f);const B=this._textures.get(p);m.textures=B.textures,m.depthTexture=B.depthTexture,m.width=B.width,m.height=B.height,m.renderTarget=p,m.depth=p.depthBuffer,m.stencil=p.stencilBuffer}else m.textures=null,m.depthTexture=null,m.width=this.domElement.width,m.height=this.domElement.height,m.depth=this.depth,m.stencil=this.stencil;m.width>>=f,m.height>>=f,m.activeCubeFace=h,m.activeMipmapLevel=f,m.occlusionQueryCount=w.occlusionQueryCount,this._background.update(u,w,m),m.camera=n,this.backend.beginRender(m);const{bundles:E,lightsNode:A,transparentDoublePass:M,transparent:R,opaque:F}=w;return E.length>0&&this._renderBundles(E,u,A),this.opaque===!0&&F.length>0&&this._renderObjects(F,n,u,A),this.transparent===!0&&R.length>0&&this._renderTransparents(R,M,n,u,A),this.backend.finishRender(m),o.renderId=a,this._currentRenderContext=l,this._currentRenderObjectFunction=c,s!==null&&(this.setRenderTarget(d,h,f),this._renderOutput(p)),u.onAfterRender(this,e,n,p),m}_renderOutput(e){const n=this._quad;this._nodes.hasOutputChange(e.texture)&&(n.material.fragmentNode=this._nodes.getOutputNode(e.texture),n.material.needsUpdate=!0);const r=this.autoClear,s=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(n,n.camera,!1),this.autoClear=r,this.xr.enabled=s}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,n,r){this.xr&&this.xr.isPresenting||(this._width=e,this._height=n,this._pixelRatio=r,this.domElement.width=Math.floor(e*r),this.domElement.height=Math.floor(n*r),this.setViewport(0,0,e,n),this._initialized&&this.backend.updateSize())}setSize(e,n,r=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=n,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(n*this._pixelRatio),r===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=n+"px"),this.setViewport(0,0,e,n),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const n=this._scissor;return e.x=n.x,e.y=n.y,e.width=n.width,e.height=n.height,e}setScissor(e,n,r,s){const o=this._scissor;e.isVector4?o.copy(e):o.set(e,n,r,s)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,n,r,s,o=0,a=1){const l=this._viewport;e.isVector4?l.copy(e):l.set(e,n,r,s),l.minDepth=o,l.maxDepth=a}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,n=1){this._clearColor.set(e),this._clearColor.a=n}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const n=this._currentRenderContext;return n&&this.backend.isOccluded(n,e)}clear(e=!0,n=!0,r=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,n,r);const s=this._renderTarget||this._getFrameBufferTarget();let o=null;if(s!==null){this._textures.updateRenderTarget(s);const a=this._textures.get(s);o=this._renderContexts.getForClear(s),o.textures=a.textures,o.depthTexture=a.depthTexture,o.width=a.width,o.height=a.height,o.renderTarget=s,o.depth=s.depthBuffer,o.stencil=s.stencilBuffer,o.clearColorValue=this.backend.getClearColor(),o.activeCubeFace=this.getActiveCubeFace(),o.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,n,r,o),s!==null&&this._renderTarget===null&&this._renderOutput(s)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,n=!0,r=!0){this._initialized===!1&&await this.init(),this.clear(e,n,r)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:Ps}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:Wa}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()}),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,n=0,r=0){this._renderTarget=e,this._activeCubeFace=n,this._activeMipmapLevel=r}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const n=this._nodes.nodeFrame,r=n.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,n.renderId=this.info.calls;const s=this.backend,o=this._pipelines,a=this._bindings,l=this._nodes,c=Array.isArray(e)?e:[e];if(c[0]===void 0||c[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");s.beginCompute(e);for(const u of c){if(o.has(u)===!1){const f=()=>{u.removeEventListener("dispose",f),o.delete(u),a.delete(u),l.delete(u)};u.addEventListener("dispose",f);const p=u.onInitFunction;p!==null&&p.call(u,{renderer:this})}l.updateForCompute(u),a.updateForCompute(u);const d=a.getForCompute(u),h=o.getForCompute(u,d);s.compute(e,u,d,h)}s.finishCompute(e),n.renderId=r}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e)}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){this._initialized===!1&&await this.init(),this._textures.updateTexture(e)}initTexture(e){this._initialized===!1&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,n=null){if(n!==null)if(n.isVector2)n=Ic.set(n.x,n.y,e.image.width,e.image.height).floor();else if(n.isVector4)n=Ic.copy(n).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else n=Ic.set(0,0,e.image.width,e.image.height);let r=this._currentRenderContext,s;r!==null?s=r.renderTarget:(s=this._renderTarget||this._getFrameBufferTarget(),s!==null&&(this._textures.updateRenderTarget(s),r=this._textures.get(s))),this._textures.updateTexture(e,{renderTarget:s}),this.backend.copyFramebufferToTexture(e,r,n)}copyTextureToTexture(e,n,r=null,s=null,o=0,a=0){this._textures.updateTexture(e),this._textures.updateTexture(n),this.backend.copyTextureToTexture(e,n,r,s,o,a)}async readRenderTargetPixelsAsync(e,n,r,s,o,a=0,l=0){return this.backend.copyTextureToBuffer(e.textures[a],n,r,s,o,l)}_projectObject(e,n,r,s,o){if(e.visible===!1)return;if(e.layers.test(n.layers)){if(e.isGroup)r=e.renderOrder,e.isClippingGroup&&e.enabled&&(o=o.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(n);else if(e.isLight)s.pushLight(e);else if(e.isSprite){const c=n.isArrayCamera?zM:UM;if(!e.frustumCulled||c.intersectsSprite(e,n)){this.sortObjects===!0&&Ic.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Jx);const{geometry:u,material:d}=e;d.visible&&s.push(e,u,d,r,Ic.z,null,o)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const c=n.isArrayCamera?zM:UM;if(!e.frustumCulled||c.intersectsObject(e,n)){const{geometry:u,material:d}=e;if(this.sortObjects===!0&&(u.boundingSphere===null&&u.computeBoundingSphere(),Ic.copy(u.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(Jx)),Array.isArray(d)){const h=u.groups;for(let f=0,p=h.length;f<p;f++){const m=h[f],y=d[m.materialIndex];y&&y.visible&&s.push(e,u,y,r,Ic.z,m,o)}}else d.visible&&s.push(e,u,d,r,Ic.z,null,o)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const c=s;s=this._renderLists.get(e,n),s.begin(),c.pushBundle({bundleGroup:e,camera:n,renderList:s}),s.finish()}const l=e.children;for(let c=0,u=l.length;c<u;c++)this._projectObject(l[c],n,r,s,o)}_renderBundles(e,n,r){for(const s of e)this._renderBundle(s,n,r)}_renderTransparents(e,n,r,s,o){if(n.length>0){for(const{material:a}of n)a.side=On;this._renderObjects(n,r,s,o,"backSide");for(const{material:a}of n)a.side=Cs;this._renderObjects(e,r,s,o);for(const{material:a}of n)a.side=Qr}else this._renderObjects(e,r,s,o)}_renderObjects(e,n,r,s,o=null){for(let a=0,l=e.length;a<l;a++){const{object:c,geometry:u,material:d,group:h,clippingContext:f}=e[a];this._currentRenderObjectFunction(c,r,n,u,d,h,s,f,o)}}renderObject(e,n,r,s,o,a,l,c=null,u=null){let d,h,f;if(e.onBeforeRender(this,n,r,s,o,a),o.allowOverride===!0&&n.overrideMaterial!==null){const p=n.overrideMaterial;o.positionNode&&o.positionNode.isNode&&(d=p.positionNode,p.positionNode=o.positionNode),p.alphaTest=o.alphaTest,p.alphaMap=o.alphaMap,p.transparent=o.transparent||o.transmission>0,p.isShadowPassMaterial&&(p.side=o.shadowSide===null?o.side:o.shadowSide,o.depthNode&&o.depthNode.isNode&&(f=p.depthNode,p.depthNode=o.depthNode),o.castShadowNode&&o.castShadowNode.isNode&&(h=p.colorNode,p.colorNode=o.castShadowNode),o.castShadowPositionNode&&o.castShadowPositionNode.isNode&&(d=p.positionNode,p.positionNode=o.castShadowPositionNode)),o=p}o.transparent===!0&&o.side===Qr&&o.forceSinglePass===!1?(o.side=On,this._handleObjectFunction(e,o,n,r,l,a,c,"backSide"),o.side=Cs,this._handleObjectFunction(e,o,n,r,l,a,c,u),o.side=Qr):this._handleObjectFunction(e,o,n,r,l,a,c,u),d!==void 0&&(n.overrideMaterial.positionNode=d),f!==void 0&&(n.overrideMaterial.depthNode=f),h!==void 0&&(n.overrideMaterial.colorNode=h),e.onAfterRender(this,n,r,s,o,a)}_renderObjectDirect(e,n,r,s,o,a,l,c){const u=this._objects.get(e,n,r,s,o,this._currentRenderContext,l,c);u.drawRange=e.geometry.drawRange,u.group=a;const d=this._nodes.needsRefresh(u);d&&(this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u)),this._pipelines.updateForRender(u),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(u),u.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(u,this.info),d&&this._nodes.updateAfter(u)}_createObjectPipeline(e,n,r,s,o,a,l,c){const u=this._objects.get(e,n,r,s,o,this._currentRenderContext,l,c);u.drawRange=e.geometry.drawRange,u.group=a,this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}get compile(){return this.compileAsync}}class nk{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function bCe(i){return i+(jc-i%jc)%jc}let h6=class extends nk{constructor(e,n=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=n}get byteLength(){return bCe(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}};class f6 extends h6{constructor(e,n=null){super(e,n),this.isUniformBuffer=!0}}let SCe=0;class p6 extends f6{constructor(e,n){super("UniformBuffer_"+SCe++,e?e.value:null),this.nodeUniform=e,this.groupNode=n}get buffer(){return this.nodeUniform.value}}class wCe extends f6{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const n=this.byteLength;e=new Float32Array(new ArrayBuffer(n)),this._buffer=e}return e}get byteLength(){let e=0;for(let n=0,r=this.uniforms.length;n<r;n++){const s=this.uniforms[n],{boundary:o,itemSize:a}=s,l=e%jc,c=jc-l;l!==0&&c-o<0?e+=jc-l:l%o!==0&&(e+=l%o),s.offset=e/this.bytesPerElement,e+=a*this.bytesPerElement}return Math.ceil(e/jc)*jc}update(){let e=!1;for(const n of this.uniforms)this.updateByType(n)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let n=!1;const r=this.values,s=e.getValue(),o=e.offset,a=e.getType();if(r[o]!==s){const l=this._getBufferForType(a);l[o]=r[o]=s,n=!0}return n}updateVector2(e){let n=!1;const r=this.values,s=e.getValue(),o=e.offset,a=e.getType();if(r[o+0]!==s.x||r[o+1]!==s.y){const l=this._getBufferForType(a);l[o+0]=r[o+0]=s.x,l[o+1]=r[o+1]=s.y,n=!0}return n}updateVector3(e){let n=!1;const r=this.values,s=e.getValue(),o=e.offset,a=e.getType();if(r[o+0]!==s.x||r[o+1]!==s.y||r[o+2]!==s.z){const l=this._getBufferForType(a);l[o+0]=r[o+0]=s.x,l[o+1]=r[o+1]=s.y,l[o+2]=r[o+2]=s.z,n=!0}return n}updateVector4(e){let n=!1;const r=this.values,s=e.getValue(),o=e.offset,a=e.getType();if(r[o+0]!==s.x||r[o+1]!==s.y||r[o+2]!==s.z||r[o+4]!==s.w){const l=this._getBufferForType(a);l[o+0]=r[o+0]=s.x,l[o+1]=r[o+1]=s.y,l[o+2]=r[o+2]=s.z,l[o+3]=r[o+3]=s.w,n=!0}return n}updateColor(e){let n=!1;const r=this.values,s=e.getValue(),o=e.offset;if(r[o+0]!==s.r||r[o+1]!==s.g||r[o+2]!==s.b){const a=this.buffer;a[o+0]=r[o+0]=s.r,a[o+1]=r[o+1]=s.g,a[o+2]=r[o+2]=s.b,n=!0}return n}updateMatrix3(e){let n=!1;const r=this.values,s=e.getValue().elements,o=e.offset;if(r[o+0]!==s[0]||r[o+1]!==s[1]||r[o+2]!==s[2]||r[o+4]!==s[3]||r[o+5]!==s[4]||r[o+6]!==s[5]||r[o+8]!==s[6]||r[o+9]!==s[7]||r[o+10]!==s[8]){const a=this.buffer;a[o+0]=r[o+0]=s[0],a[o+1]=r[o+1]=s[1],a[o+2]=r[o+2]=s[2],a[o+4]=r[o+4]=s[3],a[o+5]=r[o+5]=s[4],a[o+6]=r[o+6]=s[5],a[o+8]=r[o+8]=s[6],a[o+9]=r[o+9]=s[7],a[o+10]=r[o+10]=s[8],n=!0}return n}updateMatrix4(e){let n=!1;const r=this.values,s=e.getValue().elements,o=e.offset;return ECe(r,s,o)===!1&&(this.buffer.set(s,o),TCe(r,s,o),n=!0),n}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function TCe(i,e,n){for(let r=0,s=e.length;r<s;r++)i[n+r]=e[r]}function ECe(i,e,n){for(let r=0,s=e.length;r<s;r++)if(i[n+r]!==e[r])return!1;return!0}let MCe=0;class m6 extends wCe{constructor(e,n){super(e),this.id=MCe++,this.groupNode=n,this.isNodeUniformsGroup=!0}}let ACe=0;class CCe extends nk{constructor(e,n){super(e),this.id=ACe++,this.texture=n,this.version=n?n.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:n}=this;return e!==this.generation?(this.generation=e,!0):n.isVideoTexture}update(){const{texture:e,version:n}=this;return n!==e.version?(this.version=e.version,!0):!1}}class Mw extends CCe{constructor(e,n,r,s=null){super(e,n?n.value:null),this.textureNode=n,this.groupNode=r,this.access=s}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class g6 extends Mw{constructor(e,n,r,s=null){super(e,n,r,s),this.isSampledCubeTexture=!0}}class y6 extends Mw{constructor(e,n,r,s=null){super(e,n,r,s),this.isSampledTexture3D=!0}}const RCe={textureDimensions:"textureSize",equals:"equal"},PCe={low:"lowp",medium:"mediump",high:"highp"},FB={swizzleAssign:!0,storageBuffer:!1},BB={perspective:"smooth",linear:"noperspective"},UB={centroid:"centroid","flat first":"flat","flat either":"flat"},zB=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class NCe extends l6{constructor(e,n){super(e,n,new oCe),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==qs}getMethod(e){return RCe[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const n=e.layout,r=this.flowShaderNode(e),s=[];for(const a of n.inputs)s.push(this.getType(a.type)+" "+a.name);return`${this.getType(n.type)} ${n.name}( ${s.join(", ")} ) {

	${r.vars}

${r.code}
	return ${r.result};

}`}setupPBO(e){const n=e.value;if(n.pbo===void 0){const r=n.array,s=n.count*n.itemSize,{itemSize:o}=n,a=n.array.constructor.name.toLowerCase().includes("int");let l=a?nm:z0;o===2?l=a?im:Ol:o===3?l=a?lue:U0:o===4&&(l=a?rm:yi);const c={Float32Array:wi,Uint8Array:ci,Uint16Array:oa,Uint32Array:Dn,Int8Array:bd,Int16Array:Sd,Int32Array:or,Uint8ClampedArray:ci},u=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(s/o))));let d=Math.ceil(s/o/u);u*d*o<s&&d++;const h=u*d*o,f=new r.constructor(h);f.set(r,0),n.array=f;const p=new hde(n.array,u,d,l,c[n.array.constructor.name]||wi);p.needsUpdate=!0,p.isPBOTexture=!0;const m=new cm(p,null,null);m.setPrecision("high"),n.pboNode=m,n.pbo=m.value,this.getUniformFromNode(n.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,n=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?n.charAt(0)+"_"+e.name:super.getPropertyName(e,n)}generatePBO(e){const{node:n,indexNode:r}=e,s=n.value;if(this.renderer.backend.has(s)){const d=this.renderer.backend.get(s);d.pbo=s.pbo}const o=this.getUniformFromNode(s.pboNode,"texture",this.shaderStage,this.context.label),a=this.getPropertyName(o);this.increaseUsage(r);const l=r.build(this,"uint"),c=this.getDataFromNode(e);let u=c.propertyName;if(u===void 0){const d=this.getVarFromNode(e);u=this.getPropertyName(d);const h=this.getDataFromNode(n);let f=h.propertySizeName;f===void 0&&(f=u+"Size",this.getVarFromNode(n,f,"uint"),this.addLineFlowCode(`${f} = uint( textureSize( ${a}, 0 ).x )`,e),h.propertySizeName=f);const{itemSize:p}=s,m="."+lm.join("").slice(0,p),y=`ivec2(${l} % ${f}, ${l} / ${f})`,v=this.generateTextureLoad(null,a,y,null,"0");let g="vec4";s.pbo.type===Dn?g="uvec4":s.pbo.type===or&&(g="ivec4"),this.addLineFlowCode(`${u} = ${g}(${v})${m}`,e),c.propertyName=u}return u}generateTextureLoad(e,n,r,s,o="0"){return s?`texelFetch( ${n}, ivec3( ${r}, ${s} ), ${o} )`:`texelFetch( ${n}, ${r}, ${o} )`}generateTexture(e,n,r,s){return e.isDepthTexture?(s&&(r=`vec4( ${r}, ${s} )`),`texture( ${n}, ${r} ).x`):(s&&(r=`vec3( ${r}, ${s} )`),`texture( ${n}, ${r} )`)}generateTextureLevel(e,n,r,s){return`textureLod( ${n}, ${r}, ${s} )`}generateTextureBias(e,n,r,s){return`texture( ${n}, ${r}, ${s} )`}generateTextureGrad(e,n,r,s){return`textureGrad( ${n}, ${r}, ${s[0]}, ${s[1]} )`}generateTextureCompare(e,n,r,s,o,a=this.shaderStage){if(a==="fragment")return o?`texture( ${n}, vec4( ${r}, ${o}, ${s} ) )`:`texture( ${n}, vec3( ${r}, ${s} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}getVars(e){const n=[],r=this.vars[e];if(r!==void 0)for(const s of r)n.push(`${this.getVar(s.type,s.name,s.count)};`);return n.join(`
	`)}getUniforms(e){const n=this.uniforms[e],r=[],s={};for(const a of n){let l=null,c=!1;if(a.type==="texture"||a.type==="texture3D"){const d=a.node.value;let h="";(d.isDataTexture===!0||d.isData3DTexture===!0)&&(d.type===Dn?h="u":d.type===or&&(h="i")),a.type==="texture3D"&&d.isTextureArray===!1?l=`${h}sampler3D ${a.name};`:d.compareFunction?d.isDepthArrayTexture===!0?l=`sampler2DArrayShadow ${a.name};`:l=`sampler2DShadow ${a.name};`:d.isDataArrayTexture===!0||d.isCompressedArrayTexture===!0||d.isTextureArray===!0?l=`${h}sampler2DArray ${a.name};`:l=`${h}sampler2D ${a.name};`}else if(a.type==="cubeTexture")l=`samplerCube ${a.name};`;else if(a.type==="buffer"){const d=a.node,h=this.getType(d.bufferType),f=d.bufferCount,p=f>0?f:"";l=`${d.name} {
	${h} ${a.name}[${p}];
};
`}else l=`${this.getVectorType(a.type)} ${this.getPropertyName(a,e)};`,c=!0;const u=a.node.precision;if(u!==null&&(l=PCe[u]+" "+l),c){l="	"+l;const d=a.groupNode.name;(s[d]||(s[d]=[])).push(l)}else l="uniform "+l,r.push(l)}let o="";for(const a in s){const l=s[a];o+=this._getGLSLUniformStruct(e+"_"+a,l.join(`
`))+`
`}return o+=r.join(`
`),o}getTypeFromAttribute(e){let n=super.getTypeFromAttribute(e);if(/^[iu]/.test(n)&&e.gpuType!==or){let r=e;e.isInterleavedBufferAttribute&&(r=e.data);const s=r.array;s instanceof Uint32Array||s instanceof Int32Array||(n=n.slice(1))}return n}getAttributes(e){let n="";if(e==="vertex"||e==="compute"){const r=this.getAttributesArray();let s=0;for(const o of r)n+=`layout( location = ${s++} ) in ${o.type} ${o.name};
`}return n}getStructMembers(e){const n=[];for(const r of e.members)n.push(`	${r.type} ${r.name};`);return n.join(`
`)}getStructs(e){const n=[],r=this.structs[e],s=[];for(const o of r)if(o.output)for(const a of o.members)s.push(`layout( location = ${a.index} ) out ${a.type} ${a.name};`);else{let a="struct "+o.name+` {
`;a+=this.getStructMembers(o),a+=`
};
`,n.push(a)}return s.length===0&&s.push("layout( location = 0 ) out vec4 fragColor;"),`
`+s.join(`
`)+`

`+n.join(`
`)}getVaryings(e){let n="";const r=this.varyings;if(e==="vertex"||e==="compute")for(const s of r){e==="compute"&&(s.needsInterpolation=!0);const o=this.getType(s.type);if(s.needsInterpolation)if(s.interpolationType){const a=BB[s.interpolationType]||s.interpolationType,l=UB[s.interpolationSampling]||"";n+=`${a} ${l} out ${o} ${s.name};
`}else{const a=o.includes("int")||o.includes("uv")||o.includes("iv")?"flat ":"";n+=`${a}out ${o} ${s.name};
`}else n+=`${o} ${s.name};
`}else if(e==="fragment"){for(const s of r)if(s.needsInterpolation){const o=this.getType(s.type);if(s.interpolationType){const a=BB[s.interpolationType]||s.interpolationType,l=UB[s.interpolationSampling]||"";n+=`${a} ${l} in ${o} ${s.name};
`}else{const a=o.includes("int")||o.includes("uv")||o.includes("iv")?"flat ":"";n+=`${a}in ${o} ${s.name};
`}}}for(const s of this.builtins[e])n+=`${s};
`;return n}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((r,s)=>r*s,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,n,r=this.shaderStage){const s=this.extensions[r]||(this.extensions[r]=new Map);s.has(e)===!1&&s.set(e,{name:e,behavior:n})}getExtensions(e){const n=[];if(e==="vertex"){const s=this.renderer.backend.extensions;this.object.isBatchedMesh&&s.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const r=this.extensions[e];if(r!==void 0)for(const{name:s,behavior:o}of r.values())n.push(`#extension ${s} : ${o}`);return n.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let n=FB[e];if(n===void 0){let r;switch(n=!1,e){case"float32Filterable":r="OES_texture_float_linear";break;case"clipDistance":r="WEBGL_clip_cull_distance";break}if(r!==void 0){const s=this.renderer.backend.extensions;s.has(r)&&(s.get(r),n=!0)}FB[e]=n}return n}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,n){this.transforms.push({varyingName:e,attributeNode:n})}getTransforms(){const e=this.transforms;let n="";for(let r=0;r<e.length;r++){const s=e[r],o=this.getPropertyName(s.attributeNode);o&&(n+=`${s.varyingName} = ${o};
	`)}return n}_getGLSLUniformStruct(e,n){return`
layout( std140 ) uniform ${e} {
${n}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${zB}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${zB}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

// structs
${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const n in e){let r=`// code

`;r+=this.flowCode[n];const s=this.flowNodes[n],o=s[s.length-1];for(const l of s){const c=this.getFlowData(l),u=l.name;u&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${u}
	`),r+=`${c.code}
	`,l===o&&n!=="compute"&&(r+=`// result
	`,n==="vertex"?(r+="gl_Position = ",r+=`${c.result};`):n==="fragment"&&(l.outputNode.isOutputStructNode||(r+="fragColor = ",r+=`${c.result};`)))}const a=e[n];a.extensions=this.getExtensions(n),a.uniforms=this.getUniforms(n),a.attributes=this.getAttributes(n),a.varyings=this.getVaryings(n),a.vars=this.getVars(n),a.structs=this.getStructs(n),a.codes=this.getCodes(n),a.transforms=this.getTransforms(n),a.flow=r}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,n,r,s=null){const o=super.getUniformFromNode(e,n,r,s),a=this.getDataFromNode(e,r,this.globalCache);let l=a.uniformGPU;if(l===void 0){const c=e.groupNode,u=c.name,d=this.getBindGroupArray(u,r);if(n==="texture")l=new Mw(o.name,o.node,c),d.push(l);else if(n==="cubeTexture")l=new g6(o.name,o.node,c),d.push(l);else if(n==="texture3D")l=new y6(o.name,o.node,c),d.push(l);else if(n==="buffer"){e.name=`NodeBuffer_${e.id}`,o.name=`buffer${e.id}`;const h=new p6(e,c);h.name=e.name,d.push(h),l=h}else{const h=this.uniformGroups[r]||(this.uniformGroups[r]={});let f=h[u];f===void 0&&(f=new m6(r+"_"+u,c),h[u]=f,d.push(f)),l=this.getNodeUniform(o,n),f.addUniform(l)}a.uniformGPU=l}return o}}let VM=null,qh=null;class v6{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){da("WebGPURenderer: Timestamp tracking is disabled.");return}const n=this.timestampQueryPool[e];if(!n){da(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);return}const r=await n.resolveQueriesAsync();return this.renderer.info[e].timestamp=r,r}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return VM=VM||new Oe,this.renderer.getDrawingBufferSize(VM)}setScissorTest(){}getClearColor(){const e=this.renderer;return qh=qh||new J2,e.getClearColor(qh),qh.getRGB(qh),qh}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:Z$(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${tm} webgpu`),this.domElement=e),e}set(e,n){this.data.set(e,n)}get(e){let n=this.data.get(e);return n===void 0&&(n={},this.data.set(e,n)),n}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let kCe=0;class LCe{constructor(e,n){this.buffers=[e.bufferGPU,n],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class ICe{constructor(e){this.backend=e}createAttribute(e,n){const r=this.backend,{gl:s}=r,o=e.array,a=e.usage||s.STATIC_DRAW,l=e.isInterleavedBufferAttribute?e.data:e,c=r.get(l);let u=c.bufferGPU;u===void 0&&(u=this._createBuffer(s,n,o,a),c.bufferGPU=u,c.bufferType=n,c.version=l.version);let d;if(o instanceof Float32Array)d=s.FLOAT;else if(o instanceof Uint16Array)e.isFloat16BufferAttribute?d=s.HALF_FLOAT:d=s.UNSIGNED_SHORT;else if(o instanceof Int16Array)d=s.SHORT;else if(o instanceof Uint32Array)d=s.UNSIGNED_INT;else if(o instanceof Int32Array)d=s.INT;else if(o instanceof Int8Array)d=s.BYTE;else if(o instanceof Uint8Array)d=s.UNSIGNED_BYTE;else if(o instanceof Uint8ClampedArray)d=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+o);let h={bufferGPU:u,bufferType:n,type:d,byteLength:o.byteLength,bytesPerElement:o.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:d===s.INT||d===s.UNSIGNED_INT||e.gpuType===or,id:kCe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const f=this._createBuffer(s,n,o,a);h=new LCe(h,f)}r.set(e,h)}updateAttribute(e){const n=this.backend,{gl:r}=n,s=e.array,o=e.isInterleavedBufferAttribute?e.data:e,a=n.get(o),l=a.bufferType,c=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(r.bindBuffer(l,a.bufferGPU),c.length===0)r.bufferSubData(l,0,s);else{for(let u=0,d=c.length;u<d;u++){const h=c[u];r.bufferSubData(l,h.start*s.BYTES_PER_ELEMENT,s,h.start,h.count)}o.clearUpdateRanges()}r.bindBuffer(l,null),a.version=o.version}destroyAttribute(e){const n=this.backend,{gl:r}=n;e.isInterleavedBufferAttribute&&n.delete(e.data);const s=n.get(e);r.deleteBuffer(s.bufferGPU),n.delete(e)}async getArrayBufferAsync(e){const n=this.backend,{gl:r}=n,s=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:o}=n.get(s),a=e.array,l=a.byteLength;r.bindBuffer(r.COPY_READ_BUFFER,o);const c=r.createBuffer();r.bindBuffer(r.COPY_WRITE_BUFFER,c),r.bufferData(r.COPY_WRITE_BUFFER,l,r.STREAM_READ),r.copyBufferSubData(r.COPY_READ_BUFFER,r.COPY_WRITE_BUFFER,0,0,l),await n.utils._clientWaitAsync();const u=new e.array.constructor(a.length);return r.bindBuffer(r.COPY_WRITE_BUFFER,c),r.getBufferSubData(r.COPY_WRITE_BUFFER,0,u),r.deleteBuffer(c),r.bindBuffer(r.COPY_READ_BUFFER,null),r.bindBuffer(r.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,n,r,s){const o=e.createBuffer();return e.bindBuffer(n,o),e.bufferData(n,r,s),e.bindBuffer(n,null),o}}let $M,lg;class DCe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;$M={[Ur]:e.FUNC_ADD,[NN]:e.FUNC_SUBTRACT,[kN]:e.FUNC_REVERSE_SUBTRACT},lg={[Tl]:e.ZERO,[LN]:e.ONE,[IN]:e.SRC_COLOR,[zy]:e.SRC_ALPHA,[zN]:e.SRC_ALPHA_SATURATE,[BN]:e.DST_COLOR,[ON]:e.DST_ALPHA,[DN]:e.ONE_MINUS_SRC_COLOR,[Vy]:e.ONE_MINUS_SRC_ALPHA,[UN]:e.ONE_MINUS_DST_COLOR,[FN]:e.ONE_MINUS_DST_ALPHA};const n=e.getParameter(e.SCISSOR_BOX),r=e.getParameter(e.VIEWPORT);this.currentScissor=new Dt().fromArray(n),this.currentViewport=new Dt().fromArray(r),this._tempVec4=new Dt}enable(e){const{enabled:n}=this;n[e]!==!0&&(this.gl.enable(e),n[e]=!0)}disable(e){const{enabled:n}=this;n[e]!==!1&&(this.gl.disable(e),n[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:n}=this;e?n.frontFace(n.CW):n.frontFace(n.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:n}=this;e!==B$?(this.enable(n.CULL_FACE),e!==this.currentCullFace&&(e===DC?n.cullFace(n.BACK):e===U$?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):this.disable(n.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:n,gl:r}=this;e!==n&&(r.lineWidth(e),this.currentLineWidth=e)}setBlending(e,n,r,s,o,a,l,c){const{gl:u}=this;if(e===Rs){this.currentBlendingEnabled===!0&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),e!==Vf){if(e!==this.currentBlending||c!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==Ur||this.currentBlendEquationAlpha!==Ur)&&(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=Ur,this.currentBlendEquationAlpha=Ur),c)switch(e){case eo:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case cp:u.blendFunc(u.ONE,u.ONE);break;case up:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case dp:u.blendFuncSeparate(u.ZERO,u.SRC_COLOR,u.ZERO,u.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case eo:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case cp:u.blendFunc(u.SRC_ALPHA,u.ONE);break;case up:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case dp:u.blendFunc(u.ZERO,u.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=c}return}o=o||n,a=a||r,l=l||s,(n!==this.currentBlendEquation||o!==this.currentBlendEquationAlpha)&&(u.blendEquationSeparate($M[n],$M[o]),this.currentBlendEquation=n,this.currentBlendEquationAlpha=o),(r!==this.currentBlendSrc||s!==this.currentBlendDst||a!==this.currentBlendSrcAlpha||l!==this.currentBlendDstAlpha)&&(u.blendFuncSeparate(lg[r],lg[s],lg[a],lg[l]),this.currentBlendSrc=r,this.currentBlendDst=s,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=l),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:n}=this;e?this.enable(n.DEPTH_TEST):this.disable(n.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:n}=this;switch(e){case $y:n.depthFunc(n.NEVER);break;case Gy:n.depthFunc(n.ALWAYS);break;case Hy:n.depthFunc(n.LESS);break;case pu:n.depthFunc(n.LEQUAL);break;case Wy:n.depthFunc(n.EQUAL);break;case jy:n.depthFunc(n.GEQUAL);break;case qy:n.depthFunc(n.GREATER);break;case Xy:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}this.currentDepthFunc=e}}scissor(e,n,r,s){const o=this._tempVec4.set(e,n,r,s);if(this.currentScissor.equals(o)===!1){const{gl:a}=this;a.scissor(o.x,o.y,o.z,o.w),this.currentScissor.copy(o)}}viewport(e,n,r,s){const o=this._tempVec4.set(e,n,r,s);if(this.currentViewport.equals(o)===!1){const{gl:a}=this;a.viewport(o.x,o.y,o.z,o.w),this.currentViewport.copy(o)}}setScissorTest(e){const n=this.gl;e?n.enable(n.SCISSOR_TEST):n.disable(n.SCISSOR_TEST)}setStencilTest(e){const{gl:n}=this;e?this.enable(n.STENCIL_TEST):this.disable(n.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,n,r){(this.currentStencilFunc!==e||this.currentStencilRef!==n||this.currentStencilFuncMask!==r)&&(this.gl.stencilFunc(e,n,r),this.currentStencilFunc=e,this.currentStencilRef=n,this.currentStencilFuncMask=r)}setStencilOp(e,n,r){(this.currentStencilFail!==e||this.currentStencilZFail!==n||this.currentStencilZPass!==r)&&(this.gl.stencilOp(e,n,r),this.currentStencilFail=e,this.currentStencilZFail=n,this.currentStencilZPass=r)}setMaterial(e,n,r){const{gl:s}=this;e.side===Qr?this.disable(s.CULL_FACE):this.enable(s.CULL_FACE);let o=e.side===On;n&&(o=!o),this.setFlipSided(o),e.blending===eo&&e.transparent===!1?this.setBlending(Rs):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const a=e.stencilWrite;if(this.setStencilTest(a),a&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(s.SAMPLE_ALPHA_TO_COVERAGE):this.disable(s.SAMPLE_ALPHA_TO_COVERAGE),r>0&&this.currentClippingPlanes!==r)for(let c=0;c<8;c++)c<r?this.enable(12288+c):this.disable(12288+c)}setPolygonOffset(e,n,r){const{gl:s}=this;e?(this.enable(s.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==n||this.currentPolygonOffsetUnits!==r)&&(s.polygonOffset(n,r),this.currentPolygonOffsetFactor=n,this.currentPolygonOffsetUnits=r)):this.disable(s.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,n=null){const r=this.gl;return this.currentVAO!==e||this.currentIndex!==n?(r.bindVertexArray(e),n!==null&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n),this.currentVAO=e,this.currentIndex=n,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,n){const{gl:r,currentBoundFramebuffers:s}=this;return s[e]!==n?(r.bindFramebuffer(e,n),s[e]=n,e===r.DRAW_FRAMEBUFFER&&(s[r.FRAMEBUFFER]=n),e===r.FRAMEBUFFER&&(s[r.DRAW_FRAMEBUFFER]=n),!0):!1}drawBuffers(e,n){const{gl:r}=this;let s=[],o=!1;if(e.textures!==null){s=this.currentDrawbuffers.get(n),s===void 0&&(s=[],this.currentDrawbuffers.set(n,s));const a=e.textures;if(s.length!==a.length||s[0]!==r.COLOR_ATTACHMENT0){for(let l=0,c=a.length;l<c;l++)s[l]=r.COLOR_ATTACHMENT0+l;s.length=a.length,o=!0}}else s[0]!==r.BACK&&(s[0]=r.BACK,o=!0);o&&r.drawBuffers(s)}activeTexture(e){const{gl:n,currentTextureSlot:r,maxTextures:s}=this;e===void 0&&(e=n.TEXTURE0+s-1),r!==e&&(n.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,n,r){const{gl:s,currentTextureSlot:o,currentBoundTextures:a,maxTextures:l}=this;r===void 0&&(o===null?r=s.TEXTURE0+l-1:r=o);let c=a[r];c===void 0&&(c={type:void 0,texture:void 0},a[r]=c),(c.type!==e||c.texture!==n)&&(o!==r&&(s.activeTexture(r),this.currentTextureSlot=r),s.bindTexture(e,n),c.type=e,c.texture=n)}bindBufferBase(e,n,r){const{gl:s}=this,o=`${e}-${n}`;return this.currentBoundBufferBases[o]!==r?(s.bindBufferBase(e,n,r),this.currentBoundBufferBases[o]=r,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:n,currentBoundTextures:r}=this,s=r[n];s!==void 0&&s.type!==void 0&&(e.bindTexture(s.type,null),s.type=void 0,s.texture=void 0)}}class OCe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,n=qs){const{gl:r,extensions:s}=this;let o;if(e===ci)return r.UNSIGNED_BYTE;if(e===KS)return r.UNSIGNED_SHORT_4_4_4_4;if(e===YS)return r.UNSIGNED_SHORT_5_5_5_1;if(e===ZS)return r.UNSIGNED_INT_5_9_9_9_REV;if(e===bd)return r.BYTE;if(e===Sd)return r.SHORT;if(e===oa)return r.UNSIGNED_SHORT;if(e===or)return r.INT;if(e===Dn)return r.UNSIGNED_INT;if(e===wi)return r.FLOAT;if(e===lr)return r.HALF_FLOAT;if(e===GN)return r.ALPHA;if(e===U0)return r.RGB;if(e===yi)return r.RGBA;if(e===no)return r.DEPTH_COMPONENT;if(e===io)return r.DEPTH_STENCIL;if(e===z0)return r.RED;if(e===nm)return r.RED_INTEGER;if(e===Ol)return r.RG;if(e===im)return r.RG_INTEGER;if(e===rm)return r.RGBA_INTEGER;if(e===wd||e===ou||e===au||e===lu)if(n===Et)if(o=s.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(e===wd)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===ou)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===au)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===lu)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=s.get("WEBGL_compressed_texture_s3tc"),o!==null){if(e===wd)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===ou)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===au)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===lu)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===Ky||e===Yy||e===Zy||e===Qy)if(o=s.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(e===Ky)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Yy)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Zy)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Qy)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===Jy||e===hp||e===fp)if(o=s.get("WEBGL_compressed_texture_etc"),o!==null){if(e===Jy||e===hp)return n===Et?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(e===fp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===pp||e===mp||e===gp||e===yp||e===vp||e===xp||e===_p||e===bp||e===Sp||e===wp||e===Tp||e===Ep||e===Mp||e===Ap)if(o=s.get("WEBGL_compressed_texture_astc"),o!==null){if(e===pp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===mp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===gp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===yp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===vp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===xp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===_p)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===bp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===Sp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===wp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===Tp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===Ep)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===Mp)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===Ap)return n===Et?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===Td)if(o=s.get("EXT_texture_compression_bptc"),o!==null){if(e===Td)return n===Et?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===HN||e===e0||e===t0||e===n0)if(o=s.get("EXT_texture_compression_rgtc"),o!==null){if(e===Td)return o.COMPRESSED_RED_RGTC1_EXT;if(e===e0)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===t0)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===n0)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===to?r.UNSIGNED_INT_24_8:r[e]!==void 0?r[e]:null}_clientWaitAsync(){const{gl:e}=this,n=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((r,s)=>{function o(){const a=e.clientWaitSync(n,e.SYNC_FLUSH_COMMANDS_BIT,0);if(a===e.WAIT_FAILED){e.deleteSync(n),s();return}if(a===e.TIMEOUT_EXPIRED){requestAnimationFrame(o);return}e.deleteSync(n),r()}o()})}}let VB=!1,e_,GM,$B;class FCe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},VB===!1&&(this._init(),VB=!0)}_init(){const e=this.gl;e_={[zd]:e.REPEAT,[Ua]:e.CLAMP_TO_EDGE,[Vd]:e.MIRRORED_REPEAT},GM={[Vn]:e.NEAREST,[$N]:e.NEAREST_MIPMAP_NEAREST,[Dl]:e.NEAREST_MIPMAP_LINEAR,[Xi]:e.LINEAR,[$f]:e.LINEAR_MIPMAP_NEAREST,[_s]:e.LINEAR_MIPMAP_LINEAR},$B={[WN]:e.NEVER,[YN]:e.ALWAYS,[QS]:e.LESS,[JS]:e.LEQUAL,[jN]:e.EQUAL,[KN]:e.GEQUAL,[qN]:e.GREATER,[XN]:e.NOTEQUAL}}getGLTextureType(e){const{gl:n}=this;let r;return e.isCubeTexture===!0?r=n.TEXTURE_CUBE_MAP:e.isDepthArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0||e.isTextureArray===!0?r=n.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?r=n.TEXTURE_3D:r=n.TEXTURE_2D,r}getInternalFormat(e,n,r,s,o=!1){const{gl:a,extensions:l}=this;if(e!==null){if(a[e]!==void 0)return a[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let c=n;return n===a.RED&&(r===a.FLOAT&&(c=a.R32F),r===a.HALF_FLOAT&&(c=a.R16F),r===a.UNSIGNED_BYTE&&(c=a.R8),r===a.UNSIGNED_SHORT&&(c=a.R16),r===a.UNSIGNED_INT&&(c=a.R32UI),r===a.BYTE&&(c=a.R8I),r===a.SHORT&&(c=a.R16I),r===a.INT&&(c=a.R32I)),n===a.RED_INTEGER&&(r===a.UNSIGNED_BYTE&&(c=a.R8UI),r===a.UNSIGNED_SHORT&&(c=a.R16UI),r===a.UNSIGNED_INT&&(c=a.R32UI),r===a.BYTE&&(c=a.R8I),r===a.SHORT&&(c=a.R16I),r===a.INT&&(c=a.R32I)),n===a.RG&&(r===a.FLOAT&&(c=a.RG32F),r===a.HALF_FLOAT&&(c=a.RG16F),r===a.UNSIGNED_BYTE&&(c=a.RG8),r===a.UNSIGNED_SHORT&&(c=a.RG16),r===a.UNSIGNED_INT&&(c=a.RG32UI),r===a.BYTE&&(c=a.RG8I),r===a.SHORT&&(c=a.RG16I),r===a.INT&&(c=a.RG32I)),n===a.RG_INTEGER&&(r===a.UNSIGNED_BYTE&&(c=a.RG8UI),r===a.UNSIGNED_SHORT&&(c=a.RG16UI),r===a.UNSIGNED_INT&&(c=a.RG32UI),r===a.BYTE&&(c=a.RG8I),r===a.SHORT&&(c=a.RG16I),r===a.INT&&(c=a.RG32I)),n===a.RGB&&(r===a.FLOAT&&(c=a.RGB32F),r===a.HALF_FLOAT&&(c=a.RGB16F),r===a.UNSIGNED_BYTE&&(c=a.RGB8),r===a.UNSIGNED_SHORT&&(c=a.RGB16),r===a.UNSIGNED_INT&&(c=a.RGB32UI),r===a.BYTE&&(c=a.RGB8I),r===a.SHORT&&(c=a.RGB16I),r===a.INT&&(c=a.RGB32I),r===a.UNSIGNED_BYTE&&(c=s===Et&&o===!1?a.SRGB8:a.RGB8),r===a.UNSIGNED_SHORT_5_6_5&&(c=a.RGB565),r===a.UNSIGNED_SHORT_5_5_5_1&&(c=a.RGB5_A1),r===a.UNSIGNED_SHORT_4_4_4_4&&(c=a.RGB4),r===a.UNSIGNED_INT_5_9_9_9_REV&&(c=a.RGB9_E5)),n===a.RGB_INTEGER&&(r===a.UNSIGNED_BYTE&&(c=a.RGB8UI),r===a.UNSIGNED_SHORT&&(c=a.RGB16UI),r===a.UNSIGNED_INT&&(c=a.RGB32UI),r===a.BYTE&&(c=a.RGB8I),r===a.SHORT&&(c=a.RGB16I),r===a.INT&&(c=a.RGB32I)),n===a.RGBA&&(r===a.FLOAT&&(c=a.RGBA32F),r===a.HALF_FLOAT&&(c=a.RGBA16F),r===a.UNSIGNED_BYTE&&(c=a.RGBA8),r===a.UNSIGNED_SHORT&&(c=a.RGBA16),r===a.UNSIGNED_INT&&(c=a.RGBA32UI),r===a.BYTE&&(c=a.RGBA8I),r===a.SHORT&&(c=a.RGBA16I),r===a.INT&&(c=a.RGBA32I),r===a.UNSIGNED_BYTE&&(c=s===Et&&o===!1?a.SRGB8_ALPHA8:a.RGBA8),r===a.UNSIGNED_SHORT_4_4_4_4&&(c=a.RGBA4),r===a.UNSIGNED_SHORT_5_5_5_1&&(c=a.RGB5_A1)),n===a.RGBA_INTEGER&&(r===a.UNSIGNED_BYTE&&(c=a.RGBA8UI),r===a.UNSIGNED_SHORT&&(c=a.RGBA16UI),r===a.UNSIGNED_INT&&(c=a.RGBA32UI),r===a.BYTE&&(c=a.RGBA8I),r===a.SHORT&&(c=a.RGBA16I),r===a.INT&&(c=a.RGBA32I)),n===a.DEPTH_COMPONENT&&(r===a.UNSIGNED_SHORT&&(c=a.DEPTH_COMPONENT16),r===a.UNSIGNED_INT&&(c=a.DEPTH_COMPONENT24),r===a.FLOAT&&(c=a.DEPTH_COMPONENT32F)),n===a.DEPTH_STENCIL&&r===a.UNSIGNED_INT_24_8&&(c=a.DEPTH24_STENCIL8),(c===a.R16F||c===a.R32F||c===a.RG16F||c===a.RG32F||c===a.RGBA16F||c===a.RGBA32F)&&l.get("EXT_color_buffer_float"),c}setTextureParameters(e,n){const{gl:r,extensions:s,backend:o}=this;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,n.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,n.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE),r.texParameteri(e,r.TEXTURE_WRAP_S,e_[n.wrapS]),r.texParameteri(e,r.TEXTURE_WRAP_T,e_[n.wrapT]),(e===r.TEXTURE_3D||e===r.TEXTURE_2D_ARRAY)&&n.isDepthArrayTexture!==!0&&n.isTextureArray===!1&&r.texParameteri(e,r.TEXTURE_WRAP_R,e_[n.wrapR]),r.texParameteri(e,r.TEXTURE_MAG_FILTER,GM[n.magFilter]);const a=n.mipmaps!==void 0&&n.mipmaps.length>0,l=n.minFilter===Xi&&a?_s:n.minFilter;if(r.texParameteri(e,r.TEXTURE_MIN_FILTER,GM[l]),n.compareFunction&&(r.texParameteri(e,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(e,r.TEXTURE_COMPARE_FUNC,$B[n.compareFunction])),s.has("EXT_texture_filter_anisotropic")===!0){if(n.magFilter===Vn||n.minFilter!==Dl&&n.minFilter!==_s||n.type===wi&&s.has("OES_texture_float_linear")===!1)return;if(n.anisotropy>1){const c=s.get("EXT_texture_filter_anisotropic");r.texParameterf(e,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(n.anisotropy,o.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:n,backend:r,defaultTextures:s}=this,o=this.getGLTextureType(e);let a=s[o];a===void 0&&(a=n.createTexture(),r.state.bindTexture(o,a),n.texParameteri(o,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(o,n.TEXTURE_MAG_FILTER,n.NEAREST),s[o]=a),r.set(e,{textureGPU:a,glTextureType:o,isDefault:!0})}createTexture(e,n){const{gl:r,backend:s}=this,{levels:o,width:a,height:l,depth:c}=n,u=s.utils.convert(e.format,e.colorSpace),d=s.utils.convert(e.type),h=this.getInternalFormat(e.internalFormat,u,d,e.colorSpace,e.isVideoTexture),f=r.createTexture(),p=this.getGLTextureType(e);s.state.bindTexture(p,f),this.setTextureParameters(p,e),e.isDepthArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture||e.isTextureArray?r.texStorage3D(r.TEXTURE_2D_ARRAY,o,h,a,l,c):e.isData3DTexture?r.texStorage3D(r.TEXTURE_3D,o,h,a,l,c):e.isVideoTexture||r.texStorage2D(p,o,h,a,l),s.set(e,{textureGPU:f,glTextureType:p,glFormat:u,glType:d,glInternalFormat:h})}copyBufferToTexture(e,n){const{gl:r,backend:s}=this,{textureGPU:o,glTextureType:a,glFormat:l,glType:c}=s.get(n),{width:u,height:d}=n.source.data;r.bindBuffer(r.PIXEL_UNPACK_BUFFER,e),s.state.bindTexture(a,o),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.texSubImage2D(a,0,0,0,u,d,l,c,0),r.bindBuffer(r.PIXEL_UNPACK_BUFFER,null),s.state.unbindTexture()}updateTexture(e,n){const{gl:r}=this,{width:s,height:o}=n,{textureGPU:a,glTextureType:l,glFormat:c,glType:u,glInternalFormat:d}=this.backend.get(e);if(e.isRenderTargetTexture||a===void 0)return;const h=f=>f.isDataTexture?f.image.data:typeof HTMLImageElement<"u"&&f instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&f instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&f instanceof ImageBitmap||f instanceof OffscreenCanvas?f:f.data;if(this.backend.state.bindTexture(l,a),this.setTextureParameters(l,e),e.isCompressedTexture){const f=e.mipmaps,p=n.image;for(let m=0;m<f.length;m++){const y=f[m];e.isCompressedArrayTexture?e.format!==r.RGBA?c!==null?r.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,m,0,0,0,y.width,y.height,p.depth,c,y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texSubImage3D(r.TEXTURE_2D_ARRAY,m,0,0,0,y.width,y.height,p.depth,c,u,y.data):c!==null?r.compressedTexSubImage2D(r.TEXTURE_2D,m,0,0,y.width,y.height,c,y.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const f=n.images;for(let p=0;p<6;p++){const m=h(f[p]);r.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+p,0,0,0,s,o,c,u,m)}}else if(e.isDataArrayTexture||e.isDepthArrayTexture){const f=n.image;r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,c,u,f.data)}else if(e.isData3DTexture){const f=n.image;r.texSubImage3D(r.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,c,u,f.data)}else if(e.isVideoTexture)e.update(),r.texImage2D(l,0,d,c,u,n.image);else{const f=h(n.image);r.texSubImage2D(l,0,0,0,s,o,c,u,f)}}generateMipmaps(e){const{gl:n,backend:r}=this,{textureGPU:s,glTextureType:o}=r.get(e);r.state.bindTexture(o,s),n.generateMipmap(o)}deallocateRenderBuffers(e){const{gl:n,backend:r}=this;if(e){const s=r.get(e);if(s.renderBufferStorageSetup=void 0,s.framebuffers){for(const o in s.framebuffers)n.deleteFramebuffer(s.framebuffers[o]);delete s.framebuffers}if(s.depthRenderbuffer&&(n.deleteRenderbuffer(s.depthRenderbuffer),delete s.depthRenderbuffer),s.stencilRenderbuffer&&(n.deleteRenderbuffer(s.stencilRenderbuffer),delete s.stencilRenderbuffer),s.msaaFrameBuffer&&(n.deleteFramebuffer(s.msaaFrameBuffer),delete s.msaaFrameBuffer),s.msaaRenderbuffers){for(let o=0;o<s.msaaRenderbuffers.length;o++)n.deleteRenderbuffer(s.msaaRenderbuffers[o]);delete s.msaaRenderbuffers}}}destroyTexture(e){const{gl:n,backend:r}=this,{textureGPU:s,renderTarget:o}=r.get(e);this.deallocateRenderBuffers(o),n.deleteTexture(s),r.delete(e)}copyTextureToTexture(e,n,r=null,s=null,o=0,a=0){const{gl:l,backend:c}=this,{state:u}=this.backend,{textureGPU:d,glTextureType:h,glType:f,glFormat:p}=c.get(n);u.bindTexture(h,d);let m,y,v,g,_,x,b,S,T;const w=e.isCompressedTexture?e.mipmaps[a]:e.image;if(r!==null)m=r.max.x-r.min.x,y=r.max.y-r.min.y,v=r.isBox3?r.max.z-r.min.z:1,g=r.min.x,_=r.min.y,x=r.isBox3?r.min.z:0;else{const C=Math.pow(2,-o);m=Math.floor(w.width*C),y=Math.floor(w.height*C),e.isDataArrayTexture||e.isDepthArrayTexture?v=w.depth:e.isData3DTexture?v=Math.floor(w.depth*C):v=1,g=0,_=0,x=0}s!==null?(b=s.x,S=s.y,T=s.z):(b=0,S=0,T=0),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,n.unpackAlignment);const E=l.getParameter(l.UNPACK_ROW_LENGTH),A=l.getParameter(l.UNPACK_IMAGE_HEIGHT),M=l.getParameter(l.UNPACK_SKIP_PIXELS),R=l.getParameter(l.UNPACK_SKIP_ROWS),F=l.getParameter(l.UNPACK_SKIP_IMAGES);l.pixelStorei(l.UNPACK_ROW_LENGTH,w.width),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,w.height),l.pixelStorei(l.UNPACK_SKIP_PIXELS,g),l.pixelStorei(l.UNPACK_SKIP_ROWS,_),l.pixelStorei(l.UNPACK_SKIP_IMAGES,x);const B=n.isDataArrayTexture||n.isData3DTexture||n.isDepthArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const C=c.get(e),L=c.get(n),P=c.get(C.renderTarget),W=c.get(L.renderTarget),D=P.framebuffers[C.cacheKey],X=W.framebuffers[L.cacheKey];u.bindFramebuffer(l.READ_FRAMEBUFFER,D),u.bindFramebuffer(l.DRAW_FRAMEBUFFER,X);let q=l.COLOR_BUFFER_BIT;e.isDepthTexture&&(q=l.DEPTH_BUFFER_BIT),l.blitFramebuffer(g,_,m,y,b,S,m,y,q,l.NEAREST),u.bindFramebuffer(l.READ_FRAMEBUFFER,null),u.bindFramebuffer(l.DRAW_FRAMEBUFFER,null)}else B?e.isDataTexture||e.isData3DTexture?l.texSubImage3D(h,a,b,S,T,m,y,v,p,f,w.data):n.isCompressedArrayTexture?l.compressedTexSubImage3D(h,a,b,S,T,m,y,v,p,w.data):l.texSubImage3D(h,a,b,S,T,m,y,v,p,f,w):e.isDataTexture?l.texSubImage2D(h,a,b,S,m,y,p,f,w.data):e.isCompressedTexture?l.compressedTexSubImage2D(h,a,b,S,w.width,w.height,p,w.data):l.texSubImage2D(h,a,b,S,m,y,p,f,w);l.pixelStorei(l.UNPACK_ROW_LENGTH,E),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,A),l.pixelStorei(l.UNPACK_SKIP_PIXELS,M),l.pixelStorei(l.UNPACK_SKIP_ROWS,R),l.pixelStorei(l.UNPACK_SKIP_IMAGES,F),a===0&&n.generateMipmaps&&l.generateMipmap(h),u.unbindTexture()}copyFramebufferToTexture(e,n,r){const{gl:s}=this,{state:o}=this.backend,{textureGPU:a}=this.backend.get(e),{x:l,y:c,z:u,w:d}=r,h=e.isDepthTexture===!0||n.renderTarget&&n.renderTarget.samples>0,f=n.renderTarget?n.renderTarget.height:this.backend.getDrawingBufferSize().y;if(h){const p=l!==0||c!==0;let m,y;if(e.isDepthTexture===!0?(m=s.DEPTH_BUFFER_BIT,y=s.DEPTH_ATTACHMENT,n.stencil&&(m|=s.STENCIL_BUFFER_BIT)):(m=s.COLOR_BUFFER_BIT,y=s.COLOR_ATTACHMENT0),p){const v=this.backend.get(n.renderTarget),g=v.framebuffers[n.getCacheKey()],_=v.msaaFrameBuffer;o.bindFramebuffer(s.DRAW_FRAMEBUFFER,g),o.bindFramebuffer(s.READ_FRAMEBUFFER,_);const x=f-c-d;s.blitFramebuffer(l,x,l+u,x+d,l,x,l+u,x+d,m,s.NEAREST),o.bindFramebuffer(s.READ_FRAMEBUFFER,g),o.bindTexture(s.TEXTURE_2D,a),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,l,x,u,d),o.unbindTexture()}else{const v=s.createFramebuffer();o.bindFramebuffer(s.DRAW_FRAMEBUFFER,v),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,y,s.TEXTURE_2D,a,0),s.blitFramebuffer(0,0,u,d,0,0,u,d,m,s.NEAREST),s.deleteFramebuffer(v)}}else o.bindTexture(s.TEXTURE_2D,a),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,l,f-d-c,u,d),o.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(n)}setupRenderBufferStorage(e,n,r,s=!1){const{gl:o}=this,a=n.renderTarget,{depthTexture:l,depthBuffer:c,stencilBuffer:u,width:d,height:h}=a;if(o.bindRenderbuffer(o.RENDERBUFFER,e),c&&!u){let f=o.DEPTH_COMPONENT24;s===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(o.RENDERBUFFER,a.samples,f,d,h):r>0?(l&&l.isDepthTexture&&l.type===o.FLOAT&&(f=o.DEPTH_COMPONENT32F),o.renderbufferStorageMultisample(o.RENDERBUFFER,r,f,d,h)):o.renderbufferStorage(o.RENDERBUFFER,f,d,h),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e)}else c&&u&&(r>0?o.renderbufferStorageMultisample(o.RENDERBUFFER,r,o.DEPTH24_STENCIL8,d,h):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,d,h),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,e))}async copyTextureToBuffer(e,n,r,s,o,a){const{backend:l,gl:c}=this,{textureGPU:u,glFormat:d,glType:h}=this.backend.get(e),f=c.createFramebuffer();c.bindFramebuffer(c.READ_FRAMEBUFFER,f);const p=e.isCubeTexture?c.TEXTURE_CUBE_MAP_POSITIVE_X+a:c.TEXTURE_2D;c.framebufferTexture2D(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,p,u,0);const m=this._getTypedArrayType(h),y=this._getBytesPerTexel(h,d),g=s*o*y,_=c.createBuffer();c.bindBuffer(c.PIXEL_PACK_BUFFER,_),c.bufferData(c.PIXEL_PACK_BUFFER,g,c.STREAM_READ),c.readPixels(n,r,s,o,d,h,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),await l.utils._clientWaitAsync();const x=new m(g/m.BYTES_PER_ELEMENT);return c.bindBuffer(c.PIXEL_PACK_BUFFER,_),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,x),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),c.deleteFramebuffer(f),x}_getTypedArrayType(e){const{gl:n}=this;if(e===n.UNSIGNED_BYTE)return Uint8Array;if(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT)return Uint16Array;if(e===n.UNSIGNED_INT)return Uint32Array;if(e===n.HALF_FLOAT)return Uint16Array;if(e===n.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,n){const{gl:r}=this;let s=0;if(e===r.UNSIGNED_BYTE&&(s=1),(e===r.UNSIGNED_SHORT_4_4_4_4||e===r.UNSIGNED_SHORT_5_5_5_1||e===r.UNSIGNED_SHORT_5_6_5||e===r.UNSIGNED_SHORT||e===r.HALF_FLOAT)&&(s=2),(e===r.UNSIGNED_INT||e===r.FLOAT)&&(s=4),n===r.RGBA)return s*4;if(n===r.RGB)return s*3;if(n===r.ALPHA)return s}}class BCe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let n=this.extensions[e];return n===void 0&&(n=this.gl.getExtension(e),this.extensions[e]=n),n}has(e){return this.availableExtensions.includes(e)}}class UCe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,n=this.backend.extensions;if(n.has("EXT_texture_filter_anisotropic")===!0){const r=n.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const GB={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class zCe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,n){const{gl:r,mode:s,object:o,type:a,info:l,index:c}=this;c!==0?r.drawElements(s,n,a,e):r.drawArrays(s,e,n),l.update(o,n,1)}renderInstances(e,n,r){const{gl:s,mode:o,type:a,index:l,object:c,info:u}=this;r!==0&&(l!==0?s.drawElementsInstanced(o,n,a,e,r):s.drawArraysInstanced(o,e,n,r),u.update(c,n,r))}renderMultiDraw(e,n,r){const{extensions:s,mode:o,object:a,info:l}=this;if(r===0)return;const c=s.get("WEBGL_multi_draw");if(c===null)for(let u=0;u<r;u++)this.render(e[u],n[u]);else{this.index!==0?c.multiDrawElementsWEBGL(o,n,0,this.type,e,0,r):c.multiDrawArraysWEBGL(o,e,0,n,0,r);let u=0;for(let d=0;d<r;d++)u+=n[d];l.update(a,u,1)}}renderMultiDrawInstances(e,n,r,s){const{extensions:o,mode:a,object:l,info:c}=this;if(r===0)return;const u=o.get("WEBGL_multi_draw");if(u===null)for(let d=0;d<r;d++)this.renderInstances(e[d],n[d],s[d]);else{this.index!==0?u.multiDrawElementsInstancedWEBGL(a,n,0,this.type,e,0,s,0,r):u.multiDrawArraysInstancedWEBGL(a,e,0,n,0,s,0,r);let d=0;for(let h=0;h<r;h++)d+=n[h]*s[h];c.update(l,d,1)}}}class x6{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class VCe extends x6{constructor(e,n,r=2048){if(super(r),this.gl=e,this.type=n,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let s=0;s<this.maxQueries;s++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return da(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const n=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(n,"inactive"),this.queryOffsets.set(e.id,n),n}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const n=this.queryOffsets.get(e.id);if(n==null||this.activeQuery!==null)return;const r=this.queries[n];if(r)try{this.queryStates.get(n)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,r),this.activeQuery=n,this.queryStates.set(n,"started"))}catch(s){console.error("Error in beginQuery:",s),this.activeQuery=null,this.queryStates.set(n,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const n=this.queryOffsets.get(e.id);if(n!=null&&this.activeQuery===n)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(n,"ended"),this.activeQuery=null}catch(r){console.error("Error in endQuery:",r),this.queryStates.set(n,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[s,o]of this.queryStates)if(o==="ended"){const a=this.queries[s];e.push(this.resolveQuery(a))}if(e.length===0)return this.lastValue;const r=(await Promise.all(e)).reduce((s,o)=>s+o,0);return this.lastValue=r,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,r}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(n=>{if(this.isDisposed){n(this.lastValue);return}let r,s=!1;const o=()=>{r&&(clearTimeout(r),r=null)},a=c=>{s||(s=!0,o(),n(c))},l=()=>{if(this.isDisposed){a(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){a(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){r=setTimeout(l,1);return}const d=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);n(Number(d)/1e6)}catch(c){console.error("Error checking query:",c),n(this.lastValue)}};l()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class HB extends v6{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const n=this.parameters,r={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},s=n.context!==void 0?n.context:e.domElement.getContext("webgl2",r);function o(a){a.preventDefault();const l={api:"WebGL",message:a.statusMessage||"Unknown reason",reason:null,originalEvent:a};e.onDeviceLost(l)}this._onContextLost=o,e.domElement.addEventListener("webglcontextlost",o,!1),this.gl=s,this.extensions=new BCe(this),this.capabilities=new UCe(this),this.attributeUtils=new ICe(this),this.textureUtils=new FCe(this),this.bufferRenderer=new zCe(this),this.state=new DCe(this),this.utils=new OCe(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return is}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,n,r=null){const s=this.gl;if(this.set(e.texture,{textureGPU:n,glInternalFormat:s.RGBA8}),r!==null){const o=e.stencilBuffer?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:r,glInternalFormat:o}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer===!0&&e.multiview===!1&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e.autoAllocateDepthBuffer=!1}}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const n=e.isComputeNode?"compute":"render";this.timestampQueryPool[n]||(this.timestampQueryPool[n]=new VCe(this.gl,n,2048));const r=this.timestampQueryPool[n];r.allocateQueriesForContext(e)!==null&&r.beginQuery(e)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const n=e.isComputeNode?"compute":"render";this.timestampQueryPool[n].endQuery(e)}getContext(){return this.gl}beginRender(e){const{state:n,gl:r}=this,s=this.get(e);if(e.viewport?this.updateViewport(e):n.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),e.scissor){const{x:a,y:l,width:c,height:u}=e.scissorValue;n.scissor(a,e.height-u-l,c,u)}this.initTimestampQuery(e),s.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const o=e.occlusionQueryCount;o>0&&(s.currentOcclusionQueries=s.occlusionQueries,s.currentOcclusionQueryObjects=s.occlusionQueryObjects,s.lastOcclusionObject=null,s.occlusionQueries=new Array(o),s.occlusionQueryObjects=new Array(o),s.occlusionQueryIndex=0)}finishRender(e){const{gl:n,state:r}=this,s=this.get(e),o=s.previousContext;r.resetVertexState();const a=e.occlusionQueryCount;a>0&&(a>s.occlusionQueryIndex&&n.endQuery(n.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const l=e.textures;if(l!==null)for(let c=0;c<l.length;c++){const u=l[c];u.generateMipmaps&&this.generateMipmaps(u)}if(this._currentContext=o,e.textures!==null&&e.renderTarget){const c=this.get(e.renderTarget),{samples:u}=e.renderTarget;if(u>0&&this._useMultisampledExtension(e.renderTarget)===!1){const d=c.framebuffers[e.getCacheKey()],h=n.COLOR_BUFFER_BIT,f=c.msaaFrameBuffer,p=e.textures;r.bindFramebuffer(n.READ_FRAMEBUFFER,f),r.bindFramebuffer(n.DRAW_FRAMEBUFFER,d);for(let m=0;m<p.length;m++)if(e.scissor){const{x:y,y:v,width:g,height:_}=e.scissorValue,x=e.height-_-v;n.blitFramebuffer(y,x,y+g,x+_,y,x,y+g,x+_,h,n.NEAREST),this._supportsInvalidateFramebuffer===!0&&n.invalidateSubFramebuffer(n.READ_FRAMEBUFFER,c.invalidationArray,y,x,g,_)}else n.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,h,n.NEAREST),this._supportsInvalidateFramebuffer===!0&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,c.invalidationArray)}}o!==null&&(this._setFramebuffer(o),o.viewport?this.updateViewport(o):r.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight)),this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const n=this.get(e),{currentOcclusionQueries:r,currentOcclusionQueryObjects:s}=n;if(r&&s){const o=new WeakSet,{gl:a}=this;n.currentOcclusionQueryObjects=null,n.currentOcclusionQueries=null;const l=()=>{let c=0;for(let u=0;u<r.length;u++){const d=r[u];d!==null&&a.getQueryParameter(d,a.QUERY_RESULT_AVAILABLE)&&(a.getQueryParameter(d,a.QUERY_RESULT)===0&&o.add(s[u]),r[u]=null,a.deleteQuery(d),c++)}c<r.length?requestAnimationFrame(l):n.occluded=o};l()}}isOccluded(e,n){const r=this.get(e);return r.occluded&&r.occluded.has(n)}updateViewport(e){const{state:n}=this,{x:r,y:s,width:o,height:a}=e.viewportValue;n.viewport(r,e.height-a-s,o,a)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,n,r,s=null,o=!0){const{gl:a,renderer:l}=this;s===null&&(s={textures:null,clearColorValue:this.getClearColor()});let c=0;if(e&&(c|=a.COLOR_BUFFER_BIT),n&&(c|=a.DEPTH_BUFFER_BIT),r&&(c|=a.STENCIL_BUFFER_BIT),c!==0){let u;s.clearColorValue?u=s.clearColorValue:u=this.getClearColor();const d=l.getClearDepth(),h=l.getClearStencil();if(n&&this.state.setDepthMask(!0),s.textures===null)a.clearColor(u.r,u.g,u.b,u.a),a.clear(c);else{if(o&&this._setFramebuffer(s),e)for(let f=0;f<s.textures.length;f++)f===0?a.clearBufferfv(a.COLOR,f,[u.r,u.g,u.b,u.a]):a.clearBufferfv(a.COLOR,f,[0,0,0,1]);n&&r?a.clearBufferfi(a.DEPTH_STENCIL,0,d,h):n?a.clearBufferfv(a.DEPTH,0,[d]):r&&a.clearBufferiv(a.STENCIL,0,[h])}}}beginCompute(e){const{state:n,gl:r}=this;n.bindFramebuffer(r.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,n,r,s){const{state:o,gl:a}=this;this.discard===!1&&(a.enable(a.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:l,transformBuffers:c,attributes:u}=this.get(s),d=this._getVaoKey(u),h=this.vaoCache[d];h===void 0?this._createVao(u):o.setVertexState(h),o.useProgram(l),this._bindUniforms(r);const f=this._getTransformFeedback(c);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,f),a.beginTransformFeedback(a.POINTS),u[0].isStorageInstancedBufferAttribute?a.drawArraysInstanced(a.POINTS,0,1,n.count):a.drawArrays(a.POINTS,0,n.count),a.endTransformFeedback(),a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null);for(let p=0;p<c.length;p++){const m=c[p];m.pbo&&this.textureUtils.copyBufferToTexture(m.transformBuffer,m.pbo),m.switchBuffers()}}finishCompute(e){const n=this.gl;this.discard=!1,n.disable(n.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isDepthArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:n,pipeline:r,material:s,context:o,hardwareClippingPlanes:a}=e,{programGPU:l}=this.get(r),{gl:c,state:u}=this,d=this.get(o),h=e.getDrawParameters();if(h===null)return;this._bindUniforms(e.getBindings());const f=n.isMesh&&n.matrixWorld.determinant()<0;u.setMaterial(s,f,a),u.useProgram(l);const p=this.get(e);let m=p.staticVao;if(m===void 0||p.geometryId!==e.geometry.id){const w=this._getVaoKey(e.getAttributes());if(m=this.vaoCache[w],m===void 0){let E;({vaoGPU:m,staticVao:E}=this._createVao(e.getAttributes())),E&&(p.staticVao=m,p.geometryId=e.geometry.id)}}const y=e.getIndex(),v=y!==null?this.get(y).bufferGPU:null;u.setVertexState(m,v);const g=d.lastOcclusionObject;if(g!==n&&g!==void 0){if(g!==null&&g.occlusionTest===!0&&(c.endQuery(c.ANY_SAMPLES_PASSED),d.occlusionQueryIndex++),n.occlusionTest===!0){const w=c.createQuery();c.beginQuery(c.ANY_SAMPLES_PASSED,w),d.occlusionQueries[d.occlusionQueryIndex]=w,d.occlusionQueryObjects[d.occlusionQueryIndex]=n}d.lastOcclusionObject=n}const _=this.bufferRenderer;n.isPoints?_.mode=c.POINTS:n.isLineSegments?_.mode=c.LINES:n.isLine?_.mode=c.LINE_STRIP:n.isLineLoop?_.mode=c.LINE_LOOP:s.wireframe===!0?(u.setLineWidth(s.wireframeLinewidth*this.renderer.getPixelRatio()),_.mode=c.LINES):_.mode=c.TRIANGLES;const{vertexCount:x,instanceCount:b}=h;let{firstVertex:S}=h;if(_.object=n,y!==null){S*=y.array.BYTES_PER_ELEMENT;const w=this.get(y);_.index=y.count,_.type=w.type}else _.index=0;const T=()=>{n.isBatchedMesh?n._multiDrawInstances!==null?(da("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),_.renderMultiDrawInstances(n._multiDrawStarts,n._multiDrawCounts,n._multiDrawCount,n._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?_.renderMultiDraw(n._multiDrawStarts,n._multiDrawCounts,n._multiDrawCount):da("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):b>1?_.renderInstances(S,x,b):_.render(S,x)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const w=this.get(e.camera),E=e.camera.cameras,A=e.getBindingGroup("cameraIndex").bindings[0];if(w.indexesGPU===void 0||w.indexesGPU.length!==E.length){const L=new Uint32Array([0,0,0,0]),P=[];for(let W=0,D=E.length;W<D;W++){const X=c.createBuffer();L[0]=W,c.bindBuffer(c.UNIFORM_BUFFER,X),c.bufferData(c.UNIFORM_BUFFER,L,c.STATIC_DRAW),P.push(X)}w.indexesGPU=P}const M=this.get(A),R=this.renderer.getPixelRatio(),F=this._currentContext.renderTarget,B=this._isRenderCameraDepthArray(this._currentContext),C=this._currentContext.activeCubeFace;if(B){const L=this.get(F.depthTexture);if(L.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){L.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:P}=F;for(let W=0,D=E.length;W<D;W++)this.renderer._activeCubeFace=W,this._currentContext.activeCubeFace=W,this._setFramebuffer(this._currentContext),this.clear(!1,!0,P,this._currentContext,!1);this.renderer._activeCubeFace=C,this._currentContext.activeCubeFace=C}}for(let L=0,P=E.length;L<P;L++){const W=E[L];if(n.layers.test(W.layers)){B&&(this.renderer._activeCubeFace=L,this._currentContext.activeCubeFace=L,this._setFramebuffer(this._currentContext));const D=W.viewport;if(D!==void 0){const X=D.x*R,q=D.y*R,J=D.width*R,se=D.height*R;u.viewport(Math.floor(X),Math.floor(e.context.height-se-q),Math.floor(J),Math.floor(se))}u.bindBufferBase(c.UNIFORM_BUFFER,M.index,w.indexesGPU[L]),T()}this._currentContext.activeCubeFace=C,this.renderer._activeCubeFace=C}}else T()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,n){this.textureUtils.createTexture(e,n)}updateTexture(e,n){this.textureUtils.updateTexture(e,n)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,n,r,s,o,a){return this.textureUtils.copyTextureToBuffer(e,n,r,s,o,a)}createSampler(){}destroySampler(){}createNodeBuilder(e,n){return new NCe(e,n)}createProgram(e){const n=this.gl,{stage:r,code:s}=e,o=r==="fragment"?n.createShader(n.FRAGMENT_SHADER):n.createShader(n.VERTEX_SHADER);n.shaderSource(o,s),n.compileShader(o),this.set(e,{shaderGPU:o})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,n){const r=this.gl,s=e.pipeline,{fragmentProgram:o,vertexProgram:a}=s,l=r.createProgram(),c=this.get(o).shaderGPU,u=this.get(a).shaderGPU;if(r.attachShader(l,c),r.attachShader(l,u),r.linkProgram(l),this.set(s,{programGPU:l,fragmentShader:c,vertexShader:u}),n!==null&&this.parallel){const d=new Promise(h=>{const f=this.parallel,p=()=>{r.getProgramParameter(l,f.COMPLETION_STATUS_KHR)?(this._completeCompile(e,s),h()):requestAnimationFrame(p)};p()});n.push(d);return}this._completeCompile(e,s)}_handleSource(e,n){const r=e.split(`
`),s=[],o=Math.max(n-6,0),a=Math.min(n+6,r.length);for(let l=o;l<a;l++){const c=l+1;s.push(`${c===n?">":" "} ${c}: ${r[l]}`)}return s.join(`
`)}_getShaderErrors(e,n,r){const s=e.getShaderParameter(n,e.COMPILE_STATUS),o=e.getShaderInfoLog(n).trim();if(s&&o==="")return"";const a=/ERROR: 0:(\d+)/.exec(o);if(a){const l=parseInt(a[1]);return r.toUpperCase()+`

`+o+`

`+this._handleSource(e.getShaderSource(n),l)}else return o}_logProgramError(e,n,r){if(this.renderer.debug.checkShaderErrors){const s=this.gl,o=s.getProgramInfoLog(e).trim();if(s.getProgramParameter(e,s.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(s,e,r,n);else{const a=this._getShaderErrors(s,r,"vertex"),l=this._getShaderErrors(s,n,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(e,s.VALIDATE_STATUS)+`

Program Info Log: `+o+`
`+a+`
`+l)}else o!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",o)}}_completeCompile(e,n){const{state:r,gl:s}=this,o=this.get(n),{programGPU:a,fragmentShader:l,vertexShader:c}=o;s.getProgramParameter(a,s.LINK_STATUS)===!1&&this._logProgramError(a,l,c),r.useProgram(a);const u=e.getBindings();this._setupBindings(u,a),this.set(n,{programGPU:a})}createComputePipeline(e,n){const{state:r,gl:s}=this,o={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(o);const{computeProgram:a}=e,l=s.createProgram(),c=this.get(o).shaderGPU,u=this.get(a).shaderGPU,d=a.transforms,h=[],f=[];for(let v=0;v<d.length;v++){const g=d[v];h.push(g.varyingName),f.push(g.attributeNode)}s.attachShader(l,c),s.attachShader(l,u),s.transformFeedbackVaryings(l,h,s.SEPARATE_ATTRIBS),s.linkProgram(l),s.getProgramParameter(l,s.LINK_STATUS)===!1&&this._logProgramError(l,c,u),r.useProgram(l),this._setupBindings(n,l);const p=a.attributes,m=[],y=[];for(let v=0;v<p.length;v++){const g=p[v].node.attribute;m.push(g),this.has(g)||this.attributeUtils.createAttribute(g,s.ARRAY_BUFFER)}for(let v=0;v<f.length;v++){const g=f[v].attribute;this.has(g)||this.attributeUtils.createAttribute(g,s.ARRAY_BUFFER);const _=this.get(g);y.push(_)}this.set(e,{programGPU:l,transformBuffers:y,attributes:m})}createBindings(e,n){if(this._knownBindings.has(n)===!1){this._knownBindings.add(n);let r=0,s=0;for(const o of n){this.set(o,{textures:s,uniformBuffers:r});for(const a of o.bindings)a.isUniformBuffer&&r++,a.isSampledTexture&&s++}}this.updateBindings(e,n)}updateBindings(e){const{gl:n}=this,r=this.get(e);let s=r.uniformBuffers,o=r.textures;for(const a of e.bindings)if(a.isUniformsGroup||a.isUniformBuffer){const l=a.buffer,c=n.createBuffer();n.bindBuffer(n.UNIFORM_BUFFER,c),n.bufferData(n.UNIFORM_BUFFER,l,n.DYNAMIC_DRAW),this.set(a,{index:s++,bufferGPU:c})}else if(a.isSampledTexture){const{textureGPU:l,glTextureType:c}=this.get(a.texture);this.set(a,{index:o++,textureGPU:l,glTextureType:c})}}updateBinding(e){const n=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const s=this.get(e).bufferGPU,o=e.buffer;n.bindBuffer(n.UNIFORM_BUFFER,s),n.bufferData(n.UNIFORM_BUFFER,o,n.DYNAMIC_DRAW)}}createIndexAttribute(e){const n=this.gl;this.attributeUtils.createAttribute(e,n.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const n=this.gl;this.attributeUtils.createAttribute(e,n.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const n=this.gl;this.attributeUtils.createAttribute(e,n.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const n=Object.keys(GB).filter(s=>GB[s]===e),r=this.extensions;for(let s=0;s<n.length;s++)if(r.has(n[s]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,n,r=null,s=null,o=0,a=0){this.textureUtils.copyTextureToTexture(e,n,r,s,o,a)}copyFramebufferToTexture(e,n,r){this.textureUtils.copyFramebufferToTexture(e,n,r)}_setFramebuffer(e){const{gl:n,state:r}=this;let s=null;if(e.textures!==null){const o=e.renderTarget,a=this.get(o),{samples:l,depthBuffer:c,stencilBuffer:u}=o,d=o.isWebGLCubeRenderTarget===!0,h=o.isRenderTarget3D===!0,f=o.isRenderTargetArray===!0,p=o.isXRRenderTarget===!0,m=p===!0&&o.hasExternalTextures===!0;let y=a.msaaFrameBuffer,v=a.depthRenderbuffer;const g=this.extensions.get("WEBGL_multisampled_render_to_texture"),_=this.extensions.get("OVR_multiview2"),x=this._useMultisampledExtension(o),b=Y8(e);let S;if(d?(a.cubeFramebuffers||(a.cubeFramebuffers={}),S=a.cubeFramebuffers[b]):p&&m===!1?S=this._xrFramebuffer:(a.framebuffers||(a.framebuffers={}),S=a.framebuffers[b]),S===void 0){S=n.createFramebuffer(),r.bindFramebuffer(n.FRAMEBUFFER,S);const T=e.textures;if(d){a.cubeFramebuffers[b]=S;const{textureGPU:w}=this.get(T[0]),E=this.renderer._activeCubeFace;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+E,w,0)}else{a.framebuffers[b]=S;for(let w=0;w<T.length;w++){const E=T[w],A=this.get(E);A.renderTarget=e.renderTarget,A.cacheKey=b;const M=n.COLOR_ATTACHMENT0+w;if(h||f){const R=this.renderer._activeCubeFace;n.framebufferTextureLayer(n.FRAMEBUFFER,M,A.textureGPU,0,R)}else o.multiview?_.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,M,A.textureGPU,0,l,0,2):m&&x?g.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,M,n.TEXTURE_2D,A.textureGPU,0,l):n.framebufferTexture2D(n.FRAMEBUFFER,M,n.TEXTURE_2D,A.textureGPU,0)}r.drawBuffers(e,S)}if(o.isXRRenderTarget&&o.autoAllocateDepthBuffer===!0){const w=n.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(w,e,0,x),a.xrDepthRenderbuffer=w}else if(e.depthTexture!==null){const w=this.get(e.depthTexture),E=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(w.renderTarget=e.renderTarget,w.cacheKey=b,o.multiview)_.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,E,w.textureGPU,0,l,0,2);else if(m&&x)g.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,E,n.TEXTURE_2D,w.textureGPU,0,l);else if(e.depthTexture.isDepthArrayTexture){const A=this.renderer._activeCubeFace;n.framebufferTextureLayer(n.FRAMEBUFFER,E,w.textureGPU,0,A)}else n.framebufferTexture2D(n.FRAMEBUFFER,E,n.TEXTURE_2D,w.textureGPU,0)}}else{if(this._isRenderCameraDepthArray(e)){r.bindFramebuffer(n.FRAMEBUFFER,S);const w=this.renderer._activeCubeFace,E=this.get(e.depthTexture),A=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.framebufferTextureLayer(n.FRAMEBUFFER,A,E.textureGPU,0,w)}if(p&&m||o.multiview){r.bindFramebuffer(n.FRAMEBUFFER,S);const w=this.get(e.textures[0]);o.multiview?_.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,w.textureGPU,0,l,0,2):x?g.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,w.textureGPU,0,l):n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,w.textureGPU,0);const E=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(o.autoAllocateDepthBuffer===!0){const A=a.xrDepthRenderbuffer;n.bindRenderbuffer(n.RENDERBUFFER,A),n.framebufferRenderbuffer(n.FRAMEBUFFER,E,n.RENDERBUFFER,A)}else{const A=this.get(e.depthTexture);o.multiview?_.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,E,A.textureGPU,0,l,0,2):x?g.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,E,n.TEXTURE_2D,A.textureGPU,0,l):n.framebufferTexture2D(n.FRAMEBUFFER,E,n.TEXTURE_2D,A.textureGPU,0)}}}if(l>0&&x===!1&&!o.multiview){if(y===void 0){const T=[];y=n.createFramebuffer(),r.bindFramebuffer(n.FRAMEBUFFER,y);const w=[],E=e.textures;for(let A=0;A<E.length;A++){if(w[A]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,w[A]),T.push(n.COLOR_ATTACHMENT0+A),c){const F=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;T.push(F)}const M=e.textures[A],R=this.get(M);n.renderbufferStorageMultisample(n.RENDERBUFFER,l,R.glInternalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+A,n.RENDERBUFFER,w[A])}if(a.msaaFrameBuffer=y,a.msaaRenderbuffers=w,v===void 0){v=n.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(v,e,l),a.depthRenderbuffer=v;const A=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;T.push(A)}a.invalidationArray=T}s=a.msaaFrameBuffer}else s=S}r.bindFramebuffer(n.FRAMEBUFFER,s)}_getVaoKey(e){let n="";for(let r=0;r<e.length;r++){const s=this.get(e[r]);n+=":"+s.id}return n}_createVao(e){const{gl:n}=this,r=n.createVertexArray();let s="",o=!0;n.bindVertexArray(r);for(let a=0;a<e.length;a++){const l=e[a],c=this.get(l);s+=":"+c.id,n.bindBuffer(n.ARRAY_BUFFER,c.bufferGPU),n.enableVertexAttribArray(a),(l.isStorageBufferAttribute||l.isStorageInstancedBufferAttribute)&&(o=!1);let u,d;l.isInterleavedBufferAttribute===!0?(u=l.data.stride*c.bytesPerElement,d=l.offset*c.bytesPerElement):(u=0,d=0),c.isInteger?n.vertexAttribIPointer(a,l.itemSize,c.type,u,d):n.vertexAttribPointer(a,l.itemSize,c.type,l.normalized,u,d),l.isInstancedBufferAttribute&&!l.isInterleavedBufferAttribute?n.vertexAttribDivisor(a,l.meshPerAttribute):l.isInterleavedBufferAttribute&&l.data.isInstancedInterleavedBuffer&&n.vertexAttribDivisor(a,l.data.meshPerAttribute)}return n.bindBuffer(n.ARRAY_BUFFER,null),this.vaoCache[s]=r,{vaoGPU:r,staticVao:o}}_getTransformFeedback(e){let n="";for(let o=0;o<e.length;o++)n+=":"+e[o].id;let r=this.transformFeedbackCache[n];if(r!==void 0)return r;const{gl:s}=this;r=s.createTransformFeedback(),s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,r);for(let o=0;o<e.length;o++){const a=e[o];s.bindBufferBase(s.TRANSFORM_FEEDBACK_BUFFER,o,a.transformBuffer)}return s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[n]=r,r}_setupBindings(e,n){const r=this.gl;for(const s of e)for(const o of s.bindings){const l=this.get(o).index;if(o.isUniformsGroup||o.isUniformBuffer){const c=r.getUniformBlockIndex(n,o.name);r.uniformBlockBinding(n,c,l)}else if(o.isSampledTexture){const c=r.getUniformLocation(n,o.name);r.uniform1i(c,l)}}}_bindUniforms(e){const{gl:n,state:r}=this;for(const s of e)for(const o of s.bindings){const a=this.get(o),l=a.index;o.isUniformsGroup||o.isUniformBuffer?r.bindBufferBase(n.UNIFORM_BUFFER,l,a.bufferGPU):o.isSampledTexture&&r.bindTexture(a.glTextureType,a.textureGPU,n.TEXTURE0+l)}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer!==!1}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const Ef={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},mr={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},Xr={Store:"store"},_n={Load:"load",Clear:"clear"},HM={CCW:"ccw"},WM={None:"none",Front:"front",Back:"back"},Ip={Uint16:"uint16",Uint32:"uint32"},te={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},jM={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},ud={Linear:"linear",Nearest:"nearest"},$t={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDstColor:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},ju={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},WB={None:0,All:15},Dc={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},qM={Storage:"storage",ReadOnlyStorage:"read-only-storage"},XM={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},jB={NonFiltering:"non-filtering",Comparison:"comparison"},qu={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},qB={TwoD:"2d",ThreeD:"3d"},sr={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},$Ce={All:"all"},t_={Vertex:"vertex",Instance:"instance"},xR={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"};class GCe extends nk{constructor(e,n){super(e),this.texture=n,this.version=n?n.version:0,this.isSampler=!0}}class HCe extends GCe{constructor(e,n,r){super(e,n?n.value:null),this.textureNode=n,this.groupNode=r}update(){this.texture=this.textureNode.value}}class WCe extends h6{constructor(e,n){super(e,n?n.array:null),this.attribute=n,this.isStorageBuffer=!0}}let jCe=0;class qCe extends WCe{constructor(e,n){super("StorageBuffer_"+jCe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:Bl.READ_WRITE,this.groupNode=n}get buffer(){return this.nodeUniform.value}}class XCe extends Nu{constructor(e){super(),this.device=e;const n=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,s=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:ud.Linear}),this.flipYSampler=e.createSampler({minFilter:ud.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:n}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:r}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:s})}getTransferPipeline(e){let n=this.transferPipelines[e];return n===void 0&&(n=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Ef.TriangleStrip,stripIndexFormat:Ip.Uint32},layout:"auto"}),this.transferPipelines[e]=n),n}getFlipYPipeline(e){let n=this.flipYPipelines[e];return n===void 0&&(n=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Ef.TriangleStrip,stripIndexFormat:Ip.Uint32},layout:"auto"}),this.flipYPipelines[e]=n),n}flipY(e,n,r=0){const s=n.format,{width:o,height:a}=n.size,l=this.getTransferPipeline(s),c=this.getFlipYPipeline(s),u=this.device.createTexture({size:{width:o,height:a,depthOrArrayLayers:1},format:s,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),d=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:sr.TwoD,baseArrayLayer:r}),h=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:sr.TwoD,baseArrayLayer:0}),f=this.device.createCommandEncoder({}),p=(m,y,v)=>{const g=m.getBindGroupLayout(0),_=this.device.createBindGroup({layout:g,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:y}]}),x=f.beginRenderPass({colorAttachments:[{view:v,loadOp:_n.Clear,storeOp:Xr.Store,clearValue:[0,0,0,0]}]});x.setPipeline(m),x.setBindGroup(0,_),x.draw(4,1,0,0),x.end()};p(l,d,h),p(c,h,d),this.device.queue.submit([f.finish()]),u.destroy()}generateMipmaps(e,n,r=0){const s=this.get(e);s.useCount===void 0&&(s.useCount=0,s.layers=[]);const o=s.layers[r]||this._mipmapCreateBundles(e,n,r),a=this.device.createCommandEncoder({});this._mipmapRunBundles(a,o),this.device.queue.submit([a.finish()]),s.useCount!==0&&(s.layers[r]=o),s.useCount++}_mipmapCreateBundles(e,n,r){const s=this.getTransferPipeline(n.format),o=s.getBindGroupLayout(0);let a=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:sr.TwoD,baseArrayLayer:r});const l=[];for(let c=1;c<n.mipLevelCount;c++){const u=this.device.createBindGroup({layout:o,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:a}]}),d=e.createView({baseMipLevel:c,mipLevelCount:1,dimension:sr.TwoD,baseArrayLayer:r}),h={colorAttachments:[{view:d,loadOp:_n.Clear,storeOp:Xr.Store,clearValue:[0,0,0,0]}]},f=this.device.createRenderBundleEncoder({colorFormats:[n.format]});f.setPipeline(s),f.setBindGroup(0,u),f.draw(4,1,0,0),l.push({renderBundles:[f.finish()],passDescriptor:h}),a=d}return l}_mipmapRunBundles(e,n){const r=n.length;for(let s=0;s<r;s++){const o=n[s],a=e.beginRenderPass(o.passDescriptor);a.executeBundles(o.renderBundles),a.end()}}}const KCe={[WN]:"never",[QS]:"less",[jN]:"equal",[JS]:"less-equal",[qN]:"greater",[KN]:"greater-equal",[YN]:"always",[XN]:"not-equal"},YCe=[0,1,3,2,4,5];class ZCe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new ro,this.depthTexture.name="depthBuffer"}createSampler(e){const n=this.backend,r=n.device,s=n.get(e),o={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};o.magFilter===ud.Linear&&o.minFilter===ud.Linear&&o.mipmapFilter===ud.Linear&&(o.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(o.compare=KCe[e.compareFunction]),s.sampler=r.createSampler(o)}createDefaultTexture(e){let n;const r=_R(e);e.isCubeTexture?n=this._getDefaultCubeTextureGPU(r):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():n=this._getDefaultTextureGPU(r),this.backend.get(e).texture=n}createTexture(e,n={}){const r=this.backend,s=r.get(e);if(s.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");n.needsMipmaps===void 0&&(n.needsMipmaps=!1),n.levels===void 0&&(n.levels=1),n.depth===void 0&&(n.depth=1);const{width:o,height:a,depth:l,levels:c}=n;e.isFramebufferTexture&&(n.renderTarget?n.format=this.backend.utils.getCurrentColorFormat(n.renderTarget):n.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),d=e.internalFormat||n.format||_R(e,r.device);s.format=d;const{samples:h,primarySamples:f,isMSAA:p}=r.utils.getTextureSampleData(e);let m=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(m|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(m|=GPUTextureUsage.RENDER_ATTACHMENT);const y={label:e.name,size:{width:o,height:a,depthOrArrayLayers:l},mipLevelCount:c,sampleCount:f,dimension:u,format:d,usage:m};if(e.isVideoTexture){const v=e.source.data,g=new VideoFrame(v);y.size.width=g.displayWidth,y.size.height=g.displayHeight,g.close(),s.externalTexture=v}else{if(d===void 0){console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}e.isCubeTexture&&(y.textureBindingViewDimension=sr.Cube),s.texture=r.device.createTexture(y)}if(p){const v=Object.assign({},y);v.label=v.label+"-msaa",v.sampleCount=h,s.msaaTexture=r.device.createTexture(v)}s.initialized=!0,s.textureDescriptorGPU=y}destroyTexture(e){const n=this.backend,r=n.get(e);r.texture!==void 0&&r.texture.destroy(),r.msaaTexture!==void 0&&r.msaaTexture.destroy(),n.delete(e)}destroySampler(e){const r=this.backend.get(e);delete r.sampler}generateMipmaps(e){const n=this.backend.get(e);if(e.isCubeTexture)for(let r=0;r<6;r++)this._generateMipmaps(n.texture,n.textureDescriptorGPU,r);else{const r=e.image.depth||1;for(let s=0;s<r;s++)this._generateMipmaps(n.texture,n.textureDescriptorGPU,s)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:n,height:r}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:n,height:r,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,n=!1){const r=this.backend,{width:s,height:o}=r.getDrawingBufferSize(),a=this.depthTexture,l=r.get(a).texture;let c,u;if(n?(c=io,u=to):e&&(c=no,u=Dn),l!==void 0){if(a.image.width===s&&a.image.height===o&&a.format===c&&a.type===u)return l;this.destroyTexture(a)}return a.name="depthBuffer",a.format=c,a.type=u,a.image.width=s,a.image.height=o,this.createTexture(a,{width:s,height:o}),r.get(a).texture}updateTexture(e,n){const r=this.backend.get(e),{textureDescriptorGPU:s}=r;if(!(e.isRenderTargetTexture||s===void 0)){if(e.isDataTexture)this._copyBufferToTexture(n.image,r.texture,s,0,e.flipY);else if(e.isDataArrayTexture||e.isDepthArrayTexture||e.isData3DTexture)for(let o=0;o<n.image.depth;o++)this._copyBufferToTexture(n.image,r.texture,s,o,e.flipY,o);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,r.texture,s);else if(e.isCubeTexture)this._copyCubeMapToTexture(n.images,r.texture,s,e.flipY);else if(e.isVideoTexture){const o=e.source.data;r.externalTexture=o}else this._copyImageToTexture(n.image,r.texture,s,0,e.flipY);r.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,n,r,s,o,a){const l=this.backend.device,c=this.backend.get(e),u=c.texture,d=c.textureDescriptorGPU.format,h=this._getBytesPerTexel(d);let f=s*h;f=Math.ceil(f/256)*256;const p=l.createBuffer({size:s*o*h,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),m=l.createCommandEncoder();m.copyTextureToBuffer({texture:u,origin:{x:n,y:r,z:a}},{buffer:p,bytesPerRow:f},{width:s,height:o});const y=this._getTypedArrayType(d);l.queue.submit([m.finish()]),await p.mapAsync(GPUMapMode.READ);const v=p.getMappedRange();return new y(v)}_isEnvironmentTexture(e){const n=e.mapping;return n===Fd||n===Bd||n===pa||n===ma}_getDefaultTextureGPU(e){let n=this.defaultTexture[e];if(n===void 0){const r=new Ki;r.minFilter=Vn,r.magFilter=Vn,this.createTexture(r,{width:1,height:1,format:e}),this.defaultTexture[e]=n=r}return this.backend.get(n).texture}_getDefaultCubeTextureGPU(e){let n=this.defaultTexture[e];if(n===void 0){const r=new nw;r.minFilter=Vn,r.magFilter=Vn,this.createTexture(r,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=n=r}return this.backend.get(n).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const n={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),n)}return e}_copyCubeMapToTexture(e,n,r,s){for(let o=0;o<6;o++){const a=e[o],l=s===!0?YCe[o]:o;a.isDataTexture?this._copyBufferToTexture(a.image,n,r,l,s):this._copyImageToTexture(a,n,r,l,s)}}_copyImageToTexture(e,n,r,s,o){this.backend.device.queue.copyExternalImageToTexture({source:e,flipY:o},{texture:n,mipLevel:0,origin:{x:0,y:0,z:s}},{width:e.width,height:e.height,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new XCe(this.backend.device)),e}_generateMipmaps(e,n,r=0){this._getPassUtils().generateMipmaps(e,n,r)}_flipY(e,n,r=0){this._getPassUtils().flipY(e,n,r)}_copyBufferToTexture(e,n,r,s,o,a=0){const l=this.backend.device,c=e.data,u=this._getBytesPerTexel(r.format),d=e.width*u;l.queue.writeTexture({texture:n,mipLevel:0,origin:{x:0,y:0,z:s}},c,{offset:e.width*e.height*u*a,bytesPerRow:d},{width:e.width,height:e.height,depthOrArrayLayers:1}),o===!0&&this._flipY(n,r,s)}_copyCompressedBufferToTexture(e,n,r){const s=this.backend.device,o=this._getBlockData(r.format),a=r.size.depthOrArrayLayers>1;for(let l=0;l<e.length;l++){const c=e[l],u=c.width,d=c.height,h=a?r.size.depthOrArrayLayers:1,f=Math.ceil(u/o.width)*o.byteLength,p=f*Math.ceil(d/o.height);for(let m=0;m<h;m++)s.queue.writeTexture({texture:n,mipLevel:l,origin:{x:0,y:0,z:m}},c.data,{offset:m*p,bytesPerRow:f,rowsPerImage:Math.ceil(d/o.height)},{width:Math.ceil(u/o.width)*o.width,height:Math.ceil(d/o.height)*o.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===te.BC1RGBAUnorm||e===te.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===te.BC2RGBAUnorm||e===te.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===te.BC3RGBAUnorm||e===te.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===te.BC4RUnorm||e===te.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===te.BC5RGUnorm||e===te.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===te.BC6HRGBUFloat||e===te.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===te.BC7RGBAUnorm||e===te.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===te.ETC2RGB8Unorm||e===te.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===te.ETC2RGB8A1Unorm||e===te.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===te.ETC2RGBA8Unorm||e===te.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===te.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===te.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===te.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===te.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===te.ASTC4x4Unorm||e===te.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===te.ASTC5x4Unorm||e===te.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===te.ASTC5x5Unorm||e===te.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===te.ASTC6x5Unorm||e===te.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===te.ASTC6x6Unorm||e===te.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===te.ASTC8x5Unorm||e===te.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===te.ASTC8x6Unorm||e===te.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===te.ASTC8x8Unorm||e===te.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===te.ASTC10x5Unorm||e===te.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===te.ASTC10x6Unorm||e===te.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===te.ASTC10x8Unorm||e===te.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===te.ASTC10x10Unorm||e===te.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===te.ASTC12x10Unorm||e===te.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===te.ASTC12x12Unorm||e===te.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let n=jM.ClampToEdge;return e===zd?n=jM.Repeat:e===Vd&&(n=jM.MirrorRepeat),n}_convertFilterMode(e){let n=ud.Linear;return(e===Vn||e===$N||e===Dl)&&(n=ud.Nearest),n}_getBytesPerTexel(e){if(e===te.R8Unorm||e===te.R8Snorm||e===te.R8Uint||e===te.R8Sint)return 1;if(e===te.R16Uint||e===te.R16Sint||e===te.R16Float||e===te.RG8Unorm||e===te.RG8Snorm||e===te.RG8Uint||e===te.RG8Sint)return 2;if(e===te.R32Uint||e===te.R32Sint||e===te.R32Float||e===te.RG16Uint||e===te.RG16Sint||e===te.RG16Float||e===te.RGBA8Unorm||e===te.RGBA8UnormSRGB||e===te.RGBA8Snorm||e===te.RGBA8Uint||e===te.RGBA8Sint||e===te.BGRA8Unorm||e===te.BGRA8UnormSRGB||e===te.RGB9E5UFloat||e===te.RGB10A2Unorm||e===te.RG11B10UFloat||e===te.Depth32Float||e===te.Depth24Plus||e===te.Depth24PlusStencil8||e===te.Depth32FloatStencil8)return 4;if(e===te.RG32Uint||e===te.RG32Sint||e===te.RG32Float||e===te.RGBA16Uint||e===te.RGBA16Sint||e===te.RGBA16Float)return 8;if(e===te.RGBA32Uint||e===te.RGBA32Sint||e===te.RGBA32Float)return 16}_getTypedArrayType(e){if(e===te.R8Uint)return Uint8Array;if(e===te.R8Sint)return Int8Array;if(e===te.R8Unorm)return Uint8Array;if(e===te.R8Snorm)return Int8Array;if(e===te.RG8Uint)return Uint8Array;if(e===te.RG8Sint)return Int8Array;if(e===te.RG8Unorm)return Uint8Array;if(e===te.RG8Snorm)return Int8Array;if(e===te.RGBA8Uint)return Uint8Array;if(e===te.RGBA8Sint)return Int8Array;if(e===te.RGBA8Unorm)return Uint8Array;if(e===te.RGBA8Snorm)return Int8Array;if(e===te.R16Uint)return Uint16Array;if(e===te.R16Sint)return Int16Array;if(e===te.RG16Uint)return Uint16Array;if(e===te.RG16Sint)return Int16Array;if(e===te.RGBA16Uint)return Uint16Array;if(e===te.RGBA16Sint)return Int16Array;if(e===te.R16Float||e===te.RG16Float||e===te.RGBA16Float)return Uint16Array;if(e===te.R32Uint)return Uint32Array;if(e===te.R32Sint)return Int32Array;if(e===te.R32Float)return Float32Array;if(e===te.RG32Uint)return Uint32Array;if(e===te.RG32Sint)return Int32Array;if(e===te.RG32Float)return Float32Array;if(e===te.RGBA32Uint)return Uint32Array;if(e===te.RGBA32Sint)return Int32Array;if(e===te.RGBA32Float)return Float32Array;if(e===te.BGRA8Unorm||e===te.BGRA8UnormSRGB)return Uint8Array;if(e===te.RGB10A2Unorm||e===te.RGB9E5UFloat||e===te.RG11B10UFloat)return Uint32Array;if(e===te.Depth32Float)return Float32Array;if(e===te.Depth24Plus||e===te.Depth24PlusStencil8)return Uint32Array;if(e===te.Depth32FloatStencil8)return Float32Array}_getDimension(e){let n;return e.isData3DTexture?n=qB.ThreeD:n=qB.TwoD,n}}function _R(i,e=null){const n=i.format,r=i.type,s=i.colorSpace;let o;if(i.isCompressedTexture===!0||i.isCompressedArrayTexture===!0)switch(n){case ou:o=s===Et?te.BC1RGBAUnormSRGB:te.BC1RGBAUnorm;break;case au:o=s===Et?te.BC2RGBAUnormSRGB:te.BC2RGBAUnorm;break;case lu:o=s===Et?te.BC3RGBAUnormSRGB:te.BC3RGBAUnorm;break;case hp:o=s===Et?te.ETC2RGB8UnormSRGB:te.ETC2RGB8Unorm;break;case fp:o=s===Et?te.ETC2RGBA8UnormSRGB:te.ETC2RGBA8Unorm;break;case pp:o=s===Et?te.ASTC4x4UnormSRGB:te.ASTC4x4Unorm;break;case mp:o=s===Et?te.ASTC5x4UnormSRGB:te.ASTC5x4Unorm;break;case gp:o=s===Et?te.ASTC5x5UnormSRGB:te.ASTC5x5Unorm;break;case yp:o=s===Et?te.ASTC6x5UnormSRGB:te.ASTC6x5Unorm;break;case vp:o=s===Et?te.ASTC6x6UnormSRGB:te.ASTC6x6Unorm;break;case xp:o=s===Et?te.ASTC8x5UnormSRGB:te.ASTC8x5Unorm;break;case _p:o=s===Et?te.ASTC8x6UnormSRGB:te.ASTC8x6Unorm;break;case bp:o=s===Et?te.ASTC8x8UnormSRGB:te.ASTC8x8Unorm;break;case Sp:o=s===Et?te.ASTC10x5UnormSRGB:te.ASTC10x5Unorm;break;case wp:o=s===Et?te.ASTC10x6UnormSRGB:te.ASTC10x6Unorm;break;case Tp:o=s===Et?te.ASTC10x8UnormSRGB:te.ASTC10x8Unorm;break;case Ep:o=s===Et?te.ASTC10x10UnormSRGB:te.ASTC10x10Unorm;break;case Mp:o=s===Et?te.ASTC12x10UnormSRGB:te.ASTC12x10Unorm;break;case Ap:o=s===Et?te.ASTC12x12UnormSRGB:te.ASTC12x12Unorm;break;case yi:o=s===Et?te.RGBA8UnormSRGB:te.RGBA8Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}else switch(n){case yi:switch(r){case bd:o=te.RGBA8Snorm;break;case Sd:o=te.RGBA16Sint;break;case oa:o=te.RGBA16Uint;break;case Dn:o=te.RGBA32Uint;break;case or:o=te.RGBA32Sint;break;case ci:o=s===Et?te.RGBA8UnormSRGB:te.RGBA8Unorm;break;case lr:o=te.RGBA16Float;break;case wi:o=te.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",r)}break;case U0:switch(r){case ZS:o=te.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",r)}break;case z0:switch(r){case bd:o=te.R8Snorm;break;case Sd:o=te.R16Sint;break;case oa:o=te.R16Uint;break;case Dn:o=te.R32Uint;break;case or:o=te.R32Sint;break;case ci:o=te.R8Unorm;break;case lr:o=te.R16Float;break;case wi:o=te.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",r)}break;case Ol:switch(r){case bd:o=te.RG8Snorm;break;case Sd:o=te.RG16Sint;break;case oa:o=te.RG16Uint;break;case Dn:o=te.RG32Uint;break;case or:o=te.RG32Sint;break;case ci:o=te.RG8Unorm;break;case lr:o=te.RG16Float;break;case wi:o=te.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",r)}break;case no:switch(r){case oa:o=te.Depth16Unorm;break;case Dn:o=te.Depth24Plus;break;case wi:o=te.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",r)}break;case io:switch(r){case to:o=te.Depth24PlusStencil8;break;case wi:e&&e.features.has(xR.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),o=te.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",r)}break;case nm:switch(r){case or:o=te.R32Sint;break;case Dn:o=te.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",r)}break;case im:switch(r){case or:o=te.RG32Sint;break;case Dn:o=te.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",r)}break;case rm:switch(r){case or:o=te.RGBA32Sint;break;case Dn:o=te.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",r)}break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}return o}const QCe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,JCe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,XB={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},eRe=i=>{i=i.trim();const e=i.match(QCe);if(e!==null&&e.length===4){const n=e[2],r=[];let s=null;for(;(s=JCe.exec(n))!==null;)r.push({name:s[1],type:s[2]});const o=[];for(let d=0;d<r.length;d++){const{name:h,type:f}=r[d];let p=f;p.startsWith("ptr")?p="pointer":(p.startsWith("texture")&&(p=f.split("<")[0]),p=XB[p]),o.push(new ek(p,h))}const a=i.substring(e[0].length),l=e[3]||"void",c=e[1]!==void 0?e[1]:"";return{type:XB[l]||l,inputs:o,name:c,inputsCode:n,blockCode:a,outputType:l}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class tRe extends tk{constructor(e){const{type:n,inputs:r,name:s,inputsCode:o,blockCode:a,outputType:l}=eRe(e);super(n,r,s),this.inputsCode=o,this.blockCode=a,this.outputType=l}getCode(e=this.name){const n=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${n}`+this.blockCode}}class nRe extends u6{parseFunction(e){return new tRe(e)}}const Xh=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},iRe={[Bl.READ_ONLY]:"read",[Bl.WRITE_ONLY]:"write",[Bl.READ_WRITE]:"read_write"},KB={[zd]:"repeat",[Ua]:"clamp",[Vd]:"mirror"},n_={vertex:Xh?Xh.VERTEX:1,fragment:Xh?Xh.FRAGMENT:2,compute:Xh?Xh.COMPUTE:4},YB={instance:!0,swizzleAssign:!1,storageBuffer:!0},rRe={"^^":"tsl_xor"},sRe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},ZB={},vo={tsl_xor:new Wi("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new Wi("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new Wi("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new Wi("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new Wi("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new Wi("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new Wi("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new Wi("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new Wi("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new Wi("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new Wi("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new Wi("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new Wi(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},Rg={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};typeof navigator<"u"&&/Windows/g.test(navigator.userAgent)&&(vo.pow_float=new Wi("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),vo.pow_vec2=new Wi("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[vo.pow_float]),vo.pow_vec3=new Wi("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[vo.pow_float]),vo.pow_vec4=new Wi("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[vo.pow_float]),Rg.pow_float="tsl_pow_float",Rg.pow_vec2="tsl_pow_vec2",Rg.pow_vec3="tsl_pow_vec3",Rg.pow_vec4="tsl_pow_vec4");let _6="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(_6+=`diagnostic( off, derivative_uniformity );
`);class oRe extends l6{constructor(e,n){super(e,n,new nRe),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==qs}_generateTextureSample(e,n,r,s,o=this.shaderStage){return o==="fragment"?s?`textureSample( ${n}, ${n}_sampler, ${r}, ${s} )`:`textureSample( ${n}, ${n}_sampler, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,n,r):this.generateTextureLod(e,n,r,s,"0")}_generateVideoSample(e,n,r=this.shaderStage){if(r==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${n}.x, 1.0 - ${n}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${r} shader.`)}_generateTextureSampleLevel(e,n,r,s,o,a=this.shaderStage){return(a==="fragment"||a==="compute")&&this.isUnfilterable(e)===!1?`textureSampleLevel( ${n}, ${n}_sampler, ${r}, ${s} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,n,r,s):this.generateTextureLod(e,n,r,o,s)}generateWrapFunction(e){const n=`tsl_coord_${KB[e.wrapS]}S_${KB[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let r=ZB[n];if(r===void 0){const s=[],o=e.isData3DTexture?"vec3f":"vec2f";let a=`fn ${n}( coord : ${o} ) -> ${o} {

	return ${o}(
`;const l=(c,u)=>{c===zd?(s.push(vo.repeatWrapping_float),a+=`		tsl_repeatWrapping_float( coord.${u} )`):c===Ua?(s.push(vo.clampWrapping_float),a+=`		tsl_clampWrapping_float( coord.${u} )`):c===Vd?(s.push(vo.mirrorWrapping_float),a+=`		tsl_mirrorWrapping_float( coord.${u} )`):(a+=`		coord.${u}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${c}" for vertex shader.`))};l(e.wrapS,"x"),a+=`,
`,l(e.wrapT,"y"),e.isData3DTexture&&(a+=`,
`,l(e.wrapR,"z")),a+=`
	);

}
`,ZB[n]=r=new Wi(a,s)}return r.build(this),n}generateArrayDeclaration(e,n){return`array< ${this.getType(e)}, ${n} >`}generateTextureDimension(e,n,r){const s=this.getDataFromNode(e,this.shaderStage,this.globalCache);s.dimensionsSnippet===void 0&&(s.dimensionsSnippet={});let o=s.dimensionsSnippet[r];if(s.dimensionsSnippet[r]===void 0){let a,l;const{primarySamples:c}=this.renderer.backend.utils.getTextureSampleData(e),u=c>1;e.isData3DTexture?l="vec3<u32>":l="vec2<u32>",u||e.isVideoTexture||e.isStorageTexture?a=n:a=`${n}${r?`, u32( ${r} )`:""}`,o=new X_(new Y_(`textureDimensions( ${a} )`,l)),s.dimensionsSnippet[r]=o,(e.isDataArrayTexture||e.isDepthArrayTexture||e.isData3DTexture)&&(s.arrayLayerCount=new X_(new Y_(`textureNumLayers(${n})`,"u32"))),e.isTextureCube&&(s.cubeFaceCount=new X_(new Y_("6u","u32")))}return o.build(this)}generateFilteredTexture(e,n,r,s="0u"){this._include("biquadraticTexture");const o=this.generateWrapFunction(e),a=this.generateTextureDimension(e,n,s);return`tsl_biquadraticTexture( ${n}, ${o}( ${r} ), ${a}, u32( ${s} ) )`}generateTextureLod(e,n,r,s,o="0u"){const a=this.generateWrapFunction(e),l=this.generateTextureDimension(e,n,o),c=e.isData3DTexture?"vec3":"vec2",u=`${c}<u32>( ${a}( ${r} ) * ${c}<f32>( ${l} ) )`;return this.generateTextureLoad(e,n,u,s,o)}generateTextureLoad(e,n,r,s,o="0u"){let a;return e.isVideoTexture===!0||e.isStorageTexture===!0?a=`textureLoad( ${n}, ${r} )`:s?a=`textureLoad( ${n}, ${r}, ${s}, u32( ${o} ) )`:(a=`textureLoad( ${n}, ${r}, u32( ${o} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(a+=".x")),a}generateTextureStore(e,n,r,s){return`textureStore( ${n}, ${r}, ${s} )`}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===wi||this.isSampleCompare(e)===!1&&e.minFilter===Vn&&e.magFilter===Vn||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,n,r,s,o=this.shaderStage){let a=null;return e.isVideoTexture===!0?a=this._generateVideoSample(n,r,o):this.isUnfilterable(e)?a=this.generateTextureLod(e,n,r,s,"0",o):a=this._generateTextureSample(e,n,r,s,o),a}generateTextureGrad(e,n,r,s,o,a=this.shaderStage){if(a==="fragment")return`textureSampleGrad( ${n}, ${n}_sampler, ${r},  ${s[0]}, ${s[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${a} shader.`)}generateTextureCompare(e,n,r,s,o,a=this.shaderStage){if(a==="fragment")return e.isDepthArrayTexture?`textureSampleCompare( ${n}, ${n}_sampler, ${r}, ${o}, ${s} )`:`textureSampleCompare( ${n}, ${n}_sampler, ${r}, ${s} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}generateTextureLevel(e,n,r,s,o,a=this.shaderStage){let l=null;return e.isVideoTexture===!0?l=this._generateVideoSample(n,r,a):l=this._generateTextureSampleLevel(e,n,r,s,o,a),l}generateTextureBias(e,n,r,s,o,a=this.shaderStage){if(a==="fragment")return`textureSampleBias( ${n}, ${n}_sampler, ${r}, ${s} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${a} shader.`)}getPropertyName(e,n=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(n==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const r=e.name,s=e.type;return s==="texture"||s==="cubeTexture"||s==="storageTexture"||s==="texture3D"?r:s==="buffer"||s==="storageBuffer"||s==="indirectStorageBuffer"?this.isCustomStruct(e)?r:r+".value":e.groupNode.name+"."+r}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const n=rRe[e];return n!==void 0?(this._include(n),n):null}getNodeAccess(e,n){return n!=="compute"?Bl.READ_ONLY:e.access}getStorageAccess(e,n){return iRe[this.getNodeAccess(e,n)]}getUniformFromNode(e,n,r,s=null){const o=super.getUniformFromNode(e,n,r,s),a=this.getDataFromNode(e,r,this.globalCache);if(a.uniformGPU===void 0){let l;const c=e.groupNode,u=c.name,d=this.getBindGroupArray(u,r);if(n==="texture"||n==="cubeTexture"||n==="storageTexture"||n==="texture3D"){let h=null;const f=this.getNodeAccess(e,r);if(n==="texture"||n==="storageTexture"?h=new Mw(o.name,o.node,c,f):n==="cubeTexture"?h=new g6(o.name,o.node,c,f):n==="texture3D"&&(h=new y6(o.name,o.node,c,f)),h.store=e.isStorageTextureNode===!0,h.setVisibility(n_[r]),(r==="fragment"||r==="compute")&&this.isUnfilterable(e.value)===!1&&h.store===!1){const p=new HCe(`${o.name}_sampler`,o.node,c);p.setVisibility(n_[r]),d.push(p,h),l=[p,h]}else d.push(h),l=[h]}else if(n==="buffer"||n==="storageBuffer"||n==="indirectStorageBuffer"){const h=n==="buffer"?p6:qCe,f=new h(e,c);f.setVisibility(n_[r]),d.push(f),l=f,o.name=s||"NodeBuffer_"+o.id}else{const h=this.uniformGroups[r]||(this.uniformGroups[r]={});let f=h[u];f===void 0&&(f=new m6(u,c),f.setVisibility(n_[r]),h[u]=f,d.push(f)),l=this.getNodeUniform(o,n),f.addUniform(l)}a.uniformGPU=l}return o}getBuiltin(e,n,r,s=this.shaderStage){const o=this.builtins[s]||(this.builtins[s]=new Map);return o.has(e)===!1&&o.set(e,{name:e,property:n,type:r}),n}hasBuiltin(e,n=this.shaderStage){return this.builtins[n]!==void 0&&this.builtins[n].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const n=e.layout,r=this.flowShaderNode(e),s=[];for(const a of n.inputs)s.push(a.name+" : "+this.getType(a.type));let o=`fn ${n.name}( ${s.join(", ")} ) -> ${this.getType(n.type)} {
${r.vars}
${r.code}
`;return r.result&&(o+=`	return ${r.result};
`),o+=`
}
`,o}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,n=this.shaderStage){(this.directives[n]||(this.directives[n]=new Set)).add(e)}getDirectives(e){const n=[],r=this.directives[e];if(r!==void 0)for(const s of r)n.push(`enable ${s};`);return n.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const n=[],r=this.builtins[e];if(r!==void 0)for(const{name:s,property:o,type:a}of r.values())n.push(`@builtin( ${s} ) ${o} : ${a}`);return n.join(`,
	`)}getScopedArray(e,n,r,s){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:n,bufferType:r,bufferCount:s}),e}getScopedArrays(e){if(e!=="compute")return;const n=[];for(const{name:r,scope:s,bufferType:o,bufferCount:a}of this.scopedArrays.values()){const l=this.getType(o);n.push(`var<${s}> ${r}: array< ${l}, ${a} >;`)}return n.join(`
`)}getAttributes(e){const n=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const r=this.getBuiltins("attribute");r&&n.push(r);const s=this.getAttributesArray();for(let o=0,a=s.length;o<a;o++){const l=s[o],c=l.name,u=this.getType(l.type);n.push(`@location( ${o} ) ${c} : ${u}`)}}return n.join(`,
	`)}getStructMembers(e){const n=[];for(const r of e.members){const s=e.output?"@location( "+r.index+" ) ":"";let o=this.getType(r.type);r.atomic&&(o="atomic< "+o+" >"),n.push(`	${s+r.name} : ${o}`)}return e.output&&n.push(`	${this.getBuiltins("output")}`),n.join(`,
`)}getStructs(e){let n="";const r=this.structs[e];if(r.length>0){const s=[];for(const o of r){let a=`struct ${o.name} {
`;a+=this.getStructMembers(o),a+=`
};`,s.push(a)}n=`
`+s.join(`

`)+`
`}return n}getVar(e,n,r=null){let s=`var ${n} : `;return r!==null?s+=this.generateArrayDeclaration(e,r):s+=this.getType(e),s}getVars(e){const n=[],r=this.vars[e];if(r!==void 0)for(const s of r)n.push(`	${this.getVar(s.type,s.name,s.count)};`);return`
${n.join(`
`)}
`}getVaryings(e){const n=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const o=this.varyings,a=this.vars[e];for(let l=0;l<o.length;l++){const c=o[l];if(c.needsInterpolation){let u=`@location( ${l} )`;if(c.interpolationType){const d=c.interpolationSampling!==null?`, ${c.interpolationSampling} )`:" )";u+=` @interpolate( ${c.interpolationType}${d}`}else/^(int|uint|ivec|uvec)/.test(c.type)&&(u+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);n.push(`${u} ${c.name} : ${this.getType(c.type)}`)}else e==="vertex"&&a.includes(c)===!1&&a.push(c)}}const r=this.getBuiltins(e);r&&n.push(r);const s=n.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+s):s}isCustomStruct(e){const n=e.value,r=e.node,s=(n.isBufferAttribute||n.isInstancedBufferAttribute)&&r.structTypeNode!==null,o=r.value&&r.value.array&&typeof r.value.itemSize=="number"&&r.value.array.length>r.value.itemSize;return s&&!o}getUniforms(e){const n=this.uniforms[e],r=[],s=[],o=[],a={};for(const c of n){const u=c.groupNode.name,d=this.bindingsIndexes[u];if(c.type==="texture"||c.type==="cubeTexture"||c.type==="storageTexture"||c.type==="texture3D"){const h=c.node.value;(e==="fragment"||e==="compute")&&this.isUnfilterable(h)===!1&&c.node.isStorageTextureNode!==!0&&(this.isSampleCompare(h)?r.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var ${c.name}_sampler : sampler_comparison;`):r.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var ${c.name}_sampler : sampler;`));let f,p="";const{primarySamples:m}=this.renderer.backend.utils.getTextureSampleData(h);if(m>1&&(p="_multisampled"),h.isCubeTexture===!0)f="texture_cube<f32>";else if(h.isDataArrayTexture===!0||h.isCompressedArrayTexture===!0||h.isTextureArray===!0)f="texture_2d_array<f32>";else if(h.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&h.compareFunction===null?f=`texture${p}_2d<f32>`:f=`texture_depth${p}_2d${h.isDepthArrayTexture===!0?"_array":""}`;else if(h.isVideoTexture===!0)f="texture_external";else if(h.isData3DTexture===!0)f="texture_3d<f32>";else if(c.node.isStorageTextureNode===!0){const y=_R(h),v=this.getStorageAccess(c.node,e);f=`texture_storage_2d<${y}, ${v}>`}else{const y=this.getComponentTypeFromTexture(h).charAt(0);f=`texture${p}_2d<${y}32>`}r.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var ${c.name} : ${f};`)}else if(c.type==="buffer"||c.type==="storageBuffer"||c.type==="indirectStorageBuffer"){const h=c.node,f=this.getType(h.getNodeType(this)),p=h.bufferCount,m=p>0&&c.type==="buffer"?", "+p:"",y=h.isStorageBufferNode?`storage, ${this.getStorageAccess(h,e)}`:"uniform";if(this.isCustomStruct(c))s.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var<${y}> ${c.name} : ${f};`);else{const g=`	value : array< ${h.isAtomic?`atomic<${f}>`:`${f}`}${m} >`;s.push(this._getWGSLStructBinding(c.name,g,y,d.binding++,d.group))}}else{const h=this.getType(this.getVectorType(c.type)),f=c.groupNode.name;(a[f]||(a[f]={index:d.binding++,id:d.group,snippets:[]})).snippets.push(`	${c.name} : ${h}`)}}for(const c in a){const u=a[c];o.push(this._getWGSLStructBinding(c,u.snippets.join(`,
`),"uniform",u.index,u.id))}let l=r.join(`
`);return l+=s.join(`
`),l+=o.join(`
`),l}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const n in e){this.shaderStage=n;const r=e[n];r.uniforms=this.getUniforms(n),r.attributes=this.getAttributes(n),r.varyings=this.getVaryings(n),r.structs=this.getStructs(n),r.vars=this.getVars(n),r.codes=this.getCodes(n),r.directives=this.getDirectives(n),r.scopedArrays=this.getScopedArrays(n);let s=`// code

`;s+=this.flowCode[n];const o=this.flowNodes[n],a=o[o.length-1],l=a.outputNode,c=l!==void 0&&l.isOutputStructNode===!0;for(const u of o){const d=this.getFlowData(u),h=u.name;if(h&&(s.length>0&&(s+=`
`),s+=`	// flow -> ${h}
`),s+=`${d.code}
	`,u===a&&n!=="compute"){if(s+=`// result

	`,n==="vertex")s+=`varyings.Vertex = ${d.result};`;else if(n==="fragment")if(c)r.returnType=l.getNodeType(this),r.structs+="var<private> output : "+r.returnType+";",s+=`return ${d.result};`;else{let f="	@location(0) color: vec4<f32>";const p=this.getBuiltins("output");p&&(f+=`,
	`+p),r.returnType="OutputStruct",r.structs+=this._getWGSLStruct("OutputStruct",f),r.structs+=`
var<private> output : OutputStruct;`,s+=`output.color = ${d.result};

	return output;`}}}r.flow=s}this.shaderStage=null,this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,n=null){let r;return n!==null&&(r=this._getWGSLMethod(e+"_"+n)),r===void 0&&(r=this._getWGSLMethod(e)),r||e}getType(e){return sRe[e]||e}isAvailable(e){let n=YB[e];return n===void 0&&(e==="float32Filterable"?n=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(n=this.renderer.hasFeature("clip-distances")),YB[e]=n),n}_getWGSLMethod(e){return vo[e]!==void 0&&this._include(e),Rg[e]}_include(e){const n=vo[e];return n.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(n),n}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${_6}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,n){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${n} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x + globalId.y * numWorkgroups.x * u32(${n}) + globalId.z * numWorkgroups.x * numWorkgroups.y * u32(${n});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,n){return`
struct ${e} {
${n}
};`}_getWGSLStructBinding(e,n,r,s=0,o=0){const a=e+"Struct";return`${this._getWGSLStruct(a,n)}
@binding( ${s} ) @group( ${o} )
var<${r}> ${e} : ${a};`}}class aRe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let n;return e.depthTexture!==null?n=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?n=te.Depth24PlusStencil8:e.depth&&(n=te.Depth24Plus),n}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let n;if(e.isFramebufferTexture)n=1;else if(e.isDepthTexture&&!e.renderTarget){const o=this.backend.renderer,a=o.getRenderTarget();n=a?a.samples:o.samples}else e.renderTarget&&(n=e.renderTarget.samples);n=n||1;const r=n>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:n,primarySamples:r?1:n,isMSAA:r}}getCurrentColorFormat(e){let n;return e.textures!==null?n=this.getTextureFormatGPU(e.textures[0]):n=this.getPreferredCanvasFormat(),n}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,n){if(e.isPoints)return Ef.PointList;if(e.isLineSegments||e.isMesh&&n.wireframe===!0)return Ef.LineList;if(e.isLine)return Ef.LineStrip;if(e.isMesh)return Ef.TriangleList}getSampleCount(e){let n=1;return e>1&&(n=Math.pow(2,Math.floor(Math.log2(e))),n===2&&(n=4)),n}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(e===void 0)return navigator.gpu.getPreferredCanvasFormat();if(e===ci)return te.BGRA8Unorm;if(e===lr)return te.RGBA16Float;throw new Error("Unsupported outputType")}}const lRe=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),cRe=new Map([[J$,["float16"]]]),uRe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class dRe{constructor(e){this.backend=e}createAttribute(e,n){const r=this._getBufferAttribute(e),s=this.backend,o=s.get(r);let a=o.buffer;if(a===void 0){const l=s.device;let c=r.array;if(e.normalized===!1){if(c.constructor===Int16Array||c.constructor===Int8Array)c=new Int32Array(c);else if((c.constructor===Uint16Array||c.constructor===Uint8Array)&&(c=new Uint32Array(c),n&GPUBufferUsage.INDEX))for(let d=0;d<c.length;d++)c[d]===65535&&(c[d]=4294967295)}if(r.array=c,(r.isStorageBufferAttribute||r.isStorageInstancedBufferAttribute)&&r.itemSize===3){c=new c.constructor(r.count*4);for(let d=0;d<r.count;d++)c.set(r.array.subarray(d*3,d*3+3),d*4);r.itemSize=4,r.array=c,o._force3to4BytesAlignment=!0}const u=c.byteLength+(4-c.byteLength%4)%4;a=l.createBuffer({label:r.name,size:u,usage:n,mappedAtCreation:!0}),new c.constructor(a.getMappedRange()).set(c),a.unmap(),o.buffer=a}}updateAttribute(e){const n=this._getBufferAttribute(e),r=this.backend,s=r.device,o=r.get(n),a=r.get(n).buffer;let l=n.array;if(o._force3to4BytesAlignment===!0){l=new l.constructor(n.count*4);for(let d=0;d<n.count;d++)l.set(n.array.subarray(d*3,d*3+3),d*4);n.array=l}const c=this._isTypedArray(l),u=n.updateRanges;if(u.length===0)s.queue.writeBuffer(a,0,l,0);else{const d=c?1:l.BYTES_PER_ELEMENT;for(let h=0,f=u.length;h<f;h++){const p=u[h];let m,y;if(o._force3to4BytesAlignment===!0){const g=Math.floor(p.start/3),_=Math.ceil(p.count/3);m=g*4*d,y=_*4*d}else m=p.start*d,y=p.count*d;const v=m*(c?l.BYTES_PER_ELEMENT:1);s.queue.writeBuffer(a,v,l,m,y)}n.clearUpdateRanges()}}createShaderVertexBuffers(e){const n=e.getAttributes(),r=new Map;for(let s=0;s<n.length;s++){const o=n[s],a=o.array.BYTES_PER_ELEMENT,l=this._getBufferAttribute(o);let c=r.get(l);if(c===void 0){let h,f;o.isInterleavedBufferAttribute===!0?(h=o.data.stride*a,f=o.data.isInstancedInterleavedBuffer?t_.Instance:t_.Vertex):(h=o.itemSize*a,f=o.isInstancedBufferAttribute?t_.Instance:t_.Vertex),o.normalized===!1&&(o.array.constructor===Int16Array||o.array.constructor===Uint16Array)&&(h=4),c={arrayStride:h,attributes:[],stepMode:f},r.set(l,c)}const u=this._getVertexFormat(o),d=o.isInterleavedBufferAttribute===!0?o.offset*a:0;c.attributes.push({shaderLocation:s,offset:d,format:u})}return Array.from(r.values())}destroyAttribute(e){const n=this.backend;n.get(this._getBufferAttribute(e)).buffer.destroy(),n.delete(e)}async getArrayBufferAsync(e){const n=this.backend,r=n.device,o=n.get(this._getBufferAttribute(e)).buffer,a=o.size,l=r.createBuffer({label:`${e.name}_readback`,size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),c=r.createCommandEncoder({label:`readback_encoder_${e.name}`});c.copyBufferToBuffer(o,0,l,0,a);const u=c.finish();r.queue.submit([u]),await l.mapAsync(GPUMapMode.READ);const d=l.getMappedRange(),h=new e.array.constructor(d.slice(0));return l.unmap(),h.buffer}_getVertexFormat(e){const{itemSize:n,normalized:r}=e,s=e.array.constructor,o=e.constructor;let a;if(n===1)a=uRe.get(s);else{const c=(cRe.get(o)||lRe.get(s))[r?1:0];if(c){const u=s.BYTES_PER_ELEMENT*n,h=Math.floor((u+3)/4)*4/s.BYTES_PER_ELEMENT;if(h%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");a=`${c}x${h}`}}return a||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),a}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class hRe{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const n=this.backend,r=n.device,s=[];let o=0;for(const a of e.bindings){const l={binding:o++,visibility:a.visibility};if(a.isUniformBuffer||a.isStorageBuffer){const c={};a.isStorageBuffer&&(a.visibility&4&&(a.access===Bl.READ_WRITE||a.access===Bl.WRITE_ONLY)?c.type=qM.Storage:c.type=qM.ReadOnlyStorage),l.buffer=c}else if(a.isSampler){const c={};a.texture.isDepthTexture&&(a.texture.compareFunction!==null?c.type=jB.Comparison:n.compatibilityMode&&(c.type=jB.NonFiltering)),l.sampler=c}else if(a.isSampledTexture&&a.texture.isVideoTexture)l.externalTexture={};else if(a.isSampledTexture&&a.store){const c={};c.format=this.backend.get(a.texture).texture.format;const u=a.access;u===Bl.READ_WRITE?c.access=XM.ReadWrite:u===Bl.WRITE_ONLY?c.access=XM.WriteOnly:c.access=XM.ReadOnly,l.storageTexture=c}else if(a.isSampledTexture){const c={},{primarySamples:u}=n.utils.getTextureSampleData(a.texture);if(u>1&&(c.multisampled=!0,a.texture.isDepthTexture||(c.sampleType=qu.UnfilterableFloat)),a.texture.isDepthTexture)n.compatibilityMode&&a.texture.compareFunction===null?c.sampleType=qu.UnfilterableFloat:c.sampleType=qu.Depth;else if(a.texture.isDataTexture||a.texture.isDataArrayTexture||a.texture.isData3DTexture){const d=a.texture.type;d===or?c.sampleType=qu.SInt:d===Dn?c.sampleType=qu.UInt:d===wi&&(this.backend.hasFeature("float32-filterable")?c.sampleType=qu.Float:c.sampleType=qu.UnfilterableFloat)}a.isSampledCubeTexture?c.viewDimension=sr.Cube:a.texture.isDataArrayTexture||a.texture.isDepthArrayTexture||a.texture.isCompressedArrayTexture?c.viewDimension=sr.TwoDArray:a.isSampledTexture3D&&(c.viewDimension=sr.ThreeD),l.texture=c}else console.error(`WebGPUBindingUtils: Unsupported binding "${a}".`);s.push(l)}return r.createBindGroupLayout({entries:s})}createBindings(e,n,r,s=0){const{backend:o,bindGroupLayoutCache:a}=this,l=o.get(e);let c=a.get(e.bindingsReference);c===void 0&&(c=this.createBindingsLayout(e),a.set(e.bindingsReference,c));let u;r>0&&(l.groups===void 0&&(l.groups=[],l.versions=[]),l.versions[r]===s&&(u=l.groups[r])),u===void 0&&(u=this.createBindGroup(e,c),r>0&&(l.groups[r]=u,l.versions[r]=s)),l.group=u,l.layout=c}updateBinding(e){const n=this.backend,r=n.device,s=e.buffer,o=n.get(e).buffer;r.queue.writeBuffer(o,0,s,0)}createBindGroupIndex(e,n){const s=this.backend.device,o=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a=e[0],l=s.createBuffer({label:"bindingCameraIndex_"+a,size:16,usage:o});s.queue.writeBuffer(l,0,e,0);const c=[{binding:0,resource:{buffer:l}}];return s.createBindGroup({label:"bindGroupCameraIndex_"+a,layout:n,entries:c})}createBindGroup(e,n){const r=this.backend,s=r.device;let o=0;const a=[];for(const l of e.bindings){if(l.isUniformBuffer){const c=r.get(l);if(c.buffer===void 0){const u=l.byteLength,d=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,h=s.createBuffer({label:"bindingBuffer_"+l.name,size:u,usage:d});c.buffer=h}a.push({binding:o,resource:{buffer:c.buffer}})}else if(l.isStorageBuffer){const c=r.get(l);if(c.buffer===void 0){const u=l.attribute;c.buffer=r.get(u).buffer}a.push({binding:o,resource:{buffer:c.buffer}})}else if(l.isSampler){const c=r.get(l.texture);a.push({binding:o,resource:c.sampler})}else if(l.isSampledTexture){const c=r.get(l.texture);let u;if(c.externalTexture!==void 0)u=s.importExternalTexture({source:c.externalTexture});else{const d=l.store?1:c.texture.mipLevelCount,h=`view-${c.texture.width}-${c.texture.height}-${d}`;if(u=c[h],u===void 0){const f=$Ce.All;let p;l.isSampledCubeTexture?p=sr.Cube:l.isSampledTexture3D?p=sr.ThreeD:l.texture.isDataArrayTexture||l.texture.isDepthArrayTexture||l.texture.isCompressedArrayTexture?p=sr.TwoDArray:p=sr.TwoD,u=c[h]=c.texture.createView({aspect:f,dimension:p,mipLevelCount:d})}}a.push({binding:o,resource:u})}o++}return s.createBindGroup({label:"bindGroup_"+e.name,layout:n,entries:a})}}class fRe{constructor(e){this.backend=e}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,n){const{object:r,material:s,geometry:o,pipeline:a}=e,{vertexProgram:l,fragmentProgram:c}=a,u=this.backend,d=u.device,h=u.utils,f=u.get(a),p=[];for(const B of e.getBindings()){const C=u.get(B);p.push(C.layout)}const m=u.attributeUtils.createShaderVertexBuffers(e);let y;s.blending!==Rs&&(s.blending!==eo||s.transparent!==!1)&&(y=this._getBlending(s));let v={};s.stencilWrite===!0&&(v={compare:this._getStencilCompare(s),failOp:this._getStencilOperation(s.stencilFail),depthFailOp:this._getStencilOperation(s.stencilZFail),passOp:this._getStencilOperation(s.stencilZPass)});const g=this._getColorWriteMask(s),_=[];if(e.context.textures!==null){const B=e.context.textures;for(let C=0;C<B.length;C++){const L=h.getTextureFormatGPU(B[C]);_.push({format:L,blend:y,writeMask:g})}}else{const B=h.getCurrentColorFormat(e.context);_.push({format:B,blend:y,writeMask:g})}const x=u.get(l).module,b=u.get(c).module,S=this._getPrimitiveState(r,o,s),T=this._getDepthCompare(s),w=h.getCurrentDepthStencilFormat(e.context),E=this._getSampleCount(e.context),A={label:`renderPipeline_${s.name||s.type}_${s.id}`,vertex:Object.assign({},x,{buffers:m}),fragment:Object.assign({},b,{targets:_}),primitive:S,multisample:{count:E,alphaToCoverageEnabled:s.alphaToCoverage&&E>1},layout:d.createPipelineLayout({bindGroupLayouts:p})},M={},R=e.context.depth,F=e.context.stencil;if((R===!0||F===!0)&&(R===!0&&(M.format=w,M.depthWriteEnabled=s.depthWrite,M.depthCompare=T),F===!0&&(M.stencilFront=v,M.stencilBack={},M.stencilReadMask=s.stencilFuncMask,M.stencilWriteMask=s.stencilWriteMask),s.polygonOffset===!0&&(M.depthBias=s.polygonOffsetUnits,M.depthBiasSlopeScale=s.polygonOffsetFactor,M.depthBiasClamp=0),A.depthStencil=M),n===null)f.pipeline=d.createRenderPipeline(A);else{const B=new Promise(C=>{d.createRenderPipelineAsync(A).then(L=>{f.pipeline=L,C()})});n.push(B)}}createBundleEncoder(e,n="renderBundleEncoder"){const r=this.backend,{utils:s,device:o}=r,a=s.getCurrentDepthStencilFormat(e),l=s.getCurrentColorFormat(e),c=this._getSampleCount(e),u={label:n,colorFormats:[l],depthStencilFormat:a,sampleCount:c};return o.createRenderBundleEncoder(u)}createComputePipeline(e,n){const r=this.backend,s=r.device,o=r.get(e.computeProgram).module,a=r.get(e),l=[];for(const c of n){const u=r.get(c);l.push(u.layout)}a.pipeline=s.createComputePipeline({compute:o,layout:s.createPipelineLayout({bindGroupLayouts:l})})}_getBlending(e){let n,r;const s=e.blending,o=e.blendSrc,a=e.blendDst,l=e.blendEquation;if(s===Vf){const c=e.blendSrcAlpha!==null?e.blendSrcAlpha:o,u=e.blendDstAlpha!==null?e.blendDstAlpha:a,d=e.blendEquationAlpha!==null?e.blendEquationAlpha:l;n={srcFactor:this._getBlendFactor(o),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(l)},r={srcFactor:this._getBlendFactor(c),dstFactor:this._getBlendFactor(u),operation:this._getBlendOperation(d)}}else{const c=e.premultipliedAlpha,u=(d,h,f,p)=>{n={srcFactor:d,dstFactor:h,operation:ju.Add},r={srcFactor:f,dstFactor:p,operation:ju.Add}};if(c)switch(s){case eo:u($t.One,$t.OneMinusSrcAlpha,$t.One,$t.OneMinusSrcAlpha);break;case cp:u($t.One,$t.One,$t.One,$t.One);break;case up:u($t.Zero,$t.OneMinusSrc,$t.Zero,$t.One);break;case dp:u($t.Zero,$t.Src,$t.Zero,$t.SrcAlpha);break}else switch(s){case eo:u($t.SrcAlpha,$t.OneMinusSrcAlpha,$t.One,$t.OneMinusSrcAlpha);break;case cp:u($t.SrcAlpha,$t.One,$t.SrcAlpha,$t.One);break;case up:u($t.Zero,$t.OneMinusSrc,$t.Zero,$t.One);break;case dp:u($t.Zero,$t.Src,$t.Zero,$t.Src);break}}if(n!==void 0&&r!==void 0)return{color:n,alpha:r};console.error("THREE.WebGPURenderer: Invalid blending: ",s)}_getBlendFactor(e){let n;switch(e){case Tl:n=$t.Zero;break;case LN:n=$t.One;break;case IN:n=$t.Src;break;case DN:n=$t.OneMinusSrc;break;case zy:n=$t.SrcAlpha;break;case Vy:n=$t.OneMinusSrcAlpha;break;case BN:n=$t.Dst;break;case UN:n=$t.OneMinusDstColor;break;case ON:n=$t.DstAlpha;break;case FN:n=$t.OneMinusDstAlpha;break;case zN:n=$t.SrcAlphaSaturated;break;case eMe:n=$t.Constant;break;case tMe:n=$t.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return n}_getStencilCompare(e){let n;const r=e.stencilFunc;switch(r){case vue:n=mr.Never;break;case BC:n=mr.Always;break;case xue:n=mr.Less;break;case bue:n=mr.LessEqual;break;case _ue:n=mr.Equal;break;case Tue:n=mr.GreaterEqual;break;case Sue:n=mr.Greater;break;case wue:n=mr.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",r)}return n}_getStencilOperation(e){let n;switch(e){case td:n=Dc.Keep;break;case due:n=Dc.Zero;break;case hue:n=Dc.Replace;break;case yue:n=Dc.Invert;break;case fue:n=Dc.IncrementClamp;break;case pue:n=Dc.DecrementClamp;break;case mue:n=Dc.IncrementWrap;break;case gue:n=Dc.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",n)}return n}_getBlendOperation(e){let n;switch(e){case Ur:n=ju.Add;break;case NN:n=ju.Subtract;break;case kN:n=ju.ReverseSubtract;break;case z$:n=ju.Min;break;case V$:n=ju.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return n}_getPrimitiveState(e,n,r){const s={},o=this.backend.utils;switch(s.topology=o.getPrimitiveTopology(e,r),n.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(s.stripIndexFormat=n.index.array instanceof Uint16Array?Ip.Uint16:Ip.Uint32),r.side){case Cs:s.frontFace=HM.CCW,s.cullMode=WM.Back;break;case On:s.frontFace=HM.CCW,s.cullMode=WM.Front;break;case Qr:s.frontFace=HM.CCW,s.cullMode=WM.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",r.side);break}return s}_getColorWriteMask(e){return e.colorWrite===!0?WB.All:WB.None}_getDepthCompare(e){let n;if(e.depthTest===!1)n=mr.Always;else{const r=e.depthFunc;switch(r){case $y:n=mr.Never;break;case Gy:n=mr.Always;break;case Hy:n=mr.Less;break;case pu:n=mr.LessEqual;break;case Wy:n=mr.Equal;break;case jy:n=mr.GreaterEqual;break;case qy:n=mr.Greater;break;case Xy:n=mr.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",r)}}return n}}class pRe extends x6{constructor(e,n,r=2048){super(r),this.device=e,this.type=n,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${n}`});const s=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${n}`,size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${n}`,size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return da(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const n=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e.id,n),n}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),n=this.currentQueryIndex,r=n*8;this.currentQueryIndex=0,this.queryOffsets.clear();const s=this.device.createCommandEncoder();s.resolveQuerySet(this.querySet,0,n,this.resolveBuffer,0),s.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,r);const o=s.finish();if(this.device.queue.submit([o]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,r),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const a=new BigUint64Array(this.resultBuffer.getMappedRange(0,r));let l=0;for(const[,c]of e){const u=a[c],d=a[c+1],h=Number(d-u)/1e6;l+=h}return this.resultBuffer.unmap(),this.lastValue=l,l}catch(e){return console.error("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class mRe extends v6{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new aRe(this),this.attributeUtils=new dRe(this),this.bindingUtils=new hRe(this),this.pipelineUtils=new fRe(this),this.textureUtils=new ZCe(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const n=this.parameters;let r;if(n.device===void 0){const a={powerPreference:n.powerPreference,featureLevel:n.compatibilityMode?"compatibility":void 0},l=typeof navigator<"u"?await navigator.gpu.requestAdapter(a):null;if(l===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const c=Object.values(xR),u=[];for(const h of c)l.features.has(h)&&u.push(h);const d={requiredFeatures:u,requiredLimits:n.requiredLimits};r=await l.requestDevice(d)}else r=n.device;r.lost.then(a=>{const l={api:"WebGPU",message:a.message||"Unknown reason",reason:a.reason||null,originalEvent:a};e.onDeviceLost(l)});const s=n.context!==void 0?n.context:e.domElement.getContext("webgpu");this.device=r,this.context=s;const o=n.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(xR.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:o}),this.updateSize()}get coordinateSystem(){return mu}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const r=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(r.depth,r.stencil).createView()});const s=e.colorAttachments[0];this.renderer.samples>0?s.view=this.colorBuffer.createView():s.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const n=e.colorAttachments[0];return this.renderer.samples>0?n.resolveTarget=this.context.getCurrentTexture().createView():n.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isDepthArrayTexture&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,n={}){const r=e.renderTarget,s=this.get(r);let o=s.descriptors;if(o===void 0||s.width!==r.width||s.height!==r.height||s.dimensions!==r.dimensions||s.activeMipmapLevel!==e.activeMipmapLevel||s.activeCubeFace!==e.activeCubeFace||s.samples!==r.samples){o={},s.descriptors=o;const u=()=>{r.removeEventListener("dispose",u),this.delete(r)};r.hasEventListener("dispose",u)===!1&&r.addEventListener("dispose",u)}const a=e.getCacheKey();let l=o[a];if(l===void 0){const u=e.textures,d=[];let h;const f=this._isRenderCameraDepthArray(e);for(let p=0;p<u.length;p++){const m=this.get(u[p]),y={label:`colorAttachment_${p}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:sr.TwoD};if(r.isRenderTarget3D)h=e.activeCubeFace,y.baseArrayLayer=0,y.dimension=sr.ThreeD,y.depthOrArrayLayers=u[p].image.depth;else if(r.isRenderTargetArray)if(f===!0){const v=e.camera.cameras;for(let g=0;g<v.length;g++){const _={...y,baseArrayLayer:g,arrayLayerCount:1,dimension:sr.TwoD},x=m.texture.createView(_);d.push({view:x,resolveTarget:void 0,depthSlice:void 0})}}else y.dimension=sr.TwoDArray,y.depthOrArrayLayers=u[p].image.depth;if(f!==!0){const v=m.texture.createView(y);let g,_;m.msaaTexture!==void 0?(g=m.msaaTexture.createView(),_=v):(g=v,_=void 0),d.push({view:g,resolveTarget:_,depthSlice:h})}}if(l={textureViews:d},e.depth){const p=this.get(e.depthTexture),m={};e.depthTexture.isDepthArrayTexture&&(m.dimension=sr.TwoD,m.arrayLayerCount=1,m.baseArrayLayer=e.activeCubeFace),l.depthStencilView=p.texture.createView(m)}o[a]=l,s.width=r.width,s.height=r.height,s.samples=r.samples,s.activeMipmapLevel=e.activeMipmapLevel,s.activeCubeFace=e.activeCubeFace,s.dimensions=r.dimensions}const c={colorAttachments:[]};for(let u=0;u<l.textureViews.length;u++){const d=l.textureViews[u];let h={r:0,g:0,b:0,a:1};u===0&&n.clearValue&&(h=n.clearValue),c.colorAttachments.push({view:d.view,depthSlice:d.depthSlice,resolveTarget:d.resolveTarget,loadOp:n.loadOp||_n.Load,storeOp:n.storeOp||Xr.Store,clearValue:h})}return l.depthStencilView&&(c.depthStencilAttachment={view:l.depthStencilView}),c}beginRender(e){const n=this.get(e),r=this.device,s=e.occlusionQueryCount;let o;s>0&&(n.currentOcclusionQuerySet&&n.currentOcclusionQuerySet.destroy(),n.currentOcclusionQueryBuffer&&n.currentOcclusionQueryBuffer.destroy(),n.currentOcclusionQuerySet=n.occlusionQuerySet,n.currentOcclusionQueryBuffer=n.occlusionQueryBuffer,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,o=r.createQuerySet({type:"occlusion",count:s,label:`occlusionQuerySet_${e.id}`}),n.occlusionQuerySet=o,n.occlusionQueryIndex=0,n.occlusionQueryObjects=new Array(s),n.lastOcclusionObject=null);let a;e.textures===null?a=this._getDefaultRenderPassDescriptor():a=this._getRenderPassDescriptor(e,{loadOp:_n.Load}),this.initTimestampQuery(e,a),a.occlusionQuerySet=o;const l=a.depthStencilAttachment;if(e.textures!==null){const u=a.colorAttachments;for(let d=0;d<u.length;d++){const h=u[d];e.clearColor?(h.clearValue=d===0?e.clearColorValue:{r:0,g:0,b:0,a:1},h.loadOp=_n.Clear):h.loadOp=_n.Load,h.storeOp=Xr.Store}}else{const u=a.colorAttachments[0];e.clearColor?(u.clearValue=e.clearColorValue,u.loadOp=_n.Clear):u.loadOp=_n.Load,u.storeOp=Xr.Store}e.depth&&(e.clearDepth?(l.depthClearValue=e.clearDepthValue,l.depthLoadOp=_n.Clear):l.depthLoadOp=_n.Load,l.depthStoreOp=Xr.Store),e.stencil&&(e.clearStencil?(l.stencilClearValue=e.clearStencilValue,l.stencilLoadOp=_n.Clear):l.stencilLoadOp=_n.Load,l.stencilStoreOp=Xr.Store);const c=r.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const u=e.camera.cameras;!n.layerDescriptors||n.layerDescriptors.length!==u.length?this._createDepthLayerDescriptors(e,n,a,u):this._updateDepthLayerDescriptors(e,n,u),n.bundleEncoders=[],n.bundleSets=[];for(let d=0;d<u.length;d++){const h=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+d),f={attributes:{},bindingGroups:[],pipeline:null,index:null};n.bundleEncoders.push(h),n.bundleSets.push(f)}n.currentPass=null}else{const u=c.beginRenderPass(a);if(n.currentPass=u,e.viewport&&this.updateViewport(e),e.scissor){const{x:d,y:h,width:f,height:p}=e.scissorValue;u.setScissorRect(d,h,f,p)}}n.descriptor=a,n.encoder=c,n.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.renderBundles=[]}_createDepthLayerDescriptors(e,n,r,s){const o=r.depthStencilAttachment;n.layerDescriptors=[];const a=this.get(e.depthTexture);a.viewCache||(a.viewCache=[]);for(let l=0;l<s.length;l++){const c={...r,colorAttachments:[{...r.colorAttachments[0],view:r.colorAttachments[l].view}]};if(r.depthStencilAttachment){const u=l;a.viewCache[u]||(a.viewCache[u]=a.texture.createView({dimension:sr.TwoD,baseArrayLayer:l,arrayLayerCount:1})),c.depthStencilAttachment={view:a.viewCache[u],depthLoadOp:o.depthLoadOp||_n.Clear,depthStoreOp:o.depthStoreOp||Xr.Store,depthClearValue:o.depthClearValue||1},e.stencil&&(c.depthStencilAttachment.stencilLoadOp=o.stencilLoadOp,c.depthStencilAttachment.stencilStoreOp=o.stencilStoreOp,c.depthStencilAttachment.stencilClearValue=o.stencilClearValue)}else c.depthStencilAttachment={...o};n.layerDescriptors.push(c)}}_updateDepthLayerDescriptors(e,n,r){for(let s=0;s<r.length;s++){const o=n.layerDescriptors[s];if(o.depthStencilAttachment){const a=o.depthStencilAttachment;e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=_n.Clear):a.depthLoadOp=_n.Load),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=_n.Clear):a.stencilLoadOp=_n.Load)}}}finishRender(e){const n=this.get(e),r=e.occlusionQueryCount;n.renderBundles.length>0&&n.currentPass.executeBundles(n.renderBundles),r>n.occlusionQueryIndex&&n.currentPass.endOcclusionQuery();const s=n.encoder;if(this._isRenderCameraDepthArray(e)===!0){const o=[];for(let a=0;a<n.bundleEncoders.length;a++){const l=n.bundleEncoders[a];o.push(l.finish())}for(let a=0;a<n.layerDescriptors.length;a++)if(a<o.length){const l=n.layerDescriptors[a],c=s.beginRenderPass(l);if(e.viewport){const{x:u,y:d,width:h,height:f,minDepth:p,maxDepth:m}=e.viewportValue;c.setViewport(u,d,h,f,p,m)}if(e.scissor){const{x:u,y:d,width:h,height:f}=e.scissorValue;c.setScissorRect(u,d,h,f)}c.executeBundles([o[a]]),c.end()}}else n.currentPass&&n.currentPass.end();if(r>0){const o=r*8;let a=this.occludedResolveCache.get(o);a===void 0&&(a=this.device.createBuffer({size:o,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(o,a));const l=this.device.createBuffer({size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});n.encoder.resolveQuerySet(n.occlusionQuerySet,0,r,a,0),n.encoder.copyBufferToBuffer(a,0,l,0,o),n.occlusionQueryBuffer=l,this.resolveOccludedAsync(e)}if(this.device.queue.submit([n.encoder.finish()]),e.textures!==null){const o=e.textures;for(let a=0;a<o.length;a++){const l=o[a];l.generateMipmaps===!0&&this.textureUtils.generateMipmaps(l)}}}isOccluded(e,n){const r=this.get(e);return r.occluded&&r.occluded.has(n)}async resolveOccludedAsync(e){const n=this.get(e),{currentOcclusionQueryBuffer:r,currentOcclusionQueryObjects:s}=n;if(r&&s){const o=new WeakSet;n.currentOcclusionQueryObjects=null,n.currentOcclusionQueryBuffer=null,await r.mapAsync(GPUMapMode.READ);const a=r.getMappedRange(),l=new BigUint64Array(a);for(let c=0;c<s.length;c++)l[c]===BigInt(0)&&o.add(s[c]);r.destroy(),n.occluded=o}}updateViewport(e){const{currentPass:n}=this.get(e),{x:r,y:s,width:o,height:a,minDepth:l,maxDepth:c}=e.viewportValue;n.setViewport(r,s,o,a,l,c)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,n,r,s=null){const o=this.device,a=this.renderer;let l=[],c,u,d,h;if(e){const m=this.getClearColor();u={r:m.r,g:m.g,b:m.b,a:m.a}}if(s===null){d=a.depth,h=a.stencil;const m=this._getDefaultRenderPassDescriptor();if(e){l=m.colorAttachments;const y=l[0];y.clearValue=u,y.loadOp=_n.Clear,y.storeOp=Xr.Store}(d||h)&&(c=m.depthStencilAttachment)}else{d=s.depth,h=s.stencil;const m={loadOp:e?_n.Clear:_n.Load,clearValue:e?u:void 0};d&&(m.depthLoadOp=n?_n.Clear:_n.Load,m.depthClearValue=n?a.getClearDepth():void 0,m.depthStoreOp=Xr.Store),h&&(m.stencilLoadOp=r?_n.Clear:_n.Load,m.stencilClearValue=r?a.getClearStencil():void 0,m.stencilStoreOp=Xr.Store);const y=this._getRenderPassDescriptor(s,m);l=y.colorAttachments,c=y.depthStencilAttachment}d&&c&&c.depthLoadOp===void 0&&(n?(c.depthLoadOp=_n.Clear,c.depthClearValue=a.getClearDepth(),c.depthStoreOp=Xr.Store):(c.depthLoadOp=_n.Load,c.depthStoreOp=Xr.Store)),h&&c&&c.stencilLoadOp===void 0&&(r?(c.stencilLoadOp=_n.Clear,c.stencilClearValue=a.getClearStencil(),c.stencilStoreOp=Xr.Store):(c.stencilLoadOp=_n.Load,c.stencilStoreOp=Xr.Store));const f=o.createCommandEncoder({label:"clear"});f.beginRenderPass({colorAttachments:l,depthStencilAttachment:c}).end(),o.queue.submit([f.finish()])}beginCompute(e){const n=this.get(e),r={label:"computeGroup_"+e.id};this.initTimestampQuery(e,r),n.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),n.passEncoderGPU=n.cmdEncoderGPU.beginComputePass(r)}compute(e,n,r,s){const{passEncoderGPU:o}=this.get(e),a=this.get(s).pipeline;o.setPipeline(a);for(let d=0,h=r.length;d<h;d++){const f=r[d],p=this.get(f);o.setBindGroup(d,p.group)}const l=this.device.limits.maxComputeWorkgroupsPerDimension,c=this.get(n);c.dispatchSize===void 0&&(c.dispatchSize={x:0,y:1,z:1});const{dispatchSize:u}=c;n.dispatchCount>l?(u.x=Math.min(n.dispatchCount,l),u.y=Math.ceil(n.dispatchCount/l)):u.x=n.dispatchCount,o.dispatchWorkgroups(u.x,u.y,u.z)}finishCompute(e){const n=this.get(e);n.passEncoderGPU.end(),this.device.queue.submit([n.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,n){const{object:r,material:s,context:o,pipeline:a}=e,l=e.getBindings(),c=this.get(o),u=this.get(a).pipeline,d=e.getIndex(),h=d!==null,f=e.getDrawParameters();if(f===null)return;const p=(y,v)=>{y.setPipeline(u),v.pipeline=u;const g=v.bindingGroups;for(let x=0,b=l.length;x<b;x++){const S=l[x],T=this.get(S);g[S.index]!==S.id&&(y.setBindGroup(S.index,T.group),g[S.index]=S.id)}if(h===!0&&v.index!==d){const x=this.get(d).buffer,b=d.array instanceof Uint16Array?Ip.Uint16:Ip.Uint32;y.setIndexBuffer(x,b),v.index=d}const _=e.getVertexBuffers();for(let x=0,b=_.length;x<b;x++){const S=_[x];if(v.attributes[x]!==S){const T=this.get(S).buffer;y.setVertexBuffer(x,T),v.attributes[x]=S}}o.stencil===!0&&s.stencilWrite===!0&&c.currentStencilRef!==s.stencilRef&&(y.setStencilReference(s.stencilRef),c.currentStencilRef=s.stencilRef)},m=(y,v)=>{if(p(y,v),r.isBatchedMesh===!0){const g=r._multiDrawStarts,_=r._multiDrawCounts,x=r._multiDrawCount,b=r._multiDrawInstances;b!==null&&da("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let S=0;S<x;S++){const T=b?b[S]:1,w=T>1?0:S;h===!0?y.drawIndexed(_[S],T,g[S]/d.array.BYTES_PER_ELEMENT,0,w):y.draw(_[S],T,g[S],w),n.update(r,_[S],T)}}else if(h===!0){const{vertexCount:g,instanceCount:_,firstVertex:x}=f,b=e.getIndirect();if(b!==null){const S=this.get(b).buffer;y.drawIndexedIndirect(S,0)}else y.drawIndexed(g,_,x,0,0);n.update(r,g,_)}else{const{vertexCount:g,instanceCount:_,firstVertex:x}=f,b=e.getIndirect();if(b!==null){const S=this.get(b).buffer;y.drawIndirect(S,0)}else y.draw(g,_,x,0);n.update(r,g,_)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const y=this.get(e.camera),v=e.camera.cameras,g=e.getBindingGroup("cameraIndex");if(y.indexesGPU===void 0||y.indexesGPU.length!==v.length){const x=this.get(g),b=[],S=new Uint32Array([0,0,0,0]);for(let T=0,w=v.length;T<w;T++){S[0]=T;const E=this.bindingUtils.createBindGroupIndex(S,x.layout);b.push(E)}y.indexesGPU=b}const _=this.renderer.getPixelRatio();for(let x=0,b=v.length;x<b;x++){const S=v[x];if(r.layers.test(S.layers)){const T=S.viewport;let w=c.currentPass,E=c.currentSets;if(c.bundleEncoders){const A=c.bundleEncoders[x],M=c.bundleSets[x];w=A,E=M}T&&w.setViewport(Math.floor(T.x*_),Math.floor(T.y*_),Math.floor(T.width*_),Math.floor(T.height*_),o.viewportValue.minDepth,o.viewportValue.maxDepth),g&&y.indexesGPU&&(w.setBindGroup(g.index,y.indexesGPU[x]),E.bindingGroups[g.index]=g.id),m(w,E)}}}else if(c.currentPass){if(c.occlusionQuerySet!==void 0){const y=c.lastOcclusionObject;y!==r&&(y!==null&&y.occlusionTest===!0&&(c.currentPass.endOcclusionQuery(),c.occlusionQueryIndex++),r.occlusionTest===!0&&(c.currentPass.beginOcclusionQuery(c.occlusionQueryIndex),c.occlusionQueryObjects[c.occlusionQueryIndex]=r),c.lastOcclusionObject=r)}m(c.currentPass,c.currentSets)}}needsRenderUpdate(e){const n=this.get(e),{object:r,material:s}=e,o=this.utils,a=o.getSampleCountRenderContext(e.context),l=o.getCurrentColorSpace(e.context),c=o.getCurrentColorFormat(e.context),u=o.getCurrentDepthStencilFormat(e.context),d=o.getPrimitiveTopology(r,s);let h=!1;return(n.material!==s||n.materialVersion!==s.version||n.transparent!==s.transparent||n.blending!==s.blending||n.premultipliedAlpha!==s.premultipliedAlpha||n.blendSrc!==s.blendSrc||n.blendDst!==s.blendDst||n.blendEquation!==s.blendEquation||n.blendSrcAlpha!==s.blendSrcAlpha||n.blendDstAlpha!==s.blendDstAlpha||n.blendEquationAlpha!==s.blendEquationAlpha||n.colorWrite!==s.colorWrite||n.depthWrite!==s.depthWrite||n.depthTest!==s.depthTest||n.depthFunc!==s.depthFunc||n.stencilWrite!==s.stencilWrite||n.stencilFunc!==s.stencilFunc||n.stencilFail!==s.stencilFail||n.stencilZFail!==s.stencilZFail||n.stencilZPass!==s.stencilZPass||n.stencilFuncMask!==s.stencilFuncMask||n.stencilWriteMask!==s.stencilWriteMask||n.side!==s.side||n.alphaToCoverage!==s.alphaToCoverage||n.sampleCount!==a||n.colorSpace!==l||n.colorFormat!==c||n.depthStencilFormat!==u||n.primitiveTopology!==d||n.clippingContextCacheKey!==e.clippingContextCacheKey)&&(n.material=s,n.materialVersion=s.version,n.transparent=s.transparent,n.blending=s.blending,n.premultipliedAlpha=s.premultipliedAlpha,n.blendSrc=s.blendSrc,n.blendDst=s.blendDst,n.blendEquation=s.blendEquation,n.blendSrcAlpha=s.blendSrcAlpha,n.blendDstAlpha=s.blendDstAlpha,n.blendEquationAlpha=s.blendEquationAlpha,n.colorWrite=s.colorWrite,n.depthWrite=s.depthWrite,n.depthTest=s.depthTest,n.depthFunc=s.depthFunc,n.stencilWrite=s.stencilWrite,n.stencilFunc=s.stencilFunc,n.stencilFail=s.stencilFail,n.stencilZFail=s.stencilZFail,n.stencilZPass=s.stencilZPass,n.stencilFuncMask=s.stencilFuncMask,n.stencilWriteMask=s.stencilWriteMask,n.side=s.side,n.alphaToCoverage=s.alphaToCoverage,n.sampleCount=a,n.colorSpace=l,n.colorFormat=c,n.depthStencilFormat=u,n.primitiveTopology=d,n.clippingContextCacheKey=e.clippingContextCacheKey,h=!0),h}getRenderCacheKey(e){const{object:n,material:r}=e,s=this.utils,o=e.context;return[r.transparent,r.blending,r.premultipliedAlpha,r.blendSrc,r.blendDst,r.blendEquation,r.blendSrcAlpha,r.blendDstAlpha,r.blendEquationAlpha,r.colorWrite,r.depthWrite,r.depthTest,r.depthFunc,r.stencilWrite,r.stencilFunc,r.stencilFail,r.stencilZFail,r.stencilZPass,r.stencilFuncMask,r.stencilWriteMask,r.side,s.getSampleCountRenderContext(o),s.getCurrentColorSpace(o),s.getCurrentColorFormat(o),s.getCurrentDepthStencilFormat(o),s.getPrimitiveTopology(n,r),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,n){this.textureUtils.createTexture(e,n)}updateTexture(e,n){this.textureUtils.updateTexture(e,n)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,n,r,s,o,a){return this.textureUtils.copyTextureToBuffer(e,n,r,s,o,a)}initTimestampQuery(e,n){if(!this.trackTimestamp)return;const r=e.isComputeNode?"compute":"render";this.timestampQueryPool[r]||(this.timestampQueryPool[r]=new pRe(this.device,r,2048));const s=this.timestampQueryPool[r],o=s.allocateQueriesForContext(e);n.timestampWrites={querySet:s.querySet,beginningOfPassWriteIndex:o,endOfPassWriteIndex:o+1}}createNodeBuilder(e,n){return new oRe(e,n)}createProgram(e){const n=this.get(e);n.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,n){this.pipelineUtils.createRenderPipeline(e,n)}createComputePipeline(e,n){this.pipelineUtils.createComputePipeline(e,n)}beginBundle(e){const n=this.get(e);n._currentPass=n.currentPass,n._currentSets=n.currentSets,n.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,n){const r=this.get(e),o=r.currentPass.finish();this.get(n).bundleGPU=o,r.currentSets=r._currentSets,r.currentPass=r._currentPass}addBundle(e,n){this.get(e).renderBundles.push(this.get(n).bundleGPU)}createBindings(e,n,r,s){this.bindingUtils.createBindings(e,n,r,s)}updateBindings(e,n,r,s){this.bindingUtils.createBindings(e,n,r,s)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,n,r=null,s=null,o=0,a=0){let l=0,c=0,u=0,d=0,h=0,f=0,p=e.image.width,m=e.image.height,y=1;r!==null&&(r.isBox3===!0?(d=r.min.x,h=r.min.y,f=r.min.z,p=r.max.x-r.min.x,m=r.max.y-r.min.y,y=r.max.z-r.min.z):(d=r.min.x,h=r.min.y,p=r.max.x-r.min.x,m=r.max.y-r.min.y,y=1)),s!==null&&(l=s.x,c=s.y,u=s.z||0);const v=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+n.id}),g=this.get(e).texture,_=this.get(n).texture;v.copyTextureToTexture({texture:g,mipLevel:o,origin:{x:d,y:h,z:f}},{texture:_,mipLevel:a,origin:{x:l,y:c,z:u}},[p,m,y]),this.device.queue.submit([v.finish()]),a===0&&n.generateMipmaps&&this.textureUtils.generateMipmaps(n)}copyFramebufferToTexture(e,n,r){const s=this.get(n);let o=null;n.renderTarget?e.isDepthTexture?o=this.get(n.depthTexture).texture:o=this.get(n.textures[0]).texture:e.isDepthTexture?o=this.textureUtils.getDepthBuffer(n.depth,n.stencil):o=this.context.getCurrentTexture();const a=this.get(e).texture;if(o.format!==a.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",o.format,a.format);return}let l;if(s.currentPass?(s.currentPass.end(),l=s.encoder):l=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),l.copyTextureToTexture({texture:o,origin:[r.x,r.y,0]},{texture:a},[r.z,r.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e),s.currentPass){const{descriptor:c}=s;for(let u=0;u<c.colorAttachments.length;u++)c.colorAttachments[u].loadOp=_n.Load;if(n.depth&&(c.depthStencilAttachment.depthLoadOp=_n.Load),n.stencil&&(c.depthStencilAttachment.stencilLoadOp=_n.Load),s.currentPass=l.beginRenderPass(c),s.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.viewport&&this.updateViewport(n),n.scissor){const{x:u,y:d,width:h,height:f}=n.scissorValue;s.currentPass.setScissorRect(u,d,h,f)}}else this.device.queue.submit([l.finish()])}}class gRe extends dG{constructor(e,n,r,s,o,a){super(e,n,r,s,o,a),this.iesMap=null}copy(e,n){return super.copy(e,n),this.iesMap=e.iesMap,this}}class yRe extends d6{constructor(){super(),this.addMaterial(zTe,"MeshPhongMaterial"),this.addMaterial(W8,"MeshStandardMaterial"),this.addMaterial(LEe,"MeshPhysicalMaterial"),this.addMaterial(FEe,"MeshToonMaterial"),this.addMaterial(LTe,"MeshBasicMaterial"),this.addMaterial(BTe,"MeshLambertMaterial"),this.addMaterial(ATe,"MeshNormalMaterial"),this.addMaterial(VEe,"MeshMatcapMaterial"),this.addMaterial(STe,"LineBasicMaterial"),this.addMaterial(TTe,"LineDashedMaterial"),this.addMaterial(WEe,"PointsMaterial"),this.addMaterial(q8,"SpriteMaterial"),this.addMaterial(XEe,"ShadowMaterial"),this.addLight(wAe,Kde),this.addLight(YAe,hG),this.addLight(ZAe,Zde),this.addLight(c6,dG),this.addLight(JAe,fG),this.addLight(eCe,jde),this.addLight(tCe,Jde),this.addLight(QAe,gRe),this.addToneMapping(NMe,H$),this.addToneMapping(kMe,W$),this.addToneMapping(LMe,j$),this.addToneMapping(DMe,q$),this.addToneMapping(UMe,X$),this.addToneMapping(zMe,K$)}}class vRe extends _Ce{constructor(e={}){let n;e.forceWebGL?n=HB:(n=mRe,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new HB(e)));const r=new n(e);super(r,e),this.library=new yRe,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}const KM={type:"change"},ik={type:"start"},rk={type:"end"},QB=1e-6,wn={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},i_=new Oe,Oc=new Oe,xRe=new K,r_=new K,YM=new K,Kh=new ga,JB=new K,s_=new K,ZM=new K,o_=new K;class _Re extends sw{constructor(e,n=null){super(e,n),this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:_r.ROTATE,MIDDLE:_r.DOLLY,RIGHT:_r.PAN},this.target=new K,this.state=wn.NONE,this.keyState=wn.NONE,this._lastPosition=new K,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new K,this._movePrev=new Oe,this._moveCurr=new Oe,this._lastAxis=new K,this._zoomStart=new Oe,this._zoomEnd=new Oe,this._panStart=new Oe,this._panEnd=new Oe,this._pointers=[],this._pointerPositions={},this._onPointerMove=SRe.bind(this),this._onPointerDown=bRe.bind(this),this._onPointerUp=wRe.bind(this),this._onPointerCancel=TRe.bind(this),this._onContextMenu=NRe.bind(this),this._onMouseWheel=PRe.bind(this),this._onKeyDown=MRe.bind(this),this._onKeyUp=ERe.bind(this),this._onTouchStart=kRe.bind(this),this._onTouchMove=LRe.bind(this),this._onTouchEnd=IRe.bind(this),this._onMouseDown=ARe.bind(this),this._onMouseMove=CRe.bind(this),this._onMouseUp=RRe.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,n!==null&&(this.connect(n),this.handleResize()),this.update()}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),n=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-n.clientLeft,this.screen.top=e.top+window.pageYOffset-n.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>QB&&(this.dispatchEvent(KM),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>QB||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(KM),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=wn.NONE,this.keyState=wn.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(KM),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(Oc.copy(this._panEnd).sub(this._panStart),Oc.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,n=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;Oc.x*=e,Oc.y*=n}Oc.multiplyScalar(this._eye.length()*this.panSpeed),r_.copy(this._eye).cross(this.object.up).setLength(Oc.x),r_.add(xRe.copy(this.object.up).setLength(Oc.y)),this.object.position.add(r_),this.target.add(r_),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(Oc.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){o_.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=o_.length();e?(this._eye.copy(this.object.position).sub(this.target),JB.copy(this._eye).normalize(),s_.copy(this.object.up).normalize(),ZM.crossVectors(s_,JB).normalize(),s_.setLength(this._moveCurr.y-this._movePrev.y),ZM.setLength(this._moveCurr.x-this._movePrev.x),o_.copy(s_.add(ZM)),YM.crossVectors(o_,this._eye).normalize(),e*=this.rotateSpeed,Kh.setFromAxisAngle(YM,e),this._eye.applyQuaternion(Kh),this.object.up.applyQuaternion(Kh),this._lastAxis.copy(YM),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),Kh.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(Kh),this.object.up.applyQuaternion(Kh)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===wn.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=e1.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=e1.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,n){return i_.set((e-this.screen.left)/this.screen.width,(n-this.screen.top)/this.screen.height),i_}_getMouseOnCircle(e,n){return i_.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-n))/this.screen.width),i_}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n].pointerId==e.pointerId){this._pointers.splice(n,1);return}}_trackPointer(e){let n=this._pointerPositions[e.pointerId];n===void 0&&(n=new Oe,this._pointerPositions[e.pointerId]=n),n.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const n=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[n.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function bRe(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i))}function SRe(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function wRe(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchEnd(i):this._onMouseUp(),this._removePointer(i),this._pointers.length===0&&(this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function TRe(i){this._removePointer(i)}function ERe(){this.enabled!==!1&&(this.keyState=wn.NONE,window.addEventListener("keydown",this._onKeyDown))}function MRe(i){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===wn.NONE&&(i.code===this.keys[wn.ROTATE]&&!this.noRotate?this.keyState=wn.ROTATE:i.code===this.keys[wn.ZOOM]&&!this.noZoom?this.keyState=wn.ZOOM:i.code===this.keys[wn.PAN]&&!this.noPan&&(this.keyState=wn.PAN)))}function ARe(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case _r.DOLLY:this.state=wn.ZOOM;break;case _r.ROTATE:this.state=wn.ROTATE;break;case _r.PAN:this.state=wn.PAN;break;default:this.state=wn.NONE}const n=this.keyState!==wn.NONE?this.keyState:this.state;n===wn.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY)),this._movePrev.copy(this._moveCurr)):n===wn.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(i.pageX,i.pageY)),this._zoomEnd.copy(this._zoomStart)):n===wn.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(i.pageX,i.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(ik)}function CRe(i){const e=this.keyState!==wn.NONE?this.keyState:this.state;e===wn.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY))):e===wn.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(i.pageX,i.pageY)):e===wn.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(i.pageX,i.pageY))}function RRe(){this.state=wn.NONE,this.dispatchEvent(rk)}function PRe(i){if(this.enabled!==!1&&this.noZoom!==!0){switch(i.preventDefault(),i.deltaMode){case 2:this._zoomStart.y-=i.deltaY*.025;break;case 1:this._zoomStart.y-=i.deltaY*.01;break;default:this._zoomStart.y-=i.deltaY*25e-5;break}this.dispatchEvent(ik),this.dispatchEvent(rk)}}function NRe(i){this.enabled!==!1&&i.preventDefault()}function kRe(i){switch(this._trackPointer(i),this._pointers.length){case 1:this.state=wn.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=wn.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,n=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+n*n);const r=(this._pointers[0].pageX+this._pointers[1].pageX)/2,s=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(r,s)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(ik)}function LRe(i){switch(this._trackPointer(i),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY));break;default:const e=this._getSecondPointerPosition(i),n=i.pageX-e.x,r=i.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(n*n+r*r);const s=(i.pageX+e.x)/2,o=(i.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(s,o));break}}function IRe(i){switch(this._pointers.length){case 0:this.state=wn.NONE;break;case 1:this.state=wn.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=wn.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==i.pointerId){const n=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(n.x,n.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(rk)}const eU={type:"change"},sk={type:"start"},b6={type:"end"},a_=new tw,tU=new Ws,DRe=Math.cos(70*e1.DEG2RAD),Hi=new K,ps=2*Math.PI,Nn={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},QM=1e-6;class ORe extends sw{constructor(e,n=null){super(e,n),this.state=Nn.NONE,this.target=new K,this.cursor=new K,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:_r.ROTATE,MIDDLE:_r.DOLLY,RIGHT:_r.PAN},this.touches={ONE:Il.ROTATE,TWO:Il.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new K,this._lastQuaternion=new ga,this._lastTargetPosition=new K,this._quat=new ga().setFromUnitVectors(e.up,new K(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new JO,this._sphericalDelta=new JO,this._scale=1,this._panOffset=new K,this._rotateStart=new Oe,this._rotateEnd=new Oe,this._rotateDelta=new Oe,this._panStart=new Oe,this._panEnd=new Oe,this._panDelta=new Oe,this._dollyStart=new Oe,this._dollyEnd=new Oe,this._dollyDelta=new Oe,this._dollyDirection=new K,this._mouse=new Oe,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=BRe.bind(this),this._onPointerDown=FRe.bind(this),this._onPointerUp=URe.bind(this),this._onContextMenu=jRe.bind(this),this._onMouseWheel=$Re.bind(this),this._onKeyDown=GRe.bind(this),this._onTouchStart=HRe.bind(this),this._onTouchMove=WRe.bind(this),this._onMouseDown=zRe.bind(this),this._onMouseMove=VRe.bind(this),this._interceptControlDown=qRe.bind(this),this._interceptControlUp=XRe.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(eU),this.update(),this.state=Nn.NONE}update(e=null){const n=this.object.position;Hi.copy(n).sub(this.target),Hi.applyQuaternion(this._quat),this._spherical.setFromVector3(Hi),this.autoRotate&&this.state===Nn.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let r=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(r)&&isFinite(s)&&(r<-Math.PI?r+=ps:r>Math.PI&&(r-=ps),s<-Math.PI?s+=ps:s>Math.PI&&(s-=ps),r<=s?this._spherical.theta=Math.max(r,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(r+s)/2?Math.max(r,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const a=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=a!=this._spherical.radius}if(Hi.setFromSpherical(this._spherical),Hi.applyQuaternion(this._quatInverse),n.copy(this.target).add(Hi),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let a=null;if(this.object.isPerspectiveCamera){const l=Hi.length();a=this._clampDistance(l*this._scale);const c=l-a;this.object.position.addScaledVector(this._dollyDirection,c),this.object.updateMatrixWorld(),o=!!c}else if(this.object.isOrthographicCamera){const l=new K(this._mouse.x,this._mouse.y,0);l.unproject(this.object);const c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=c!==this.object.zoom;const u=new K(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(l),this.object.updateMatrixWorld(),a=Hi.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;a!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(a).add(this.object.position):(a_.origin.copy(this.object.position),a_.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(a_.direction))<DRe?this.object.lookAt(this.target):(tU.setFromNormalAndCoplanarPoint(this.object.up,this.target),a_.intersectPlane(tU,this.target))))}else if(this.object.isOrthographicCamera){const a=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),a!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,o||this._lastPosition.distanceToSquared(this.object.position)>QM||8*(1-this._lastQuaternion.dot(this.object.quaternion))>QM||this._lastTargetPosition.distanceToSquared(this.target)>QM?(this.dispatchEvent(eU),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?ps/60*this.autoRotateSpeed*e:ps/60/60*this.autoRotateSpeed}_getZoomScale(e){const n=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*n)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,n){Hi.setFromMatrixColumn(n,0),Hi.multiplyScalar(-e),this._panOffset.add(Hi)}_panUp(e,n){this.screenSpacePanning===!0?Hi.setFromMatrixColumn(n,1):(Hi.setFromMatrixColumn(n,0),Hi.crossVectors(this.object.up,Hi)),Hi.multiplyScalar(e),this._panOffset.add(Hi)}_pan(e,n){const r=this.domElement;if(this.object.isPerspectiveCamera){const s=this.object.position;Hi.copy(s).sub(this.target);let o=Hi.length();o*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*o/r.clientHeight,this.object.matrix),this._panUp(2*n*o/r.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrix),this._panUp(n*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,n){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const r=this.domElement.getBoundingClientRect(),s=e-r.left,o=n-r.top,a=r.width,l=r.height;this._mouse.x=s/a*2-1,this._mouse.y=-(o/l)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(ps*this._rotateDelta.x/n.clientHeight),this._rotateUp(ps*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let n=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(ps*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),n=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-ps*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),n=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(ps*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),n=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-ps*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),n=!0;break}n&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._rotateStart.set(r,s)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._panStart.set(r,s)}}_handleTouchStartDolly(e){const n=this._getSecondPointerPosition(e),r=e.pageX-n.x,s=e.pageY-n.y,o=Math.sqrt(r*r+s*s);this._dollyStart.set(0,o)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const r=this._getSecondPointerPosition(e),s=.5*(e.pageX+r.x),o=.5*(e.pageY+r.y);this._rotateEnd.set(s,o)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(ps*this._rotateDelta.x/n.clientHeight),this._rotateUp(ps*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._panEnd.set(r,s)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const n=this._getSecondPointerPosition(e),r=e.pageX-n.x,s=e.pageY-n.y,o=Math.sqrt(r*r+s*s);this._dollyEnd.set(0,o),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const a=(e.pageX+n.x)*.5,l=(e.pageY+n.y)*.5;this._updateZoomParameters(a,l)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId){this._pointers.splice(n,1);return}}_isTrackingPointer(e){for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId)return!0;return!1}_trackPointer(e){let n=this._pointerPositions[e.pointerId];n===void 0&&(n=new Oe,this._pointerPositions[e.pointerId]=n),n.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const n=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[n]}_customWheelEvent(e){const n=e.deltaMode,r={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(n){case 1:r.deltaY*=16;break;case 2:r.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(r.deltaY*=10),r}}function FRe(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function BRe(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function URe(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(b6),this.state=Nn.NONE;break;case 1:const e=this._pointers[0],n=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:n.x,pageY:n.y});break}}function zRe(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case _r.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=Nn.DOLLY;break;case _r.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=Nn.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=Nn.ROTATE}break;case _r.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=Nn.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=Nn.PAN}break;default:this.state=Nn.NONE}this.state!==Nn.NONE&&this.dispatchEvent(sk)}function VRe(i){switch(this.state){case Nn.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case Nn.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case Nn.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function $Re(i){this.enabled===!1||this.enableZoom===!1||this.state!==Nn.NONE||(i.preventDefault(),this.dispatchEvent(sk),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(b6))}function GRe(i){this.enabled!==!1&&this._handleKeyDown(i)}function HRe(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case Il.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=Nn.TOUCH_ROTATE;break;case Il.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=Nn.TOUCH_PAN;break;default:this.state=Nn.NONE}break;case 2:switch(this.touches.TWO){case Il.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=Nn.TOUCH_DOLLY_PAN;break;case Il.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=Nn.TOUCH_DOLLY_ROTATE;break;default:this.state=Nn.NONE}break;default:this.state=Nn.NONE}this.state!==Nn.NONE&&this.dispatchEvent(sk)}function WRe(i){switch(this._trackPointer(i),this.state){case Nn.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case Nn.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case Nn.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case Nn.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=Nn.NONE}}function jRe(i){this.enabled!==!1&&i.preventDefault()}function qRe(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function XRe(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const KRe={type:"change"},nU=1e-6,iU=new ga;class YRe extends sw{constructor(e,n=null){super(e,n),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new K(0,0,0),this._rotationVector=new K(0,0,0),this._lastQuaternion=new ga,this._lastPosition=new K,this._status=0,this._onKeyDown=ZRe.bind(this),this._onKeyUp=QRe.bind(this),this._onPointerMove=ePe.bind(this),this._onPointerDown=JRe.bind(this),this._onPointerUp=tPe.bind(this),this._onPointerCancel=nPe.bind(this),this._onContextMenu=iPe.bind(this),n!==null&&this.connect(n)}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(this.enabled===!1)return;const n=this.object,r=e*this.movementSpeed,s=e*this.rollSpeed;n.translateX(this._moveVector.x*r),n.translateY(this._moveVector.y*r),n.translateZ(this._moveVector.z*r),iU.set(this._rotationVector.x*s,this._rotationVector.y*s,this._rotationVector.z*s,1).normalize(),n.quaternion.multiply(iU),(this._lastPosition.distanceToSquared(n.position)>nU||8*(1-this._lastQuaternion.dot(n.quaternion))>nU)&&(this.dispatchEvent(KRe),this._lastQuaternion.copy(n.quaternion),this._lastPosition.copy(n.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function ZRe(i){if(!(i.altKey||this.enabled===!1)){switch(i.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function QRe(i){if(this.enabled!==!1){switch(i.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function JRe(i){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(i.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function ePe(i){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){const e=this._getContainerDimensions(),n=e.size[0]/2,r=e.size[1]/2;this._moveState.yawLeft=-(i.pageX-e.offset[0]-n)/n,this._moveState.pitchDown=(i.pageY-e.offset[1]-r)/r,this._updateRotationVector()}}function tPe(i){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(i.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function nPe(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function iPe(i){this.enabled!==!1&&i.preventDefault()}const rPe={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class Aw{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const sPe=new j0(-1,1,1,-1,0,1);class oPe extends Tr{constructor(){super(),this.setAttribute("position",new Ti([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Ti([0,2,0,0,2,0],2))}}const aPe=new oPe;class lPe{constructor(e){this._mesh=new Xn(aPe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,sPe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class cPe extends Aw{constructor(e,n="tDiffuse"){super(),this.textureID=n,this.uniforms=null,this.material=null,e instanceof Ka?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=tG.clone(e.uniforms),this.material=new Ka({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new lPe(this.material)}render(e,n,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}class rU extends Aw{constructor(e,n){super(),this.scene=e,this.camera=n,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,n,r){const s=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);let a,l;this.inverse?(a=0,l=1):(a=1,l=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.buffers.stencil.setFunc(s.ALWAYS,a,4294967295),o.buffers.stencil.setClear(l),o.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.color.setMask(!0),o.buffers.depth.setMask(!0),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(s.EQUAL,1,4294967295),o.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.buffers.stencil.setLocked(!0)}}class uPe extends Aw{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class dPe{constructor(e,n){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),n===void 0){const r=e.getSize(new Oe);this._width=r.width,this._height=r.height,n=new gu(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:lr}),n.texture.name="EffectComposer.rt1"}else this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new cPe(rPe),this.copyPass.material.blending=Rs,this.clock=new mG}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,n){this.passes.splice(n,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const n=this.passes.indexOf(e);n!==-1&&this.passes.splice(n,1)}isLastEnabledPass(e){for(let n=e+1;n<this.passes.length;n++)if(this.passes[n].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const n=this.renderer.getRenderTarget();let r=!1;for(let s=0,o=this.passes.length;s<o;s++){const a=this.passes[s];if(a.enabled!==!1){if(a.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),a.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),a.needsSwap){if(r){const l=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}rU!==void 0&&(a instanceof rU?r=!0:a instanceof uPe&&(r=!1))}}this.renderer.setRenderTarget(n)}reset(e){if(e===void 0){const n=this.renderer.getSize(new Oe);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,n){this._width=e,this._height=n;const r=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(r,s),this.renderTarget2.setSize(r,s);for(let o=0;o<this.passes.length;o++)this.passes[o].setSize(r,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class hPe extends Aw{constructor(e,n,r=null,s=null,o=null){super(),this.scene=e,this.camera=n,this.overrideMaterial=r,this.clearColor=s,this.clearAlpha=o,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new St}render(e,n,r){const s=e.autoClear;e.autoClear=!1;let o,a;this.overrideMaterial!==null&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(o=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(o),this.overrideMaterial!==null&&(this.scene.overrideMaterial=a),e.autoClear=s}}var ql=Object.freeze({Linear:Object.freeze({None:function(i){return i},In:function(i){return i},Out:function(i){return i},InOut:function(i){return i}}),Quadratic:Object.freeze({In:function(i){return i*i},Out:function(i){return i*(2-i)},InOut:function(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)}}),Cubic:Object.freeze({In:function(i){return i*i*i},Out:function(i){return--i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)}}),Quartic:Object.freeze({In:function(i){return i*i*i*i},Out:function(i){return 1- --i*i*i*i},InOut:function(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)}}),Quintic:Object.freeze({In:function(i){return i*i*i*i*i},Out:function(i){return--i*i*i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)}}),Sinusoidal:Object.freeze({In:function(i){return 1-Math.sin((1-i)*Math.PI/2)},Out:function(i){return Math.sin(i*Math.PI/2)},InOut:function(i){return .5*(1-Math.sin(Math.PI*(.5-i)))}}),Exponential:Object.freeze({In:function(i){return i===0?0:Math.pow(1024,i-1)},Out:function(i){return i===1?1:1-Math.pow(2,-10*i)},InOut:function(i){return i===0?0:i===1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)}}),Circular:Object.freeze({In:function(i){return 1-Math.sqrt(1-i*i)},Out:function(i){return Math.sqrt(1- --i*i)},InOut:function(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)}}),Elastic:Object.freeze({In:function(i){return i===0?0:i===1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},Out:function(i){return i===0?0:i===1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},InOut:function(i){return i===0?0:i===1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(i){var e=1.70158;return i===1?1:i*i*((e+1)*i-e)},Out:function(i){var e=1.70158;return i===0?0:--i*i*((e+1)*i+e)+1},InOut:function(i){var e=2.5949095;return(i*=2)<1?.5*(i*i*((e+1)*i-e)):.5*((i-=2)*i*((e+1)*i+e)+2)}}),Bounce:Object.freeze({In:function(i){return 1-ql.Bounce.Out(1-i)},Out:function(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},InOut:function(i){return i<.5?ql.Bounce.In(i*2)*.5:ql.Bounce.Out(i*2-1)*.5+.5}}),generatePow:function(i){return i===void 0&&(i=4),i=i<Number.EPSILON?Number.EPSILON:i,i=i>1e4?1e4:i,{In:function(e){return Math.pow(e,i)},Out:function(e){return 1-Math.pow(1-e,i)},InOut:function(e){return e<.5?Math.pow(e*2,i)/2:(1-Math.pow(2-e*2,i))/2+.5}}}}),Pg=function(){return performance.now()},ok=function(){function i(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return i.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},i.prototype.removeAll=function(){this._tweens={}},i.prototype.add=function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var s=0,o=n;s<o.length;s++){var a=o[s];(e=a._group)===null||e===void 0||e.remove(a),a._group=this,this._tweens[a.getId()]=a,this._tweensAddedDuringUpdate[a.getId()]=a}},i.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=0,s=e;r<s.length;r++){var o=s[r];o._group=void 0,delete this._tweens[o.getId()],delete this._tweensAddedDuringUpdate[o.getId()]}},i.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},i.prototype.update=function(e,n){e===void 0&&(e=Pg()),n===void 0&&(n=!0);var r=Object.keys(this._tweens);if(r.length!==0)for(;r.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<r.length;s++){var o=this._tweens[r[s]],a=!n;o&&o.update(e,a)===!1&&!n&&this.remove(o)}r=Object.keys(this._tweensAddedDuringUpdate)}},i}(),Mf={Linear:function(i,e){var n=i.length-1,r=n*e,s=Math.floor(r),o=Mf.Utils.Linear;return e<0?o(i[0],i[1],r):e>1?o(i[n],i[n-1],n-r):o(i[s],i[s+1>n?n:s+1],r-s)},Bezier:function(i,e){for(var n=0,r=i.length-1,s=Math.pow,o=Mf.Utils.Bernstein,a=0;a<=r;a++)n+=s(1-e,r-a)*s(e,a)*i[a]*o(r,a);return n},CatmullRom:function(i,e){var n=i.length-1,r=n*e,s=Math.floor(r),o=Mf.Utils.CatmullRom;return i[0]===i[n]?(e<0&&(s=Math.floor(r=n*(1+e))),o(i[(s-1+n)%n],i[s],i[(s+1)%n],i[(s+2)%n],r-s)):e<0?i[0]-(o(i[0],i[0],i[1],i[1],-r)-i[0]):e>1?i[n]-(o(i[n],i[n],i[n-1],i[n-1],r-n)-i[n]):o(i[s?s-1:0],i[s],i[n<s+1?n:s+1],i[n<s+2?n:s+2],r-s)},Utils:{Linear:function(i,e,n){return(e-i)*n+i},Bernstein:function(i,e){var n=Mf.Utils.Factorial;return n(i)/n(e)/n(i-e)},Factorial:function(){var i=[1];return function(e){var n=1;if(i[e])return i[e];for(var r=e;r>1;r--)n*=r;return i[e]=n,n}}(),CatmullRom:function(i,e,n,r,s){var o=(n-i)*.5,a=(r-e)*.5,l=s*s,c=s*l;return(2*e-2*n+o+a)*c+(-3*e+3*n-2*o-a)*l+o*s+e}}},fPe=function(){function i(){}return i.nextId=function(){return i._nextId++},i._nextId=0,i}(),bR=new ok,S1=function(){function i(e,n){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=ql.Linear.None,this._interpolationFunction=Mf.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=fPe.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof n=="object"?(this._group=n,n.add(this)):n===!0&&(this._group=bR,bR.add(this))}return i.prototype.getId=function(){return this._id},i.prototype.isPlaying=function(){return this._isPlaying},i.prototype.isPaused=function(){return this._isPaused},i.prototype.getDuration=function(){return this._duration},i.prototype.to=function(e,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},i.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},i.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},i.prototype.start=function(e,n){if(e===void 0&&(e=Pg()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var r in this._valuesStartRepeat)this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var s={};for(var o in this._valuesEnd)s[o]=this._valuesEnd[o];this._valuesEnd=s}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},i.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},i.prototype._setupProperties=function(e,n,r,s,o){for(var a in r){var l=e[a],c=Array.isArray(l),u=c?"array":typeof l,d=!c&&Array.isArray(r[a]);if(!(u==="undefined"||u==="function")){if(d){var h=r[a];if(h.length===0)continue;for(var f=[l],p=0,m=h.length;p<m;p+=1){var y=this._handleRelativeValue(l,h[p]);if(isNaN(y)){d=!1,console.warn("Found invalid interpolation list. Skipping.");break}f.push(y)}d&&(r[a]=f)}if((u==="object"||c)&&l&&!d){n[a]=c?[]:{};var v=l;for(var g in v)n[a][g]=v[g];s[a]=c?[]:{};var h=r[a];if(!this._isDynamic){var _={};for(var g in h)_[g]=h[g];r[a]=h=_}this._setupProperties(v,n[a],h,s[a],o)}else(typeof n[a]>"u"||o)&&(n[a]=l),c||(n[a]*=1),d?s[a]=r[a].slice().reverse():s[a]=n[a]||0}}},i.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},i.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},i.prototype.pause=function(e){return e===void 0&&(e=Pg()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},i.prototype.resume=function(e){return e===void 0&&(e=Pg()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},i.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},i.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},i.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},i.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},i.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},i.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},i.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},i.prototype.easing=function(e){return e===void 0&&(e=ql.Linear.None),this._easingFunction=e,this},i.prototype.interpolation=function(e){return e===void 0&&(e=Mf.Linear),this._interpolationFunction=e,this},i.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},i.prototype.onStart=function(e){return this._onStartCallback=e,this},i.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},i.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},i.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},i.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},i.prototype.onStop=function(e){return this._onStopCallback=e,this},i.prototype.update=function(e,n){var r=this,s;if(e===void 0&&(e=Pg()),n===void 0&&(n=i.autoStartOnUpdate),this._isPaused)return!0;var o;if(!this._goToEnd&&!this._isPlaying)if(n)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var a=e-this._startTime,l=this._duration+((s=this._repeatDelayTime)!==null&&s!==void 0?s:this._delayTime),c=this._duration+this._repeat*l,u=function(){if(r._duration===0||a>c)return 1;var y=Math.trunc(a/l),v=a-y*l,g=Math.min(v/r._duration,1);return g===0&&a===r._duration?1:g},d=u(),h=this._easingFunction(d);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,h),this._onUpdateCallback&&this._onUpdateCallback(this._object,d),this._duration===0||a>=this._duration)if(this._repeat>0){var f=Math.min(Math.trunc((a-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=f);for(o in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[o]=="string"&&(this._valuesStartRepeat[o]=this._valuesStartRepeat[o]+parseFloat(this._valuesEnd[o])),this._yoyo&&this._swapEndStartRepeatValues(o),this._valuesStart[o]=this._valuesStartRepeat[o];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*f,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,m=this._chainedTweens.length;p<m;p++)this._chainedTweens[p].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},i.prototype._updateProperties=function(e,n,r,s){for(var o in r)if(n[o]!==void 0){var a=n[o]||0,l=r[o],c=Array.isArray(e[o]),u=Array.isArray(l),d=!c&&u;d?e[o]=this._interpolationFunction(l,s):typeof l=="object"&&l?this._updateProperties(e[o],a,l,s):(l=this._handleRelativeValue(a,l),typeof l=="number"&&(e[o]=a+(l-a)*s))}},i.prototype._handleRelativeValue=function(e,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?e+parseFloat(n):parseFloat(n)},i.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],r=this._valuesEnd[e];typeof r=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(r):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=n},i.autoStartOnUpdate=!1,i}(),Za=bR;Za.getAll.bind(Za);Za.removeAll.bind(Za);Za.add.bind(Za);Za.remove.bind(Za);Za.update.bind(Za);var SR="http://www.w3.org/1999/xhtml";const sU={svg:"http://www.w3.org/2000/svg",xhtml:SR,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Cw(i){var e=i+="",n=e.indexOf(":");return n>=0&&(e=i.slice(0,n))!=="xmlns"&&(i=i.slice(n+1)),sU.hasOwnProperty(e)?{space:sU[e],local:i}:i}function pPe(i){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===SR&&e.documentElement.namespaceURI===SR?e.createElement(i):e.createElementNS(n,i)}}function mPe(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function S6(i){var e=Cw(i);return(e.local?mPe:pPe)(e)}function gPe(){}function ak(i){return i==null?gPe:function(){return this.querySelector(i)}}function yPe(i){typeof i!="function"&&(i=ak(i));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var o=e[s],a=o.length,l=r[s]=new Array(a),c,u,d=0;d<a;++d)(c=o[d])&&(u=i.call(c,c.__data__,d,o))&&("__data__"in c&&(u.__data__=c.__data__),l[d]=u);return new oo(r,this._parents)}function vPe(i){return i==null?[]:Array.isArray(i)?i:Array.from(i)}function xPe(){return[]}function w6(i){return i==null?xPe:function(){return this.querySelectorAll(i)}}function _Pe(i){return function(){return vPe(i.apply(this,arguments))}}function bPe(i){typeof i=="function"?i=_Pe(i):i=w6(i);for(var e=this._groups,n=e.length,r=[],s=[],o=0;o<n;++o)for(var a=e[o],l=a.length,c,u=0;u<l;++u)(c=a[u])&&(r.push(i.call(c,c.__data__,u,a)),s.push(c));return new oo(r,s)}function T6(i){return function(){return this.matches(i)}}function E6(i){return function(e){return e.matches(i)}}var SPe=Array.prototype.find;function wPe(i){return function(){return SPe.call(this.children,i)}}function TPe(){return this.firstElementChild}function EPe(i){return this.select(i==null?TPe:wPe(typeof i=="function"?i:E6(i)))}var MPe=Array.prototype.filter;function APe(){return Array.from(this.children)}function CPe(i){return function(){return MPe.call(this.children,i)}}function RPe(i){return this.selectAll(i==null?APe:CPe(typeof i=="function"?i:E6(i)))}function PPe(i){typeof i!="function"&&(i=T6(i));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var o=e[s],a=o.length,l=r[s]=[],c,u=0;u<a;++u)(c=o[u])&&i.call(c,c.__data__,u,o)&&l.push(c);return new oo(r,this._parents)}function M6(i){return new Array(i.length)}function NPe(){return new oo(this._enter||this._groups.map(M6),this._parents)}function w1(i,e){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=e}w1.prototype={constructor:w1,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,e){return this._parent.insertBefore(i,e)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};function kPe(i){return function(){return i}}function LPe(i,e,n,r,s,o){for(var a=0,l,c=e.length,u=o.length;a<u;++a)(l=e[a])?(l.__data__=o[a],r[a]=l):n[a]=new w1(i,o[a]);for(;a<c;++a)(l=e[a])&&(s[a]=l)}function IPe(i,e,n,r,s,o,a){var l,c,u=new Map,d=e.length,h=o.length,f=new Array(d),p;for(l=0;l<d;++l)(c=e[l])&&(f[l]=p=a.call(c,c.__data__,l,e)+"",u.has(p)?s[l]=c:u.set(p,c));for(l=0;l<h;++l)p=a.call(i,o[l],l,o)+"",(c=u.get(p))?(r[l]=c,c.__data__=o[l],u.delete(p)):n[l]=new w1(i,o[l]);for(l=0;l<d;++l)(c=e[l])&&u.get(f[l])===c&&(s[l]=c)}function DPe(i){return i.__data__}function OPe(i,e){if(!arguments.length)return Array.from(this,DPe);var n=e?IPe:LPe,r=this._parents,s=this._groups;typeof i!="function"&&(i=kPe(i));for(var o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=0;u<o;++u){var d=r[u],h=s[u],f=h.length,p=FPe(i.call(d,d&&d.__data__,u,r)),m=p.length,y=l[u]=new Array(m),v=a[u]=new Array(m),g=c[u]=new Array(f);n(d,h,y,v,g,p,e);for(var _=0,x=0,b,S;_<m;++_)if(b=y[_]){for(_>=x&&(x=_+1);!(S=v[x])&&++x<m;);b._next=S||null}}return a=new oo(a,r),a._enter=l,a._exit=c,a}function FPe(i){return typeof i=="object"&&"length"in i?i:Array.from(i)}function BPe(){return new oo(this._exit||this._groups.map(M6),this._parents)}function UPe(i,e,n){var r=this.enter(),s=this,o=this.exit();return typeof i=="function"?(r=i(r),r&&(r=r.selection())):r=r.append(i+""),e!=null&&(s=e(s),s&&(s=s.selection())),n==null?o.remove():n(o),r&&s?r.merge(s).order():s}function zPe(i){for(var e=i.selection?i.selection():i,n=this._groups,r=e._groups,s=n.length,o=r.length,a=Math.min(s,o),l=new Array(s),c=0;c<a;++c)for(var u=n[c],d=r[c],h=u.length,f=l[c]=new Array(h),p,m=0;m<h;++m)(p=u[m]||d[m])&&(f[m]=p);for(;c<s;++c)l[c]=n[c];return new oo(l,this._parents)}function VPe(){for(var i=this._groups,e=-1,n=i.length;++e<n;)for(var r=i[e],s=r.length-1,o=r[s],a;--s>=0;)(a=r[s])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function $Pe(i){i||(i=GPe);function e(h,f){return h&&f?i(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,s=new Array(r),o=0;o<r;++o){for(var a=n[o],l=a.length,c=s[o]=new Array(l),u,d=0;d<l;++d)(u=a[d])&&(c[d]=u);c.sort(e)}return new oo(s,this._parents).order()}function GPe(i,e){return i<e?-1:i>e?1:i>=e?0:NaN}function HPe(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this}function WPe(){return Array.from(this)}function jPe(){for(var i=this._groups,e=0,n=i.length;e<n;++e)for(var r=i[e],s=0,o=r.length;s<o;++s){var a=r[s];if(a)return a}return null}function qPe(){let i=0;for(const e of this)++i;return i}function XPe(){return!this.node()}function KPe(i){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s=e[n],o=0,a=s.length,l;o<a;++o)(l=s[o])&&i.call(l,l.__data__,o,s);return this}function YPe(i){return function(){this.removeAttribute(i)}}function ZPe(i){return function(){this.removeAttributeNS(i.space,i.local)}}function QPe(i,e){return function(){this.setAttribute(i,e)}}function JPe(i,e){return function(){this.setAttributeNS(i.space,i.local,e)}}function eNe(i,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(i):this.setAttribute(i,n)}}function tNe(i,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,n)}}function nNe(i,e){var n=Cw(i);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?ZPe:YPe:typeof e=="function"?n.local?tNe:eNe:n.local?JPe:QPe)(n,e))}function A6(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function iNe(i){return function(){this.style.removeProperty(i)}}function rNe(i,e,n){return function(){this.style.setProperty(i,e,n)}}function sNe(i,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(i):this.style.setProperty(i,r,n)}}function oNe(i,e,n){return arguments.length>1?this.each((e==null?iNe:typeof e=="function"?sNe:rNe)(i,e,n??"")):Dp(this.node(),i)}function Dp(i,e){return i.style.getPropertyValue(e)||A6(i).getComputedStyle(i,null).getPropertyValue(e)}function aNe(i){return function(){delete this[i]}}function lNe(i,e){return function(){this[i]=e}}function cNe(i,e){return function(){var n=e.apply(this,arguments);n==null?delete this[i]:this[i]=n}}function uNe(i,e){return arguments.length>1?this.each((e==null?aNe:typeof e=="function"?cNe:lNe)(i,e)):this.node()[i]}function C6(i){return i.trim().split(/^|\s+/)}function lk(i){return i.classList||new R6(i)}function R6(i){this._node=i,this._names=C6(i.getAttribute("class")||"")}R6.prototype={add:function(i){var e=this._names.indexOf(i);e<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var e=this._names.indexOf(i);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};function P6(i,e){for(var n=lk(i),r=-1,s=e.length;++r<s;)n.add(e[r])}function N6(i,e){for(var n=lk(i),r=-1,s=e.length;++r<s;)n.remove(e[r])}function dNe(i){return function(){P6(this,i)}}function hNe(i){return function(){N6(this,i)}}function fNe(i,e){return function(){(e.apply(this,arguments)?P6:N6)(this,i)}}function pNe(i,e){var n=C6(i+"");if(arguments.length<2){for(var r=lk(this.node()),s=-1,o=n.length;++s<o;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof e=="function"?fNe:e?dNe:hNe)(n,e))}function mNe(){this.textContent=""}function gNe(i){return function(){this.textContent=i}}function yNe(i){return function(){var e=i.apply(this,arguments);this.textContent=e??""}}function vNe(i){return arguments.length?this.each(i==null?mNe:(typeof i=="function"?yNe:gNe)(i)):this.node().textContent}function xNe(){this.innerHTML=""}function _Ne(i){return function(){this.innerHTML=i}}function bNe(i){return function(){var e=i.apply(this,arguments);this.innerHTML=e??""}}function SNe(i){return arguments.length?this.each(i==null?xNe:(typeof i=="function"?bNe:_Ne)(i)):this.node().innerHTML}function wNe(){this.nextSibling&&this.parentNode.appendChild(this)}function TNe(){return this.each(wNe)}function ENe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function MNe(){return this.each(ENe)}function ANe(i){var e=typeof i=="function"?i:S6(i);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function CNe(){return null}function RNe(i,e){var n=typeof i=="function"?i:S6(i),r=e==null?CNe:typeof e=="function"?e:ak(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function PNe(){var i=this.parentNode;i&&i.removeChild(this)}function NNe(){return this.each(PNe)}function kNe(){var i=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}function LNe(){var i=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}function INe(i){return this.select(i?LNe:kNe)}function DNe(i){return arguments.length?this.property("__data__",i):this.node().__data__}function ONe(i){return function(e){i.call(this,e,this.__data__)}}function FNe(i){return i.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function BNe(i){return function(){var e=this.__on;if(e){for(var n=0,r=-1,s=e.length,o;n<s;++n)o=e[n],(!i.type||o.type===i.type)&&o.name===i.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function UNe(i,e,n){return function(){var r=this.__on,s,o=ONe(e);if(r){for(var a=0,l=r.length;a<l;++a)if((s=r[a]).type===i.type&&s.name===i.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=o,s.options=n),s.value=e;return}}this.addEventListener(i.type,o,n),s={type:i.type,name:i.name,value:e,listener:o,options:n},r?r.push(s):this.__on=[s]}}function zNe(i,e,n){var r=FNe(i+""),s,o=r.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,d;c<u;++c)for(s=0,d=l[c];s<o;++s)if((a=r[s]).type===d.type&&a.name===d.name)return d.value}return}for(l=e?UNe:BNe,s=0;s<o;++s)this.each(l(r[s],e,n));return this}function k6(i,e,n){var r=A6(i),s=r.CustomEvent;typeof s=="function"?s=new s(e,n):(s=r.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),i.dispatchEvent(s)}function VNe(i,e){return function(){return k6(this,i,e)}}function $Ne(i,e){return function(){return k6(this,i,e.apply(this,arguments))}}function GNe(i,e){return this.each((typeof e=="function"?$Ne:VNe)(i,e))}function*HNe(){for(var i=this._groups,e=0,n=i.length;e<n;++e)for(var r=i[e],s=0,o=r.length,a;s<o;++s)(a=r[s])&&(yield a)}var L6=[null];function oo(i,e){this._groups=i,this._parents=e}function tv(){return new oo([[document.documentElement]],L6)}function WNe(){return this}oo.prototype=tv.prototype={constructor:oo,select:yPe,selectAll:bPe,selectChild:EPe,selectChildren:RPe,filter:PPe,data:OPe,enter:NPe,exit:BPe,join:UPe,merge:zPe,selection:WNe,order:VPe,sort:$Pe,call:HPe,nodes:WPe,node:jPe,size:qPe,empty:XPe,each:KPe,attr:nNe,style:oNe,property:uNe,classed:pNe,text:vNe,html:SNe,raise:TNe,lower:MNe,append:ANe,insert:RNe,remove:NNe,clone:INe,datum:DNe,on:zNe,dispatch:GNe,[Symbol.iterator]:HNe};function Eo(i){return typeof i=="string"?new oo([[document.querySelector(i)]],[document.documentElement]):new oo([[i]],L6)}function jNe(i){let e;for(;e=i.sourceEvent;)i=e;return i}function ka(i,e){if(i=jNe(i),e===void 0&&(e=i.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=i.clientX,r.y=i.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[i.clientX-s.left-e.clientLeft,i.clientY-s.top-e.clientTop]}}return[i.pageX,i.pageY]}var nv,ti,I6,D6,dd,oU,O6,F6,B6,ck,wR,TR,y0={},U6=[],qNe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Rw=Array.isArray;function Va(i,e){for(var n in e)i[n]=e[n];return i}function uk(i){i&&i.parentNode&&i.parentNode.removeChild(i)}function XNe(i,e,n){var r,s,o,a={};for(o in e)o=="key"?r=e[o]:o=="ref"?s=e[o]:a[o]=e[o];if(arguments.length>2&&(a.children=arguments.length>3?nv.call(arguments,2):n),typeof i=="function"&&i.defaultProps!=null)for(o in i.defaultProps)a[o]==null&&(a[o]=i.defaultProps[o]);return ny(i,a,r,s,null)}function ny(i,e,n,r,s){var o={type:i,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++I6,__i:-1,__u:0};return s==null&&ti.vnode!=null&&ti.vnode(o),o}function Pw(i){return i.children}function Q_(i,e){this.props=i,this.context=e}function Op(i,e){if(e==null)return i.__?Op(i.__,i.__i+1):null;for(var n;e<i.__k.length;e++)if((n=i.__k[e])!=null&&n.__e!=null)return n.__e;return typeof i.type=="function"?Op(i):null}function z6(i){var e,n;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((n=i.__k[e])!=null&&n.__e!=null){i.__e=i.__c.base=n.__e;break}return z6(i)}}function aU(i){(!i.__d&&(i.__d=!0)&&dd.push(i)&&!T1.__r++||oU!=ti.debounceRendering)&&((oU=ti.debounceRendering)||O6)(T1)}function T1(){for(var i,e,n,r,s,o,a,l=1;dd.length;)dd.length>l&&dd.sort(F6),i=dd.shift(),l=dd.length,i.__d&&(n=void 0,s=(r=(e=i).__v).__e,o=[],a=[],e.__P&&((n=Va({},r)).__v=r.__v+1,ti.vnode&&ti.vnode(n),dk(e.__P,n,r,e.__n,e.__P.namespaceURI,32&r.__u?[s]:null,o,s??Op(r),!!(32&r.__u),a),n.__v=r.__v,n.__.__k[n.__i]=n,G6(o,n,a),n.__e!=s&&z6(n)));T1.__r=0}function V6(i,e,n,r,s,o,a,l,c,u,d){var h,f,p,m,y,v,g=r&&r.__k||U6,_=e.length;for(c=KNe(n,e,g,c,_),h=0;h<_;h++)(p=n.__k[h])!=null&&(f=p.__i==-1?y0:g[p.__i]||y0,p.__i=h,v=dk(i,p,f,s,o,a,l,c,u,d),m=p.__e,p.ref&&f.ref!=p.ref&&(f.ref&&hk(f.ref,null,p),d.push(p.ref,p.__c||m,p)),y==null&&m!=null&&(y=m),4&p.__u||f.__k===p.__k?c=$6(p,c,i):typeof p.type=="function"&&v!==void 0?c=v:m&&(c=m.nextSibling),p.__u&=-7);return n.__e=y,c}function KNe(i,e,n,r,s){var o,a,l,c,u,d=n.length,h=d,f=0;for(i.__k=new Array(s),o=0;o<s;o++)(a=e[o])!=null&&typeof a!="boolean"&&typeof a!="function"?(c=o+f,(a=i.__k[o]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?ny(null,a,null,null,null):Rw(a)?ny(Pw,{children:a},null,null,null):a.constructor==null&&a.__b>0?ny(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=i,a.__b=i.__b+1,l=null,(u=a.__i=YNe(a,n,c,h))!=-1&&(h--,(l=n[u])&&(l.__u|=2)),l==null||l.__v==null?(u==-1&&(s>d?f--:s<d&&f++),typeof a.type!="function"&&(a.__u|=4)):u!=c&&(u==c-1?f--:u==c+1?f++:(u>c?f--:f++,a.__u|=4))):i.__k[o]=null;if(h)for(o=0;o<d;o++)(l=n[o])!=null&&!(2&l.__u)&&(l.__e==r&&(r=Op(l)),W6(l,l));return r}function $6(i,e,n){var r,s;if(typeof i.type=="function"){for(r=i.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=i,e=$6(r[s],e,n));return e}i.__e!=e&&(e&&i.type&&!n.contains(e)&&(e=Op(i)),n.insertBefore(i.__e,e||null),e=i.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function YNe(i,e,n,r){var s,o,a=i.key,l=i.type,c=e[n];if(c===null&&i.key==null||c&&a==c.key&&l==c.type&&!(2&c.__u))return n;if(r>(c!=null&&!(2&c.__u)?1:0))for(s=n-1,o=n+1;s>=0||o<e.length;){if(s>=0){if((c=e[s])&&!(2&c.__u)&&a==c.key&&l==c.type)return s;s--}if(o<e.length){if((c=e[o])&&!(2&c.__u)&&a==c.key&&l==c.type)return o;o++}}return-1}function lU(i,e,n){e[0]=="-"?i.setProperty(e,n??""):i[e]=n==null?"":typeof n!="number"||qNe.test(e)?n:n+"px"}function l_(i,e,n,r,s){var o;e:if(e=="style")if(typeof n=="string")i.style.cssText=n;else{if(typeof r=="string"&&(i.style.cssText=r=""),r)for(e in r)n&&e in n||lU(i.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||lU(i.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(B6,"$1")),e=e.toLowerCase()in i||e=="onFocusOut"||e=="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),i.l||(i.l={}),i.l[e+o]=n,n?r?n.u=r.u:(n.u=ck,i.addEventListener(e,o?TR:wR,o)):i.removeEventListener(e,o?TR:wR,o);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in i)try{i[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?i.removeAttribute(e):i.setAttribute(e,e=="popover"&&n==1?"":n))}}function cU(i){return function(e){if(this.l){var n=this.l[e.type+i];if(e.t==null)e.t=ck++;else if(e.t<n.u)return;return n(ti.event?ti.event(e):e)}}}function dk(i,e,n,r,s,o,a,l,c,u){var d,h,f,p,m,y,v,g,_,x,b,S,T,w,E,A,M,R=e.type;if(e.constructor!=null)return null;128&n.__u&&(c=!!(32&n.__u),o=[l=e.__e=n.__e]),(d=ti.__b)&&d(e);e:if(typeof R=="function")try{if(g=e.props,_="prototype"in R&&R.prototype.render,x=(d=R.contextType)&&r[d.__c],b=d?x?x.props.value:d.__:r,n.__c?v=(h=e.__c=n.__c).__=h.__E:(_?e.__c=h=new R(g,b):(e.__c=h=new Q_(g,b),h.constructor=R,h.render=QNe),x&&x.sub(h),h.props=g,h.state||(h.state={}),h.context=b,h.__n=r,f=h.__d=!0,h.__h=[],h._sb=[]),_&&h.__s==null&&(h.__s=h.state),_&&R.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=Va({},h.__s)),Va(h.__s,R.getDerivedStateFromProps(g,h.__s))),p=h.props,m=h.state,h.__v=e,f)_&&R.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),_&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(_&&R.getDerivedStateFromProps==null&&g!==p&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(g,b),!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(g,h.__s,b)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(h.props=g,h.state=h.__s,h.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(F){F&&(F.__=e)}),S=0;S<h._sb.length;S++)h.__h.push(h._sb[S]);h._sb=[],h.__h.length&&a.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(g,h.__s,b),_&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(p,m,y)})}if(h.context=b,h.props=g,h.__P=i,h.__e=!1,T=ti.__r,w=0,_){for(h.state=h.__s,h.__d=!1,T&&T(e),d=h.render(h.props,h.state,h.context),E=0;E<h._sb.length;E++)h.__h.push(h._sb[E]);h._sb=[]}else do h.__d=!1,T&&T(e),d=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++w<25);h.state=h.__s,h.getChildContext!=null&&(r=Va(Va({},r),h.getChildContext())),_&&!f&&h.getSnapshotBeforeUpdate!=null&&(y=h.getSnapshotBeforeUpdate(p,m)),A=d,d!=null&&d.type===Pw&&d.key==null&&(A=H6(d.props.children)),l=V6(i,Rw(A)?A:[A],e,n,r,s,o,a,l,c,u),h.base=e.__e,e.__u&=-161,h.__h.length&&a.push(h),v&&(h.__E=h.__=null)}catch(F){if(e.__v=null,c||o!=null)if(F.then){for(e.__u|=c?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;o[o.indexOf(l)]=null,e.__e=l}else for(M=o.length;M--;)uk(o[M]);else e.__e=n.__e,e.__k=n.__k;ti.__e(F,e,n)}else o==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=ZNe(n.__e,e,n,r,s,o,a,c,u);return(d=ti.diffed)&&d(e),128&e.__u?void 0:l}function G6(i,e,n){for(var r=0;r<n.length;r++)hk(n[r],n[++r],n[++r]);ti.__c&&ti.__c(e,i),i.some(function(s){try{i=s.__h,s.__h=[],i.some(function(o){o.call(s)})}catch(o){ti.__e(o,s.__v)}})}function H6(i){return typeof i!="object"||i==null||i.__b&&i.__b>0?i:Rw(i)?i.map(H6):Va({},i)}function ZNe(i,e,n,r,s,o,a,l,c){var u,d,h,f,p,m,y,v=n.props,g=e.props,_=e.type;if(_=="svg"?s="http://www.w3.org/2000/svg":_=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),o!=null){for(u=0;u<o.length;u++)if((p=o[u])&&"setAttribute"in p==!!_&&(_?p.localName==_:p.nodeType==3)){i=p,o[u]=null;break}}if(i==null){if(_==null)return document.createTextNode(g);i=document.createElementNS(s,_,g.is&&g),l&&(ti.__m&&ti.__m(e,o),l=!1),o=null}if(_==null)v===g||l&&i.data==g||(i.data=g);else{if(o=o&&nv.call(i.childNodes),v=n.props||y0,!l&&o!=null)for(v={},u=0;u<i.attributes.length;u++)v[(p=i.attributes[u]).name]=p.value;for(u in v)if(p=v[u],u!="children"){if(u=="dangerouslySetInnerHTML")h=p;else if(!(u in g)){if(u=="value"&&"defaultValue"in g||u=="checked"&&"defaultChecked"in g)continue;l_(i,u,null,p,s)}}for(u in g)p=g[u],u=="children"?f=p:u=="dangerouslySetInnerHTML"?d=p:u=="value"?m=p:u=="checked"?y=p:l&&typeof p!="function"||v[u]===p||l_(i,u,p,v[u],s);if(d)l||h&&(d.__html==h.__html||d.__html==i.innerHTML)||(i.innerHTML=d.__html),e.__k=[];else if(h&&(i.innerHTML=""),V6(e.type=="template"?i.content:i,Rw(f)?f:[f],e,n,r,_=="foreignObject"?"http://www.w3.org/1999/xhtml":s,o,a,o?o[0]:n.__k&&Op(n,0),l,c),o!=null)for(u=o.length;u--;)uk(o[u]);l||(u="value",_=="progress"&&m==null?i.removeAttribute("value"):m!=null&&(m!==i[u]||_=="progress"&&!m||_=="option"&&m!=v[u])&&l_(i,u,m,v[u],s),u="checked",y!=null&&y!=i[u]&&l_(i,u,y,v[u],s))}return i}function hk(i,e,n){try{if(typeof i=="function"){var r=typeof i.__u=="function";r&&i.__u(),r&&e==null||(i.__u=i(e))}else i.current=e}catch(s){ti.__e(s,n)}}function W6(i,e,n){var r,s;if(ti.unmount&&ti.unmount(i),(r=i.ref)&&(r.current&&r.current!=i.__e||hk(r,null,e)),(r=i.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){ti.__e(o,e)}r.base=r.__P=null}if(r=i.__k)for(s=0;s<r.length;s++)r[s]&&W6(r[s],e,n||typeof i.type!="function");n||uk(i.__e),i.__c=i.__=i.__e=void 0}function QNe(i,e,n){return this.constructor(i,n)}function JNe(i,e,n){var r,s,o,a;e==document&&(e=document.documentElement),ti.__&&ti.__(i,e),s=(r=typeof n=="function")?null:n&&n.__k||e.__k,o=[],a=[],dk(e,i=(!r&&n||e).__k=XNe(Pw,null,[i]),s||y0,y0,e.namespaceURI,!r&&n?[n]:s?null:e.firstChild?nv.call(e.childNodes):null,o,!r&&n?n:s?s.__e:e.firstChild,r,a),G6(o,i,a)}function j6(i,e,n){var r,s,o,a,l=Va({},i.props);for(o in i.type&&i.type.defaultProps&&(a=i.type.defaultProps),e)o=="key"?r=e[o]:o=="ref"?s=e[o]:l[o]=e[o]==null&&a!=null?a[o]:e[o];return arguments.length>2&&(l.children=arguments.length>3?nv.call(arguments,2):n),ny(i.type,l,r||i.key,s||i.ref,null)}nv=U6.slice,ti={__e:function(i,e,n,r){for(var s,o,a;e=e.__;)if((s=e.__c)&&!s.__)try{if((o=s.constructor)&&o.getDerivedStateFromError!=null&&(s.setState(o.getDerivedStateFromError(i)),a=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,r||{}),a=s.__d),a)return s.__E=s}catch(l){i=l}throw i}},I6=0,D6=function(i){return i!=null&&i.constructor==null},Q_.prototype.setState=function(i,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Va({},this.state),typeof i=="function"&&(i=i(Va({},n),this.props)),i&&Va(n,i),i!=null&&this.__v&&(e&&this._sb.push(e),aU(this))},Q_.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),aU(this))},Q_.prototype.render=Pw,dd=[],O6=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,F6=function(i,e){return i.__v.__b-e.__v.__b},T1.__r=0,B6=/(PointerCapture)$|Capture$/i,ck=0,wR=cU(!1),TR=cU(!0);function uU(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function e2e(i){if(Array.isArray(i))return i}function t2e(i,e,n){return(e=a2e(e))in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function n2e(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function i2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dU(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),n.push.apply(n,r)}return n}function r2e(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dU(Object(n),!0).forEach(function(r){t2e(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):dU(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}function s2e(i,e){return e2e(i)||n2e(i,e)||l2e(i,e)||i2e()}function o2e(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function a2e(i){var e=o2e(i,"string");return typeof e=="symbol"?e:e+""}function E1(i){"@babel/helpers - typeof";return E1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E1(i)}function l2e(i,e){if(i){if(typeof i=="string")return uU(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uU(i,e):void 0}}var ER=function(e){if(E1(e)!=="object")return e;var n=j6(e);if(n.props){var r;n.props=r2e({},n.props),n!=null&&(r=n.props)!==null&&r!==void 0&&r.children&&(n.props.children=Array.isArray(n.props.children)?n.props.children.map(ER):ER(n.props.children))}return n},c2e=function(e){return D6(j6(e))},u2e=function(e,n){delete n.__k,JNe(ER(e),n)};function d2e(i,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var h2e=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;d2e(h2e);var q6=Au({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=r.style,o=s===void 0?{}:s,a=!!e&&E1(e)==="object"&&!!e.node&&typeof e.node=="function",l=Eo(a?e.node():e);l.style("position")==="static"&&l.style("position","relative"),n.tooltipEl=l.append("div").attr("class","float-tooltip-kap"),Object.entries(o).forEach(function(u){var d=s2e(u,2),h=d[0],f=d[1];return n.tooltipEl.style(h,f)}),n.tooltipEl.style("left","-10000px").style("display","none");var c="tooltip-".concat(Math.round(Math.random()*1e12));n.mouseInside=!1,l.on("mousemove.".concat(c),function(u){n.mouseInside=!0;var d=ka(u),h=l.node(),f=h.offsetWidth,p=h.offsetHeight,m=[n.offsetX===null||n.offsetX===void 0?"-".concat(d[0]/f*100,"%"):typeof n.offsetX=="number"?"calc(-50% + ".concat(n.offsetX,"px)"):n.offsetX,n.offsetY===null||n.offsetY===void 0?p>130&&p-d[1]<100?"calc(-100% - 6px)":"21px":typeof n.offsetY=="number"?n.offsetY<0?"calc(-100% - ".concat(Math.abs(n.offsetY),"px)"):"".concat(n.offsetY,"px"):n.offsetY];n.tooltipEl.style("left",d[0]+"px").style("top",d[1]+"px").style("transform","translate(".concat(m.join(","),")")),n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseover.".concat(c),function(){n.mouseInside=!0,n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseout.".concat(c),function(){n.mouseInside=!1,n.tooltipEl.style("display","none")})},update:function(e){e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append(function(){return e.content})):typeof e.content=="string"?e.tooltipEl.html(e.content):c2e(e.content)?(e.tooltipEl.text(""),u2e(e.content,e.tooltipEl.node())):(e.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",e.content,e.content.toString())):e.tooltipEl.text("")}});function f2e(i,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var p2e=`.scene-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;f2e(p2e);function MR(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function m2e(i){if(Array.isArray(i))return i}function g2e(i){if(Array.isArray(i))return MR(i)}function y2e(i,e,n){return(e=T2e(e))in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function v2e(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function x2e(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function _2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S2e(i,e){return m2e(i)||x2e(i,e)||X6(i,e)||_2e()}function Xu(i){return g2e(i)||v2e(i)||X6(i)||b2e()}function w2e(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function T2e(i){var e=w2e(i,"string");return typeof e=="symbol"?e:e+""}function X6(i,e){if(i){if(typeof i=="string")return MR(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MR(i,e):void 0}}var Qn=window.THREE?window.THREE:{WebGLRenderer:Bge,Scene:iw,PerspectiveCamera:ar,Raycaster:gG,SRGBColorSpace:Et,TextureLoader:Wde,Vector2:Oe,Vector3:K,Box3:Kd,Color:St,Mesh:Xn,SphereGeometry:Gd,MeshBasicMaterial:es,BackSide:On,Clock:mG},K6=Au({props:{width:{default:window.innerWidth,onChange:function(e,n,r){isNaN(e)&&(n.width=r)}},height:{default:window.innerHeight,onChange:function(e,n,r){isNaN(e)&&(n.height=r)}},viewOffset:{default:[0,0]},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null,n.tooltip&&n.tooltip.content(null)},triggerUpdate:!1},pointerRaycasterThrottleMs:{default:50,triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},pointsHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach(function(a){return a.render(e.scene,e.camera)});var n=+new Date;if(e.enablePointerInteraction&&n-e.lastRaycasterCheck>=e.pointerRaycasterThrottleMs){e.lastRaycasterCheck=n;var r=null;if(e.hoverDuringDrag||!e.isPointerDragging){var s=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y);e.hoverOrderComparator&&s.sort(function(a,l){return e.hoverOrderComparator(a.object,l.object)});var o=s.find(function(a){return e.hoverFilter(a.object)})||null;r=o?o.object:null,e.intersection=o||null}r!==e.hoverObj&&(e.onHover(r,e.hoverObj,e.intersection),e.tooltip.content(r&&yt(e.tooltipContent)(r,e.intersection)||null),e.hoverObj=r)}e.tweenGroup.update()}return this},getPointerPos:function(e){var n=e.pointerPos,r=n.x,s=n.y;return{x:r,y:s}},cameraPosition:function(e,n,r,s){var o=e.camera;if(n&&e.initialised){var a=n,l=r||{x:0,y:0,z:0};if(!s)d(a),h(l);else{var c=Object.assign({},o.position),u=f();e.tweenGroup.add(new S1(c).to(a,s).easing(ql.Quadratic.Out).onUpdate(d).start()),e.tweenGroup.add(new S1(u).to(l,s/3).easing(ql.Quadratic.Out).onUpdate(h).start())}return this}return Object.assign({},o.position,{lookAt:f()});function d(p){var m=p.x,y=p.y,v=p.z;m!==void 0&&(o.position.x=m),y!==void 0&&(o.position.y=y),v!==void 0&&(o.position.z=v)}function h(p){var m=new Qn.Vector3(p.x,p.y,p.z);e.controls.target?e.controls.target=m:o.lookAt(m)}function f(){return Object.assign(new Qn.Vector3(0,0,-1e3).applyQuaternion(o.quaternion).add(o.position))}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return this.fitToBbox(this.getBbox.apply(this,o),n,r)},fitToBbox:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,o=e.camera;if(n){var a=new Qn.Vector3(0,0,0),l=Math.max.apply(Math,Xu(Object.entries(n).map(function(p){var m=S2e(p,2),y=m[0],v=m[1];return Math.max.apply(Math,Xu(v.map(function(g){return Math.abs(a[y]-g)})))})))*2,c=(1-s*2/e.height)*o.fov,u=l/Math.atan(c*Math.PI/180),d=u/o.aspect,h=Math.max(u,d);if(h>0){var f=a.clone().sub(o.position).normalize().multiplyScalar(-h);this.cameraPosition(f,a,r)}}return this},getBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},r=new Qn.Box3(new Qn.Vector3(0,0,0),new Qn.Vector3(0,0,0)),s=e.objects.filter(n);return s.length?(s.forEach(function(o){return r.expandByObject(o)}),Object.assign.apply(Object,Xu(["x","y","z"].map(function(o){return y2e({},o,[r.min[o],r.max[o]])})))):null},getScreenCoords:function(e,n,r,s){var o=new Qn.Vector3(n,r,s);return o.project(this.camera()),{x:(o.x+1)*e.width/2,y:-(o.y-1)*e.height/2}},getSceneCoords:function(e,n,r){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=new Qn.Vector2(n/e.width*2-1,-(r/e.height)*2+1),a=new Qn.Raycaster;return a.setFromCamera(o,e.camera),Object.assign({},a.ray.at(s,new Qn.Vector3))},intersectingObjects:function(e,n,r){var s=new Qn.Vector2(n/e.width*2-1,-(r/e.height)*2+1),o=new Qn.Raycaster;return o.params.Line.threshold=e.lineHoverPrecision,o.params.Points.threshold=e.pointsHoverPrecision,o.setFromCamera(s,e.camera),o.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new Qn.Scene,camera:new Qn.PerspectiveCamera,clock:new Qn.Clock,tweenGroup:new ok,lastRaycasterCheck:0}},init:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=r.controlType,o=s===void 0?"trackball":s,a=r.useWebGPU,l=a===void 0?!1:a,c=r.rendererConfig,u=c===void 0?{}:c,d=r.extraRenderers,h=d===void 0?[]:d,f=r.waitForLoadComplete,p=f===void 0?!0:f;e.innerHTML="",e.appendChild(n.container=document.createElement("div")),n.container.className="scene-container",n.container.style.position="relative",n.container.appendChild(n.navInfo=document.createElement("div")),n.navInfo.className="scene-nav-info",n.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[o]||"",n.navInfo.style.display=n.showNavInfo?null:"none",n.tooltip=new q6(n.container),n.pointerPos=new Qn.Vector2,n.pointerPos.x=-2,n.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(m){return n.container.addEventListener(m,function(y){if(m==="pointerdown"&&(n.isPointerPressed=!0),!n.isPointerDragging&&y.type==="pointermove"&&(y.pressure>0||n.isPointerPressed)&&(y.pointerType!=="touch"||y.movementX===void 0||[y.movementX,y.movementY].some(function(_){return Math.abs(_)>1}))&&(n.isPointerDragging=!0),n.enablePointerInteraction){var v=g(n.container);n.pointerPos.x=y.pageX-v.left,n.pointerPos.y=y.pageY-v.top}function g(_){var x=_.getBoundingClientRect(),b=window.pageXOffset||document.documentElement.scrollLeft,S=window.pageYOffset||document.documentElement.scrollTop;return{top:x.top+S,left:x.left+b}}},{passive:!0})}),n.container.addEventListener("pointerup",function(m){n.isPointerPressed=!1,!(n.isPointerDragging&&(n.isPointerDragging=!1,!n.clickAfterDrag))&&requestAnimationFrame(function(){m.button===0&&n.onClick(n.hoverObj||null,m,n.intersection),m.button===2&&n.onRightClick&&n.onRightClick(n.hoverObj||null,m,n.intersection)})},{passive:!0,capture:!0}),n.container.addEventListener("contextmenu",function(m){n.onRightClick&&m.preventDefault()}),n.renderer=new(l?vRe:Qn.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},u)),n.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),n.container.appendChild(n.renderer.domElement),n.extraRenderers=h,n.extraRenderers.forEach(function(m){m.domElement.style.position="absolute",m.domElement.style.top="0px",m.domElement.style.pointerEvents="none",n.container.appendChild(m.domElement)}),n.postProcessingComposer=new dPe(n.renderer),n.postProcessingComposer.addPass(new hPe(n.scene,n.camera)),n.controls=new{trackball:_Re,orbit:ORe,fly:YRe}[o](n.camera,n.renderer.domElement),o==="fly"&&(n.controls.movementSpeed=300,n.controls.rollSpeed=Math.PI/6,n.controls.dragToLook=!0),(o==="trackball"||o==="orbit")&&(n.controls.minDistance=.1,n.controls.maxDistance=n.skyRadius,n.controls.addEventListener("start",function(){n.controlsEngaged=!0}),n.controls.addEventListener("change",function(){n.controlsEngaged&&(n.controlsDragging=!0)}),n.controls.addEventListener("end",function(){n.controlsEngaged=!1,n.controlsDragging=!1})),[n.renderer,n.postProcessingComposer].concat(Xu(n.extraRenderers)).forEach(function(m){return m.setSize(n.width,n.height)}),n.camera.aspect=n.width/n.height,n.camera.updateProjectionMatrix(),n.camera.position.z=1e3,n.scene.add(n.skysphere=new Qn.Mesh),n.skysphere.visible=!1,n.loadComplete=n.scene.visible=!p,window.scene=n.scene},update:function(e,n){if(e.width&&e.height&&(n.hasOwnProperty("width")||n.hasOwnProperty("height"))){var r,s=e.width,o=e.height;e.container.style.width="".concat(s,"px"),e.container.style.height="".concat(o,"px"),[e.renderer,e.postProcessingComposer].concat(Xu(e.extraRenderers)).forEach(function(p){return p.setSize(s,o)}),e.camera.aspect=s/o;var a=e.viewOffset.slice(0,2);a.some(function(p){return p})&&(r=e.camera).setViewOffset.apply(r,[s,o].concat(Xu(a),[s,o])),e.camera.updateProjectionMatrix()}if(n.hasOwnProperty("viewOffset")){var l,c=e.width,u=e.height,d=e.viewOffset.slice(0,2);d.some(function(p){return p})?(l=e.camera).setViewOffset.apply(l,[c,u].concat(Xu(d),[c,u])):e.camera.clearViewOffset()}if(n.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&n.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=e.skyRadius*2.5,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new Qn.SphereGeometry(e.skyRadius)),n.hasOwnProperty("backgroundColor")){var h=yu(e.backgroundColor).alpha;h===void 0&&(h=1),e.renderer.setClearColor(new Qn.Color(EH(1,e.backgroundColor)),h)}n.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?new Qn.TextureLoader().load(e.backgroundImageUrl,function(p){p.colorSpace=Qn.SRGBColorSpace,e.skysphere.material=new Qn.MeshBasicMaterial({map:p,side:Qn.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&f()}):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&f())),n.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),n.hasOwnProperty("lights")&&((n.lights||[]).forEach(function(p){return e.scene.remove(p)}),e.lights.forEach(function(p){return e.scene.add(p)})),n.hasOwnProperty("objects")&&((n.objects||[]).forEach(function(p){return e.scene.remove(p)}),e.objects.forEach(function(p){return e.scene.add(p)}));function f(){e.loadComplete=e.scene.visible=!0}}});function E2e(i,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var M2e=`.graph-info-msg {
  top: 50%;
  width: 100%;
  text-align: center;
  color: lavender;
  opacity: 0.7;
  font-size: 22px;
  position: absolute;
  font-family: Sans-serif;
}

.scene-container .clickable {
  cursor: pointer;
}

.scene-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.scene-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}`;E2e(M2e);function AR(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function A2e(i){if(Array.isArray(i))return AR(i)}function iv(i,e,n){return(e=N2e(e))in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function C2e(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function R2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hU(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),n.push.apply(n,r)}return n}function c_(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?hU(Object(n),!0).forEach(function(r){iv(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):hU(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}function Nw(i){return A2e(i)||C2e(i)||k2e(i)||R2e()}function P2e(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function N2e(i){var e=P2e(i,"string");return typeof e=="symbol"?e:e+""}function k2e(i,e){if(i){if(typeof i=="string")return AR(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?AR(i,e):void 0}}function Y6(i,e){var n=new e;return n._destructor&&n._destructor(),{linkProp:function(s){return{default:n[s](),onChange:function(a,l){l[i][s](a)},triggerUpdate:!1}},linkMethod:function(s){return function(o){for(var a=o[i],l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];var d=a[s].apply(a,c);return d===a?this:d}}}}var JM=window.THREE?window.THREE:{AmbientLight:fG,DirectionalLight:hG,REVISION:tm},L2e=170,Z6=Y6("forceGraph",bf),I2e=Object.assign.apply(Object,Nw(["jsonUrl","graphData","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeColor","nodeAutoColorBy","nodeOpacity","nodeVisibility","nodeThreeObject","nodeThreeObjectExtend","nodePositionUpdate","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaDecay","d3VelocityDecay","d3AlphaMin","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(i){return iv({},i,Z6.linkProp(i))}))),D2e=Object.assign.apply(Object,Nw(["refresh","getGraphBbox","d3Force","d3ReheatSimulation","emitParticle"].map(function(i){return iv({},i,Z6.linkMethod(i))}))),J_=Y6("renderObjs",K6),O2e=Object.assign.apply(Object,Nw(["width","height","backgroundColor","showNavInfo","enablePointerInteraction"].map(function(i){return iv({},i,J_.linkProp(i))}))),F2e=Object.assign.apply(Object,Nw(["lights","cameraPosition","postProcessingComposer"].map(function(i){return iv({},i,J_.linkMethod(i))})).concat([{graph2ScreenCoords:J_.linkMethod("getScreenCoords"),screen2GraphCoords:J_.linkMethod("getSceneCoords")}])),B2e=Au({props:c_(c_({nodeLabel:{default:"name",triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:1,onChange:function(e,n){return n.renderObjs.lineHoverPrecision(e)},triggerUpdate:!1},enableNavigationControls:{default:!0,onChange:function(e,n){var r=n.renderObjs.controls();r&&(r.enabled=e,e&&r.domElement&&r.domElement.dispatchEvent(new PointerEvent("pointerup")))},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1}},I2e),O2e),methods:c_(c_({zoomToFit:function(e,n,r){for(var s,o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return e.renderObjs.fitToBbox((s=e.forceGraph).getGraphBbox.apply(s,a),n,r),this},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),this},_animationCycle:function(e){e.enablePointerInteraction&&(this.renderer().domElement.style.cursor=null),e.forceGraph.tickFrame(),e.renderObjs.tick(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},tbControls:function(e){return e.renderObjs.tbControls()},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},D2e),F2e),stateInit:function(e){var n=e.controlType,r=e.rendererConfig,s=e.extraRenderers,o=new bf;return{forceGraph:o,renderObjs:K6({controlType:n,rendererConfig:r,extraRenderers:s}).objects([o]).lights([new JM.AmbientLight(13421772,Math.PI),new JM.DirectionalLight(16777215,.6*Math.PI)])}},init:function(e,n){e.innerHTML="",e.appendChild(n.container=document.createElement("div")),n.container.style.position="relative";var r=document.createElement("div");n.container.appendChild(r),n.renderObjs(r);var s=n.renderObjs.camera(),o=n.renderObjs.renderer(),a=n.renderObjs.controls();a.enabled=!!n.enableNavigationControls,n.lastSetCameraZ=s.position.z;var l;n.container.appendChild(l=document.createElement("div")),l.className="graph-info-msg",l.textContent="",n.forceGraph.onLoading(function(){l.textContent="Loading..."}).onFinishLoading(function(){l.textContent=""}).onUpdate(function(){n.graphData=n.forceGraph.graphData(),s.position.x===0&&s.position.y===0&&s.position.z===n.lastSetCameraZ&&n.graphData.nodes.length&&(s.lookAt(n.forceGraph.position),n.lastSetCameraZ=s.position.z=Math.cbrt(n.graphData.nodes.length)*L2e)}).onFinishUpdate(function(){if(n._dragControls){var c=n.graphData.nodes.find(function(d){return d.__initialFixedPos&&!d.__disposeControlsAfterDrag});c?c.__disposeControlsAfterDrag=!0:n._dragControls.dispose(),n._dragControls=void 0}if(n.enableNodeDrag&&n.enablePointerInteraction&&n.forceEngine==="d3"){var u=n._dragControls=new lbe(n.graphData.nodes.map(function(d){return d.__threeObj}).filter(function(d){return d}),s,o.domElement);u.addEventListener("dragstart",function(d){var h=vl(d.object);if(h){a.enabled=!1,d.object.__initialPos=d.object.position.clone(),d.object.__prevPos=d.object.position.clone();var f=h.__data;!f.__initialFixedPos&&(f.__initialFixedPos={fx:f.fx,fy:f.fy,fz:f.fz}),!f.__initialPos&&(f.__initialPos={x:f.x,y:f.y,z:f.z}),["x","y","z"].forEach(function(p){return f["f".concat(p)]=f[p]}),o.domElement.classList.add("grabbable")}}),u.addEventListener("drag",function(d){var h=vl(d.object);if(h){if(!d.object.hasOwnProperty("__graphObjType")){var f=d.object.__initialPos,p=d.object.__prevPos,m=d.object.position;h.position.add(m.clone().sub(p)),p.copy(m),m.copy(f)}var y=h.__data,v=h.position,g={x:v.x-y.x,y:v.y-y.y,z:v.z-y.z};["x","y","z"].forEach(function(_){return y["f".concat(_)]=y[_]=v[_]}),n.forceGraph.d3AlphaTarget(.3).resetCountdown(),y.__dragged=!0,n.onNodeDrag(y,g)}}),u.addEventListener("dragend",function(d){var h=vl(d.object);if(h){delete d.object.__initialPos,delete d.object.__prevPos;var f=h.__data;f.__disposeControlsAfterDrag&&(u.dispose(),delete f.__disposeControlsAfterDrag);var p=f.__initialFixedPos,m=f.__initialPos,y={x:m.x-f.x,y:m.y-f.y,z:m.z-f.z};p&&(["x","y","z"].forEach(function(v){var g="f".concat(v);p[g]===void 0&&delete f[g]}),delete f.__initialFixedPos,delete f.__initialPos,f.__dragged&&(delete f.__dragged,n.onNodeDragEnd(f,y))),n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.enableNavigationControls&&(a.enabled=!0,a.domElement&&a.domElement.ownerDocument&&a.domElement.ownerDocument.dispatchEvent(new PointerEvent("pointerup",{pointerType:"touch"}))),o.domElement.classList.remove("grabbable")}})}}),JM.REVISION<155&&(n.renderObjs.renderer().useLegacyLights=!1),n.renderObjs.hoverOrderComparator(function(c,u){var d=vl(c);if(!d)return 1;var h=vl(u);if(!h)return-1;var f=function(m){return m.__graphObjType==="node"};return f(h)-f(d)}).tooltipContent(function(c){var u=vl(c);return u&&yt(n["".concat(u.__graphObjType,"Label")])(u.__data)||""}).hoverDuringDrag(!1).onHover(function(c){var u=vl(c);if(u!==n.hoverObj){var d=n.hoverObj?n.hoverObj.__graphObjType:null,h=n.hoverObj?n.hoverObj.__data:null,f=u?u.__graphObjType:null,p=u?u.__data:null;if(d&&d!==f){var m=n["on".concat(d==="node"?"Node":"Link","Hover")];m&&m(null,h)}if(f){var y=n["on".concat(f==="node"?"Node":"Link","Hover")];y&&y(p,d===f?h:null)}o.domElement.classList[u&&n["on".concat(f==="node"?"Node":"Link","Click")]||!u&&n.onBackgroundClick?"add":"remove"]("clickable"),n.hoverObj=u}}).clickAfterDrag(!1).onClick(function(c,u){var d=vl(c);if(d){var h=n["on".concat(d.__graphObjType==="node"?"Node":"Link","Click")];h&&h(d.__data,u)}else n.onBackgroundClick&&n.onBackgroundClick(u)}).onRightClick(function(c,u){var d=vl(c);if(d){var h=n["on".concat(d.__graphObjType==="node"?"Node":"Link","RightClick")];h&&h(d.__data,u)}else n.onBackgroundRightClick&&n.onBackgroundRightClick(u)}),this._animationCycle()}});function vl(i){for(var e=i;e&&!e.hasOwnProperty("__graphObjType");)e=e.parent;return e}const U2e={passive:!1},v0={capture:!0,passive:!1};function eA(i){i.stopImmediatePropagation()}function Zf(i){i.preventDefault(),i.stopImmediatePropagation()}function Q6(i){var e=i.document.documentElement,n=Eo(i).on("dragstart.drag",Zf,v0);"onselectstart"in e?n.on("selectstart.drag",Zf,v0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function J6(i,e){var n=i.document.documentElement,r=Eo(i).on("dragstart.drag",null);e&&(r.on("click.drag",Zf,v0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const u_=i=>()=>i;function CR(i,{sourceEvent:e,subject:n,target:r,identifier:s,active:o,x:a,y:l,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:i,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}CR.prototype.on=function(){var i=this._.on.apply(this._,arguments);return i===this._?this:i};function z2e(i){return!i.ctrlKey&&!i.button}function V2e(){return this.parentNode}function $2e(i,e){return e??{x:i.x,y:i.y}}function G2e(){return navigator.maxTouchPoints||"ontouchstart"in this}function H2e(){var i=z2e,e=V2e,n=$2e,r=G2e,s={},o=q0("start","drag","end"),a=0,l,c,u,d,h=0;function f(b){b.on("mousedown.drag",p).filter(r).on("touchstart.drag",v).on("touchmove.drag",g,U2e).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(b,S){if(!(d||!i.call(this,b,S))){var T=x(this,e.call(this,b,S),b,S,"mouse");T&&(Eo(b.view).on("mousemove.drag",m,v0).on("mouseup.drag",y,v0),Q6(b.view),eA(b),u=!1,l=b.clientX,c=b.clientY,T("start",b))}}function m(b){if(Zf(b),!u){var S=b.clientX-l,T=b.clientY-c;u=S*S+T*T>h}s.mouse("drag",b)}function y(b){Eo(b.view).on("mousemove.drag mouseup.drag",null),J6(b.view,u),Zf(b),s.mouse("end",b)}function v(b,S){if(i.call(this,b,S)){var T=b.changedTouches,w=e.call(this,b,S),E=T.length,A,M;for(A=0;A<E;++A)(M=x(this,w,b,S,T[A].identifier,T[A]))&&(eA(b),M("start",b,T[A]))}}function g(b){var S=b.changedTouches,T=S.length,w,E;for(w=0;w<T;++w)(E=s[S[w].identifier])&&(Zf(b),E("drag",b,S[w]))}function _(b){var S=b.changedTouches,T=S.length,w,E;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),w=0;w<T;++w)(E=s[S[w].identifier])&&(eA(b),E("end",b,S[w]))}function x(b,S,T,w,E,A){var M=o.copy(),R=ka(A||T,S),F,B,C;if((C=n.call(b,new CR("beforestart",{sourceEvent:T,target:f,identifier:E,active:a,x:R[0],y:R[1],dx:0,dy:0,dispatch:M}),w))!=null)return F=C.x-R[0]||0,B=C.y-R[1]||0,function L(P,W,D){var X=R,q;switch(P){case"start":s[E]=L,q=a++;break;case"end":delete s[E],--a;case"drag":R=ka(D||W,S),q=a;break}M.call(P,b,new CR(P,{sourceEvent:W,subject:C,target:f,identifier:E,active:q,x:R[0]+F,y:R[1]+B,dx:R[0]-X[0],dy:R[1]-X[1],dispatch:M}),w)}}return f.filter=function(b){return arguments.length?(i=typeof b=="function"?b:u_(!!b),f):i},f.container=function(b){return arguments.length?(e=typeof b=="function"?b:u_(b),f):e},f.subject=function(b){return arguments.length?(n=typeof b=="function"?b:u_(b),f):n},f.touchable=function(b){return arguments.length?(r=typeof b=="function"?b:u_(!!b),f):r},f.on=function(){var b=o.on.apply(o,arguments);return b===o?f:b},f.clickDistance=function(b){return arguments.length?(h=(b=+b)*b,f):Math.sqrt(h)},f}var W2e=q0("start","end","cancel","interrupt"),j2e=[],eW=0,fU=1,RR=2,eb=3,pU=4,PR=5,tb=6;function kw(i,e,n,r,s,o){var a=i.__transition;if(!a)i.__transition={};else if(n in a)return;q2e(i,n,{name:e,index:r,group:s,on:W2e,tween:j2e,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:eW})}function fk(i,e){var n=Sa(i,e);if(n.state>eW)throw new Error("too late; already scheduled");return n}function el(i,e){var n=Sa(i,e);if(n.state>eb)throw new Error("too late; already running");return n}function Sa(i,e){var n=i.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function q2e(i,e,n){var r=i.__transition,s;r[e]=n,n.timer=y2(o,0,n.time);function o(u){n.state=fU,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var d,h,f,p;if(n.state!==fU)return c();for(d in r)if(p=r[d],p.name===n.name){if(p.state===eb)return NF(a);p.state===pU?(p.state=tb,p.timer.stop(),p.on.call("interrupt",i,i.__data__,p.index,p.group),delete r[d]):+d<e&&(p.state=tb,p.timer.stop(),p.on.call("cancel",i,i.__data__,p.index,p.group),delete r[d])}if(NF(function(){n.state===eb&&(n.state=pU,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=RR,n.on.call("start",i,i.__data__,n.index,n.group),n.state===RR){for(n.state=eb,s=new Array(f=n.tween.length),d=0,h=-1;d<f;++d)(p=n.tween[d].value.call(i,i.__data__,n.index,n.group))&&(s[++h]=p);s.length=h+1}}function l(u){for(var d=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=PR,1),h=-1,f=s.length;++h<f;)s[h].call(i,d);n.state===PR&&(n.on.call("end",i,i.__data__,n.index,n.group),c())}function c(){n.state=tb,n.timer.stop(),delete r[e];for(var u in r)return;delete i.__transition}}function nb(i,e){var n=i.__transition,r,s,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){o=!1;continue}s=r.state>RR&&r.state<PR,r.state=tb,r.timer.stop(),r.on.call(s?"interrupt":"cancel",i,i.__data__,r.index,r.group),delete n[a]}o&&delete i.__transition}}function X2e(i){return this.each(function(){nb(this,i)})}function K2e(i,e){var n,r;return function(){var s=el(this,i),o=s.tween;if(o!==n){r=n=o;for(var a=0,l=r.length;a<l;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function Y2e(i,e,n){var r,s;if(typeof n!="function")throw new Error;return function(){var o=el(this,i),a=o.tween;if(a!==r){s=(r=a).slice();for(var l={name:e,value:n},c=0,u=s.length;c<u;++c)if(s[c].name===e){s[c]=l;break}c===u&&s.push(l)}o.tween=s}}function Z2e(i,e){var n=this._id;if(i+="",arguments.length<2){for(var r=Sa(this.node(),n).tween,s=0,o=r.length,a;s<o;++s)if((a=r[s]).name===i)return a.value;return null}return this.each((e==null?K2e:Y2e)(n,i,e))}function pk(i,e,n){var r=i._id;return i.each(function(){var s=el(this,r);(s.value||(s.value={}))[e]=n.apply(this,arguments)}),function(s){return Sa(s,r).value[e]}}function tW(i,e){var n;return(typeof e=="number"?Vc:e instanceof a0?n3:(n=a0(e))?(e=n,n3):lxe)(i,e)}function Q2e(i){return function(){this.removeAttribute(i)}}function J2e(i){return function(){this.removeAttributeNS(i.space,i.local)}}function eke(i,e,n){var r,s=n+"",o;return function(){var a=this.getAttribute(i);return a===s?null:a===r?o:o=e(r=a,n)}}function tke(i,e,n){var r,s=n+"",o;return function(){var a=this.getAttributeNS(i.space,i.local);return a===s?null:a===r?o:o=e(r=a,n)}}function nke(i,e,n){var r,s,o;return function(){var a,l=n(this),c;return l==null?void this.removeAttribute(i):(a=this.getAttribute(i),c=l+"",a===c?null:a===r&&c===s?o:(s=c,o=e(r=a,l)))}}function ike(i,e,n){var r,s,o;return function(){var a,l=n(this),c;return l==null?void this.removeAttributeNS(i.space,i.local):(a=this.getAttributeNS(i.space,i.local),c=l+"",a===c?null:a===r&&c===s?o:(s=c,o=e(r=a,l)))}}function rke(i,e){var n=Cw(i),r=n==="transform"?hxe:tW;return this.attrTween(i,typeof e=="function"?(n.local?ike:nke)(n,r,pk(this,"attr."+i,e)):e==null?(n.local?J2e:Q2e)(n):(n.local?tke:eke)(n,r,e))}function ske(i,e){return function(n){this.setAttribute(i,e.call(this,n))}}function oke(i,e){return function(n){this.setAttributeNS(i.space,i.local,e.call(this,n))}}function ake(i,e){var n,r;function s(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&oke(i,o)),n}return s._value=e,s}function lke(i,e){var n,r;function s(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&ske(i,o)),n}return s._value=e,s}function cke(i,e){var n="attr."+i;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Cw(i);return this.tween(n,(r.local?ake:lke)(r,e))}function uke(i,e){return function(){fk(this,i).delay=+e.apply(this,arguments)}}function dke(i,e){return e=+e,function(){fk(this,i).delay=e}}function hke(i){var e=this._id;return arguments.length?this.each((typeof i=="function"?uke:dke)(e,i)):Sa(this.node(),e).delay}function fke(i,e){return function(){el(this,i).duration=+e.apply(this,arguments)}}function pke(i,e){return e=+e,function(){el(this,i).duration=e}}function mke(i){var e=this._id;return arguments.length?this.each((typeof i=="function"?fke:pke)(e,i)):Sa(this.node(),e).duration}function gke(i,e){if(typeof e!="function")throw new Error;return function(){el(this,i).ease=e}}function yke(i){var e=this._id;return arguments.length?this.each(gke(e,i)):Sa(this.node(),e).ease}function vke(i,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;el(this,i).ease=n}}function xke(i){if(typeof i!="function")throw new Error;return this.each(vke(this._id,i))}function _ke(i){typeof i!="function"&&(i=T6(i));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var o=e[s],a=o.length,l=r[s]=[],c,u=0;u<a;++u)(c=o[u])&&i.call(c,c.__data__,u,o)&&l.push(c);return new rc(r,this._parents,this._name,this._id)}function bke(i){if(i._id!==this._id)throw new Error;for(var e=this._groups,n=i._groups,r=e.length,s=n.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var c=e[l],u=n[l],d=c.length,h=a[l]=new Array(d),f,p=0;p<d;++p)(f=c[p]||u[p])&&(h[p]=f);for(;l<r;++l)a[l]=e[l];return new rc(a,this._parents,this._name,this._id)}function Ske(i){return(i+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function wke(i,e,n){var r,s,o=Ske(e)?fk:el;return function(){var a=o(this,i),l=a.on;l!==r&&(s=(r=l).copy()).on(e,n),a.on=s}}function Tke(i,e){var n=this._id;return arguments.length<2?Sa(this.node(),n).on.on(i):this.each(wke(n,i,e))}function Eke(i){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==i)return;e&&e.removeChild(this)}}function Mke(){return this.on("end.remove",Eke(this._id))}function Ake(i){var e=this._name,n=this._id;typeof i!="function"&&(i=ak(i));for(var r=this._groups,s=r.length,o=new Array(s),a=0;a<s;++a)for(var l=r[a],c=l.length,u=o[a]=new Array(c),d,h,f=0;f<c;++f)(d=l[f])&&(h=i.call(d,d.__data__,f,l))&&("__data__"in d&&(h.__data__=d.__data__),u[f]=h,kw(u[f],e,n,f,u,Sa(d,n)));return new rc(o,this._parents,e,n)}function Cke(i){var e=this._name,n=this._id;typeof i!="function"&&(i=w6(i));for(var r=this._groups,s=r.length,o=[],a=[],l=0;l<s;++l)for(var c=r[l],u=c.length,d,h=0;h<u;++h)if(d=c[h]){for(var f=i.call(d,d.__data__,h,c),p,m=Sa(d,n),y=0,v=f.length;y<v;++y)(p=f[y])&&kw(p,e,n,y,f,m);o.push(f),a.push(d)}return new rc(o,a,e,n)}var Rke=tv.prototype.constructor;function Pke(){return new Rke(this._groups,this._parents)}function Nke(i,e){var n,r,s;return function(){var o=Dp(this,i),a=(this.style.removeProperty(i),Dp(this,i));return o===a?null:o===n&&a===r?s:s=e(n=o,r=a)}}function nW(i){return function(){this.style.removeProperty(i)}}function kke(i,e,n){var r,s=n+"",o;return function(){var a=Dp(this,i);return a===s?null:a===r?o:o=e(r=a,n)}}function Lke(i,e,n){var r,s,o;return function(){var a=Dp(this,i),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(i),Dp(this,i))),a===c?null:a===r&&c===s?o:(s=c,o=e(r=a,l))}}function Ike(i,e){var n,r,s,o="style."+e,a="end."+o,l;return function(){var c=el(this,i),u=c.on,d=c.value[o]==null?l||(l=nW(e)):void 0;(u!==n||s!==d)&&(r=(n=u).copy()).on(a,s=d),c.on=r}}function Dke(i,e,n){var r=(i+="")=="transform"?dxe:tW;return e==null?this.styleTween(i,Nke(i,r)).on("end.style."+i,nW(i)):typeof e=="function"?this.styleTween(i,Lke(i,r,pk(this,"style."+i,e))).each(Ike(this._id,i)):this.styleTween(i,kke(i,r,e),n).on("end.style."+i,null)}function Oke(i,e,n){return function(r){this.style.setProperty(i,e.call(this,r),n)}}function Fke(i,e,n){var r,s;function o(){var a=e.apply(this,arguments);return a!==s&&(r=(s=a)&&Oke(i,a,n)),r}return o._value=e,o}function Bke(i,e,n){var r="style."+(i+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Fke(i,e,n??""))}function Uke(i){return function(){this.textContent=i}}function zke(i){return function(){var e=i(this);this.textContent=e??""}}function Vke(i){return this.tween("text",typeof i=="function"?zke(pk(this,"text",i)):Uke(i==null?"":i+""))}function $ke(i){return function(e){this.textContent=i.call(this,e)}}function Gke(i){var e,n;function r(){var s=i.apply(this,arguments);return s!==n&&(e=(n=s)&&$ke(s)),e}return r._value=i,r}function Hke(i){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(i==null)return this.tween(e,null);if(typeof i!="function")throw new Error;return this.tween(e,Gke(i))}function Wke(){for(var i=this._name,e=this._id,n=iW(),r=this._groups,s=r.length,o=0;o<s;++o)for(var a=r[o],l=a.length,c,u=0;u<l;++u)if(c=a[u]){var d=Sa(c,e);kw(c,i,n,u,a,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new rc(r,this._parents,i,n)}function jke(){var i,e,n=this,r=n._id,s=n.size();return new Promise(function(o,a){var l={value:a},c={value:function(){--s===0&&o()}};n.each(function(){var u=el(this,r),d=u.on;d!==i&&(e=(i=d).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(c)),u.on=e}),s===0&&o()})}var qke=0;function rc(i,e,n,r){this._groups=i,this._parents=e,this._name=n,this._id=r}function iW(){return++qke}var xl=tv.prototype;rc.prototype={constructor:rc,select:Ake,selectAll:Cke,selectChild:xl.selectChild,selectChildren:xl.selectChildren,filter:_ke,merge:bke,selection:Pke,transition:Wke,call:xl.call,nodes:xl.nodes,node:xl.node,size:xl.size,empty:xl.empty,each:xl.each,on:Tke,attr:rke,attrTween:cke,style:Dke,styleTween:Bke,text:Vke,textTween:Hke,remove:Mke,tween:Z2e,delay:hke,duration:mke,ease:yke,easeVarying:xke,end:jke,[Symbol.iterator]:xl[Symbol.iterator]};function Xke(i){return((i*=2)<=1?i*i*i:(i-=2)*i*i+2)/2}var Kke={time:null,delay:0,duration:250,ease:Xke};function Yke(i,e){for(var n;!(n=i.__transition)||!(n=n[e]);)if(!(i=i.parentNode))throw new Error(`transition ${e} not found`);return n}function Zke(i){var e,n;i instanceof rc?(e=i._id,i=i._name):(e=iW(),(n=Kke).time=g2(),i=i==null?null:i+"");for(var r=this._groups,s=r.length,o=0;o<s;++o)for(var a=r[o],l=a.length,c,u=0;u<l;++u)(c=a[u])&&kw(c,i,e,u,a,n||Yke(c,e));return new rc(r,this._parents,i,e)}tv.prototype.interrupt=X2e;tv.prototype.transition=Zke;const d_=i=>()=>i;function Qke(i,{sourceEvent:e,target:n,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:i,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function Ul(i,e,n){this.k=i,this.x=e,this.y=n}Ul.prototype={constructor:Ul,scale:function(i){return i===1?this:new Ul(this.k*i,this.x,this.y)},translate:function(i,e){return i===0&e===0?this:new Ul(this.k,this.x+this.k*i,this.y+this.k*e)},apply:function(i){return[i[0]*this.k+this.x,i[1]*this.k+this.y]},applyX:function(i){return i*this.k+this.x},applyY:function(i){return i*this.k+this.y},invert:function(i){return[(i[0]-this.x)/this.k,(i[1]-this.y)/this.k]},invertX:function(i){return(i-this.x)/this.k},invertY:function(i){return(i-this.y)/this.k},rescaleX:function(i){return i.copy().domain(i.range().map(this.invertX,this).map(i.invert,i))},rescaleY:function(i){return i.copy().domain(i.range().map(this.invertY,this).map(i.invert,i))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var mk=new Ul(1,0,0);Na.prototype=Ul.prototype;function Na(i){for(;!i.__zoom;)if(!(i=i.parentNode))return mk;return i.__zoom}function tA(i){i.stopImmediatePropagation()}function cg(i){i.preventDefault(),i.stopImmediatePropagation()}function Jke(i){return(!i.ctrlKey||i.type==="wheel")&&!i.button}function eLe(){var i=this;return i instanceof SVGElement?(i=i.ownerSVGElement||i,i.hasAttribute("viewBox")?(i=i.viewBox.baseVal,[[i.x,i.y],[i.x+i.width,i.y+i.height]]):[[0,0],[i.width.baseVal.value,i.height.baseVal.value]]):[[0,0],[i.clientWidth,i.clientHeight]]}function mU(){return this.__zoom||mk}function tLe(i){return-i.deltaY*(i.deltaMode===1?.05:i.deltaMode?1:.002)*(i.ctrlKey?10:1)}function nLe(){return navigator.maxTouchPoints||"ontouchstart"in this}function iLe(i,e,n){var r=i.invertX(e[0][0])-n[0][0],s=i.invertX(e[1][0])-n[1][0],o=i.invertY(e[0][1])-n[0][1],a=i.invertY(e[1][1])-n[1][1];return i.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function rLe(){var i=Jke,e=eLe,n=iLe,r=tLe,s=nLe,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],l=250,c=gxe,u=q0("start","zoom","end"),d,h,f,p=500,m=150,y=0,v=10;function g(C){C.property("__zoom",mU).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",M).filter(s).on("touchstart.zoom",R).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(C,L,P,W){var D=C.selection?C.selection():C;D.property("__zoom",mU),C!==D?S(C,L,P,W):D.interrupt().each(function(){T(this,arguments).event(W).start().zoom(null,typeof L=="function"?L.apply(this,arguments):L).end()})},g.scaleBy=function(C,L,P,W){g.scaleTo(C,function(){var D=this.__zoom.k,X=typeof L=="function"?L.apply(this,arguments):L;return D*X},P,W)},g.scaleTo=function(C,L,P,W){g.transform(C,function(){var D=e.apply(this,arguments),X=this.__zoom,q=P==null?b(D):typeof P=="function"?P.apply(this,arguments):P,J=X.invert(q),se=typeof L=="function"?L.apply(this,arguments):L;return n(x(_(X,se),q,J),D,a)},P,W)},g.translateBy=function(C,L,P,W){g.transform(C,function(){return n(this.__zoom.translate(typeof L=="function"?L.apply(this,arguments):L,typeof P=="function"?P.apply(this,arguments):P),e.apply(this,arguments),a)},null,W)},g.translateTo=function(C,L,P,W,D){g.transform(C,function(){var X=e.apply(this,arguments),q=this.__zoom,J=W==null?b(X):typeof W=="function"?W.apply(this,arguments):W;return n(mk.translate(J[0],J[1]).scale(q.k).translate(typeof L=="function"?-L.apply(this,arguments):-L,typeof P=="function"?-P.apply(this,arguments):-P),X,a)},W,D)};function _(C,L){return L=Math.max(o[0],Math.min(o[1],L)),L===C.k?C:new Ul(L,C.x,C.y)}function x(C,L,P){var W=L[0]-P[0]*C.k,D=L[1]-P[1]*C.k;return W===C.x&&D===C.y?C:new Ul(C.k,W,D)}function b(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function S(C,L,P,W){C.on("start.zoom",function(){T(this,arguments).event(W).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(W).end()}).tween("zoom",function(){var D=this,X=arguments,q=T(D,X).event(W),J=e.apply(D,X),se=P==null?b(J):typeof P=="function"?P.apply(D,X):P,de=Math.max(J[1][0]-J[0][0],J[1][1]-J[0][1]),G=D.__zoom,Q=typeof L=="function"?L.apply(D,X):L,ee=c(G.invert(se).concat(de/G.k),Q.invert(se).concat(de/Q.k));return function(ie){if(ie===1)ie=Q;else{var Se=ee(ie),Fe=de/Se[2];ie=new Ul(Fe,se[0]-Se[0]*Fe,se[1]-Se[1]*Fe)}q.zoom(null,ie)}})}function T(C,L,P){return!P&&C.__zooming||new w(C,L)}function w(C,L){this.that=C,this.args=L,this.active=0,this.sourceEvent=null,this.extent=e.apply(C,L),this.taps=0}w.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,L){return this.mouse&&C!=="mouse"&&(this.mouse[1]=L.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=L.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=L.invert(this.touch1[0])),this.that.__zoom=L,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var L=Eo(this.that).datum();u.call(C,this.that,new Qke(C,{sourceEvent:this.sourceEvent,target:g,type:C,transform:this.that.__zoom,dispatch:u}),L)}};function E(C,...L){if(!i.apply(this,arguments))return;var P=T(this,L).event(C),W=this.__zoom,D=Math.max(o[0],Math.min(o[1],W.k*Math.pow(2,r.apply(this,arguments)))),X=ka(C);if(P.wheel)(P.mouse[0][0]!==X[0]||P.mouse[0][1]!==X[1])&&(P.mouse[1]=W.invert(P.mouse[0]=X)),clearTimeout(P.wheel);else{if(W.k===D)return;P.mouse=[X,W.invert(X)],nb(this),P.start()}cg(C),P.wheel=setTimeout(q,m),P.zoom("mouse",n(x(_(W,D),P.mouse[0],P.mouse[1]),P.extent,a));function q(){P.wheel=null,P.end()}}function A(C,...L){if(f||!i.apply(this,arguments))return;var P=C.currentTarget,W=T(this,L,!0).event(C),D=Eo(C.view).on("mousemove.zoom",se,!0).on("mouseup.zoom",de,!0),X=ka(C,P),q=C.clientX,J=C.clientY;Q6(C.view),tA(C),W.mouse=[X,this.__zoom.invert(X)],nb(this),W.start();function se(G){if(cg(G),!W.moved){var Q=G.clientX-q,ee=G.clientY-J;W.moved=Q*Q+ee*ee>y}W.event(G).zoom("mouse",n(x(W.that.__zoom,W.mouse[0]=ka(G,P),W.mouse[1]),W.extent,a))}function de(G){D.on("mousemove.zoom mouseup.zoom",null),J6(G.view,W.moved),cg(G),W.event(G).end()}}function M(C,...L){if(i.apply(this,arguments)){var P=this.__zoom,W=ka(C.changedTouches?C.changedTouches[0]:C,this),D=P.invert(W),X=P.k*(C.shiftKey?.5:2),q=n(x(_(P,X),W,D),e.apply(this,L),a);cg(C),l>0?Eo(this).transition().duration(l).call(S,q,W,C):Eo(this).call(g.transform,q,W,C)}}function R(C,...L){if(i.apply(this,arguments)){var P=C.touches,W=P.length,D=T(this,L,C.changedTouches.length===W).event(C),X,q,J,se;for(tA(C),q=0;q<W;++q)J=P[q],se=ka(J,this),se=[se,this.__zoom.invert(se),J.identifier],D.touch0?!D.touch1&&D.touch0[2]!==se[2]&&(D.touch1=se,D.taps=0):(D.touch0=se,X=!0,D.taps=1+!!d);d&&(d=clearTimeout(d)),X&&(D.taps<2&&(h=se[0],d=setTimeout(function(){d=null},p)),nb(this),D.start())}}function F(C,...L){if(this.__zooming){var P=T(this,L).event(C),W=C.changedTouches,D=W.length,X,q,J,se;for(cg(C),X=0;X<D;++X)q=W[X],J=ka(q,this),P.touch0&&P.touch0[2]===q.identifier?P.touch0[0]=J:P.touch1&&P.touch1[2]===q.identifier&&(P.touch1[0]=J);if(q=P.that.__zoom,P.touch1){var de=P.touch0[0],G=P.touch0[1],Q=P.touch1[0],ee=P.touch1[1],ie=(ie=Q[0]-de[0])*ie+(ie=Q[1]-de[1])*ie,Se=(Se=ee[0]-G[0])*Se+(Se=ee[1]-G[1])*Se;q=_(q,Math.sqrt(ie/Se)),J=[(de[0]+Q[0])/2,(de[1]+Q[1])/2],se=[(G[0]+ee[0])/2,(G[1]+ee[1])/2]}else if(P.touch0)J=P.touch0[0],se=P.touch0[1];else return;P.zoom("touch",n(x(q,J,se),P.extent,a))}}function B(C,...L){if(this.__zooming){var P=T(this,L).event(C),W=C.changedTouches,D=W.length,X,q;for(tA(C),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),X=0;X<D;++X)q=W[X],P.touch0&&P.touch0[2]===q.identifier?delete P.touch0:P.touch1&&P.touch1[2]===q.identifier&&delete P.touch1;if(P.touch1&&!P.touch0&&(P.touch0=P.touch1,delete P.touch1),P.touch0)P.touch0[1]=this.__zoom.invert(P.touch0[0]);else if(P.end(),P.taps===2&&(q=ka(q,this),Math.hypot(h[0]-q[0],h[1]-q[1])<v)){var J=Eo(this).on("dblclick.zoom");J&&J.apply(this,arguments)}}}return g.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:d_(+C),g):r},g.filter=function(C){return arguments.length?(i=typeof C=="function"?C:d_(!!C),g):i},g.touchable=function(C){return arguments.length?(s=typeof C=="function"?C:d_(!!C),g):s},g.extent=function(C){return arguments.length?(e=typeof C=="function"?C:d_([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),g):e},g.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],g):[o[0],o[1]]},g.translateExtent=function(C){return arguments.length?(a[0][0]=+C[0][0],a[1][0]=+C[1][0],a[0][1]=+C[0][1],a[1][1]=+C[1][1],g):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},g.constrain=function(C){return arguments.length?(n=C,g):n},g.duration=function(C){return arguments.length?(l=+C,g):l},g.interpolate=function(C){return arguments.length?(c=C,g):c},g.on=function(){var C=u.on.apply(u,arguments);return C===u?g:C},g.clickDistance=function(C){return arguments.length?(y=(C=+C)*C,g):Math.sqrt(y)},g.tapDistance=function(C){return arguments.length?(v=+C,g):v},g}var sLe="Expected a function";function oLe(i,e,n){var r=!0,s=!0;if(typeof i!="function")throw new TypeError(sLe);return o1(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),eH(i,e,{leading:r,maxWait:e,trailing:s})}function NR(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function aLe(i){if(Array.isArray(i))return NR(i)}function rW(i,e,n){if(typeof i=="function"?i===e:i.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function lLe(i,e){if(e.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cLe(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function po(i,e){return i.get(rW(i,e))}function gU(i,e,n){lLe(i,e),e.set(i,n)}function yU(i,e,n){return i.set(rW(i,e),n),n}function uLe(i,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,gLe(r.key),r)}}function dLe(i,e,n){return e&&uLe(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function hLe(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function fLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pLe(i){return aLe(i)||hLe(i)||yLe(i)||fLe()}function mLe(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function gLe(i){var e=mLe(i,"string");return typeof e=="symbol"?e:e+""}function yLe(i,e){if(i){if(typeof i=="string")return NR(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?NR(i,e):void 0}}var vLe=123,xLe=function(e){return"#".concat(Math.min(e,Math.pow(2,24)).toString(16).padStart(6,"0"))},sW=function(e,n,r){return(e<<16)+(n<<8)+r},_Le=function(e){var n=wt(e).toRgb(),r=n.r,s=n.g,o=n.b;return sW(r,s,o)},vU=function(e,n){return e*vLe%Math.pow(2,n)},Ku=new WeakMap,_l=new WeakMap,bLe=function(){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;cLe(this,i),gU(this,Ku,void 0),gU(this,_l,void 0),yU(_l,this,e),this.reset()}return dLe(i,[{key:"reset",value:function(){yU(Ku,this,["__reserved for background__"])}},{key:"register",value:function(n){if(po(Ku,this).length>=Math.pow(2,24-po(_l,this)))return null;var r=po(Ku,this).length,s=vU(r,po(_l,this)),o=xLe(r+(s<<24-po(_l,this)));return po(Ku,this).push(n),o}},{key:"lookup",value:function(n){if(!n)return null;var r=typeof n=="string"?_Le(n):sW.apply(void 0,pLe(n));if(!r)return null;var s=r&Math.pow(2,24-po(_l,this))-1,o=r>>24-po(_l,this)&Math.pow(2,po(_l,this))-1;return vU(s,po(_l,this))!==o||s>=po(Ku,this).length?null:po(Ku,this)[s]}}])}();const{abs:ug,cos:bl,sin:Yh,acos:SLe,atan2:dg,sqrt:Fc,pow:mo}=Math;function hg(i){return i<0?-mo(-i,1/3):mo(i,1/3)}const oW=Math.PI,h_=2*oW,Bc=oW/2,wLe=1e-6,nA=Number.MAX_SAFE_INTEGER||9007199254740991,iA=Number.MIN_SAFE_INTEGER||-9007199254740991,TLe={x:0,y:0,z:0},Ge={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(i,e){const n=e(i);let r=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(r+=n.z*n.z),Fc(r)},compute:function(i,e,n){if(i===0)return e[0].t=0,e[0];const r=e.length-1;if(i===1)return e[r].t=1,e[r];const s=1-i;let o=e;if(r===0)return e[0].t=i,e[0];if(r===1){const l={x:s*o[0].x+i*o[1].x,y:s*o[0].y+i*o[1].y,t:i};return n&&(l.z=s*o[0].z+i*o[1].z),l}if(r<4){let l=s*s,c=i*i,u,d,h,f=0;r===2?(o=[o[0],o[1],o[2],TLe],u=l,d=s*i*2,h=c):r===3&&(u=l*s,d=l*i*3,h=s*c*3,f=i*c);const p={x:u*o[0].x+d*o[1].x+h*o[2].x+f*o[3].x,y:u*o[0].y+d*o[1].y+h*o[2].y+f*o[3].y,t:i};return n&&(p.z=u*o[0].z+d*o[1].z+h*o[2].z+f*o[3].z),p}const a=JSON.parse(JSON.stringify(e));for(;a.length>1;){for(let l=0;l<a.length-1;l++)a[l]={x:a[l].x+(a[l+1].x-a[l].x)*i,y:a[l].y+(a[l+1].y-a[l].y)*i},typeof a[l].z<"u"&&(a[l].z=a[l].z+(a[l+1].z-a[l].z)*i);a.splice(a.length-1,1)}return a[0].t=i,a[0]},computeWithRatios:function(i,e,n,r){const s=1-i,o=n,a=e;let l=o[0],c=o[1],u=o[2],d=o[3],h;if(l*=s,c*=i,a.length===2)return h=l+c,{x:(l*a[0].x+c*a[1].x)/h,y:(l*a[0].y+c*a[1].y)/h,z:r?(l*a[0].z+c*a[1].z)/h:!1,t:i};if(l*=s,c*=2*s,u*=i*i,a.length===3)return h=l+c+u,{x:(l*a[0].x+c*a[1].x+u*a[2].x)/h,y:(l*a[0].y+c*a[1].y+u*a[2].y)/h,z:r?(l*a[0].z+c*a[1].z+u*a[2].z)/h:!1,t:i};if(l*=s,c*=1.5*s,u*=3*s,d*=i*i*i,a.length===4)return h=l+c+u+d,{x:(l*a[0].x+c*a[1].x+u*a[2].x+d*a[3].x)/h,y:(l*a[0].y+c*a[1].y+u*a[2].y+d*a[3].y)/h,z:r?(l*a[0].z+c*a[1].z+u*a[2].z+d*a[3].z)/h:!1,t:i}},derive:function(i,e){const n=[];for(let r=i,s=r.length,o=s-1;s>1;s--,o--){const a=[];for(let l=0,c;l<o;l++)c={x:o*(r[l+1].x-r[l].x),y:o*(r[l+1].y-r[l].y)},e&&(c.z=o*(r[l+1].z-r[l].z)),a.push(c);n.push(a),r=a}return n},between:function(i,e,n){return e<=i&&i<=n||Ge.approximately(i,e)||Ge.approximately(i,n)},approximately:function(i,e,n){return ug(i-e)<=(n||wLe)},length:function(i){const n=Ge.Tvalues.length;let r=0;for(let s=0,o;s<n;s++)o=.5*Ge.Tvalues[s]+.5,r+=Ge.Cvalues[s]*Ge.arcfn(o,i);return .5*r},map:function(i,e,n,r,s){const o=n-e,a=s-r,l=i-e,c=l/o;return r+a*c},lerp:function(i,e,n){const r={x:e.x+i*(n.x-e.x),y:e.y+i*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(r.z=e.z+i*(n.z-e.z)),r},pointToString:function(i){let e=i.x+"/"+i.y;return typeof i.z<"u"&&(e+="/"+i.z),e},pointsToString:function(i){return"["+i.map(Ge.pointToString).join(", ")+"]"},copy:function(i){return JSON.parse(JSON.stringify(i))},angle:function(i,e,n){const r=e.x-i.x,s=e.y-i.y,o=n.x-i.x,a=n.y-i.y,l=r*a-s*o,c=r*o+s*a;return dg(l,c)},round:function(i,e){const n=""+i,r=n.indexOf(".");return parseFloat(n.substring(0,r+1+e))},dist:function(i,e){const n=i.x-e.x,r=i.y-e.y;return Fc(n*n+r*r)},closest:function(i,e){let n=mo(2,63),r,s;return i.forEach(function(o,a){s=Ge.dist(e,o),s<n&&(n=s,r=a)}),{mdist:n,mpos:r}},abcratio:function(i,e){if(e!==2&&e!==3)return!1;if(typeof i>"u")i=.5;else if(i===0||i===1)return i;const n=mo(i,e)+mo(1-i,e),r=n-1;return ug(r/n)},projectionratio:function(i,e){if(e!==2&&e!==3)return!1;if(typeof i>"u")i=.5;else if(i===0||i===1)return i;const n=mo(1-i,e),r=mo(i,e)+n;return n/r},lli8:function(i,e,n,r,s,o,a,l){const c=(i*r-e*n)*(s-a)-(i-n)*(s*l-o*a),u=(i*r-e*n)*(o-l)-(e-r)*(s*l-o*a),d=(i-n)*(o-l)-(e-r)*(s-a);return d==0?!1:{x:c/d,y:u/d}},lli4:function(i,e,n,r){const s=i.x,o=i.y,a=e.x,l=e.y,c=n.x,u=n.y,d=r.x,h=r.y;return Ge.lli8(s,o,a,l,c,u,d,h)},lli:function(i,e){return Ge.lli4(i,i.c,e,e.c)},makeline:function(i,e){return new Hn(i.x,i.y,(i.x+e.x)/2,(i.y+e.y)/2,e.x,e.y)},findbbox:function(i){let e=nA,n=nA,r=iA,s=iA;return i.forEach(function(o){const a=o.bbox();e>a.x.min&&(e=a.x.min),n>a.y.min&&(n=a.y.min),r<a.x.max&&(r=a.x.max),s<a.y.max&&(s=a.y.max)}),{x:{min:e,mid:(e+r)/2,max:r,size:r-e},y:{min:n,mid:(n+s)/2,max:s,size:s-n}}},shapeintersections:function(i,e,n,r,s){if(!Ge.bboxoverlap(e,r))return[];const o=[],a=[i.startcap,i.forward,i.back,i.endcap],l=[n.startcap,n.forward,n.back,n.endcap];return a.forEach(function(c){c.virtual||l.forEach(function(u){if(u.virtual)return;const d=c.intersects(u,s);d.length>0&&(d.c1=c,d.c2=u,d.s1=i,d.s2=n,o.push(d))})}),o},makeshape:function(i,e,n){const r=e.points.length,s=i.points.length,o=Ge.makeline(e.points[r-1],i.points[0]),a=Ge.makeline(i.points[s-1],e.points[0]),l={startcap:o,forward:i,back:e,endcap:a,bbox:Ge.findbbox([o,i,e,a])};return l.intersections=function(c){return Ge.shapeintersections(l,l.bbox,c,c.bbox,n)},l},getminmax:function(i,e,n){if(!n)return{min:0,max:0};let r=nA,s=iA,o,a;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let l=0,c=n.length;l<c;l++)o=n[l],a=i.get(o),a[e]<r&&(r=a[e]),a[e]>s&&(s=a[e]);return{min:r,mid:(r+s)/2,max:s,size:s-r}},align:function(i,e){const n=e.p1.x,r=e.p1.y,s=-dg(e.p2.y-r,e.p2.x-n),o=function(a){return{x:(a.x-n)*bl(s)-(a.y-r)*Yh(s),y:(a.x-n)*Yh(s)+(a.y-r)*bl(s)}};return i.map(o)},roots:function(i,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=i.length-1,r=Ge.align(i,e),s=function(w){return 0<=w&&w<=1};if(n===2){const w=r[0].y,E=r[1].y,A=r[2].y,M=w-2*E+A;if(M!==0){const R=-Fc(E*E-w*A),F=-w+E,B=-(R+F)/M,C=-(-R+F)/M;return[B,C].filter(s)}else if(E!==A&&M===0)return[(2*E-A)/(2*E-2*A)].filter(s);return[]}const o=r[0].y,a=r[1].y,l=r[2].y,c=r[3].y;let u=-o+3*a-3*l+c,d=3*o-6*a+3*l,h=-3*o+3*a,f=o;if(Ge.approximately(u,0)){if(Ge.approximately(d,0))return Ge.approximately(h,0)?[]:[-f/h].filter(s);const w=Fc(h*h-4*d*f),E=2*d;return[(w-h)/E,(-h-w)/E].filter(s)}d/=u,h/=u,f/=u;const p=(3*h-d*d)/3,m=p/3,y=(2*d*d*d-9*d*h+27*f)/27,v=y/2,g=v*v+m*m*m;let _,x,b,S,T;if(g<0){const w=-p/3,E=w*w*w,A=Fc(E),M=-y/(2*A),R=M<-1?-1:M>1?1:M,F=SLe(R),B=hg(A),C=2*B;return b=C*bl(F/3)-d/3,S=C*bl((F+h_)/3)-d/3,T=C*bl((F+2*h_)/3)-d/3,[b,S,T].filter(s)}else{if(g===0)return _=v<0?hg(-v):-hg(v),b=2*_-d/3,S=-_-d/3,[b,S].filter(s);{const w=Fc(g);return _=hg(-v+w),x=hg(v+w),[_-x-d/3].filter(s)}}},droots:function(i){if(i.length===3){const e=i[0],n=i[1],r=i[2],s=e-2*n+r;if(s!==0){const o=-Fc(n*n-e*r),a=-e+n,l=-(o+a)/s,c=-(-o+a)/s;return[l,c]}else if(n!==r&&s===0)return[(2*n-r)/(2*(n-r))];return[]}if(i.length===2){const e=i[0],n=i[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(i,e,n,r,s){let o,a,l,c,u=0,d=0;const h=Ge.compute(i,e),f=Ge.compute(i,n),p=h.x*h.x+h.y*h.y;if(r?(o=Fc(mo(h.y*f.z-f.y*h.z,2)+mo(h.z*f.x-f.z*h.x,2)+mo(h.x*f.y-f.x*h.y,2)),a=mo(p+h.z*h.z,3/2)):(o=h.x*f.y-h.y*f.x,a=mo(p,3/2)),o===0||a===0)return{k:0,r:0};if(u=o/a,d=a/o,!s){const m=Ge.curvature(i-.001,e,n,r,!0).k,y=Ge.curvature(i+.001,e,n,r,!0).k;c=(y-u+(u-m))/2,l=(ug(y-u)+ug(u-m))/2}return{k:u,r:d,dk:c,adk:l}},inflections:function(i){if(i.length<4)return[];const e=Ge.align(i,{p1:i[0],p2:i.slice(-1)[0]}),n=e[2].x*e[1].y,r=e[3].x*e[1].y,s=e[1].x*e[2].y,o=e[3].x*e[2].y,a=18*(-3*n+2*r+3*s-o),l=18*(3*n-r-3*s),c=18*(s-n);if(Ge.approximately(a,0)){if(!Ge.approximately(l,0)){let f=-c/l;if(0<=f&&f<=1)return[f]}return[]}const u=2*a;if(Ge.approximately(u,0))return[];const d=l*l-4*a*c;if(d<0)return[];const h=Math.sqrt(d);return[(h-l)/u,-(l+h)/u].filter(function(f){return 0<=f&&f<=1})},bboxoverlap:function(i,e){const n=["x","y"],r=n.length;for(let s=0,o,a,l,c;s<r;s++)if(o=n[s],a=i[o].mid,l=e[o].mid,c=(i[o].size+e[o].size)/2,ug(a-l)>=c)return!1;return!0},expandbox:function(i,e){e.x.min<i.x.min&&(i.x.min=e.x.min),e.y.min<i.y.min&&(i.y.min=e.y.min),e.z&&e.z.min<i.z.min&&(i.z.min=e.z.min),e.x.max>i.x.max&&(i.x.max=e.x.max),e.y.max>i.y.max&&(i.y.max=e.y.max),e.z&&e.z.max>i.z.max&&(i.z.max=e.z.max),i.x.mid=(i.x.min+i.x.max)/2,i.y.mid=(i.y.min+i.y.max)/2,i.z&&(i.z.mid=(i.z.min+i.z.max)/2),i.x.size=i.x.max-i.x.min,i.y.size=i.y.max-i.y.min,i.z&&(i.z.size=i.z.max-i.z.min)},pairiteration:function(i,e,n){const r=i.bbox(),s=e.bbox(),o=1e5,a=n||.5;if(r.x.size+r.y.size<a&&s.x.size+s.y.size<a)return[(o*(i._t1+i._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];let l=i.split(.5),c=e.split(.5),u=[{left:l.left,right:c.left},{left:l.left,right:c.right},{left:l.right,right:c.right},{left:l.right,right:c.left}];u=u.filter(function(h){return Ge.bboxoverlap(h.left.bbox(),h.right.bbox())});let d=[];return u.length===0||(u.forEach(function(h){d=d.concat(Ge.pairiteration(h.left,h.right,a))}),d=d.filter(function(h,f){return d.indexOf(h)===f})),d},getccenter:function(i,e,n){const r=e.x-i.x,s=e.y-i.y,o=n.x-e.x,a=n.y-e.y,l=r*bl(Bc)-s*Yh(Bc),c=r*Yh(Bc)+s*bl(Bc),u=o*bl(Bc)-a*Yh(Bc),d=o*Yh(Bc)+a*bl(Bc),h=(i.x+e.x)/2,f=(i.y+e.y)/2,p=(e.x+n.x)/2,m=(e.y+n.y)/2,y=h+l,v=f+c,g=p+u,_=m+d,x=Ge.lli8(h,f,y,v,p,m,g,_),b=Ge.dist(x,i);let S=dg(i.y-x.y,i.x-x.x),T=dg(e.y-x.y,e.x-x.x),w=dg(n.y-x.y,n.x-x.x),E;return S<w?((S>T||T>w)&&(S+=h_),S>w&&(E=w,w=S,S=E)):w<T&&T<S?(E=w,w=S,S=E):w+=h_,x.s=S,x.e=w,x.r=b,x},numberSort:function(i,e){return i-e}};class iy{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return Ge.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var n=e[0].bbox(),r=1;r<e.length;r++)Ge.expandbox(n,e[r].bbox());return n}offset(e){const n=[];return this.curves.forEach(function(r){n.push(...r.offset(e))}),new iy(n)}}const{abs:fg,min:xU,max:_U,cos:ELe,sin:MLe,acos:ALe,sqrt:pg}=Math,CLe=Math.PI;class Hn{constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),r=!1;if(typeof n[0]=="object"){r=n.length;const p=[];n.forEach(function(m){["x","y","z"].forEach(function(y){typeof m[y]<"u"&&p.push(m[y])})}),n=p}let s=!1;const o=n.length;if(r){if(r>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const a=this._3d=!s&&(o===9||o===12)||e&&e[0]&&typeof e[0].z<"u",l=this.points=[];for(let p=0,m=a?3:2;p<o;p+=m){var c={x:n[p],y:n[p+1]};a&&(c.z=n[p+2]),l.push(c)}const u=this.order=l.length-1,d=this.dims=["x","y"];a&&d.push("z"),this.dimlen=d.length;const h=Ge.align(l,{p1:l[0],p2:l[u]}),f=Ge.dist(l[0],l[u]);this._linear=h.reduce((p,m)=>p+fg(m.y),0)<f/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,r,s){if(typeof s>"u"&&(s=.5),s===0)return new Hn(n,n,r);if(s===1)return new Hn(e,n,n);const o=Hn.getABC(2,e,n,r,s);return new Hn(e,o.A,r)}static cubicFromPoints(e,n,r,s,o){typeof s>"u"&&(s=.5);const a=Hn.getABC(3,e,n,r,s);typeof o>"u"&&(o=Ge.dist(n,a.C));const l=o*(1-s)/s,c=Ge.dist(e,r),u=(r.x-e.x)/c,d=(r.y-e.y)/c,h=o*u,f=o*d,p=l*u,m=l*d,y={x:n.x-h,y:n.y-f},v={x:n.x+p,y:n.y+m},g=a.A,_={x:g.x+(y.x-g.x)/(1-s),y:g.y+(y.y-g.y)/(1-s)},x={x:g.x+(v.x-g.x)/s,y:g.y+(v.y-g.y)/s},b={x:e.x+(_.x-e.x)/s,y:e.y+(_.y-e.y)/s},S={x:r.x+(x.x-r.x)/(1-s),y:r.y+(x.y-r.y)/(1-s)};return new Hn(e,b,S,r)}static getUtils(){return Ge}getUtils(){return Hn.getUtils()}static get PolyBezier(){return iy}valueOf(){return this.toString()}toString(){return Ge.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,n=e[0].x,r=e[0].y,s=["M",n,r,this.order===2?"Q":"C"];for(let o=1,a=e.length;o<a;o++)s.push(e[o].x),s.push(e[o].y);return s.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=Ge.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,n=Ge.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return Ge.length(this.derivative.bind(this))}static getABC(e=2,n,r,s,o=.5){const a=Ge.projectionratio(o,e),l=1-a,c={x:a*n.x+l*s.x,y:a*n.y+l*s.y},u=Ge.abcratio(o,e);return{A:{x:r.x+(r.x-c.x)/u,y:r.y+(r.y-c.y)/u},B:r,C:c,S:n,E:s}}getABC(e,n){n=n||this.get(e);let r=this.points[0],s=this.points[this.order];return Hn.getABC(this.order,r,n,s,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,r,s;n<e;n++)s=n/(e-1),r=this.compute(s),r.t=s,this._lut.push(r);return this._lut}on(e,n){n=n||5;const r=this.getLUT(),s=[];for(let o=0,a,l=0;o<r.length;o++)a=r[o],Ge.dist(a,e)<n&&(s.push(a),l+=o/r.length);return s.length?t/=s.length:!1}project(e){const n=this.getLUT(),r=n.length-1,s=Ge.closest(n,e),o=s.mpos,a=(o-1)/r,l=(o+1)/r,c=.1/r;let u=s.mdist,d=a,h=d,f;u+=1;for(let p;d<l+c;d+=c)f=this.compute(d),p=Ge.dist(e,f),p<u&&(u=p,h=d);return h=h<0?0:h>1?1:h,f=this.compute(h),f.t=h,f.d=u,f}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?Ge.computeWithRatios(e,this.points,this.ratios,this._3d):Ge.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,n=[e[0]],r=e.length;for(let s=1,o,a;s<r;s++)o=e[s],a=e[s-1],n[s]={x:(r-s)/r*o.x+s/r*a.x,y:(r-s)/r*o.y+s/r*a.y};return n[r]=e[r-1],new Hn(n)}derivative(e){return Ge.compute(e,this.dpoints[0],this._3d)}dderivative(e){return Ge.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new Hn(Ge.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return Ge.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return Ge.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const n=this.derivative(e),r=pg(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/r,y:n.x/r}}__normal3(e){const n=this.derivative(e),r=this.derivative(e+.01),s=pg(n.x*n.x+n.y*n.y+n.z*n.z),o=pg(r.x*r.x+r.y*r.y+r.z*r.z);n.x/=s,n.y/=s,n.z/=s,r.x/=o,r.y/=o,r.z/=o;const a={x:r.y*n.z-r.z*n.y,y:r.z*n.x-r.x*n.z,z:r.x*n.y-r.y*n.x},l=pg(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=l,a.y/=l,a.z/=l;const c=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{t:e,x:c[0]*n.x+c[1]*n.y+c[2]*n.z,y:c[3]*n.x+c[4]*n.y+c[5]*n.z,z:c[6]*n.x+c[7]*n.y+c[8]*n.z}}hull(e){let n=this.points,r=[],s=[],o=0;for(s[o++]=n[0],s[o++]=n[1],s[o++]=n[2],this.order===3&&(s[o++]=n[3]);n.length>1;){r=[];for(let a=0,l,c=n.length-1;a<c;a++)l=Ge.lerp(e,n[a],n[a+1]),s[o++]=l,r.push(l);n=r}return s}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;const r=this.hull(e),s={left:this.order===2?new Hn([r[0],r[3],r[5]]):new Hn([r[0],r[4],r[7],r[9]]),right:this.order===2?new Hn([r[5],r[4],r[2]]):new Hn([r[9],r[8],r[6],r[3]]),span:r};return s.left._t1=Ge.map(0,0,1,this._t1,this._t2),s.left._t2=Ge.map(e,0,1,this._t1,this._t2),s.right._t1=Ge.map(e,0,1,this._t1,this._t2),s.right._t2=Ge.map(1,0,1,this._t1,this._t2),n?(n=Ge.map(n,e,1,0,1),s.right.split(n).left):s}extrema(){const e={};let n=[];return this.dims.forEach((function(r){let s=function(a){return a[r]},o=this.dpoints[0].map(s);e[r]=Ge.droots(o),this.order===3&&(o=this.dpoints[1].map(s),e[r]=e[r].concat(Ge.droots(o))),e[r]=e[r].filter(function(a){return a>=0&&a<=1}),n=n.concat(e[r].sort(Ge.numberSort))}).bind(this)),e.values=n.sort(Ge.numberSort).filter(function(r,s){return n.indexOf(r)===s}),e}bbox(){const e=this.extrema(),n={};return this.dims.forEach((function(r){n[r]=Ge.getminmax(this,r,e[r])}).bind(this)),n}overlaps(e){const n=this.bbox(),r=e.bbox();return Ge.bboxoverlap(n,r)}offset(e,n){if(typeof n<"u"){const r=this.get(e),s=this.normal(e),o={c:r,n:s,x:r.x+s.x*n,y:r.y+s.y*n};return this._3d&&(o.z=r.z+s.z*n),o}if(this._linear){const r=this.normal(0),s=this.points.map(function(o){const a={x:o.x+e*r.x,y:o.y+e*r.y};return o.z&&r.z&&(a.z=o.z+e*r.z),a});return[new Hn(s)]}return this.reduce().map(function(r){return r._linear?r.offset(e)[0]:r.scale(e)})}simple(){if(this.order===3){const s=Ge.angle(this.points[0],this.points[3],this.points[1]),o=Ge.angle(this.points[0],this.points[3],this.points[2]);if(s>0&&o<0||s<0&&o>0)return!1}const e=this.normal(0),n=this.normal(1);let r=e.x*n.x+e.y*n.y;return this._3d&&(r+=e.z*n.z),fg(ALe(r))<CLe/3}reduce(){let e,n=0,r=0,s=.01,o,a=[],l=[],c=this.extrema().values;for(c.indexOf(0)===-1&&(c=[0].concat(c)),c.indexOf(1)===-1&&c.push(1),n=c[0],e=1;e<c.length;e++)r=c[e],o=this.split(n,r),o._t1=n,o._t2=r,a.push(o),n=r;return a.forEach(function(u){for(n=0,r=0;r<=1;)for(r=n+s;r<=1+s;r+=s)if(o=u.split(n,r),!o.simple()){if(r-=s,fg(n-r)<s)return[];o=u.split(n,r),o._t1=Ge.map(n,0,1,u._t1,u._t2),o._t2=Ge.map(r,0,1,u._t1,u._t2),l.push(o),n=r;break}n<1&&(o=u.split(n,1),o._t1=Ge.map(n,0,1,u._t1,u._t2),o._t2=u._t2,l.push(o))}),l}translate(e,n,r){r=typeof r=="number"?r:n;const s=this.order;let o=this.points.map((a,l)=>(1-l/s)*n+l/s*r);return new Hn(this.points.map((a,l)=>({x:a.x+e.x*o[l],y:a.y+e.y*o[l]})))}scale(e){const n=this.order;let r=!1;if(typeof e=="function"&&(r=e),r&&n===2)return this.raise().scale(r);const s=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),r?r(0):e,r?r(1):e);const a=r?r(0):e,l=r?r(1):e,c=[this.offset(0,10),this.offset(1,10)],u=[],d=Ge.lli4(c[0],c[0].c,c[1],c[1].c);if(!d)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(h){const f=u[h*n]=Ge.copy(o[h*n]);f.x+=(h?l:a)*c[h].n.x,f.y+=(h?l:a)*c[h].n.y}),r?([0,1].forEach(function(h){if(!(n===2&&h)){var f=o[h+1],p={x:f.x-d.x,y:f.y-d.y},m=r?r((h+1)/n):e;r&&!s&&(m=-m);var y=pg(p.x*p.x+p.y*p.y);p.x/=y,p.y/=y,u[h+1]={x:f.x+m*p.x,y:f.y+m*p.y}}}),new Hn(u)):([0,1].forEach(h=>{if(n===2&&h)return;const f=u[h*n],p=this.derivative(h),m={x:f.x+p.x,y:f.y+p.y};u[h+1]=Ge.lli4(f,m,d,o[h+1])}),new Hn(u))}outline(e,n,r,s){if(n=n===void 0?e:n,this._linear){const S=this.normal(0),T=this.points[0],w=this.points[this.points.length-1];let E,A,M;r===void 0&&(r=e,s=n),E={x:T.x+S.x*e,y:T.y+S.y*e},M={x:w.x+S.x*r,y:w.y+S.y*r},A={x:(E.x+M.x)/2,y:(E.y+M.y)/2};const R=[E,A,M];E={x:T.x-S.x*n,y:T.y-S.y*n},M={x:w.x-S.x*s,y:w.y-S.y*s},A={x:(E.x+M.x)/2,y:(E.y+M.y)/2};const F=[M,A,E],B=Ge.makeline(F[2],R[0]),C=Ge.makeline(R[2],F[0]),L=[B,new Hn(R),C,new Hn(F)];return new iy(L)}const o=this.reduce(),a=o.length,l=[];let c=[],u,d=0,h=this.length();const f=typeof r<"u"&&typeof s<"u";function p(S,T,w,E,A){return function(M){const R=E/w,F=(E+A)/w,B=T-S;return Ge.map(M,0,1,S+R*B,S+F*B)}}o.forEach(function(S){const T=S.length();f?(l.push(S.scale(p(e,r,h,d,T))),c.push(S.scale(p(-n,-s,h,d,T)))):(l.push(S.scale(e)),c.push(S.scale(-n))),d+=T}),c=c.map(function(S){return u=S.points,u[3]?S.points=[u[3],u[2],u[1],u[0]]:S.points=[u[2],u[1],u[0]],S}).reverse();const m=l[0].points[0],y=l[a-1].points[l[a-1].points.length-1],v=c[a-1].points[c[a-1].points.length-1],g=c[0].points[0],_=Ge.makeline(v,m),x=Ge.makeline(y,g),b=[_].concat(l).concat([x]).concat(c);return new iy(b)}outlineshapes(e,n,r){n=n||e;const s=this.outline(e,n).curves,o=[];for(let a=1,l=s.length;a<l/2;a++){const c=Ge.makeshape(s[a],s[l-a],r);c.startcap.virtual=a>1,c.endcap.virtual=a<l/2-1,o.push(c)}return o}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof Hn&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){const n=xU(e.p1.x,e.p2.x),r=xU(e.p1.y,e.p2.y),s=_U(e.p1.x,e.p2.x),o=_U(e.p1.y,e.p2.y);return Ge.roots(this.points,e).filter(a=>{var l=this.get(a);return Ge.between(l.x,n,s)&&Ge.between(l.y,r,o)})}selfintersects(e){const n=this.reduce(),r=n.length-2,s=[];for(let o=0,a,l,c;o<r;o++)l=n.slice(o,o+1),c=n.slice(o+2),a=this.curveintersects(l,c,e),s.push(...a);return s}curveintersects(e,n,r){const s=[];e.forEach(function(a){n.forEach(function(l){a.overlaps(l)&&s.push({left:a,right:l})})});let o=[];return s.forEach(function(a){const l=Ge.pairiteration(a.left,a.right,r);l.length>0&&(o=o.concat(l))}),o}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,r,s){const o=(s-r)/4,a=this.get(r+o),l=this.get(s-o),c=Ge.dist(e,n),u=Ge.dist(e,a),d=Ge.dist(e,l);return fg(u-c)+fg(d-c)}_iterate(e,n){let r=0,s=1,o;do{o=0,s=1;let a=this.get(r),l,c,u,d,h=!1,f=!1,p,m=s,y=1;do if(f=h,d=u,m=(r+s)/2,l=this.get(m),c=this.get(s),u=Ge.getccenter(a,l,c),u.interval={start:r,end:s},h=this._error(u,a,r,s)<=e,p=f&&!h,p||(y=s),h){if(s>=1){if(u.interval.end=y=1,d=u,s>1){let g={x:u.x+u.r*ELe(u.e),y:u.y+u.r*MLe(u.e)};u.e+=Ge.angle({x:u.x,y:u.y},g,this.get(1))}break}s=s+(s-r)/2}else s=m;while(!p&&o++<100);if(o>=100)break;d=d||u,n.push(d),r=y}while(s<1);return n}}function kR(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function RLe(i){if(Array.isArray(i))return i}function PLe(i){if(Array.isArray(i))return kR(i)}function NLe(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function kLe(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function LLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ILe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DLe(i,e){if(i==null)return{};var n,r,s=OLe(i,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(r=0;r<o.length;r++)n=o[r],e.includes(n)||{}.propertyIsEnumerable.call(i,n)&&(s[n]=i[n])}return s}function OLe(i,e){if(i==null)return{};var n={};for(var r in i)if({}.hasOwnProperty.call(i,r)){if(e.includes(r))continue;n[r]=i[r]}return n}function FLe(i,e){return RLe(i)||kLe(i,e)||aW(i,e)||LLe()}function BLe(i){return PLe(i)||NLe(i)||aW(i)||ILe()}function ULe(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function zLe(i){var e=ULe(i,"string");return typeof e=="symbol"?e:e+""}function aW(i,e){if(i){if(typeof i=="string")return kR(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kR(i,e):void 0}}var VLe=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(l){return{keyAccessor:l,isProp:!(l instanceof Function)}}),o=i.reduce(function(l,c){var u=l,d=c;return s.forEach(function(h,f){var p=h.keyAccessor,m=h.isProp,y;if(m){var v=d,g=v[p],_=DLe(v,[p].map(zLe));y=g,d=_}else y=p(d,f);f+1<s.length?(u.hasOwnProperty(y)||(u[y]={}),u=u[y]):n?(u.hasOwnProperty(y)||(u[y]=[]),u[y].push(d)):u[y]=d}),l},{});n instanceof Function&&function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;u===s.length?Object.keys(c).forEach(function(d){return c[d]=n(c[d])}):Object.values(c).forEach(function(d){return l(d,u+1)})}(o);var a=o;return r&&(a=[],function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];u.length===s.length?a.push({keys:u,vals:c}):Object.entries(c).forEach(function(d){var h=FLe(d,2),f=h[0],p=h[1];return l(p,[].concat(BLe(u),[f]))})}(o),e instanceof Array&&e.length===0&&a.length===1&&(a[0].keys=[])),a};function $Le(i,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var GLe=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;$Le(GLe);function LR(i,e){(e==null||e>i.length)&&(e=i.length);for(var n=0,r=Array(e);n<e;n++)r[n]=i[n];return r}function HLe(i){if(Array.isArray(i))return i}function WLe(i){if(Array.isArray(i))return LR(i)}function bU(i,e,n){if(lW())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var s=new(i.bind.apply(i,r));return s}function x0(i,e,n){return(e=ZLe(e))in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function lW(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lW=function(){return!!i})()}function jLe(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function qLe(i,e){var n=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(n!=null){var r,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(i)).next,e!==0)for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function XLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SU(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),n.push.apply(n,r)}return n}function Zh(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?SU(Object(n),!0).forEach(function(r){x0(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):SU(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}function ry(i,e){return HLe(i)||qLe(i,e)||cW(i,e)||XLe()}function Mo(i){return WLe(i)||jLe(i)||cW(i)||KLe()}function YLe(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function ZLe(i){var e=YLe(i,"string");return typeof e=="symbol"?e:e+""}function IR(i){"@babel/helpers - typeof";return IR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},IR(i)}function cW(i,e){if(i){if(typeof i=="string")return LR(i,e);var n={}.toString.call(i).slice(8,-1);return n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set"?Array.from(i):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LR(i,e):void 0}}var QLe=E2(cH);function wU(i,e,n){!e||typeof n!="string"||i.filter(function(r){return!r[n]}).forEach(function(r){r[n]=QLe(e(r))})}function JLe(i,e){var n=i.nodes,r=i.links,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.nodeFilter,a=o===void 0?function(){return!0}:o,l=s.onLoopError,c=l===void 0?function(p){throw"Invalid DAG structure! Found cycle in node path: ".concat(p.join(" -> "),".")}:l,u={};n.forEach(function(p){return u[e(p)]={data:p,out:[],depth:-1,skip:!a(p)}}),r.forEach(function(p){var m=p.source,y=p.target,v=b(m),g=b(y);if(!u.hasOwnProperty(v))throw"Missing source node with id: ".concat(v);if(!u.hasOwnProperty(g))throw"Missing target node with id: ".concat(g);var _=u[v],x=u[g];_.out.push(x);function b(S){return IR(S)==="object"?e(S):S}});var d=[];f(Object.values(u));var h=Object.assign.apply(Object,[{}].concat(Mo(Object.entries(u).filter(function(p){var m=ry(p,2),y=m[1];return!y.skip}).map(function(p){var m=ry(p,2),y=m[0],v=m[1];return x0({},y,v.depth)}))));return h;function f(p){for(var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=function(){var b=p[g];if(m.indexOf(b)!==-1){var S=[].concat(Mo(m.slice(m.indexOf(b))),[b]).map(function(T){return e(T.data)});return d.some(function(T){return T.length===S.length&&T.every(function(w,E){return w===S[E]})})||(d.push(S),c(S)),1}y>b.depth&&(b.depth=y,f(b.out,[].concat(Mo(m),[b]),y+(b.skip?0:1)))},g=0,_=p.length;g<_;g++)v()}}var eIe=2,Ir=function(e,n){return n.onNeedsRedraw&&n.onNeedsRedraw()},TU=function(e,n){if(!n.isShadow){var r=yt(n.linkDirectionalParticles);n.graphData.links.forEach(function(s){var o=Math.round(Math.abs(r(s)));o?s.__photons=Mo(Array(o)).map(function(){return{}}):delete s.__photons})}},M1=Au({props:{graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1,TU(e,n)}},dagMode:{onChange:function(e,n){!e&&(n.graphData.nodes||[]).forEach(function(r){return r.fx=r.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:Ir},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:Ir},nodeColor:{default:"color",triggerUpdate:!1,onChange:Ir},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:Ir},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:Ir},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:Ir},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:Ir},linkColor:{default:"color",triggerUpdate:!1,onChange:Ir},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:Ir},linkWidth:{default:1,triggerUpdate:!1,onChange:Ir},linkCurvature:{default:0,triggerUpdate:!1,onChange:Ir},linkCanvasObject:{triggerUpdate:!1,onChange:Ir},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:Ir},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:Ir},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:Ir},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:Ir},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:TU},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.velocityDecay(e)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(e,n,r){return r===void 0?e.forceLayout.force(n):(e.forceLayout.force(n,r),this)},d3ReheatSimulation:function(e){return e.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},isEngineRunning:function(e){return!!e.engineRunning},tickFrame:function(e){return!e.isShadow&&n(),s(),!e.isShadow&&o(),!e.isShadow&&a(),r(),this;function n(){e.engineRunning&&(++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.forceLayout.tick(),e.onEngineTick()))}function r(){var l=yt(e.nodeVisibility),c=yt(e.nodeVal),u=yt(e.nodeColor),d=yt(e.nodeCanvasObjectMode),h=e.ctx,f=e.isShadow/e.globalScale,p=e.graphData.nodes.filter(l);h.save(),p.forEach(function(m){var y=d(m);if(e.nodeCanvasObject&&(y==="before"||y==="replace")&&(e.nodeCanvasObject(m,h,e.globalScale),y==="replace")){h.restore();return}var v=Math.sqrt(Math.max(0,c(m)||1))*e.nodeRelSize+f;h.beginPath(),h.arc(m.x,m.y,v,0,2*Math.PI,!1),h.fillStyle=u(m)||"rgba(31, 120, 180, 0.92)",h.fill(),e.nodeCanvasObject&&y==="after"&&e.nodeCanvasObject(m,e.ctx,e.globalScale)}),h.restore()}function s(){var l=yt(e.linkVisibility),c=yt(e.linkColor),u=yt(e.linkWidth),d=yt(e.linkLineDash),h=yt(e.linkCurvature),f=yt(e.linkCanvasObjectMode),p=e.ctx,m=e.isShadow*2,y=e.graphData.links.filter(l);y.forEach(T);var v=[],g=[],_=y;if(e.linkCanvasObject){var x=[],b=[];y.forEach(function(w){return({before:v,after:g,replace:x}[f(w)]||b).push(w)}),_=[].concat(Mo(v),g,b),v=v.concat(x)}p.save(),v.forEach(function(w){return e.linkCanvasObject(w,p,e.globalScale)}),p.restore();var S=VLe(_,[c,u,d]);p.save(),Object.entries(S).forEach(function(w){var E=ry(w,2),A=E[0],M=E[1],R=!A||A==="undefined"?"rgba(0,0,0,0.15)":A;Object.entries(M).forEach(function(F){var B=ry(F,2),C=B[0],L=B[1],P=(C||1)/e.globalScale+m;Object.entries(L).forEach(function(W){var D=ry(W,2);D[0];var X=D[1],q=d(X[0]);p.beginPath(),X.forEach(function(J){var se=J.source,de=J.target;if(!(!se||!de||!se.hasOwnProperty("x")||!de.hasOwnProperty("x"))){p.moveTo(se.x,se.y);var G=J.__controlPoints;G?p[G.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(p,Mo(G).concat([de.x,de.y])):p.lineTo(de.x,de.y)}}),p.strokeStyle=R,p.lineWidth=P,p.setLineDash(q||[]),p.stroke()})})}),p.restore(),p.save(),g.forEach(function(w){return e.linkCanvasObject(w,p,e.globalScale)}),p.restore();function T(w){var E=h(w);if(!E){w.__controlPoints=null;return}var A=w.source,M=w.target;if(!(!A||!M||!A.hasOwnProperty("x")||!M.hasOwnProperty("x"))){var R=Math.sqrt(Math.pow(M.x-A.x,2)+Math.pow(M.y-A.y,2));if(R>0){var F=Math.atan2(M.y-A.y,M.x-A.x),B=R*E,C={x:(A.x+M.x)/2+B*Math.cos(F-Math.PI/2),y:(A.y+M.y)/2+B*Math.sin(F-Math.PI/2)};w.__controlPoints=[C.x,C.y]}else{var L=E*70;w.__controlPoints=[M.x,M.y-L,M.x+L,M.y]}}}}function o(){var l=1.6,c=.2,u=yt(e.linkDirectionalArrowLength),d=yt(e.linkDirectionalArrowRelPos),h=yt(e.linkVisibility),f=yt(e.linkDirectionalArrowColor||e.linkColor),p=yt(e.nodeVal),m=e.ctx;m.save(),e.graphData.links.filter(h).forEach(function(y){var v=u(y);if(!(!v||v<0)){var g=y.source,_=y.target;if(!(!g||!_||!g.hasOwnProperty("x")||!_.hasOwnProperty("x"))){var x=Math.sqrt(Math.max(0,p(g)||1))*e.nodeRelSize,b=Math.sqrt(Math.max(0,p(_)||1))*e.nodeRelSize,S=Math.min(1,Math.max(0,d(y))),T=f(y)||"rgba(0,0,0,0.28)",w=v/l/2,E=y.__controlPoints&&bU(Hn,[g.x,g.y].concat(Mo(y.__controlPoints),[_.x,_.y])),A=E?function(P){return E.get(P)}:function(P){return{x:g.x+(_.x-g.x)*P||0,y:g.y+(_.y-g.y)*P||0}},M=E?E.length():Math.sqrt(Math.pow(_.x-g.x,2)+Math.pow(_.y-g.y,2)),R=x+v+(M-x-b-v)*S,F=A(R/M),B=A((R-v)/M),C=A((R-v*(1-c))/M),L=Math.atan2(F.y-B.y,F.x-B.x)-Math.PI/2;m.beginPath(),m.moveTo(F.x,F.y),m.lineTo(B.x+w*Math.cos(L),B.y+w*Math.sin(L)),m.lineTo(C.x,C.y),m.lineTo(B.x-w*Math.cos(L),B.y-w*Math.sin(L)),m.fillStyle=T,m.fill()}}}),m.restore()}function a(){var l=yt(e.linkDirectionalParticles),c=yt(e.linkDirectionalParticleSpeed),u=yt(e.linkDirectionalParticleWidth),d=yt(e.linkVisibility),h=yt(e.linkDirectionalParticleColor||e.linkColor),f=e.ctx;f.save(),e.graphData.links.filter(d).forEach(function(p){var m=l(p);if(!(!p.hasOwnProperty("__photons")||!p.__photons.length)){var y=p.source,v=p.target;if(!(!y||!v||!y.hasOwnProperty("x")||!v.hasOwnProperty("x"))){var g=c(p),_=p.__photons||[],x=Math.max(0,u(p)/2)/Math.sqrt(e.globalScale),b=h(p)||"rgba(0,0,0,0.28)";f.fillStyle=b;var S=p.__controlPoints?bU(Hn,[y.x,y.y].concat(Mo(p.__controlPoints),[v.x,v.y])):null,T=0,w=!1;_.forEach(function(E){var A=!!E.__singleHop;if(E.hasOwnProperty("__progressRatio")||(E.__progressRatio=A?0:T/m),!A&&T++,E.__progressRatio+=g,E.__progressRatio>=1)if(!A)E.__progressRatio=E.__progressRatio%1;else{w=!0;return}var M=E.__progressRatio,R=S?S.get(M):{x:y.x+(v.x-y.x)*M||0,y:y.y+(v.y-y.y)*M||0};f.beginPath(),f.arc(R.x,R.y,x,0,2*Math.PI,!1),f.fill()}),w&&(p.__photons=p.__photons.filter(function(E){return!E.__singleHop||E.__progressRatio<=1}))}}}),f.restore()}},emitParticle:function(e,n){return n&&(!n.__photons&&(n.__photons=[]),n.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:LG().force("link",PG()).force("charge",IG()).force("center",wG()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.ctx=e},update:function(e,n){e.engineRunning=!1,e.onUpdate(),e.nodeAutoColorBy!==null&&wU(e.graphData.nodes,yt(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&wU(e.graphData.links,yt(e.linkAutoColorBy),e.linkColor),e.graphData.links.forEach(function(f){f.source=f[e.linkSource],f.target=f[e.linkTarget]}),e.forceLayout.stop().alpha(1).nodes(e.graphData.nodes);var r=e.forceLayout.force("link");r&&r.id(function(f){return f[e.nodeId]}).links(e.graphData.links);var s=e.dagMode&&JLe(e.graphData,function(f){return f[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),o=Math.max.apply(Math,Mo(Object.values(s||[]))),a=e.dagLevelDistance||e.graphData.nodes.length/(o||1)*eIe*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(n.dagMode)){var l=["lr","rl"].includes(n.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(f){return delete f[l]})}if(["lr","rl","td","bu"].includes(e.dagMode)){var c=["rl","bu"].includes(e.dagMode),u=function(p){return(s[p[e.nodeId]]-o/2)*a*(c?-1:1)},d=["lr","rl"].includes(e.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(f){return f[d]=u(f)})}e.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?DG(function(f){var p=s[f[e.nodeId]]||-1;return(e.dagMode==="radialin"?o-p:p)*a}).strength(function(f){return e.dagNodeFilter(f)?1:0}):null);for(var h=0;h<e.warmupTicks&&!(e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin);h++)e.forceLayout.tick();this.resetCountdown(),e.onFinishUpdate()}});function uW(i,e){var n=i instanceof Array?i:[i],r=new e;return r._destructor&&r._destructor(),{linkProp:function(o){return{default:r[o](),onChange:function(l,c){n.forEach(function(u){return c[u][o](l)})},triggerUpdate:!1}},linkMethod:function(o){return function(a){for(var l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];var d=[];return n.forEach(function(h){var f=a[h],p=f[o].apply(f,c);p!==f&&d.push(p)}),d.length?d[0]:this}}}}var tIe=800,nIe=4,iIe=5,dW=uW("forceGraph",M1),rIe=uW(["forceGraph","shadowGraph"],M1),sIe=Object.assign.apply(Object,Mo(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(i){return x0({},i,dW.linkProp(i))})).concat(Mo(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(i){return x0({},i,rIe.linkProp(i))})))),oIe=Object.assign.apply(Object,Mo(["d3Force","d3ReheatSimulation","emitParticle"].map(function(i){return x0({},i,dW.linkMethod(i))})));function rA(i){if(i.canvas){var e=i.canvas.width,n=i.canvas.height;e===300&&n===150&&(e=n=0);var r=window.devicePixelRatio;e/=r,n/=r,[i.canvas,i.shadowCanvas].forEach(function(o){o.style.width="".concat(i.width,"px"),o.style.height="".concat(i.height,"px"),o.width=i.width*r,o.height=i.height*r,!e&&!n&&o.getContext("2d").scale(r,r)});var s=Na(i.canvas).k;i.zoom.translateBy(i.zoom.__baseElem,(i.width-e)/2/s,(i.height-n)/2/s),i.needsRedraw=!0}}function hW(i){var e=window.devicePixelRatio;i.setTransform(e,0,0,e,0,0)}function EU(i,e,n){i.save(),hW(i),i.clearRect(0,0,e,n),i.restore()}var aIe=Au({props:Zh({width:{default:window.innerWidth,onChange:function(e,n){return rA(n)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(e,n){return rA(n)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){[e.nodes,e.links].every(function(s){return(s||[]).every(function(o){return!o.hasOwnProperty("__indexColor")})})&&n.colorTracker.reset(),[{type:"Node",objs:e.nodes},{type:"Link",objs:e.links}].forEach(r),n.forceGraph.graphData(e),n.shadowGraph.graphData(e);function r(s){var o=s.type,a=s.objs;a.filter(function(l){if(!l.hasOwnProperty("__indexColor"))return!0;var c=n.colorTracker.lookup(l.__indexColor);return!c||!c.hasOwnProperty("d")||c.d!==l}).forEach(function(l){l.__indexColor=n.colorTracker.register({type:o,d:l})})}},triggerUpdate:!1},backgroundColor:{onChange:function(e,n){n.canvas&&e&&(n.canvas.style.background=e)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(e,n){n.shadowGraph.nodeCanvasObject(e?function(r,s,o){return e(r,r.__indexColor,s,o)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(e,n){n.shadowGraph.linkCanvasObject(e?function(r,s,o){return e(r,r.__indexColor,s,o)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(e,n){n.zoom.scaleExtent([e,n.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(e,n){n.zoom.scaleExtent([n.zoom.scaleExtent()[0],e])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},sIe),aliases:{stopAnimation:"pauseAnimation"},methods:Zh({graph2ScreenCoords:function(e,n,r){var s=Na(e.canvas);return{x:n*s.k+s.x,y:r*s.k+s.y}},screen2GraphCoords:function(e,n,r){var s=Na(e.canvas);return{x:(n-s.x)/s.k,y:(r-s.y)/s.k}},centerAt:function(e,n,r,s){if(!e.canvas)return null;if(n!==void 0||r!==void 0){var o=Object.assign({},n!==void 0?{x:n}:{},r!==void 0?{y:r}:{});return s?e.tweenGroup.add(new S1(a()).to(o,s).easing(ql.Quadratic.Out).onUpdate(l).start()):l(o),this}return a();function a(){var c=Na(e.canvas);return{x:(e.width/2-c.x)/c.k,y:(e.height/2-c.y)/c.k}}function l(c){var u=c.x,d=c.y;e.zoom.translateTo(e.zoom.__baseElem,u===void 0?a().x:u,d===void 0?a().y:d),e.needsRedraw=!0}},zoom:function(e,n,r){if(!e.canvas)return null;if(n!==void 0)return r?e.tweenGroup.add(new S1({k:s()}).to({k:n},r).easing(ql.Quadratic.Out).onUpdate(function(a){var l=a.k;return o(l)}).start()):o(n),this;return s();function s(){return Na(e.canvas).k}function o(a){e.zoom.scaleTo(e.zoom.__baseElem,a),e.needsRedraw=!0}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];var l=this.getGraphBbox.apply(this,o);if(l){var c={x:(l.x[0]+l.x[1])/2,y:(l.y[0]+l.y[1])/2},u=Math.max(1e-12,Math.min(1e12,(e.width-r*2)/(l.x[1]-l.x[0]),(e.height-r*2)/(l.y[1]-l.y[0])));this.centerAt(c.x,c.y,n),this.zoom(u,n)}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},r=yt(e.nodeVal),s=function(l){return Math.sqrt(Math.max(0,r(l)||1))*e.nodeRelSize},o=e.graphData.nodes.filter(n).map(function(a){return{x:a.x,y:a.y,r:s(a)}});return o.length?{x:[HC(o,function(a){return a.x-a.r}),GC(o,function(a){return a.x+a.r})],y:[HC(o,function(a){return a.y-a.r}),GC(o,function(a){return a.y+a.r})]}:null},pauseAnimation:function(e){return e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},oIe),stateInit:function(){return{lastSetZoom:1,zoom:rLe(),forceGraph:new M1,shadowGraph:new M1().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new bLe,tweenGroup:new ok}},init:function(e,n){var r=this;e.innerHTML="";var s=document.createElement("div");s.classList.add("force-graph-container"),s.style.position="relative",e.appendChild(s),n.canvas=document.createElement("canvas"),n.backgroundColor&&(n.canvas.style.background=n.backgroundColor),s.appendChild(n.canvas),n.shadowCanvas=document.createElement("canvas");var o=n.canvas.getContext("2d"),a=n.shadowCanvas.getContext("2d",{willReadFrequently:!0}),l={x:-1e12,y:-1e12},c=function(){var h=null,f=window.devicePixelRatio,p=l.x>0&&l.y>0?a.getImageData(l.x*f,l.y*f,1,1):null;return p&&(h=n.colorTracker.lookup(p.data)),h};Eo(n.canvas).call(H2e().subject(function(){if(!n.enableNodeDrag)return null;var d=c();return d&&d.type==="Node"?d.d:null}).on("start",function(d){var h=d.subject;h.__initialDragPos={x:h.x,y:h.y,fx:h.fx,fy:h.fy},d.active||(h.fx=h.x,h.fy=h.y),n.canvas.classList.add("grabbable")}).on("drag",function(d){var h=d.subject,f=h.__initialDragPos,p=d,m=Na(n.canvas).k,y={x:f.x+(p.x-f.x)/m-h.x,y:f.y+(p.y-f.y)/m-h.y};["x","y"].forEach(function(v){return h["f".concat(v)]=h[v]=f[v]+(p[v]-f[v])/m}),!(!h.__dragged&&iIe>=Math.sqrt(Cve(["x","y"].map(function(v){return Math.pow(d[v]-f[v],2)}))))&&(n.forceGraph.d3AlphaTarget(.3).resetCountdown(),n.isPointerDragging=!0,h.__dragged=!0,n.onNodeDrag(h,y))}).on("end",function(d){var h=d.subject,f=h.__initialDragPos,p={x:h.x-f.x,y:h.y-f.y};f.fx===void 0&&(h.fx=void 0),f.fy===void 0&&(h.fy=void 0),delete h.__initialDragPos,n.forceGraph.d3AlphaTarget()&&n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.canvas.classList.remove("grabbable"),n.isPointerDragging=!1,h.__dragged&&(delete h.__dragged,n.onNodeDragEnd(h,p))})),n.zoom(n.zoom.__baseElem=Eo(n.canvas)),n.zoom.__baseElem.on("dblclick.zoom",null),n.zoom.filter(function(d){return!d.button&&n.enableZoomPanInteraction&&(d.type!=="wheel"||yt(n.enableZoomInteraction)(d))&&(d.type==="wheel"||yt(n.enablePanInteraction)(d))}).on("zoom",function(d){var h=d.transform;[o,a].forEach(function(f){hW(f),f.translate(h.x,h.y),f.scale(h.k,h.k)}),n.isPointerDragging=!0,n.onZoom&&n.onZoom(Zh(Zh({},h),r.centerAt())),n.needsRedraw=!0}).on("end",function(d){n.isPointerDragging=!1,n.onZoomEnd&&n.onZoomEnd(Zh(Zh({},d.transform),r.centerAt()))}),rA(n),n.forceGraph.onNeedsRedraw(function(){return n.needsRedraw=!0}).onFinishUpdate(function(){Na(n.canvas).k===n.lastSetZoom&&n.graphData.nodes.length&&(n.zoom.scaleTo(n.zoom.__baseElem,n.lastSetZoom=nIe/Math.cbrt(n.graphData.nodes.length)),n.needsRedraw=!0)}),n.tooltip=new q6(s),["pointermove","pointerdown"].forEach(function(d){return s.addEventListener(d,function(h){d==="pointerdown"&&(n.isPointerPressed=!0,n.pointerDownEvent=h),!n.isPointerDragging&&h.type==="pointermove"&&n.onBackgroundClick&&(h.pressure>0||n.isPointerPressed)&&(h.pointerType!=="touch"||h.movementX===void 0||[h.movementX,h.movementY].some(function(m){return Math.abs(m)>1}))&&(n.isPointerDragging=!0);var f=p(s);l.x=h.pageX-f.left,l.y=h.pageY-f.top;function p(m){var y=m.getBoundingClientRect(),v=window.pageXOffset||document.documentElement.scrollLeft,g=window.pageYOffset||document.documentElement.scrollTop;return{top:y.top+g,left:y.left+v}}},{passive:!0})}),s.addEventListener("pointerup",function(d){if(n.isPointerPressed=!1,n.isPointerDragging){n.isPointerDragging=!1;return}var h=[d,n.pointerDownEvent];requestAnimationFrame(function(){if(d.button===0)if(n.hoverObj){var f=n["on".concat(n.hoverObj.type,"Click")];f&&f.apply(void 0,[n.hoverObj.d].concat(h))}else n.onBackgroundClick&&n.onBackgroundClick.apply(n,h);if(d.button===2)if(n.hoverObj){var p=n["on".concat(n.hoverObj.type,"RightClick")];p&&p.apply(void 0,[n.hoverObj.d].concat(h))}else n.onBackgroundRightClick&&n.onBackgroundRightClick.apply(n,h)})},{passive:!0}),s.addEventListener("contextmenu",function(d){return!n.onBackgroundRightClick&&!n.onNodeRightClick&&!n.onLinkRightClick?!0:(d.preventDefault(),!1)}),n.forceGraph(o),n.shadowGraph(a);var u=oLe(function(){EU(a,n.width,n.height),n.shadowGraph.linkWidth(function(h){return yt(n.linkWidth)(h)+n.linkHoverPrecision});var d=Na(n.canvas);n.shadowGraph.globalScale(d.k).tickFrame()},tIe);n.flushShadowCanvas=u.flush,(this._animationCycle=function d(){var h=!n.autoPauseRedraw||!!n.needsRedraw||n.forceGraph.isEngineRunning()||n.graphData.links.some(function(x){return x.__photons&&x.__photons.length});if(n.needsRedraw=!1,n.enablePointerInteraction){var f=n.isPointerDragging?null:c();if(f!==n.hoverObj){var p=n.hoverObj,m=p?p.type:null,y=f?f.type:null;if(m&&m!==y){var v=n["on".concat(m,"Hover")];v&&v(null,p.d)}if(y){var g=n["on".concat(y,"Hover")];g&&g(f.d,m===y?p.d:null)}n.tooltip.content(f&&yt(n["".concat(f.type.toLowerCase(),"Label")])(f.d)||null),n.canvas.classList[f&&n["on".concat(y,"Click")]||!f&&n.onBackgroundClick?"add":"remove"]("clickable"),n.hoverObj=f}h&&u()}if(h){EU(o,n.width,n.height);var _=Na(n.canvas).k;n.onRenderFramePre&&n.onRenderFramePre(o,_),n.forceGraph.globalScale(_).tickFrame(),n.onRenderFramePost&&n.onRenderFramePost(o,_)}n.tweenGroup.update(),n.animationFrameRequestId=requestAnimationFrame(d)})()},update:function(e){}}),Lw={width:oe.number,height:oe.number,graphData:oe.shape({nodes:oe.arrayOf(oe.object).isRequired,links:oe.arrayOf(oe.object).isRequired}),backgroundColor:oe.string,nodeRelSize:oe.number,nodeId:oe.string,nodeLabel:oe.oneOfType([oe.string,oe.func]),nodeVal:oe.oneOfType([oe.number,oe.string,oe.func]),nodeVisibility:oe.oneOfType([oe.bool,oe.string,oe.func]),nodeColor:oe.oneOfType([oe.string,oe.func]),nodeAutoColorBy:oe.oneOfType([oe.string,oe.func]),onNodeHover:oe.func,onNodeClick:oe.func,linkSource:oe.string,linkTarget:oe.string,linkLabel:oe.oneOfType([oe.string,oe.func]),linkVisibility:oe.oneOfType([oe.bool,oe.string,oe.func]),linkColor:oe.oneOfType([oe.string,oe.func]),linkAutoColorBy:oe.oneOfType([oe.string,oe.func]),linkWidth:oe.oneOfType([oe.number,oe.string,oe.func]),linkCurvature:oe.oneOfType([oe.number,oe.string,oe.func]),linkDirectionalArrowLength:oe.oneOfType([oe.number,oe.string,oe.func]),linkDirectionalArrowColor:oe.oneOfType([oe.string,oe.func]),linkDirectionalArrowRelPos:oe.oneOfType([oe.number,oe.string,oe.func]),linkDirectionalParticles:oe.oneOfType([oe.number,oe.string,oe.func]),linkDirectionalParticleSpeed:oe.oneOfType([oe.number,oe.string,oe.func]),linkDirectionalParticleWidth:oe.oneOfType([oe.number,oe.string,oe.func]),linkDirectionalParticleColor:oe.oneOfType([oe.string,oe.func]),onLinkHover:oe.func,onLinkClick:oe.func,dagMode:oe.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:oe.number,dagNodeFilter:oe.func,onDagError:oe.func,d3AlphaMin:oe.number,d3AlphaDecay:oe.number,d3VelocityDecay:oe.number,warmupTicks:oe.number,cooldownTicks:oe.number,cooldownTime:oe.number,onEngineTick:oe.func,onEngineStop:oe.func,getGraphBbox:oe.func},fW={zoomToFit:oe.func,onNodeRightClick:oe.func,onNodeDrag:oe.func,onNodeDragEnd:oe.func,onLinkRightClick:oe.func,linkHoverPrecision:oe.number,onBackgroundClick:oe.func,onBackgroundRightClick:oe.func,enablePointerInteraction:oe.bool,enableNodeDrag:oe.bool},gk={showNavInfo:oe.bool,nodeOpacity:oe.number,nodeResolution:oe.number,nodeThreeObject:oe.oneOfType([oe.object,oe.string,oe.func]),nodeThreeObjectExtend:oe.oneOfType([oe.bool,oe.string,oe.func]),linkOpacity:oe.number,linkResolution:oe.number,linkCurveRotation:oe.oneOfType([oe.number,oe.string,oe.func]),linkMaterial:oe.oneOfType([oe.object,oe.string,oe.func]),linkThreeObject:oe.oneOfType([oe.object,oe.string,oe.func]),linkThreeObjectExtend:oe.oneOfType([oe.bool,oe.string,oe.func]),linkPositionUpdate:oe.func,linkDirectionalArrowResolution:oe.number,linkDirectionalParticleResolution:oe.number,forceEngine:oe.oneOf(["d3","ngraph"]),ngraphPhysics:oe.object,numDimensions:oe.oneOf([1,2,3])},lIe=Object.assign({},Lw,fW,{linkLineDash:oe.oneOfType([oe.arrayOf(oe.number),oe.string,oe.func]),nodeCanvasObjectMode:oe.oneOfType([oe.string,oe.func]),nodeCanvasObject:oe.func,nodePointerAreaPaint:oe.func,linkCanvasObjectMode:oe.oneOfType([oe.string,oe.func]),linkCanvasObject:oe.func,linkPointerAreaPaint:oe.func,autoPauseRedraw:oe.bool,minZoom:oe.number,maxZoom:oe.number,enableZoomInteraction:oe.oneOfType([oe.bool,oe.func]),enablePanInteraction:oe.oneOfType([oe.bool,oe.func]),onZoom:oe.func,onZoomEnd:oe.func,onRenderFramePre:oe.func,onRenderFramePost:oe.func}),cIe=Object.assign({},Lw,fW,gk,{enableNavigationControls:oe.bool,controlType:oe.oneOf(["trackball","orbit","fly"]),rendererConfig:oe.object,extraRenderers:oe.arrayOf(oe.shape({render:oe.func.isRequired}))}),uIe=Object.assign({},Lw,gk,{nodeDesc:oe.oneOfType([oe.string,oe.func]),linkDesc:oe.oneOfType([oe.string,oe.func])}),dIe=Object.assign({},Lw,gk,{markerAttrs:oe.object,yOffset:oe.number,glScale:oe.number});const pW=$S(Q_e,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"]});pW.displayName="ForceGraphVR";pW.propTypes=uIe;const mW=$S(abe,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"],initPropNames:["markerAttrs"]});mW.displayName="ForceGraphAR";mW.propTypes=dIe;const gW=$S(B2e,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","cameraPosition","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords","postProcessingComposer","lights","scene","camera","renderer","controls","refresh"],initPropNames:["controlType","rendererConfig","extraRenderers"]});gW.displayName="ForceGraph3D";gW.propTypes=cIe;const yk=$S(aIe,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});yk.displayName="ForceGraph2D";yk.propTypes=lIe;const hIe=()=>{const{repoId:i}=q4(),[e,n]=I.useState([]),[r,s]=I.useState({}),[o,a]=I.useState(!0),[l,c]=I.useState(null),[u,d]=I.useState({nodes:[],links:[]}),h=I.useRef(null);I.useEffect(()=>{(async()=>{var m,y;if(i)try{a(!0);const v=await Coe(i);n(v.services||[]);const g=await Roe(i);s(g.service_dependencies||{}),c(null)}catch(v){c(((y=(m=v.response)==null?void 0:m.data)==null?void 0:y.detail)||"Failed to fetch service data"),console.error(v)}finally{a(!1)}})()},[i]),I.useEffect(()=>{if(e.length>0){const p=e.map(y=>{var v;return{id:y.name,name:y.name,val:(((v=y.entities)==null?void 0:v.length)||1)*2,color:f(y.name)}}),m=[];Object.entries(r).forEach(([y,v])=>{v.forEach(g=>{m.push({source:y,target:g.target,value:1,type:g.type})})}),d({nodes:p,links:m})}},[e,r]);const f=p=>{let m=0;for(let v=0;v<p.length;v++)m=p.charCodeAt(v)+((m<<5)-m);const y=(m&16777215).toString(16).toUpperCase();return"#"+"00000".substring(0,6-y.length)+y};return o?Y(An,{sx:{display:"flex",justifyContent:"center",mt:4},children:Y(Py,{})}):l?Y(Df,{severity:"error",sx:{mt:2},children:l}):lt(An,{children:[Y(It,{variant:"h4",component:"h1",gutterBottom:!0,children:"Service Boundaries"}),Y(Ys,{component:Vl,to:`/analysis/${i}`,variant:"outlined",sx:{mb:3},children:"Back to Analysis"}),e.length===0?Y(Df,{severity:"info",children:"No service boundaries identified. The repository may not have clear domain boundaries."}):lt(zW,{children:[lt(ec,{sx:{p:3,mb:4},children:[Y(It,{variant:"h6",gutterBottom:!0,children:"Service Dependency Graph"}),Y(An,{sx:{height:"500px",border:"1px solid #eee"},children:u.nodes.length>0&&Y(yk,{ref:h,graphData:u,nodeLabel:"name",nodeRelSize:6,linkDirectionalArrowLength:3.5,linkDirectionalArrowRelPos:1,linkCurvature:.25,linkLabel:p=>p.type,cooldownTicks:100,onEngineStop:()=>{var p;return(p=h.current)==null?void 0:p.zoomToFit(400)}})})]}),Y(It,{variant:"h5",gutterBottom:!0,children:"Identified Services"}),Y(Fb,{container:!0,spacing:3,children:e.map(p=>{var m,y;return Y(Fb,{item:!0,xs:12,md:6,lg:4,children:lt(oV,{children:[lt(aV,{children:[Y(It,{variant:"h6",component:"h3",gutterBottom:!0,children:p.name}),Y(It,{variant:"body2",color:"text.secondary",paragraph:!0,children:p.description||"No description available"}),Y(It,{variant:"subtitle2",gutterBottom:!0,children:"Responsibilities:"}),Y(An,{sx:{mb:2},children:(m=p.responsibilities)!=null&&m.length?p.responsibilities.map(v=>lt(It,{variant:"body2",children:["• ",v]},v)):Y(It,{variant:"body2",children:"None specified"})}),Y(It,{variant:"subtitle2",gutterBottom:!0,children:"Entities:"}),Y(An,{sx:{mb:1},children:(y=p.entities)!=null&&y.length?p.entities.map(v=>Y(fC,{label:v,size:"small",sx:{mr:.5,mb:.5}},v)):Y(It,{variant:"body2",children:"None specified"})})]}),Y(vee,{children:Y(Ys,{size:"small",children:"View Details"})})]})},p.name)})})]})]})},fIe=()=>lt(An,{sx:{textAlign:"center",py:8},children:[Y(It,{variant:"h2",component:"h1",gutterBottom:!0,children:"404"}),Y(It,{variant:"h5",component:"h2",gutterBottom:!0,children:"Page Not Found"}),Y(It,{variant:"body1",paragraph:!0,children:"The page you are looking for doesn't exist or has been moved."}),Y(Ys,{variant:"contained",component:Vl,to:"/",children:"Go to Home"})]}),pIe=()=>Y(F7,{children:lt(Qu,{path:"/",element:Y(Wre,{}),children:[Y(Qu,{index:!0,element:Y(Noe,{})}),Y(Qu,{path:"analyze",element:Y(koe,{})}),Y(Qu,{path:"analysis/:repoId",element:Y(Loe,{})}),Y(Qu,{path:"services/:repoId",element:Y(hIe,{})}),Y(Qu,{path:"*",element:Y(fIe,{})})]})});sA.createRoot(document.getElementById("root")).render(Y(ns.StrictMode,{children:Y(H7,{children:lt(DZ,{theme:VZ,children:[Y(zZ,{}),Y(pIe,{})]})})}));
//# sourceMappingURL=index-de03a12c.js.map
